{"meta":{"title":"é’åŸŸ","subtitle":null,"description":"personal IT related station","author":"tianL.R","url":"http://yoursite.com","root":"/"},"pages":[{"title":"categories","date":"2022-06-27T06:58:23.000Z","updated":"2022-06-27T07:12:49.129Z","comments":false,"path":"categories/index.html","permalink":"http://yoursite.com/categories/index.html","excerpt":"","text":""},{"title":"about","date":"2022-06-27T07:18:21.000Z","updated":"2022-06-30T03:43:24.840Z","comments":true,"path":"about/index.html","permalink":"http://yoursite.com/about/index.html","excerpt":"","text":"Thanks For Visitï¼ ï¼ˆé˜¿æ±¤å®~æ±¤é˜¿å®~ ^^ï¼‰"},{"title":"tags","date":"2022-06-27T07:18:12.000Z","updated":"2022-06-27T07:21:10.521Z","comments":false,"path":"tags/index.html","permalink":"http://yoursite.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"yolov8-ç«ç¾æ£€æµ‹","slug":"yolov8ï¼šç«ç¾æ£€æµ‹","date":"2024-01-25T09:23:20.000Z","updated":"2024-01-25T11:21:45.306Z","comments":true,"path":"2024/01/25/yolov8ï¼šç«ç¾æ£€æµ‹/","link":"","permalink":"http://yoursite.com/2024/01/25/yolov8ï¼šç«ç¾æ£€æµ‹/","excerpt":"ç¯å¢ƒGPU NVIDIA 3090*2 æ˜¾å¡é©±åŠ¨ 535.104.05 CUDAç‰ˆæœ¬ 12.2 CUDAtoolkit (cuda_12.2.2_535.104.05_linux) cuDNN (v8.9.7) yoloç‰ˆæœ¬ v8.1.5 (ultralytics yolov8) pytorchç‰ˆæœ¬ v2.1.2 pythonç¯å¢ƒ CentOS7.9 anaconda3 python3.9 å®‰è£…æºç ä¸»é¡µï¼šhttps://github.com/ultralytics/ultralytics å®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.ultralytics.com/zh å…‹éš†æºç 1git clone https://hub.nuaa.cf/ultralytics/ultralytics.git å®‰è£…ä¾èµ–1pip install pip install ultralytics -i https://mirror.baidu.com/pypi/simple ç¯å¢ƒéªŒè¯1yolo predict model=yolov8n.pt source=ultralytics/assets/zidane.jpg æ‰§è¡Œå®Œæ¯•åå¾—åˆ°è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12345678(py39_yolov8) [root@jdz yolov8]# yolo predict model=yolov8n.pt source=ultralytics/assets/zidane.jpg Ultralytics YOLOv8.1.5 ğŸš€ Python-3.9.18 torch-2.1.2+cu121 CUDA:0 (NVIDIA GeForce RTX 3090, 24260MiB)YOLOv8n summary (fused): 168 layers, 3151904 parameters, 0 gradients, 8.7 GFLOPsimage 1/1 /exp/work/video/yolov8/ultralytics/assets/zidane.jpg: 384x640 2 persons, 1 tie, 216.9msSpeed: 7.3ms preprocess, 216.9ms inference, 762.4ms postprocess per image at shape (1, 3, 384, 640)Results saved to runs/detect/predictğŸ’¡ Learn more at https://docs.ultralytics.com/modes/predict å°†åœ¨Results saved to runs/detect/predictç›®å½•ä¸‹æ‰¾åˆ°è¾“å‡ºç»“æœ","text":"ç¯å¢ƒGPU NVIDIA 3090*2 æ˜¾å¡é©±åŠ¨ 535.104.05 CUDAç‰ˆæœ¬ 12.2 CUDAtoolkit (cuda_12.2.2_535.104.05_linux) cuDNN (v8.9.7) yoloç‰ˆæœ¬ v8.1.5 (ultralytics yolov8) pytorchç‰ˆæœ¬ v2.1.2 pythonç¯å¢ƒ CentOS7.9 anaconda3 python3.9 å®‰è£…æºç ä¸»é¡µï¼šhttps://github.com/ultralytics/ultralytics å®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.ultralytics.com/zh å…‹éš†æºç 1git clone https://hub.nuaa.cf/ultralytics/ultralytics.git å®‰è£…ä¾èµ–1pip install pip install ultralytics -i https://mirror.baidu.com/pypi/simple ç¯å¢ƒéªŒè¯1yolo predict model=yolov8n.pt source=ultralytics/assets/zidane.jpg æ‰§è¡Œå®Œæ¯•åå¾—åˆ°è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12345678(py39_yolov8) [root@jdz yolov8]# yolo predict model=yolov8n.pt source=ultralytics/assets/zidane.jpg Ultralytics YOLOv8.1.5 ğŸš€ Python-3.9.18 torch-2.1.2+cu121 CUDA:0 (NVIDIA GeForce RTX 3090, 24260MiB)YOLOv8n summary (fused): 168 layers, 3151904 parameters, 0 gradients, 8.7 GFLOPsimage 1/1 /exp/work/video/yolov8/ultralytics/assets/zidane.jpg: 384x640 2 persons, 1 tie, 216.9msSpeed: 7.3ms preprocess, 216.9ms inference, 762.4ms postprocess per image at shape (1, 3, 384, 640)Results saved to runs/detect/predictğŸ’¡ Learn more at https://docs.ultralytics.com/modes/predict å°†åœ¨Results saved to runs/detect/predictç›®å½•ä¸‹æ‰¾åˆ°è¾“å‡ºç»“æœ è‡³æ­¤ï¼Œå·²éªŒè¯åŸºç¡€ç¯å¢ƒæ­£å¸¸å·¥ä½œã€‚ è®­ç»ƒé›†å‰å¾€kaggleå®˜ç½‘å¯»æ‰¾ç«ç„°è®­ç»ƒé›†ï¼Œè¿™é‡Œä½¿ç”¨Fire and Smoke Datasetæ•°æ®é›†ï¼ˆhttps://www.kaggle.com/datasets/dataclusterlabs/fire-and-smoke-datasetï¼‰ æ•°æ®é›†åŒ…å«çƒŸã€ç«å›¾åƒå…±100å¼  æ•°æ®æ ‡æ³¨æ ‡æ³¨å·¥å…·ï¼šlabelmeå¯¹å›¾åƒä¸­çš„ç«ç„°å’ŒçƒŸé›¾è¿›è¡ŒçŸ©å½¢æ ‡è®°ï¼Œå°†æ•°æ®çš„labelåˆ†ä¸ºä¸¤ç±»ï¼š0-ç«ç„°ï¼›1-çƒŸé›¾ æ•°æ®æ ¼å¼è½¬æ¢å°†labelmeæ•°æ®æ ¼å¼è½¬ä¸ºyoloæ ¼å¼ åˆ›å»ºè®­ç»ƒyamlæ–‡ä»¶åœ¨æ•°æ®é›†çš„æ ¹ç›®å½•ä¸‹æ–°å»ºfire.yamlæ–‡ä»¶ç”¨äºè®°å½•è®­ç»ƒé›†ä¿¡æ¯ 123456train: /exp/work/video/yolov8/datasets/fire/data/train/images # è®­ç»ƒé›†val: /exp/work/video/yolov8/datasets/fire/data/val/images # éªŒè¯é›†test: /exp/work/video/yolov8/datasets/fire/data/test/images # æµ‹è¯•é›†nc: 2 # åˆ†ç±»æ•°é‡names: [fire, smoke] # ç±»åˆ«åç§° è®­ç»ƒåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºè®­ç»ƒè„šæœ¬yolov8_train.pyï¼Œå¹¶è®¾ç½®åŒå¡è®­ç»ƒ 12345678910111213from ultralytics import YOLO# åŠ è½½æ¨¡å‹model = YOLO('yolov8n.pt') # åŠ è½½é¢„è®­ç»ƒæ¨¡å‹# åŒå¡è®­ç»ƒmodel.train( data='datasets/fire/data/fire.yaml', epochs=300, device=[0, 1])# å¯åŠ¨éªŒè¯model.val() å¯åŠ¨è®­ç»ƒè„šæœ¬ï¼Œå¼€å¯è®­ç»ƒ 1python yolov8_train.py æ‰“å°é…ç½®ä¿¡æ¯ 1234Ultralytics YOLOv8.1.5 ğŸš€ Python-3.9.18 torch-2.1.2+cu121 CUDA:0 (NVIDIA GeForce RTX 3090, 24260MiB) CUDA:1 (NVIDIA GeForce RTX 3090, 24260MiB)engine/trainer: task=detect, mode=train, model=yolov8n.pt, data=datasets/fire/data/fire.yaml, epochs=300, time=None, patience=50, batch=16, imgsz=640, save=True, save_period=-1, cache=False, device=[0, 1], workers=8, project=None, name=train9, exist_ok=False, pretrained=True, optimizer=auto, verbose=True, seed=0, deterministic=True, single_cls=False, rect=False, cos_lr=False, close_mosaic=10, resume=False, amp=True, fraction=1.0, profile=False, freeze=None, multi_scale=False, overlap_mask=True, mask_ratio=4, dropout=0.0, val=True, split=val, save_json=False, save_hybrid=False, conf=None, iou=0.7, max_det=300, half=False, dnn=False, plots=True, source=None, vid_stride=1, stream_buffer=False, visualize=False, augment=False, agnostic_nms=False, classes=None, retina_masks=False, embed=None, show=False, save_frames=False, save_txt=False, save_conf=False, save_crop=False, show_labels=True, show_conf=True, show_boxes=True, line_width=None, format=torchscript, keras=False, optimize=False, int8=False, dynamic=False, simplify=False, opset=None, workspace=4, nms=False, lr0=0.01, lrf=0.01, momentum=0.937, weight_decay=0.0005, warmup_epochs=3.0, warmup_momentum=0.8, warmup_bias_lr=0.1, box=7.5, cls=0.5, dfl=1.5, pose=12.0, kobj=1.0, label_smoothing=0.0, nbs=64, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, degrees=0.0, translate=0.1, scale=0.5, shear=0.0, perspective=0.0, flipud=0.0, fliplr=0.5, mosaic=1.0, mixup=0.0, copy_paste=0.0, auto_augment=randaugment, erasing=0.4, crop_fraction=1.0, cfg=None, tracker=botsort.yaml, save_dir=runs/detect/train9Overriding model.yaml nc=80 with nc=2 123456789101112131415161718192021222324252627282930313233343536373839 from n params module arguments 0 -1 1 464 ultralytics.nn.modules.conv.Conv [3, 16, 3, 2] 1 -1 1 4672 ultralytics.nn.modules.conv.Conv [16, 32, 3, 2] 2 -1 1 7360 ultralytics.nn.modules.block.C2f [32, 32, 1, True] 3 -1 1 18560 ultralytics.nn.modules.conv.Conv [32, 64, 3, 2] 4 -1 2 49664 ultralytics.nn.modules.block.C2f [64, 64, 2, True] 5 -1 1 73984 ultralytics.nn.modules.conv.Conv [64, 128, 3, 2] 6 -1 2 197632 ultralytics.nn.modules.block.C2f [128, 128, 2, True] 7 -1 1 295424 ultralytics.nn.modules.conv.Conv [128, 256, 3, 2] 8 -1 1 460288 ultralytics.nn.modules.block.C2f [256, 256, 1, True] 9 -1 1 164608 ultralytics.nn.modules.block.SPPF [256, 256, 5] 10 -1 1 0 torch.nn.modules.upsampling.Upsample [None, 2, 'nearest'] 11 [-1, 6] 1 0 ultralytics.nn.modules.conv.Concat [1] 12 -1 1 148224 ultralytics.nn.modules.block.C2f [384, 128, 1] 13 -1 1 0 torch.nn.modules.upsampling.Upsample [None, 2, 'nearest'] 14 [-1, 4] 1 0 ultralytics.nn.modules.conv.Concat [1] 15 -1 1 37248 ultralytics.nn.modules.block.C2f [192, 64, 1] 16 -1 1 36992 ultralytics.nn.modules.conv.Conv [64, 64, 3, 2] 17 [-1, 12] 1 0 ultralytics.nn.modules.conv.Concat [1] 18 -1 1 123648 ultralytics.nn.modules.block.C2f [192, 128, 1] 19 -1 1 147712 ultralytics.nn.modules.conv.Conv [128, 128, 3, 2] 20 [-1, 9] 1 0 ultralytics.nn.modules.conv.Concat [1] 21 -1 1 493056 ultralytics.nn.modules.block.C2f [384, 256, 1] 22 [15, 18, 21] 1 751702 ultralytics.nn.modules.head.Detect [2, [64, 128, 256]] Model summary: 225 layers, 3011238 parameters, 3011222 gradients, 8.2 GFLOPsTransferred 319/355 items from pretrained weightsDDP: debug command /root/anaconda3/envs/py39_yolov8/bin/python -m torch.distributed.run --nproc_per_node 2 --master_port 45027 /root/.config/Ultralytics/DDP/_temp_bfxihrb7140614302513712.pyWARNING:__main__:*****************************************Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. *****************************************Ultralytics YOLOv8.1.5 ğŸš€ Python-3.9.18 torch-2.1.2+cu121 CUDA:0 (NVIDIA GeForce RTX 3090, 24260MiB) CUDA:1 (NVIDIA GeForce RTX 3090, 24260MiB)Overriding model.yaml nc=80 with nc=2Transferred 319/355 items from pretrained weightsFreezing layer 'model.22.dfl.conv.weight'AMP: running Automatic Mixed Precision (AMP) checks with YOLOv8n...AMP: checks passed âœ… è®°å½•æ¨¡å‹è¾“å‡º 123456Plotting labels to runs/detect/train9/labels.jpg... optimizer: 'optimizer=auto' found, ignoring 'lr0=0.01' and 'momentum=0.937' and determining best 'optimizer', 'lr0' and 'momentum' automatically... optimizer: AdamW(lr=0.000714, momentum=0.9) with parameter groups 57 weight(decay=0.0), 64 weight(decay=0.0005), 63 bias(decay=0.0)Image sizes 640 train, 640 valUsing 16 dataloader workersLogging results to runs/detect/train9 è®­ç»ƒå¼€å§‹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758Starting training for 300 epochs... Epoch GPU_mem box_loss cls_loss dfl_loss Instances Size 1/300 1.38G 2.132 4.599 2.13 6 640: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:04&lt;00:00, 1.53s/it] Class Images Instances Box(P R mAP50 mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 3.10it/s] all 41 62 0.00191 0.349 0.0223 0.0121 Epoch GPU_mem box_loss cls_loss dfl_loss Instances Size 2/300 1.44G 1.984 4.085 1.942 18 640: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 5.08it/s] Class Images Instances Box(P R mAP50 mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 11.57it/s] all 41 62 0.00209 0.373 0.0247 0.0119 Epoch GPU_mem box_loss cls_loss dfl_loss Instances Size 3/300 1.48G 2.421 4.407 2.348 14 640: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 5.78it/s] Class Images Instances Box(P R mAP50 mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 10.23it/s] all 41 62 0.00205 0.373 0.0335 0.0165 Epoch GPU_mem box_loss cls_loss dfl_loss Instances Size 4/300 1.48G 1.795 3.787 1.724 18 640: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 5.61it/s] Class Images Instances Box(P R mAP50 mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 9.82it/s] all 41 62 0.00239 0.434 0.0445 0.0219 Epoch GPU_mem box_loss cls_loss dfl_loss Instances Size 5/300 1.48G 1.707 3.619 1.785 17 640: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 5.49it/s] Class Images Instances Box(P R mAP50 mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 8.87it/s] all 41 62 0.003 0.495 0.0735 0.0283...... Epoch GPU_mem box_loss cls_loss dfl_loss Instances Size 295/300 1.5G 0.3742 0.5917 0.8247 7 640: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 7.21it/s] Class Images Instances Box(P R mAP50 mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 11.40it/s] all 41 62 0.996 1 0.995 0.946 Epoch GPU_mem box_loss cls_loss dfl_loss Instances Size 296/300 1.44G 0.4263 0.6716 0.8004 7 640: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 6.86it/s] Class Images Instances Box(P R mAP50 mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 11.97it/s] all 41 62 0.996 1 0.995 0.945 Epoch GPU_mem box_loss cls_loss dfl_loss Instances Size 297/300 1.5G 0.473 0.6775 0.8499 7 640: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 7.20it/s] Class Images Instances Box(P R mAP50 mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 11.12it/s] all 41 62 0.996 1 0.995 0.945 Epoch GPU_mem box_loss cls_loss dfl_loss Instances Size 298/300 1.51G 0.4877 0.6956 0.8936 11 640: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 6.73it/s] Class Images Instances Box(P R mAP50 mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 11.03it/s] all 41 62 0.996 1 0.995 0.942 Epoch GPU_mem box_loss cls_loss dfl_loss Instances Size 299/300 1.5G 0.4303 0.622 0.8264 6 640: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 6.89it/s] Class Images Instances Box(P R mAP50 mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 11.62it/s] all 41 62 0.996 1 0.995 0.941 Epoch GPU_mem box_loss cls_loss dfl_loss Instances Size 300/300 1.44G 0.4593 0.6413 0.8419 6 640: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 6.31it/s] Class Images Instances Box(P R mAP50 mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 11.83it/s] all 41 62 0.995 1 0.995 0.94 è®­ç»ƒç»“æŸï¼ŒéªŒè¯ 1234567891011121314151617181920212223300 epochs completed in 0.101 hours.Optimizer stripped from runs/detect/train9/weights/last.pt, 6.3MBOptimizer stripped from runs/detect/train9/weights/best.pt, 6.3MBValidating runs/detect/train9/weights/best.pt...Ultralytics YOLOv8.1.5 ğŸš€ Python-3.9.18 torch-2.1.2+cu121 CUDA:0 (NVIDIA GeForce RTX 3090, 24260MiB) CUDA:1 (NVIDIA GeForce RTX 3090, 24260MiB)Model summary (fused): 168 layers, 3006038 parameters, 0 gradients, 8.1 GFLOPs Class Images Instances Box(P R mAP50 mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00&lt;00:00, 10.62it/s] all 41 62 0.996 1 0.995 0.946 fire 41 41 0.999 1 0.995 0.938 smoke 41 21 0.992 1 0.995 0.955Speed: 0.1ms preprocess, 1.4ms inference, 0.0ms loss, 1.0ms postprocess per imageResults saved to runs/detect/train9Ultralytics YOLOv8.1.5 ğŸš€ Python-3.9.18 torch-2.1.2+cu121 CUDA:0 (NVIDIA GeForce RTX 3090, 24260MiB) CUDA:1 (NVIDIA GeForce RTX 3090, 24260MiB)Model summary (fused): 168 layers, 3006038 parameters, 0 gradients, 8.1 GFLOPs Class Images Instances Box(P R mAP50 mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:04&lt;00:00, 1.41s/it] all 41 62 0.996 1 0.995 0.941 fire 41 41 0.999 1 0.995 0.939 smoke 41 21 0.992 1 0.995 0.942Speed: 0.2ms preprocess, 14.3ms inference, 0.0ms loss, 16.8ms postprocess per imageResults saved to runs/detect/train92 è¯„ä¼°è¿›å…¥ä¿å­˜è®­ç»ƒç»“æœçš„æ–‡ä»¶å¤¹å†…ï¼Œå…¶ä¸­weightsæ–‡ä»¶å¤¹åŒ…å«äº†æœ€ä½³è®­ç»ƒæ¨¡å‹å’Œæœ€è¿‘è®­ç»ƒæ¨¡å‹ï¼Œæ–‡ä»¶å¤¹å¤–å­˜å‚¨è®­ç»ƒçš„å„é¡¹è®°å½•å’Œæµ‹è¯•æ›²çº¿ç­‰ result.csvæ–‡ä»¶ä¸­è®°å½•äº†300è½®epochçš„è¯¦ç»†ç»“æœ é¢„æµ‹åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºé¢„æµ‹è„šæœ¬yolov8_test.py 1234from ultralytics import YOLOmodel = YOLO('runs/detect/train9/weights/best.pt') # æŒ‡å®šæœ€ä½³æ¨¡å‹model.predict('video/fire.mp4', save=True, classes=[0, 1]) # æŒ‡å®šè¾“å‡ºç±»åˆ« æ‰§è¡Œ 123456789101112131415161718192021222324252627282930313233video 1/1 (1/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 1 fire, 208.5msvideo 1/1 (2/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 (no detections), 9.6msvideo 1/1 (3/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 (no detections), 7.9msvideo 1/1 (4/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 (no detections), 7.9msvideo 1/1 (5/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 (no detections), 8.0msvideo 1/1 (6/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 (no detections), 7.8msvideo 1/1 (7/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 (no detections), 7.7msvideo 1/1 (8/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 (no detections), 7.6msvideo 1/1 (9/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 (no detections), 7.9msvideo 1/1 (10/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 (no detections), 7.8msvideo 1/1 (11/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 (no detections), 8.1msvideo 1/1 (12/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 (no detections), 8.1msvideo 1/1 (13/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 (no detections), 8.2msvideo 1/1 (14/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 (no detections), 8.0msvideo 1/1 (15/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 (no detections), 7.7msvideo 1/1 (16/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 (no detections), 7.8msvideo 1/1 (17/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 (no detections), 7.6msvideo 1/1 (18/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 1 fire, 7.6msvideo 1/1 (19/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 1 fire, 7.8msvideo 1/1 (20/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 1 fire, 7.6msvideo 1/1 (21/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 1 fire, 7.8msvideo 1/1 (22/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 2 fires, 7.7msvideo 1/1 (23/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 1 fire, 7.6msvideo 1/1 (24/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 1 fire, 7.5msvideo 1/1 (25/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 1 fire, 7.7msvideo 1/1 (26/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 1 fire, 7.5msvideo 1/1 (27/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 1 fire, 7.4msvideo 1/1 (28/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 1 fire, 7.6msvideo 1/1 (29/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 1 fire, 7.8msvideo 1/1 (30/306) /exp/work/video/yolov8/video/fire.mp4: 384x640 1 fire, 7.7ms...Speed: 2.2ms preprocess, 8.3ms inference, 3.8ms postprocess per image at shape (1, 3, 384, 640)Results saved to runs/detect/predict13","categories":[{"name":"ç›®æ ‡æ£€æµ‹","slug":"ç›®æ ‡æ£€æµ‹","permalink":"http://yoursite.com/categories/ç›®æ ‡æ£€æµ‹/"}],"tags":[{"name":"opencv","slug":"opencv","permalink":"http://yoursite.com/tags/opencv/"},{"name":"yolov8","slug":"yolov8","permalink":"http://yoursite.com/tags/yolov8/"}]},{"title":"NetworkX: å›¾è®ºç®—æ³•åº”ç”¨","slug":"NetworkX-å›¾è®ºç®—æ³•åº”ç”¨","date":"2024-01-08T07:48:56.000Z","updated":"2024-01-25T08:23:02.432Z","comments":true,"path":"2024/01/08/NetworkX-å›¾è®ºç®—æ³•åº”ç”¨/","link":"","permalink":"http://yoursite.com/2024/01/08/NetworkX-å›¾è®ºç®—æ³•åº”ç”¨/","excerpt":"NetworkXNetworkXæ˜¯ä¸€æ¬¾Pythonçš„è½¯ä»¶åŒ…ï¼Œç”¨äºåˆ›é€ ã€æ“ä½œå¤æ‚ç½‘ç»œï¼Œä»¥åŠå­¦ä¹ å¤æ‚ç½‘ç»œçš„ç»“æ„ã€åŠ¨åŠ›å­¦åŠå…¶åŠŸèƒ½ã€‚æœ‰äº†NetworkXå°±å¯ä»¥ç”¨æ ‡å‡†æˆ–è€…ä¸æ ‡å‡†çš„æ•°æ®æ ¼å¼åŠ è½½æˆ–è€…å­˜å‚¨ç½‘ç»œï¼Œå®ƒå¯ä»¥äº§ç”Ÿè®¸å¤šç§ç±»çš„éšæœºç½‘ç»œæˆ–ç»å…¸ç½‘ç»œï¼Œä¹Ÿå¯ä»¥åˆ†æç½‘ç»œç»“æ„ã€å»ºç«‹ç½‘ç»œæ¨¡å‹ã€è®¾è®¡æ–°çš„ç½‘ç»œç®—æ³•ã€ç»˜åˆ¶ç½‘ç»œç­‰ å‚è€ƒæ–‡çŒ®åœ°å€: https://www.osgeo.cn/networkx/reference/index.html å›¾è®¡ç®—åº”ç”¨æ–¹å¼æ¯”è¾ƒ1.nebula + sparkä¾èµ–nebula-spark-connectoråŒ…ã€nebula-algorithmåŒ…å’Œsparké›†ç¾¤çš„æ•°æ®è¯»å–ã€å›¾è®¡ç®—æ–¹å¼ 2.clickhouse + NetworkXç”±äºnebula-algorithmä¾èµ–sparké›†ç¾¤ï¼Œä¸”nebula-consoleåŸç”Ÿçš„æ•°æ®è¯»å–èƒ½åŠ›ä¸ä½³ï¼Œåœ¨ç¯å¢ƒå—é™ä¸”è®¡ç®—é‡æœ‰é™çš„æƒ…å†µä¸‹ä¼˜å…ˆè€ƒè™‘è·³è¿‡sparké›†ç¾¤å’Œnebulaå›¾åº“ï¼Œé‡‡ç”¨clickhouse + NetworkXçš„å›¾è®¡ç®—æ–¹å¼ï¼Œå…¶ä¸­clickhouseæ˜¯å­˜å‚¨äº†nebulaæºæ•°æ®çš„åˆ—å¼åˆ†å¸ƒå¼è¡¨ï¼Œä½œç”¨ç±»ä¼¼äºæ–¹æ³•1ä¸­å°†nebulaé›†ç¾¤æ•°æ®é€šè¿‡nebula-spark-connectoråŒ…å¯¼å…¥ä¸ºspark-DataFrameï¼Œä»…ç”¨åšæ•°æ®è¯»å–ï¼Œå†é€šè¿‡å°†æ•°æ®è½¬åŒ–ä¸ºNetworkXçš„å›¾ç»“æ„è¿›è¡Œå›¾è®¡ç®—","text":"NetworkXNetworkXæ˜¯ä¸€æ¬¾Pythonçš„è½¯ä»¶åŒ…ï¼Œç”¨äºåˆ›é€ ã€æ“ä½œå¤æ‚ç½‘ç»œï¼Œä»¥åŠå­¦ä¹ å¤æ‚ç½‘ç»œçš„ç»“æ„ã€åŠ¨åŠ›å­¦åŠå…¶åŠŸèƒ½ã€‚æœ‰äº†NetworkXå°±å¯ä»¥ç”¨æ ‡å‡†æˆ–è€…ä¸æ ‡å‡†çš„æ•°æ®æ ¼å¼åŠ è½½æˆ–è€…å­˜å‚¨ç½‘ç»œï¼Œå®ƒå¯ä»¥äº§ç”Ÿè®¸å¤šç§ç±»çš„éšæœºç½‘ç»œæˆ–ç»å…¸ç½‘ç»œï¼Œä¹Ÿå¯ä»¥åˆ†æç½‘ç»œç»“æ„ã€å»ºç«‹ç½‘ç»œæ¨¡å‹ã€è®¾è®¡æ–°çš„ç½‘ç»œç®—æ³•ã€ç»˜åˆ¶ç½‘ç»œç­‰ å‚è€ƒæ–‡çŒ®åœ°å€: https://www.osgeo.cn/networkx/reference/index.html å›¾è®¡ç®—åº”ç”¨æ–¹å¼æ¯”è¾ƒ1.nebula + sparkä¾èµ–nebula-spark-connectoråŒ…ã€nebula-algorithmåŒ…å’Œsparké›†ç¾¤çš„æ•°æ®è¯»å–ã€å›¾è®¡ç®—æ–¹å¼ 2.clickhouse + NetworkXç”±äºnebula-algorithmä¾èµ–sparké›†ç¾¤ï¼Œä¸”nebula-consoleåŸç”Ÿçš„æ•°æ®è¯»å–èƒ½åŠ›ä¸ä½³ï¼Œåœ¨ç¯å¢ƒå—é™ä¸”è®¡ç®—é‡æœ‰é™çš„æƒ…å†µä¸‹ä¼˜å…ˆè€ƒè™‘è·³è¿‡sparké›†ç¾¤å’Œnebulaå›¾åº“ï¼Œé‡‡ç”¨clickhouse + NetworkXçš„å›¾è®¡ç®—æ–¹å¼ï¼Œå…¶ä¸­clickhouseæ˜¯å­˜å‚¨äº†nebulaæºæ•°æ®çš„åˆ—å¼åˆ†å¸ƒå¼è¡¨ï¼Œä½œç”¨ç±»ä¼¼äºæ–¹æ³•1ä¸­å°†nebulaé›†ç¾¤æ•°æ®é€šè¿‡nebula-spark-connectoråŒ…å¯¼å…¥ä¸ºspark-DataFrameï¼Œä»…ç”¨åšæ•°æ®è¯»å–ï¼Œå†é€šè¿‡å°†æ•°æ®è½¬åŒ–ä¸ºNetworkXçš„å›¾ç»“æ„è¿›è¡Œå›¾è®¡ç®— åº”ç”¨å®ä¾‹nebulaé›†ç¾¤å­˜å‚¨ä»¥ç¾¤èŠå’Œç¾¤æˆå‘˜ã€å¥½å‹å…³ç³»æ‰€ç»„æˆçš„å…³ç³»ç½‘ï¼Œclickhouseé›†ç¾¤å­˜å‚¨èŠ‚ç‚¹æºæ•°æ®å’Œå¯¹åº”å…³ç³» ä¸€ã€é›†åˆè¿ç®—äº¤ã€å¹¶ã€å·®é›† ç›´æ¥ä½¿ç”¨clickhouseè¿›è¡ŒæŸ¥è¯¢ï¼Œé€‚ç”¨äºä¸¤ä¸ªç¾¤ç»„æˆå‘˜æˆ–è´¦å·æ‰€åŠ ç¾¤çš„äº¤å¹¶å·®é›† è¾“å…¥ï¼š Â· nä¸ªè´¦å·ï¼ˆnâ‰¥2ï¼‰ Â· nä¸ªç¾¤ç»„ï¼ˆnâ‰¥2ï¼‰ äºŒã€è·¯å¾„æ¢å¯»ç›´æ¥ä½¿ç”¨nebulaè¿›è¡ŒæŸ¥è¯¢ï¼Œé€‚ç”¨äºæœç´¢å›¾è°±ä¸­ä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹çš„æœ€çŸ­å¯è¾¾è·¯å¾„ è¾“å…¥ï¼š Â· ä»»æ„ç±»å‹2ä¸ªèŠ‚ç‚¹ ä¸‰ã€ä¸­å¿ƒæ€§è¾“å…¥ï¼š Â· nä¸ªç¾¤ç»„ï¼ˆnâ‰¥1ï¼‰ï¼Œåˆ†æåŒ…æ‹¬æŒ‡å®šnä¸ªç¾¤ç»„ã€ç¾¤ç»„ç¾¤æˆå‘˜ã€ç¾¤æˆå‘˜æ‰€åŠ ç¾¤ç»„æˆå…³ç³»ç½‘å„èŠ‚ç‚¹çš„ä¸­å¿ƒæ€§ Â· nä¸ªè´¦å·ï¼ˆnâ‰¥1ï¼‰ï¼Œåˆ†æåŒ…æ‹¬æŒ‡å®šnä¸ªè´¦å·ã€è´¦å·æ‰€åŠ ç¾¤ã€ç¾¤æˆå‘˜ç»„æˆå…³ç³»ç½‘å„èŠ‚ç‚¹çš„ä¸­å¿ƒæ€§ Â· æŒ‡å®šå…³ç³»ç½‘ï¼Œåˆ†æå„èŠ‚ç‚¹ä¸­å¿ƒæ€§ ClickHouse SQLç¤ºä¾‹ï¼ˆå…³ç³»å›¾è°±ï¼‰ï¼š 123SELECT team_id,account_id FROM mqv3.ly_team_ship lts PREWHERE account_id GLOBAL IN (SELECT account_id FROM mqv3.ly_team_ship lts PREWHERE team_id='&#123;src_vid&#125;'); 1.åº¦ä¸­å¿ƒæ€§è¡¡é‡èŠ‚ç‚¹ä¸­å¿ƒæ€§çš„æŒ‡æ ‡ 123res = nx.degree_centrality(G)res = dict(sorted(res.items(), key=lambda x: x[1], reverse=True))print(res) e.g. ä»¥ç¾¤ï¼ˆ-1151413367ã€-1541749047ï¼‰ä¸ºæŒ‡å®šèŠ‚ç‚¹ï¼Œè®¡ç®—ä¸‰çº§å…³ç³»ç½‘å„èŠ‚ç‚¹åº¦ä¸­å¿ƒæ€§ï¼ˆæŠ›å¼ƒåº¦&lt;5çš„èŠ‚ç‚¹ï¼Œçªå‡ºç»“æ„ï¼‰ 2.æ¥è¿‘ä¸­å¿ƒæ€§åæ˜ åœ¨å…³ç³»ç½‘ç»œä¸­æŸä¸€èŠ‚ç‚¹ä¸å…¶ä»–èŠ‚ç‚¹ä¹‹é—´çš„æ¥è¿‘ç¨‹åº¦ 123res = nx.closeness_centrality(G)res = dict(sorted(res.items(), key=lambda x: x[1], reverse=True))print(res) e.g. ä»¥ç¾¤ï¼ˆ-1151413367ã€-1541749047ï¼‰ä¸ºæŒ‡å®šèŠ‚ç‚¹ï¼Œè®¡ç®—ä¸‰çº§å…³ç³»ç½‘å„èŠ‚ç‚¹æ¥è¿‘ä¸­å¿ƒæ€§ï¼ˆæŠ›å¼ƒåº¦&lt;50çš„èŠ‚ç‚¹ï¼Œçªå‡ºç»“æ„ï¼‰ 3.ä¸­ä»‹ä¸­å¿ƒæ€§ä»¥ç»è¿‡æŸä¸ªèŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„æ•°ç›®æ¥åˆ»ç”»èŠ‚ç‚¹é‡è¦æ€§çš„æŒ‡æ ‡ 123res = nx.betweenness_centrality(G, k=1000)res = dict(sorted(res.items(), key=lambda x: x[1], reverse=True))print(res) e.g. ä»¥ç¾¤ï¼ˆ-1151413367ã€-1541749047ï¼‰ä¸ºæŒ‡å®šèŠ‚ç‚¹ï¼Œè®¡ç®—ä¸‰çº§å…³ç³»ç½‘å„èŠ‚ç‚¹ä¸­ä»‹ä¸­å¿ƒæ€§ï¼ˆæŠ›å¼ƒåº¦&lt;5çš„èŠ‚ç‚¹ï¼Œçªå‡ºç»“æ„ï¼‰ 4.ç‰¹å¾å‘é‡ä¸­å¿ƒæ€§å…³ç³»ç½‘ç»œä¸­ä¸€ä¸ªèŠ‚ç‚¹çš„é‡è¦æ€§æ—¢å–å†³äºå…¶é‚»å±…èŠ‚ç‚¹çš„æ•°é‡ï¼ˆå³è¯¥èŠ‚ç‚¹çš„åº¦ï¼‰ï¼Œä¹Ÿå–å†³äºå…¶é‚»å±…èŠ‚ç‚¹çš„é‡è¦æ€§ 123res = nx.eigenvector_centrality(G)res = dict(sorted(res.items(), key=lambda x: x[1], reverse=True))print(res) e.g. ä»¥ç¾¤ï¼ˆ-1151413367ã€-1541749047ï¼‰ä¸ºæŒ‡å®šèŠ‚ç‚¹ï¼Œè®¡ç®—ä¸‰çº§å…³ç³»ç½‘å„èŠ‚ç‚¹ç‰¹å¾å‘é‡ä¸­å¿ƒæ€§ï¼ˆæŠ›å¼ƒåº¦&lt;5çš„èŠ‚ç‚¹ï¼Œçªå‡ºç»“æ„ï¼‰ å››ã€é‡è¦æ€§è¾“å…¥ï¼š Â· nä¸ªç¾¤ç»„ï¼ˆnâ‰¥1ï¼‰ï¼Œåˆ†æåŒ…æ‹¬æŒ‡å®šnä¸ªç¾¤ç»„ã€ç¾¤ç»„ç¾¤æˆå‘˜ã€ç¾¤æˆå‘˜æ‰€åŠ ç¾¤ç»„æˆå…³ç³»ç½‘å„èŠ‚ç‚¹çš„é‡è¦ç¨‹åº¦ Â· nä¸ªè´¦å·ï¼ˆnâ‰¥1ï¼‰ï¼Œåˆ†æåŒ…æ‹¬æŒ‡å®šnä¸ªè´¦å·ã€è´¦å·æ‰€åŠ ç¾¤ã€ç¾¤æˆå‘˜ç»„æˆå…³ç³»ç½‘å„èŠ‚ç‚¹çš„é‡è¦ç¨‹åº¦ Â· æŒ‡å®šå…³ç³»ç½‘ï¼Œåˆ†æå„èŠ‚ç‚¹çš„é‡è¦ç¨‹åº¦ 1.kæ ¸ç”¨äºåœ¨å›¾ä¸­å¯»æ‰¾ç¬¦åˆä¸€å®šç´§å¯†å…³ç³»æ¡ä»¶ï¼ˆKï¼‰çš„å­å›¾ç»“æ„çš„ç®—æ³•ï¼Œè¦æ±‚æ¯ä¸ªé¡¶ç‚¹è‡³å°‘ä¸è¯¥å­å›¾çš„å…¶ä»–Kä¸ªé¡¶ç‚¹å…³è” 12345res1 = nx.core_number(G)res2 = nx.k_core(G, 6)res1 = dict(sorted(res1.items(), key=lambda x: x[1], reverse=True))print(res1)print(list(res2)) e.g. ä»¥ç¾¤ï¼ˆ-1151413367ã€-1541749047ï¼‰ä¸ºæŒ‡å®šèŠ‚ç‚¹ï¼Œè®¡ç®—ä¸‰çº§å…³ç³»ç½‘å„èŠ‚ç‚¹k-coreå€¼ï¼Œç»“åˆlouvainç¤¾åŒºä¸Šè‰²ï¼ˆå…¨å›¾ï¼‰ 2.PageRankè¡¡é‡å›¾ä¸­èŠ‚ç‚¹é‡è¦æ€§çš„æŒ‡æ ‡ï¼Œå€¼è¶Šé«˜ï¼Œå›¾ä¸­è®¿é—®è¯¥èŠ‚ç‚¹çš„æ¦‚ç‡è¶Šé«˜ 123res = nx.pagerank(G, alpha=0.85)res = dict(sorted(res.items(), key=lambda x: x[1], reverse=True))print(res) e.g.1. ä»¥ç¾¤ï¼ˆ-1151413367ã€-1541749047ï¼‰ä¸ºæŒ‡å®šèŠ‚ç‚¹ï¼Œè®¡ç®—ä¸‰çº§å…³ç³»ç½‘å„èŠ‚ç‚¹pagerankå€¼ï¼ˆæŠ›å¼ƒåº¦&lt;5çš„èŠ‚ç‚¹ï¼Œçªå‡ºç»“æ„ï¼‰ e.g.2. ä»¥ç¾¤ï¼ˆ-1151413367ã€-1541749047ï¼‰ä¸ºæŒ‡å®šèŠ‚ç‚¹ï¼Œè®¡ç®—ä¸‰çº§å…³ç³»ç½‘å„èŠ‚ç‚¹pagerankå€¼ï¼Œç»“åˆlouvainç¤¾åŒºï¼ˆå…¨å›¾ï¼‰ äº”ã€èšç±»ç®—æ³•è¾“å…¥ï¼ˆç¤¾åŒºå‘ç°ï¼‰ï¼š Â· nä¸ªç¾¤ç»„ï¼ˆnâ‰¥1ï¼‰ï¼Œåˆ’åˆ†åŒ…æ‹¬æŒ‡å®šnä¸ªç¾¤ç»„ã€ç¾¤ç»„ç¾¤æˆå‘˜ã€ç¾¤æˆå‘˜æ‰€åŠ ç¾¤ç»„æˆå…³ç³»ç½‘çš„å„ä¸ªç¤¾åŒº Â· nä¸ªè´¦å·ï¼ˆnâ‰¥1ï¼‰ï¼Œåˆ’åˆ†åŒ…æ‹¬æŒ‡å®šnä¸ªè´¦å·ã€è´¦å·æ‰€åŠ ç¾¤ã€ç¾¤æˆå‘˜ç»„æˆå…³ç³»ç½‘çš„å„ä¸ªç¤¾åŒº Â· åˆ’åˆ†æŒ‡å®šå…³ç³»ç½‘å„èŠ‚ç‚¹çš„ç¤¾åŒº è¾“å…¥ï¼ˆä¸‰è§’å½¢è®¡æ•°ï¼‰ï¼š Â· nä¸ªç¾¤ç»„ï¼ˆnâ‰¥1ï¼‰ï¼Œè®¡ç®—åŒ…æ‹¬æŒ‡å®šnä¸ªç¾¤ç»„ã€ç¾¤ç»„ç¾¤æˆå‘˜ã€ç¾¤æˆå‘˜å¥½å‹ã€ç¾¤æˆå‘˜æ‰€åŠ ç¾¤ç»„ã€ç¾¤æˆå‘˜æ‰€åŠ ç¾¤ç»„æˆå…³ç³»ç½‘çš„ä¸‰è§’å½¢æ•°é‡ï¼ŒæŒ–æ˜å›¢ä½“å…³ç³» Â· è®¡ç®—æŒ‡å®šå…³ç³»ç½‘å„èŠ‚ç‚¹çš„ä¸‰è§’å½¢æ•°é‡ï¼ŒæŒ–æ˜å›¢ä½“å…³ç³» ç”¨äºè®¡ç®—å›¾è°±ä¸­ä¸‰è§’å…³ç³»æ•°é‡ï¼ŒæŒ–æ˜å…³ç³»å›¢ä½“ ClickHouse SQLç¤ºä¾‹ï¼ˆä¸‰è§’å½¢è®¡æ•°ï¼‰ï¼š 12345678910111213141516WITH T AS(-- æŒ‡å®šç¾¤ç¾¤æˆå‘˜SELECT DISTINCT team_id,account_id FROM mqv3.ly_team_ship PREWHERE team_id = '&#123;src_vid&#125;'),T1 AS(-- æŒ‡å®šç¾¤ç¾¤æˆå‘˜çš„å¥½å‹SELECT DISTINCT account_id,fri_account_id FROM mqv3.ly_account_ship PREWHERE account_id GLOBAL IN (SELECT account_id FROM T) UNION DISTINCT SELECT DISTINCT fri_account_id,account_id FROM mqv3.ly_account_ship PREWHERE fri_account_id GLOBAL IN (SELECT account_id FROM T)),T2 AS(-- ç¾¤æˆå‘˜æ‰€åŠ ç¾¤SELECT DISTINCT team_id,account_id FROM mqv3.ly_team_ship PREWHERE account_id GLOBAL IN (SELECT account_id FROM T)),T3 AS(-- ç¾¤æˆå‘˜æ‰€åŠ ç¾¤å’Œç¾¤æˆå‘˜å’Œç¾¤æˆå‘˜çš„å¥½å‹SELECT DISTINCT team_id,account_id,fri_account_id FROM T2 RIGHT JOIN T1 ON T2.account_id = T1.account_id),T4 AS(-- ç¾¤æˆå‘˜å¥½å‹æ‰€åŠ ç¾¤SELECT DISTINCT team_id,account_id AS fri_account_id FROM mqv3.ly_team_ship lts PREWHERE lts.account_id GLOBAL IN (SELECT fri_account_id FROM T1)),T5 AS(-- å…±åŒæ‰€åŠ ç¾¤SELECT DISTINCT team_id,account_id,fri_account_id FROM T3 JOIN T4 ON (T3.team_id = T4.team_id AND T3.fri_account_id = T4.fri_account_id))select DISTINCT team_id,account_id,fri_account_id from T5 1.æ ‡ç­¾ä¼ æ’­ï¼ˆLPAç¤¾åŒºå‘ç°ï¼‰åŸºäºlpaçš„ç¤¾åŒºåˆ’åˆ† 12res = nx.algorithms.community.label_propagation_communities(G)print(list(res)) e.g.ä»¥ç¾¤ï¼ˆ-1151413367ã€-1541749047ï¼‰ä¸ºæŒ‡å®šèŠ‚ç‚¹ï¼Œåˆ’åˆ†lpaæ ‡ç­¾ä¼ æ’­ç¤¾åŒºï¼ˆæŠ›å¼ƒåº¦&lt;5çš„èŠ‚ç‚¹ï¼Œçªå‡ºç»“æ„ï¼‰ 2.é²æ±¶ï¼ˆLouvainç¤¾åŒºå‘ç°ï¼‰åŸºäºlouvainçš„ç¤¾åŒºåˆ’åˆ† 12res = nx.algorithms.community.louvain_communities(G, resolution=0.5)print(res) e.g.1.ä»¥ç¾¤ï¼ˆ-1151413367ã€-1541749047ï¼‰ä¸ºæŒ‡å®šèŠ‚ç‚¹ï¼Œåˆ’åˆ†louvainé²æ±¶ç¤¾åŒºï¼ˆresolution=1ï¼ŒæŠ›å¼ƒåº¦&lt;5çš„èŠ‚ç‚¹ï¼Œçªå‡ºç»“æ„ï¼‰ e.g.2.ä»¥ç¾¤ï¼ˆ-1151413367ã€-1541749047ï¼‰ä¸ºæŒ‡å®šèŠ‚ç‚¹ï¼Œåˆ’åˆ†louvainé²æ±¶ç¤¾åŒºï¼ˆresolution=0.3ï¼ŒæŠ›å¼ƒåº¦&lt;5çš„èŠ‚ç‚¹ï¼Œçªå‡ºç»“æ„ï¼‰ 3.ä¸‰è§’å½¢è®¡æ•°123res = nx.triangles(G)res = dict(sorted(res.items(), key=lambda x: x[1], reverse=True))print(res) e.g.ä»¥ç¾¤ï¼ˆ-1151413367ã€-1541749047ï¼‰ä¸ºæŒ‡å®šèŠ‚ç‚¹ï¼Œè®¡ç®—å…³ç³»ç½‘ä¸­å„ä¸ªèŠ‚ç‚¹ä¸‰è§’å½¢æ•°é‡ï¼ˆæŠ›å¼ƒåº¦&lt;5çš„èŠ‚ç‚¹ï¼Œçªå‡ºç»“æ„ï¼‰ å…­ã€è¿é€šæ€§è¾“å…¥ï¼š Â· æŒ‡å®šnä¸ªç¾¤ç»„ï¼ˆnâ‰¥2ï¼‰ï¼Œåˆ¤æ–­ç¾¤ç»„ã€ç¾¤æˆå‘˜ã€ç¾¤æˆå‘˜æ‰€åŠ ç¾¤æ‰€ç»„å…³ç³»ç½‘æ˜¯å¦ä¸ºè¿é€šå›¾ Â· æŒ‡å®šnä¸ªè´¦å·ï¼ˆnâ‰¥2ï¼‰ï¼Œåˆ¤æ–­è´¦å·ã€è´¦å·æ‰€åŠ ç¾¤ã€ç¾¤æˆå‘˜æ‰€ç»„å…³ç³»ç½‘æ˜¯å¦ä¸ºè¿é€šå›¾ Â· æŒ‡å®šå…³ç³»ç½‘ 1.è¿é€šæ€§æ£€æµ‹åˆ¤æ–­ç›®æ ‡å›¾è°±æ˜¯å¦ä¸ºè¿é€šå›¾ 12res1 = nx.is_connected(G)print(res1) e.g.1.è¿é€šå›¾ e.g.2.éè¿é€šå›¾ 2.è”é€šç»„ä»¶æ•°åˆ¤æ–­ç›®æ ‡å›¾è°±ä¸­è”é€šç»„ä»¶çš„æ•°é‡ï¼ˆnï¼‰ 12res2 = nx.number_connected_components(G)print(res2) 3.è”é€šç»„ä»¶æ˜¾ç¤ºç›®æ ‡å›¾è°±ä¸­çš„å…¨éƒ¨è”é€šç»„ä»¶ 12res3 = nx.connected_components(G)print(res3) 4.æŒ‡å®šèŠ‚ç‚¹è”é€šç»„ä»¶æ˜¾ç¤ºç›®æ ‡å›¾è°±ä¸­æŒ‡å®šèŠ‚ç‚¹æ‰€åœ¨çš„è”é€šç»„ä»¶ 12res4 = nx.node_connected_component(G, \"sample_node\")print(res4) ä¸ƒã€å‡ ä½•è¾“å…¥ï¼š Â· æŒ‡å®šnä¸ªç¾¤ç»„ï¼ˆnâ‰¥2ï¼‰ï¼Œè®¡ç®—ç¾¤ç»„ã€ç¾¤æˆå‘˜ã€ç¾¤æˆå‘˜æ‰€åŠ ç¾¤æ‰€ç»„å…³ç³»ç½‘çš„ä¸­å¿ƒã€é‡å¿ƒ Â· æŒ‡å®šnä¸ªè´¦å·ï¼ˆnâ‰¥2ï¼‰ï¼Œè®¡ç®—è´¦å·ã€è´¦å·æ‰€åŠ ç¾¤ã€ç¾¤æˆå‘˜æ‰€ç»„å…³ç³»ç½‘çš„ä¸­å¿ƒã€é‡å¿ƒ Â· è®¡ç®—æŒ‡å®šå…³ç³»ç½‘å‡ ä½•ä¸­å¿ƒã€é‡å¿ƒ 1.å‡ ä½•é‡å¿ƒå›¾çš„é‡å¿ƒèŠ‚ç‚¹ 12res1 = nx.barycenter(G)print(res1) 2.å‡ ä½•ä¸­å¿ƒå›¾çš„ä¸­å¿ƒèŠ‚ç‚¹ 12res2 = nx.center(G)print(res2) ç»˜å›¾e.g. ä¸­å¿ƒä¸­å¿ƒæ€§ + LPAæ ‡ç­¾ä¼ æ’­ç®—æ³•èšç±» æ•°æ®æºï¼šhttps://www.inetbio.org/wormnet/downloadnetwork.php Â· WormNet v.3-GS (https://www.inetbio.org/wormnet/download.php?type=2) å®Œæ•´ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172from random import sampleimport networkx as nximport matplotlib.pyplot as plt# Gold standard data of positive gene functional associations# from https://www.inetbio.org/wormnet/downloadnetwork.phpG = nx.read_edgelist(\"WormNet.v3.benchmark.txt\")# remove randomly selected nodes (to make example fast)num_to_remove = int(len(G) / 1.5)nodes = sample(list(G.nodes), num_to_remove)G.remove_nodes_from(nodes)# remove low-degree nodeslow_degree = [n for n, d in G.degree() if d &lt; 10]G.remove_nodes_from(low_degree)# largest connected componentcomponents = nx.connected_components(G)largest_component = max(components, key=len)H = G.subgraph(largest_component)# compute centralitycentrality = nx.betweenness_centrality(H, k=10, endpoints=True)# compute community structurelpc = nx.community.label_propagation_communities(H)community_index = &#123;n: i for i, com in enumerate(lpc) for n in com&#125;#### draw graph ####fig, ax = plt.subplots(figsize=(20, 15))pos = nx.spring_layout(H, k=0.15, seed=4572321)node_color = [community_index[n] for n in H]node_size = [v * 20000 for v in centrality.values()]nx.draw_networkx( H, pos=pos, with_labels=False, node_color=node_color, node_size=node_size, edge_color=\"gainsboro\", alpha=0.4,)# Title/legendfont = &#123;\"color\": \"k\", \"fontweight\": \"bold\", \"fontsize\": 20&#125;ax.set_title(\"Gene functional association network (C. elegans)\", font)# Change font color for legendfont[\"color\"] = \"r\"ax.text( 0.80, 0.10, \"node color = community structure\", horizontalalignment=\"center\", transform=ax.transAxes, fontdict=font,)ax.text( 0.80, 0.06, \"node size = betweeness centrality\", horizontalalignment=\"center\", transform=ax.transAxes, fontdict=font,)# Resize figure for label readibilityax.margins(0.1, 0.05)fig.tight_layout()plt.axis(\"off\")plt.show()","categories":[{"name":"NetworkX","slug":"NetworkX","permalink":"http://yoursite.com/categories/NetworkX/"}],"tags":[{"name":"nebula","slug":"nebula","permalink":"http://yoursite.com/tags/nebula/"},{"name":"å›¾ç®—æ³•","slug":"å›¾ç®—æ³•","permalink":"http://yoursite.com/tags/å›¾ç®—æ³•/"},{"name":"networkx","slug":"networkx","permalink":"http://yoursite.com/tags/networkx/"}]},{"title":"CentOS-LibreOfficeå·¥å…·åŒ…å®‰è£…","slug":"CentOS-LibreOfficeå·¥å…·åŒ…å®‰è£…","date":"2023-12-28T06:43:49.000Z","updated":"2023-12-28T07:05:48.623Z","comments":true,"path":"2023/12/28/CentOS-LibreOfficeå·¥å…·åŒ…å®‰è£…/","link":"","permalink":"http://yoursite.com/2023/12/28/CentOS-LibreOfficeå·¥å…·åŒ…å®‰è£…/","excerpt":"Â· ç³»ç»Ÿï¼š CentOS7 Â· LibreOfficeï¼š 7.4.5.1 ç¨³å®šç‰ˆ èµ„æºä¸‹è½½Â· å®˜æ–¹ç½‘ç«™ï¼š https://zh-cn.libreoffice.org/download/libreoffice/ Â· ä¸‹è½½åœ°å€ï¼šhttps://downloadarchive.documentfoundation.org/libreoffice/old/7.4.5.1/rpm/x86_64/ é€‰æ‹©LibreOffice_7.4.5.1_Linux_x86-64_rpm.tar.gzå®‰è£…åŒ…å’ŒLibreOffice_7.4.5.1_Linux_x86-64_rpm_langpack_zh-CN.tar.gzä¸­æ–‡è¯­è¨€åŒ…å¹¶ä¸‹è½½ å®‰è£…è¿›å…¥å®‰è£…åŒ…ä¸‹è½½ç›®å½•è¿›è¡Œè§£å‹ï¼Œè¿™é‡Œä¸º/usr/local/ 123cd /usr/local/ è¿›å…¥ç›®å½•tar -zxvf LibreOffice_7.4.6.1_Linux_x86-64_rpm.tar.gz è§£å‹libreofficetar -zxvf LibreOffice7.4.6.1_Linux_x86-64_rpm_langpack_zh-CN.tar.gz è§£å‹ä¸­æ–‡è¯­è¨€åŒ… å®‰è£…libreofficeå’Œè¯­è¨€åŒ…çš„rpmåŒ…ï¼Œé»˜è®¤å®‰è£…ç›®å½•ä¸º/opt/libreoffice7.4 1234cd /usr/local/LibreOffice_7.4.6.1_Linux_x86-64_rpm/RPMS/yum -y install *.rpmcd /usr/local/LibreOffice_7.4.6.1_Linux_x86-64_rpm_langpack_zh-CN/RPMSyum -y install *.rpm å®‰è£…sofficeï¼Œè¿›å…¥/opt/libreoffice7.4/programç›®å½•æ‰§è¡Œ 1234cd /opt/libreoffice7.4/program/yum install cairo yum install cups-libsyum install libSM æ£€æŸ¥ 1/opt/libreoffice7.4/program/soffice -help æ­£å¸¸è¾“å‡ºï¼Œå®‰è£…æˆåŠŸï¼Œæ¥ä¸‹æ¥å°†sofficeæ·»åŠ åˆ°ç¯å¢ƒå˜é‡ 1vim /etc/profile 123# libreofficeexport LibreOffice_PATH=/opt/libreoffice7.4/programexport PATH=$LibreOffice_PATH:$PATH 1source /etc/profile","text":"Â· ç³»ç»Ÿï¼š CentOS7 Â· LibreOfficeï¼š 7.4.5.1 ç¨³å®šç‰ˆ èµ„æºä¸‹è½½Â· å®˜æ–¹ç½‘ç«™ï¼š https://zh-cn.libreoffice.org/download/libreoffice/ Â· ä¸‹è½½åœ°å€ï¼šhttps://downloadarchive.documentfoundation.org/libreoffice/old/7.4.5.1/rpm/x86_64/ é€‰æ‹©LibreOffice_7.4.5.1_Linux_x86-64_rpm.tar.gzå®‰è£…åŒ…å’ŒLibreOffice_7.4.5.1_Linux_x86-64_rpm_langpack_zh-CN.tar.gzä¸­æ–‡è¯­è¨€åŒ…å¹¶ä¸‹è½½ å®‰è£…è¿›å…¥å®‰è£…åŒ…ä¸‹è½½ç›®å½•è¿›è¡Œè§£å‹ï¼Œè¿™é‡Œä¸º/usr/local/ 123cd /usr/local/ è¿›å…¥ç›®å½•tar -zxvf LibreOffice_7.4.6.1_Linux_x86-64_rpm.tar.gz è§£å‹libreofficetar -zxvf LibreOffice7.4.6.1_Linux_x86-64_rpm_langpack_zh-CN.tar.gz è§£å‹ä¸­æ–‡è¯­è¨€åŒ… å®‰è£…libreofficeå’Œè¯­è¨€åŒ…çš„rpmåŒ…ï¼Œé»˜è®¤å®‰è£…ç›®å½•ä¸º/opt/libreoffice7.4 1234cd /usr/local/LibreOffice_7.4.6.1_Linux_x86-64_rpm/RPMS/yum -y install *.rpmcd /usr/local/LibreOffice_7.4.6.1_Linux_x86-64_rpm_langpack_zh-CN/RPMSyum -y install *.rpm å®‰è£…sofficeï¼Œè¿›å…¥/opt/libreoffice7.4/programç›®å½•æ‰§è¡Œ 1234cd /opt/libreoffice7.4/program/yum install cairo yum install cups-libsyum install libSM æ£€æŸ¥ 1/opt/libreoffice7.4/program/soffice -help æ­£å¸¸è¾“å‡ºï¼Œå®‰è£…æˆåŠŸï¼Œæ¥ä¸‹æ¥å°†sofficeæ·»åŠ åˆ°ç¯å¢ƒå˜é‡ 1vim /etc/profile 123# libreofficeexport LibreOffice_PATH=/opt/libreoffice7.4/programexport PATH=$LibreOffice_PATH:$PATH 1source /etc/profile å®‰è£…ä¸­æ–‡å­—ä½“åŒ…windowsç³»ç»Ÿå­—ä½“åŒ…ä½äºè·¯å¾„C:\\Windows\\Fontä¸‹ centosç³»ç»Ÿå­—ä½“åŒ…ä½äºè·¯å¾„/usr/share/fontsä¸‹ è¿›å…¥/usr/share/fontsåˆ›å»ºwindowsç³»ç»Ÿå­—ä½“åŒ…ç›®å½• 12cd /usr/share/fonts/mkdir windowsFont å°†windowså­—ä½“æ–‡ä»¶å…¨éƒ¨æ‹·è´è¿›è¯¥è·¯å¾„ä¸‹ï¼Œæ‰§è¡Œ 123mkfontscalemkfontdirfc-cache å®Œæˆï¼å¯ä»¥åœ¨linuxç³»ç»Ÿä¸‹é¡ºåˆ©æ“ä½œ.docsã€.pdfç­‰æ–‡æ¡£æ–‡ä»¶ï¼Œåœ¨langchain-chatchatä¸­æ·»åŠ æ–‡æ¡£å½¢çŸ¥è¯†åº“ã€‚","categories":[{"name":"Linux","slug":"Linux","permalink":"http://yoursite.com/categories/Linux/"}],"tags":[{"name":"linuxå·¥å…·","slug":"linuxå·¥å…·","permalink":"http://yoursite.com/tags/linuxå·¥å…·/"},{"name":"LibreOffice","slug":"LibreOffice","permalink":"http://yoursite.com/tags/LibreOffice/"}]},{"title":"LangChain + ChatGLM2-6Bçš„æœ¬åœ°çŸ¥è¯†é—®ç­”åº“","slug":"LangChain + ChatGLM2-6Bçš„æœ¬åœ°çŸ¥è¯†é—®ç­”åº“","date":"2023-10-24T01:14:34.000Z","updated":"2023-11-06T08:31:28.442Z","comments":true,"path":"2023/10/24/LangChain + ChatGLM2-6Bçš„æœ¬åœ°çŸ¥è¯†é—®ç­”åº“/","link":"","permalink":"http://yoursite.com/2023/10/24/LangChain + ChatGLM2-6Bçš„æœ¬åœ°çŸ¥è¯†é—®ç­”åº“/","excerpt":"åŸé¡¹ç›®Githubï¼šhttps://github.com/imClumsyPanda/langchain-ChatGLM é¡¹ç›®éƒ¨ç½²Â· v 0.2.6 æœºå™¨é…ç½®ï¼šÂ· python ç¯å¢ƒï¼šanaconda3 + python3.10.12 Â· GPUï¼šRTX3090*2 + CUDA11.7 Â· torchï¼š2.0.1ï¼ˆCUDAæœªå‡è‡³12ï¼‰ Â· condaï¼špy310_dtglm æ¨¡å‹ä¸‹è½½Â· m3e https://huggingface.co/moka-ai/m3e-base/tree/main Â· chatglm2-6b https://huggingface.co/THUDM/chatglm2-6b/tree/main chatglmæ¸…åæº https://cloud.tsinghua.edu.cn/d/674208019e314311ab5c/?p=%2F&amp;mode=list (è¿™é‡Œå°†æ¨¡å‹å…¨éƒ¨ä¸‹è½½è‡³/root/huggingfaceä¸‹) åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œå®‰è£…ä¾èµ–123456conda create -n py310_dtglm python=3.10.12conda activate py310_dtglmpip install --use-pep517 -r requirements.txt -i https://mirror.baidu.com/pypi/simplepip install --use-pep517 -r requirements_api.txt -i https://mirror.baidu.com/pypi/simplepip install --use-pep517 -r requirements_webui.txt -i https://mirror.baidu.com/pypi/simple ä¿®æ”¹é…ç½®ã€æ¨¡å‹è·¯å¾„å¤åˆ¶é…ç½®æ–‡ä»¶ 1python copy_config_example.py ä¿®æ”¹é…ç½®æ–‡ä»¶ Â· model_config.py 123456789101112131415161718MODEL_ROOT_PATH = \"/root/huggingface\"MODEL_PATH = &#123; \"embed_model\": &#123; ... \"m3e-base\": \"/root/huggingface/m3e-base\", # ä¿®æ”¹m3eæ¨¡å‹è·¯å¾„ ... &#125;, # TODO: add all supported llm models \"llm_model\": &#123; ... \"chatglm2-6b\": \"/root/huggingface/chatglm2-6b\", # ä¿®æ”¹chatglm2-6bæ¨¡å‹è·¯å¾„ ... &#125;,&#125;EMBEDDING_MODEL = \"m3e-base\" # å¯ä»¥å°è¯•æœ€æ–°çš„åµŒå…¥å¼sotaæ¨¡å‹ï¼šbge-large-zh-v1.5LLM_MODEL = \"chatglm2-6b\"","text":"åŸé¡¹ç›®Githubï¼šhttps://github.com/imClumsyPanda/langchain-ChatGLM é¡¹ç›®éƒ¨ç½²Â· v 0.2.6 æœºå™¨é…ç½®ï¼šÂ· python ç¯å¢ƒï¼šanaconda3 + python3.10.12 Â· GPUï¼šRTX3090*2 + CUDA11.7 Â· torchï¼š2.0.1ï¼ˆCUDAæœªå‡è‡³12ï¼‰ Â· condaï¼špy310_dtglm æ¨¡å‹ä¸‹è½½Â· m3e https://huggingface.co/moka-ai/m3e-base/tree/main Â· chatglm2-6b https://huggingface.co/THUDM/chatglm2-6b/tree/main chatglmæ¸…åæº https://cloud.tsinghua.edu.cn/d/674208019e314311ab5c/?p=%2F&amp;mode=list (è¿™é‡Œå°†æ¨¡å‹å…¨éƒ¨ä¸‹è½½è‡³/root/huggingfaceä¸‹) åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œå®‰è£…ä¾èµ–123456conda create -n py310_dtglm python=3.10.12conda activate py310_dtglmpip install --use-pep517 -r requirements.txt -i https://mirror.baidu.com/pypi/simplepip install --use-pep517 -r requirements_api.txt -i https://mirror.baidu.com/pypi/simplepip install --use-pep517 -r requirements_webui.txt -i https://mirror.baidu.com/pypi/simple ä¿®æ”¹é…ç½®ã€æ¨¡å‹è·¯å¾„å¤åˆ¶é…ç½®æ–‡ä»¶ 1python copy_config_example.py ä¿®æ”¹é…ç½®æ–‡ä»¶ Â· model_config.py 123456789101112131415161718MODEL_ROOT_PATH = \"/root/huggingface\"MODEL_PATH = &#123; \"embed_model\": &#123; ... \"m3e-base\": \"/root/huggingface/m3e-base\", # ä¿®æ”¹m3eæ¨¡å‹è·¯å¾„ ... &#125;, # TODO: add all supported llm models \"llm_model\": &#123; ... \"chatglm2-6b\": \"/root/huggingface/chatglm2-6b\", # ä¿®æ”¹chatglm2-6bæ¨¡å‹è·¯å¾„ ... &#125;,&#125;EMBEDDING_MODEL = \"m3e-base\" # å¯ä»¥å°è¯•æœ€æ–°çš„åµŒå…¥å¼sotaæ¨¡å‹ï¼šbge-large-zh-v1.5LLM_MODEL = \"chatglm2-6b\" Â· server_config.py 12345678910111213141516171819202122232425262728293031323334353637383940414243# webui.py serverWEBUI_SERVER = &#123; \"host\": DEFAULT_BIND_HOST, \"port\": 8501,&#125;# api.py serverAPI_SERVER = &#123; \"host\": DEFAULT_BIND_HOST, \"port\": 7861,&#125;# fastchat openai_api serverFSCHAT_OPENAI_API = &#123; \"host\": DEFAULT_BIND_HOST, \"port\": 20000,&#125;FSCHAT_MODEL_WORKERS = &#123; \"default\": &#123; \"host\": DEFAULT_BIND_HOST, \"port\": 20002, \"device\": LLM_DEVICE, \"infer_turbo\": False, # model_workerå¤šå¡åŠ è½½éœ€è¦é…ç½®çš„å‚æ•° \"gpus\": \"0,1\", # ä½¿ç”¨çš„GPUï¼Œä»¥strçš„æ ¼å¼æŒ‡å®šï¼Œå¦‚\"0,1\"ï¼Œå¦‚å¤±æ•ˆè¯·ä½¿ç”¨CUDA_VISIBLE_DEVICES=\"0,1\"ç­‰å½¢å¼æŒ‡å®š \"num_gpus\": 2, # ä½¿ç”¨GPUçš„æ•°é‡ \"max_gpu_memory\": \"20GiB\", # æ¯ä¸ªGPUå ç”¨çš„æœ€å¤§æ˜¾å­˜ &#125;, \"zhipu-api\": &#123; # è¯·ä¸ºæ¯ä¸ªè¦è¿è¡Œçš„åœ¨çº¿APIè®¾ç½®ä¸åŒçš„ç«¯å£ \"port\": 21001, &#125;,&#125;# fastchat controller serverFSCHAT_CONTROLLER = &#123; \"host\": DEFAULT_BIND_HOST, \"port\": 20001, \"dispatch_method\": \"shortest_queue\",&#125; åˆå§‹åŒ–é»˜è®¤çŸ¥è¯†åº“æ ·ä¾‹çŸ¥è¯†åº“æ–‡ä»¶ä½ç½®ï¼šknowledge_base/samples/content/test.txt 1python init_database.py --recreate-vs å¯åŠ¨é¡¹ç›®1python startup.py -a é€šè¿‡fastapiæ¥å£æ·»åŠ çŸ¥è¯†åº“http://host:7861/knowledge_base/upload_docs 12345678910111213curl -X 'POST' \\ 'http://host:7861/knowledge_base/upload_docs' \\ -H 'accept: application/json' \\ -H 'Content-Type: multipart/form-data' \\ -F 'to_vector_store=true' \\ -F 'override=false' \\ -F 'not_refresh_vs_cache=false' \\ -F 'chunk_size=250' \\ -F 'chunk_overlap=50' \\ -F 'zh_title_enhance=true' \\ -F 'files=@åˆ†ä½“å¼Må½•AIæ™ºèƒ½åˆ†æè®¾å¤‡å»ºè®¾æ–¹æ¡ˆ.docx;type=application/vnd.openxmlformats-officedocument.wordprocessingml.document' \\ -F 'knowledge_base_name=ç…çŠ' \\ -F 'docs=' é€‰æ‹©çŸ¥è¯†åº“é—®ç­” ä»£ç è°ƒæ•´ç™¾å·å¤§æ¨¡å‹æ¥å…¥è°ƒæ•´./configs/model_config.py 12345678\"llm_model\": &#123; ... 'baichuan-13b-chat':'/home/Baichuan2-main/baichuan-inc/Baichuan2-13B-Chat', ...&#125; # LLM åç§°LLM_MODEL = \"baichuan-13b-chat\" æ¥å£æµå¼è¾“å‡ºå®‰è£…sse_starlette pip install sse-starlette -i https://mirror.baidu.com/pypi/simple è¿›å…¥./chat/*.pyï¼Œä¿®æ”¹æ¥å£ 123456from sse_starlette.sse import EventSourceResponse...return EventSourceResponse(chat_iterator(query=query, history=history, model_name=model_name, prompt_name=prompt_name)) 1/*æ³¨é‡Šå†…å®¹ */","categories":[{"name":"GPT","slug":"GPT","permalink":"http://yoursite.com/categories/GPT/"}],"tags":[{"name":"langchain-chatchat","slug":"langchain-chatchat","permalink":"http://yoursite.com/tags/langchain-chatchat/"},{"name":"chat-glm","slug":"chat-glm","permalink":"http://yoursite.com/tags/chat-glm/"},{"name":"baichuan","slug":"baichuan","permalink":"http://yoursite.com/tags/baichuan/"}]},{"title":"Nebula3é›†ç¾¤ç‰ˆæ–°æ—§ç‰ˆæœ¬å¤šå¼€","slug":"Nebula3é›†ç¾¤ç‰ˆç‰ˆæœ¬å¤šå¼€","date":"2023-09-28T02:10:10.000Z","updated":"2023-11-03T09:32:18.875Z","comments":true,"path":"2023/09/28/Nebula3é›†ç¾¤ç‰ˆç‰ˆæœ¬å¤šå¼€/","link":"","permalink":"http://yoursite.com/2023/09/28/Nebula3é›†ç¾¤ç‰ˆç‰ˆæœ¬å¤šå¼€/","excerpt":"","text":"Â· ç³»ç»Ÿï¼šCentOS7 Â· å·²æœ‰nebulaç‰ˆæœ¬ï¼š2.6.1ï¼ˆå¼€æºç¤¾åŒºç‰ˆï¼‰ Â· å·²æœ‰nebula-consoleç‰ˆæœ¬ï¼š2.6.0 Â· å·²æœ‰nebula-graph-studioç‰ˆæœ¬ï¼š3.2.3 Â· å¤šå¼€nebulaç‰ˆæœ¬ï¼š3.6.0ï¼ˆå¼€æºç¤¾åŒºç‰ˆï¼‰ Â· å¤šå¼€nebula-graph-studioç‰ˆæœ¬ï¼š3.2.3 Â· å¤šå¼€nebula-consoleç‰ˆæœ¬ï¼š3.6.0 é›†ç¾¤éƒ¨ç½²Â· å‚è€ƒå•æœºéƒ¨ç½²æ–¹å¼ï¼Œå¯¹é…ç½®æ–‡ä»¶--meta_server_addrsåšæ‰©å±•ï¼Œæ·»åŠ metaæœºå™¨ Â· åŒºåˆ†2.6.1ç‰ˆæœ¬å·²è¢«å ç”¨çš„ç«¯å£ï¼Œæ‰¾åˆ°é…ç½®æ–‡ä»¶é»˜è®¤çš„9559ã€19559ã€9669ã€19669ã€9779ã€19779ç«¯å£ï¼Œä¿®æ”¹ä¸º8559ã€18559ã€8669ã€18669ã€8779ã€18779 Â· å¯åŠ¨é›†ç¾¤ Â· é…ç½®nebula-graph-studioé»˜è®¤ç«¯å£ä¸º7002 Â· æ³¨ï¼šåŒå¼€nebulaåä½¿ç”¨åŒç‰ˆæœ¬nebula-graph-studioå³ä½¿æ›´æ¢äº†ç«¯å£ï¼Œä¹Ÿä¸èƒ½åŒæ—¶è¿è¡Œï¼Œå¯ä»¥å®‰è£…nebula-consoleæ¥åŒæ—¶å¯åŠ¨nebulaæ§åˆ¶å° chmod 111 nebula-console ./nebula-console --addr &lt;host&gt; --port 9669 -u root -p nebula ./nebula-console --addr &lt;host&gt; --port 8669 -u root -p nebula","categories":[{"name":"BigData","slug":"BigData","permalink":"http://yoursite.com/categories/BigData/"}],"tags":[{"name":"database","slug":"database","permalink":"http://yoursite.com/tags/database/"},{"name":"nebula","slug":"nebula","permalink":"http://yoursite.com/tags/nebula/"}]},{"title":"Nebula3å•æœºç‰ˆå¿«é€Ÿå®‰è£…","slug":"Nebula3å•æœºç‰ˆå¿«é€Ÿå®‰è£…","date":"2023-09-27T08:12:31.000Z","updated":"2023-10-24T02:28:41.838Z","comments":true,"path":"2023/09/27/Nebula3å•æœºç‰ˆå¿«é€Ÿå®‰è£…/","link":"","permalink":"http://yoursite.com/2023/09/27/Nebula3å•æœºç‰ˆå¿«é€Ÿå®‰è£…/","excerpt":"Â· ç³»ç»Ÿï¼šCentOS7 Â· nebulaç‰ˆæœ¬ï¼š3.6.0ï¼ˆå¼€æºç¤¾åŒºç‰ˆï¼‰ Â· nebula-graph-studioç‰ˆæœ¬ï¼š3.2.3 å•æœºéƒ¨ç½²taråŒ…æºç ä¸‹è½½wget https://oss-cdn.nebula-graph.com.cn/package/3.6.0/nebula-graph-3.6.0.el7.x86_64.tar.gz è§£å‹å¹¶é‡å‘½åtar -xvzf nebula-graph-3.6.0.el7.x86_64.tar.gz mv nebula-graph-3.6.0.el7.x86_64 nebula ä¿®æ”¹é…ç½®æ–‡ä»¶cd nebula/etc mv nebula-graphd.conf.default nebula-graphd.conf mv nebula-metad.conf.default nebula-metad.conf mv nebula-storaged.conf nebula-storaged.conf ä¿®æ”¹å¯¹åº”æ–‡ä»¶å­˜å‚¨ä½ç½®ã€èŠ‚ç‚¹ipåœ°å€ï¼Œé›†ç¾¤åŒç†","text":"Â· ç³»ç»Ÿï¼šCentOS7 Â· nebulaç‰ˆæœ¬ï¼š3.6.0ï¼ˆå¼€æºç¤¾åŒºç‰ˆï¼‰ Â· nebula-graph-studioç‰ˆæœ¬ï¼š3.2.3 å•æœºéƒ¨ç½²taråŒ…æºç ä¸‹è½½wget https://oss-cdn.nebula-graph.com.cn/package/3.6.0/nebula-graph-3.6.0.el7.x86_64.tar.gz è§£å‹å¹¶é‡å‘½åtar -xvzf nebula-graph-3.6.0.el7.x86_64.tar.gz mv nebula-graph-3.6.0.el7.x86_64 nebula ä¿®æ”¹é…ç½®æ–‡ä»¶cd nebula/etc mv nebula-graphd.conf.default nebula-graphd.conf mv nebula-metad.conf.default nebula-metad.conf mv nebula-storaged.conf nebula-storaged.conf ä¿®æ”¹å¯¹åº”æ–‡ä»¶å­˜å‚¨ä½ç½®ã€èŠ‚ç‚¹ipåœ°å€ï¼Œé›†ç¾¤åŒç† ç¤ºä¾‹ï¼š Â· nebula-graphd.conf 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134########## basics ########### Whether to run as a daemon process--daemonize=true# The file to host the process id--pid_file=pids/nebula-graphd.pid# Whether to enable optimizer--enable_optimizer=true# The default charset when a space is created--default_charset=utf8# The default collate when a space is created--default_collate=utf8_bin# Whether to use the configuration obtained from the configuration file--local_config=true########## logging ########### The directory to host logging files--log_dir=/home/nebula/graph/logs# Log level, 0, 1, 2, 3 for INFO, WARNING, ERROR, FATAL respectively--minloglevel=0# Verbose log level, 1, 2, 3, 4, the higher of the level, the more verbose of the logging--v=0# Maximum seconds to buffer the log messages--logbufsecs=0# Whether to redirect stdout and stderr to separate output files--redirect_stdout=true# Destination filename of stdout and stderr, which will also reside in log_dir.--stdout_log_file=graphd-stdout.log--stderr_log_file=graphd-stderr.log# Copy log messages at or above this level to stderr in addition to logfiles. The numbers of severity levels INFO, WARNING, ERROR, and FATAL are 0, 1, 2, and 3, respectively.--stderrthreshold=3# wether logging files&apos; name contain time stamp.--timestamp_in_logfile_name=true########## query ########### Whether to treat partial success as an error.# This flag is only used for Read-only access, and Modify access always treats partial success as an error.--accept_partial_success=false# Maximum sentence length, unit byte--max_allowed_query_size=4194304########## networking ########### Comma separated Meta Server Addresses--meta_server_addrs=192.168.9.103:9559# Local IP used to identify the nebula-graphd process.# Change it to an address other than loopback if the service is distributed or# will be accessed remotely.--local_ip=192.168.9.103# Network device to listen on--listen_netdev=any# Port to listen on--port=9669# To turn on SO_REUSEPORT or not--reuse_port=false# Backlog of the listen socket, adjust this together with net.core.somaxconn--listen_backlog=1024# The number of seconds Nebula service waits before closing the idle connections--client_idle_timeout_secs=28800# The number of seconds before idle sessions expire# The range should be in [1, 604800]--session_idle_timeout_secs=28800# The number of threads to accept incoming connections--num_accept_threads=1# The number of networking IO threads, 0 for # of CPU cores--num_netio_threads=0# Max active connections for all networking threads. 0 means no limit.# Max connections for each networking thread = num_max_connections / num_netio_threads--num_max_connections=0# The number of threads to execute user queries, 0 for # of CPU cores--num_worker_threads=0# HTTP service ip--ws_ip=0.0.0.0# HTTP service port--ws_http_port=19669# storage client timeout--storage_client_timeout_ms=60000# slow query threshold in us--slow_query_threshold_us=200000# Port to listen on Meta with HTTP protocol, it corresponds to ws_http_port in metad&apos;s configuration file--ws_meta_http_port=19559########## authentication ########### Enable authorization--enable_authorize=false# User login authentication type, password for nebula authentication, ldap for ldap authentication, cloud for cloud authentication--auth_type=password########## memory ########### System memory high watermark ratio, cancel the memory checking when the ratio greater than 1.0--system_memory_high_watermark_ratio=0.8########## metrics ##########--enable_space_level_metrics=false########## experimental feature ########### if use experimental features--enable_experimental_feature=false# if use balance data feature, only work if enable_experimental_feature is true--enable_data_balance=true# enable udf, written in c++ only for now--enable_udf=true# set the directory where the .so files of udf are stored, when enable_udf is true--udf_path=/home/nebula/dev/nebula/udf/########## session ########### Maximum number of sessions that can be created per IP and per user--max_sessions_per_ip_per_user=300########## memory tracker ########### trackable memory ratio (trackable_memory / (total_memory - untracked_reserved_memory) )--memory_tracker_limit_ratio=0.8# untracked reserved memory in Mib--memory_tracker_untracked_reserved_memory_mb=50# enable log memory tracker stats periodically--memory_tracker_detail_log=false# log memory tacker stats interval in milliseconds--memory_tracker_detail_log_interval_ms=60000# enable memory background purge (if jemalloc is used)--memory_purge_enabled=true# memory background purge interval in seconds--memory_purge_interval_seconds=10########## performance optimization ########### The max job size in multi job mode--max_job_size=1# The min batch size for handling dataset in multi job mode, only enabled when max_job_size is greater than 1--min_batch_size=8192# if true, return directly without go through RPC--optimize_appendvertices=false# number of paths constructed by each thread--path_batch_size=10000 Â· nebula-metad.conf 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253########## basics ########### Whether to run as a daemon process--daemonize=true# The file to host the process id--pid_file=pids/nebula-metad.pid########## logging ########### The directory to host logging files--log_dir=/home/nebula/meta/logs# Log level, 0, 1, 2, 3 for INFO, WARNING, ERROR, FATAL respectively--minloglevel=0# Verbose log level, 1, 2, 3, 4, the higher of the level, the more verbose of the logging--v=0# Maximum seconds to buffer the log messages--logbufsecs=0# Whether to redirect stdout and stderr to separate output files--redirect_stdout=true# Destination filename of stdout and stderr, which will also reside in log_dir.--stdout_log_file=metad-stdout.log--stderr_log_file=metad-stderr.log# Copy log messages at or above this level to stderr in addition to logfiles. The numbers of severity levels INFO, WARNING, ERROR, and FATAL are 0, 1, 2, and 3, respectively.--stderrthreshold=3# wether logging files&apos; name contain time stamp, If Using logrotate to rotate logging files, than should set it to true.--timestamp_in_logfile_name=true########## networking ########### Comma separated Meta Server addresses--meta_server_addrs=192.168.9.103:9559# Local IP used to identify the nebula-metad process.# Change it to an address other than loopback if the service is distributed or# will be accessed remotely.--local_ip=192.168.9.103# Meta daemon listening port--port=9559# HTTP service ip--ws_ip=0.0.0.0# HTTP service port--ws_http_port=19559# Port to listen on Storage with HTTP protocol, it corresponds to ws_http_port in storage&apos;s configuration file--ws_storage_http_port=19779########## storage ########### Root data path, here should be only single path for metad--data_path=/home/nebula/data/meta########## Misc ########## The default number of parts when a space is created--default_parts_num=100# The default replica factor when a space is created--default_replica_factor=1--heartbeat_interval_secs=10--agent_heartbeat_interval_secs=60 Â· nebula-metad.conf 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143########## basics ########### Whether to run as a daemon process--daemonize=true# The file to host the process id--pid_file=pids/nebula-storaged.pid# Whether to use the configuration obtained from the configuration file--local_config=true########## logging ########### The directory to host logging files--log_dir=/home/nebula/storage/logs# Log level, 0, 1, 2, 3 for INFO, WARNING, ERROR, FATAL respectively--minloglevel=0# Verbose log level, 1, 2, 3, 4, the higher of the level, the more verbose of the logging--v=0# Maximum seconds to buffer the log messages--logbufsecs=0# Whether to redirect stdout and stderr to separate output files--redirect_stdout=true# Destination filename of stdout and stderr, which will also reside in log_dir.--stdout_log_file=storaged-stdout.log--stderr_log_file=storaged-stderr.log# Copy log messages at or above this level to stderr in addition to logfiles. The numbers of severity levels INFO, WARNING, ERROR, and FATAL are 0, 1, 2, and 3, respectively.--stderrthreshold=3# Wether logging files&apos; name contain time stamp.--timestamp_in_logfile_name=true########## networking ########### Comma separated Meta server addresses--meta_server_addrs=192.168.9.103:9559# Local IP used to identify the nebula-storaged process.# Change it to an address other than loopback if the service is distributed or# will be accessed remotely.--local_ip=192.168.9.103# Storage daemon listening port--port=9779# HTTP service ip--ws_ip=0.0.0.0# HTTP service port--ws_http_port=19779# heartbeat with meta service--heartbeat_interval_secs=10######### Raft ########## Raft election timeout--raft_heartbeat_interval_secs=30# RPC timeout for raft client (ms)--raft_rpc_timeout_ms=500## recycle Raft WAL--wal_ttl=14400########## Disk ########### Root data path. Split by comma. e.g. --data_path=/disk1/path1/,/disk2/path2/# One path per Rocksdb instance.--data_path=/home/nebula/data/storage# Minimum reserved bytes of each data path--minimum_reserved_bytes=268435456# The default reserved bytes for one batch operation--rocksdb_batch_size=4096# The default block cache size used in BlockBasedTable.# The unit is MB.--rocksdb_block_cache=4# The type of storage engine, `rocksdb&apos;, `memory&apos;, etc.--engine_type=rocksdb# Compression algorithm, options: no,snappy,lz4,lz4hc,zlib,bzip2,zstd# For the sake of binary compatibility, the default value is snappy.# Recommend to use:# * lz4 to gain more CPU performance, with the same compression ratio with snappy# * zstd to occupy less disk space# * lz4hc for the read-heavy write-light scenario--rocksdb_compression=lz4# Set different compressions for different levels# For example, if --rocksdb_compression is snappy,# &quot;no:no:lz4:lz4::zstd&quot; is identical to &quot;no:no:lz4:lz4:snappy:zstd:snappy&quot;# In order to disable compression for level 0/1, set it to &quot;no:no&quot;--rocksdb_compression_per_level=# Whether or not to enable rocksdb&apos;s statistics, disabled by default--enable_rocksdb_statistics=false# Statslevel used by rocksdb to collection statistics, optional values are# * kExceptHistogramOrTimers, disable timer stats, and skip histogram stats# * kExceptTimers, Skip timer stats# * kExceptDetailedTimers, Collect all stats except time inside mutex lock AND time spent on compression.# * kExceptTimeForMutex, Collect all stats except the counters requiring to get time inside the mutex lock.# * kAll, Collect all stats--rocksdb_stats_level=kExceptHistogramOrTimers# Whether or not to enable rocksdb&apos;s prefix bloom filter, enabled by default.--enable_rocksdb_prefix_filtering=true# Whether or not to enable rocksdb&apos;s whole key bloom filter, disabled by default.--enable_rocksdb_whole_key_filtering=false############## rocksdb Options ############### rocksdb DBOptions in json, each name and value of option is a string, given as &quot;option_name&quot;:&quot;option_value&quot; separated by comma--rocksdb_db_options=&#123;&#125;# rocksdb ColumnFamilyOptions in json, each name and value of option is string, given as &quot;option_name&quot;:&quot;option_value&quot; separated by comma--rocksdb_column_family_options=&#123;&quot;write_buffer_size&quot;:&quot;67108864&quot;,&quot;max_write_buffer_number&quot;:&quot;4&quot;,&quot;max_bytes_for_level_base&quot;:&quot;268435456&quot;&#125;# rocksdb BlockBasedTableOptions in json, each name and value of option is string, given as &quot;option_name&quot;:&quot;option_value&quot; separated by comma--rocksdb_block_based_table_options=&#123;&quot;block_size&quot;:&quot;8192&quot;&#125;############### misc ##################### Whether turn on query in multiple thread--query_concurrently=true# Whether remove outdated space data--auto_remove_invalid_space=true# Network IO threads number--num_io_threads=16# Max active connections for all networking threads. 0 means no limit.# Max connections for each networking thread = num_max_connections / num_netio_threads--num_max_connections=0# Worker threads number to handle request--num_worker_threads=32# Maximum subtasks to run admin jobs concurrently--max_concurrent_subtasks=10# The rate limit in bytes when leader synchronizes snapshot data--snapshot_part_rate_limit=10485760# The amount of data sent in each batch when leader synchronizes snapshot data--snapshot_batch_size=1048576# The rate limit in bytes when leader synchronizes rebuilding index--rebuild_index_part_rate_limit=4194304# The amount of data sent in each batch when leader synchronizes rebuilding index--rebuild_index_batch_size=1048576########## memory tracker ########### trackable memory ratio (trackable_memory / (total_memory - untracked_reserved_memory) )--memory_tracker_limit_ratio=0.8# untracked reserved memory in Mib--memory_tracker_untracked_reserved_memory_mb=50# enable log memory tracker stats periodically--memory_tracker_detail_log=false# log memory tacker stats interval in milliseconds--memory_tracker_detail_log_interval_ms=60000# enable memory background purge (if jemalloc is used)--memory_purge_enabled=true# memory background purge interval in seconds--memory_purge_interval_seconds=10 å¯åŠ¨æœåŠ¡å›åˆ°nebulaæ ¹ç›®å½• cd .. æ‰§è¡Œå¯åŠ¨è„šæœ¬ ./scripts/nebula.service start all æŸ¥çœ‹æœåŠ¡çŠ¶æ€ ./scripts/nebula.service status all é‡å¯æœåŠ¡ ./scripts/nebula.service restart all å…³é—­æœåŠ¡ ./scripts/nebula.service stop all nebula-graph-studioéƒ¨ç½²v3.2.3ä¸‹è½½åœ°å€ï¼ˆå…è´¹ä½¿ç”¨å›¾æ¢ç´¢çš„æœ€é«˜ç¤¾åŒºç‰ˆæœ¬ï¼‰ https://github.com/vesoft-inc/nebula-studio/releases/tag/v3.2.3 æºç å®‰è£…åï¼Œè¿›å…¥å¯¹åº”ç›®å½•ï¼Œæ‰§è¡Œå¯åŠ¨è„šæœ¬ ./service","categories":[{"name":"BigData","slug":"BigData","permalink":"http://yoursite.com/categories/BigData/"}],"tags":[{"name":"database","slug":"database","permalink":"http://yoursite.com/tags/database/"},{"name":"nebula","slug":"nebula","permalink":"http://yoursite.com/tags/nebula/"}]},{"title":"paddleDetection Demo","slug":"paddleDetection Demo","date":"2023-08-31T04:20:20.000Z","updated":"2024-01-25T09:14:54.938Z","comments":true,"path":"2023/08/31/paddleDetection Demo/","link":"","permalink":"http://yoursite.com/2023/08/31/paddleDetection Demo/","excerpt":"PPHumanè¡Œäººå±æ€§è¯†åˆ«è¡Œäººå±æ€§cfgï¼š 12345678910111213141516171819202122232425crop_thresh: 0.5attr_thresh: 0.5kpt_thresh: 0.2visual: Truewarmup_frame: 50DET: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/mot_ppyoloe_l_36e_pipeline.zip batch_size: 1MOT: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/mot_ppyoloe_l_36e_pipeline.zip tracker_config: /exp/work/video/PaddleDetection/deploy/pipeline/config/tracker_config.yml batch_size: 1 skip_frame_num: -1 # preferably no more than 3 enable: TrueKPT: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/dark_hrnet_w32_256x192.zip batch_size: 8ATTR: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/PPLCNet_x1_0_person_attribute_945_infer.zip batch_size: 8 enable: True cliï¼š 1python deploy/pipeline/pipeline.py --config deploy/pipeline/config/cache/cfg_human.yml --device=gpu --video_file=demo_input/human.mp4 --output_dir=demo_output/","text":"PPHumanè¡Œäººå±æ€§è¯†åˆ«è¡Œäººå±æ€§cfgï¼š 12345678910111213141516171819202122232425crop_thresh: 0.5attr_thresh: 0.5kpt_thresh: 0.2visual: Truewarmup_frame: 50DET: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/mot_ppyoloe_l_36e_pipeline.zip batch_size: 1MOT: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/mot_ppyoloe_l_36e_pipeline.zip tracker_config: /exp/work/video/PaddleDetection/deploy/pipeline/config/tracker_config.yml batch_size: 1 skip_frame_num: -1 # preferably no more than 3 enable: TrueKPT: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/dark_hrnet_w32_256x192.zip batch_size: 8ATTR: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/PPLCNet_x1_0_person_attribute_945_infer.zip batch_size: 8 enable: True cliï¼š 1python deploy/pipeline/pipeline.py --config deploy/pipeline/config/cache/cfg_human.yml --device=gpu --video_file=demo_input/human.mp4 --output_dir=demo_output/ è¡Œäººè¡Œä¸ºè¯†åˆ«è·Œå€’cfgï¼š 12345678910111213141516171819202122crop_thresh: 0.5kpt_thresh: 0.2visual: Truewarmup_frame: 50MOT: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/mot_ppyoloe_s_36e_pipeline.zip tracker_config: /exp/work/video/PaddleDetection/deploy/pipeline/config/tracker_config.yml batch_size: 1 enable: True KPT: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/dark_hrnet_w32_256x192.zip batch_size: 8SKELETON_ACTION: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/STGCN.zip batch_size: 1 max_frames: 50 display_frames: 80 coord_size: [384, 512] enable: True cliï¼š 1python deploy/pipeline/pipeline.py --config deploy/pipeline/config/cache/cfg_fall.yml --device=gpu --video_file=demo_input/fall.mp4 --output_dir=demo_output/ æ¥æ‰“ç”µè¯cfgï¼š 12345678910111213141516171819202122crop_thresh: 0.5kpt_thresh: 0.2visual: Truewarmup_frame: 50MOT: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/mot_ppyoloe_s_36e_pipeline.zip tracker_config: /exp/work/video/PaddleDetection/deploy/pipeline/config/tracker_config.yml batch_size: 1 enable: TrueID_BASED_CLSACTION: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/PPHGNet_tiny_calling_halfbody.zip batch_size: 8 threshold: 0.8 display_frames: 80 skip_frame_num: 2 enable: TrueKPT: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/dark_hrnet_w32_256x192.zip batch_size: 8 cliï¼š 1python deploy/pipeline/pipeline.py --config deploy/pipeline/config/cache/cfg_call.yml --device=gpu --video_file=demo_input/call.mp4 --output_dir=demo_output/ å¸çƒŸcfgï¼š 12345678910111213141516171819202122crop_thresh: 0.5kpt_thresh: 0.2visual: Truewarmup_frame: 50MOT: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/mot_ppyoloe_s_36e_pipeline.zip tracker_config: /exp/work/video/PaddleDetection/deploy/pipeline/config/tracker_config.yml batch_size: 1 enable: TrueID_BASED_DETACTION: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/ppyoloe_crn_s_80e_smoking_visdrone.zip batch_size: 8 threshold: 0.6 display_frames: 80 skip_frame_num: 2 enable: TrueKPT: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/dark_hrnet_w32_256x192.zip batch_size: 8 cliï¼š 1python deploy/pipeline/pipeline.py --config deploy/pipeline/config/cache/cfg_smoke.yml --device=gpu --video_file=demo_input/smoke.mp4 --output_dir=demo_output/ æ‰“æ¶cfgï¼š 1234567891011121314151617181920212223crop_thresh: 0.5kpt_thresh: 0.2visual: Truewarmup_frame: 50MOT: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/mot_ppyoloe_s_36e_pipeline.zip tracker_config: /exp/work/video/PaddleDetection/deploy/pipeline/config/tracker_config.yml batch_size: 1 enable: TrueKPT: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/dark_hrnet_w32_256x192.zip batch_size: 8VIDEO_ACTION: model_dir: https://videotag.bj.bcebos.com/PaddleVideo-release2.3/ppTSM_fight.zip batch_size: 1 frame_len: 8 sample_freq: 7 short_size: 340 target_size: 320 enable: True cliï¼š 1python deploy/pipeline/pipeline.py --config deploy/pipeline/config/cache/cfg_fight.yml --device=gpu --video_file=demo_input/fight.mp4 --output_dir=demo_output/ è¡Œäººè¿›å…¥cfgï¼š 12345678910crop_thresh: 0.5visual: Truewarmup_frame: 50MOT: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/mot_ppyoloe_l_36e_pipeline.zip tracker_config: /exp/work/video/PaddleDetection/backend/pp_config/tracker_config.yml batch_size: 1 skip_frame_num: -1 # preferably no more than 3 enable: True cliï¼š 1python deploy/pipeline/pipeline.py --config deploy/pipeline/config/cache/cfg_entrance.yml --region_type=bottom --do_entrance_counting --device=gpu --video_file=demo_input/entrance.mp4 --output_dir=demo_output/ ç¦åŒºcfgï¼š 12345678910crop_thresh: 0.5visual: Truewarmup_frame: 50MOT: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/mot_ppyoloe_l_36e_pipeline.zip tracker_config: /exp/work/video/PaddleDetection/backend/pp_config/tracker_config.yml batch_size: 1 skip_frame_num: -1 # preferably no more than 3 enable: True cliï¼š 1python deploy/pipeline/pipeline.py --config deploy/pipeline/config/cache/cfg_entrance.yml --do_break_in_counting=true --region_type=custom --region_polygon 355 700 1100 700 915 900 50 900 --device=gpu --video_file=demo_input/forb.mp4 --output_dir=demo_output/ PPVehicleè½¦è¾†å±æ€§è¯†åˆ«è½¦è¾†å±æ€§cfgï¼š 1234567891011121314151617181920212223242526272829303132333435crop_thresh: 0.5visual: Truewarmup_frame: 50DET: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/mot_ppyoloe_s_36e_ppvehicle.zip batch_size: 1MOT: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/mot_ppyoloe_s_36e_ppvehicle.zip tracker_config: /exp/work/video/PaddleDetection/backend/pp_config/tracker_config.yml batch_size: 1 skip_frame_num: 3 # preferably no more than 3 enable: TrueVEHICLE_PLATE: det_model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/ch_PP-OCRv3_det_infer.tar.gz det_limit_side_len: 736 det_limit_type: \"min\" rec_model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/ch_PP-OCRv3_rec_infer.tar.gz rec_image_shape: [3, 48, 320] rec_batch_num: 6 word_dict_path: /exp/work/video/PaddleDetection/deploy/pipeline/ppvehicle/rec_word_dict.txt enable: TrueVEHICLE_ATTR: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/vehicle_attribute_model.zip batch_size: 8 color_threshold: 0.5 type_threshold: 0.5 enable: TrueLANE_SEG: lane_seg_config: deploy/pipeline/config/lane_seg_config.yml model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/pp_lite_stdc2_bdd100k.zip cliï¼š 1python deploy/pipeline/pipeline.py --config deploy/pipeline/config/cache/cfg_car.yml --device=gpu --video_file=demo_input/car.mp4 --output_dir=demo_output/ è½¦è¾†è¡Œä¸ºè¯†åˆ«ç¦æ­¢åœè½¦cfgï¼š 12345678910111213141516171819crop_thresh: 0.5visual: Truewarmup_frame: 50MOT: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/mot_ppyoloe_s_36e_ppvehicle.zip tracker_config: /exp/work/video/PaddleDetection/deploy/pipeline/config/tracker_config.yml batch_size: 1 enable: TrueVEHICLE_PLATE: det_model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/ch_PP-OCRv3_det_infer.tar.gz det_limit_side_len: 736 det_limit_type: \"min\" rec_model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/ch_PP-OCRv3_rec_infer.tar.gz rec_image_shape: [3, 48, 320] rec_batch_num: 6 word_dict_path: /exp/work/video/PaddleDetection/deploy/pipeline/ppvehicle/rec_word_dict.txt enable: True cliï¼š 1python deploy/pipeline/pipeline.py --config deploy/pipeline/config/cache/cfg_park.yml --region_type=custom --FLAGS.illegal_parking_time=5 --region_polygon 600 200 1400 200 1400 900 600 900 --device=gpu --video_file=demo_input/park.mp4 --output_dir=demo_output/ äººè„¸è¯†åˆ«äººè„¸è¯†åˆ«cfgï¼ˆéœ€paddleDetectioné›†æˆarcfaceï¼‰ï¼š 1234567891011crop_thresh: 0.5attr_thresh: 0.5kpt_thresh: 0.2visual: Truewarmup_frame: 50FACE_DET: enable: TrueFACE_REC: enable: False cliï¼š 1python deploy/pipeline/pipeline.py --config deploy/pipeline/config/cache/cfg_face.yml --device=gpu --video_file=demo_input/face.mp4 --output_dir=demo_output/ OCRè§†é¢‘OCRcfgï¼ˆéœ€paddleDetectioné›†æˆpaddleOCRï¼‰ï¼š 12345678crop_thresh: 0.5attr_thresh: 0.5kpt_thresh: 0.2visual: Truewarmup_frame: 50OCR: enable: True cliï¼š 1python deploy/pipeline/pipeline.py --config deploy/pipeline/config/cache/cfg_ocr.yml --device=gpu --video_file=demo_input/ocr.mp4 --output_dir=demo_output/","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://yoursite.com/categories/æ·±åº¦å­¦ä¹ /"}],"tags":[{"name":"paddlepaddle","slug":"paddlepaddle","permalink":"http://yoursite.com/tags/paddlepaddle/"},{"name":"opencv","slug":"opencv","permalink":"http://yoursite.com/tags/opencv/"}]},{"title":"LiveGBSå›½æ ‡GB/T28181è§†é¢‘æµåª’ä½“å¹³å°","slug":"LiveGBSå›½æ ‡GB-T28181è§†é¢‘æµåª’ä½“å¹³å°","date":"2023-08-18T08:34:45.000Z","updated":"2023-08-18T08:35:21.653Z","comments":true,"path":"2023/08/18/LiveGBSå›½æ ‡GB-T28181è§†é¢‘æµåª’ä½“å¹³å°/","link":"","permalink":"http://yoursite.com/2023/08/18/LiveGBSå›½æ ‡GB-T28181è§†é¢‘æµåª’ä½“å¹³å°/","excerpt":"è½¯ä»¶åŒ…ä¸‹è½½LiveGBS GB28181æµåª’ä½“æœåŠ¡ä¸‹è½½åœ°å€ï¼šhttps://www.liveqing.com/docs/download/LiveGBS.html#%E7%89%88%E6%9C%AC%E4%B8%8B%E8%BD%BD é€‰æ‹©windowsç‰ˆæœ¬çš„LiveGBS ä¿¡ä»¤æœåŠ¡å’ŒLiveGBSæµåª’ä½“æœåŠ¡ï¼Œå…è´¹ç‰ˆæˆæƒå‘¨æœŸä¸º26å¤©ï¼Œå±Šæ—¶éœ€è¦æ‰‹åŠ¨æ›´æ–°è½¯ä»¶æœåŠ¡ å®‰è£…LiveGBS GB28281è§£å‹ä¸‹è½½å¥½çš„è½¯ä»¶åŒ…ï¼Œåˆ†åˆ«å¯åŠ¨LiveCMS.exeå’ŒLiveSMS.exeï¼Œå¦‚æœæœ‰é»˜è®¤ç«¯å£è¢«å ç”¨çš„æƒ…å†µå¯ä»¥ä¿®æ”¹å¯¹åº”çš„livecms.iniæˆ–livesms.inié…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘å°†LiveGBSçš„é»˜è®¤ç«¯å£ä»10000ä¿®æ”¹ä¸º10005 æˆåŠŸå¯åŠ¨ååå°å‡ºç°livecmså’Œlivesmsçš„å›¾æ ‡","text":"è½¯ä»¶åŒ…ä¸‹è½½LiveGBS GB28181æµåª’ä½“æœåŠ¡ä¸‹è½½åœ°å€ï¼šhttps://www.liveqing.com/docs/download/LiveGBS.html#%E7%89%88%E6%9C%AC%E4%B8%8B%E8%BD%BD é€‰æ‹©windowsç‰ˆæœ¬çš„LiveGBS ä¿¡ä»¤æœåŠ¡å’ŒLiveGBSæµåª’ä½“æœåŠ¡ï¼Œå…è´¹ç‰ˆæˆæƒå‘¨æœŸä¸º26å¤©ï¼Œå±Šæ—¶éœ€è¦æ‰‹åŠ¨æ›´æ–°è½¯ä»¶æœåŠ¡ å®‰è£…LiveGBS GB28281è§£å‹ä¸‹è½½å¥½çš„è½¯ä»¶åŒ…ï¼Œåˆ†åˆ«å¯åŠ¨LiveCMS.exeå’ŒLiveSMS.exeï¼Œå¦‚æœæœ‰é»˜è®¤ç«¯å£è¢«å ç”¨çš„æƒ…å†µå¯ä»¥ä¿®æ”¹å¯¹åº”çš„livecms.iniæˆ–livesms.inié…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘å°†LiveGBSçš„é»˜è®¤ç«¯å£ä»10000ä¿®æ”¹ä¸º10005 æˆåŠŸå¯åŠ¨ååå°å‡ºç°livecmså’Œlivesmsçš„å›¾æ ‡ é…ç½®LiveGBSè¿›å…¥&lt;host&gt;:10005ï¼Œç‚¹å‡»åŸºç¡€é…ç½®ï¼Œä¿®æ”¹ä¿¡ä»¤æœåŠ¡é…ç½®å’Œæµåª’ä½“æœåŠ¡é…ç½® é…ç½®è§†é¢‘è®¾å¤‡è¿›å…¥ç½‘ç»œè¿æ¥ï¼Œé€‰æ‹©å¯¹åº”çš„ä»¥å¤ªç½‘ï¼Œå³é”®å±æ€§ï¼Œé€‰æ‹©Internet åè®®ç‰ˆæœ¬ 4 (TCP/IPv4)ï¼Œé€‰æ‹©é«˜çº§ï¼Œæ·»åŠ è¿‘ç«¯è®¾å¤‡å’Œæ‘„åƒå¤´çš„ç½‘æ®µ è¿›å…¥è®¾å¤‡IPï¼Œä¿®æ”¹å¯¹åº”çš„ç½‘ç»œé…ç½®ã€è¿‘ç«¯é…ç½®å’Œæ‘„åƒå¤´é…ç½® é…ç½®å®Œæˆä»¥åç‚¹å‡»ç”¨æˆ·adminï¼Œé€‰æ‹©é‡å¯è®¾å¤‡ è§†é¢‘æ‹‰æµå›åˆ°&lt;host&gt;:10005ï¼Œæ­¤æ—¶å·²ç»å¯ä»¥è®¿é—®æ‘„åƒå¤´ ç‚¹å‡»å›½æ ‡è®¾å¤‡ï¼ŒæŸ¥çœ‹é€šé“ çœ‹åˆ°å·²ç»é…ç½®å¥½çš„æ‘„åƒå¤´ä¿¡æ¯ å¯ä»å³ä¸‹è§’è·å–è§†é¢‘æ‹‰æµ","categories":[{"name":"è®¡ç®—æœºè§†è§‰","slug":"è®¡ç®—æœºè§†è§‰","permalink":"http://yoursite.com/categories/è®¡ç®—æœºè§†è§‰/"}],"tags":[{"name":"LiveGBS","slug":"LiveGBS","permalink":"http://yoursite.com/tags/LiveGBS/"}]},{"title":"paddleDetection-è§†é¢‘OCR","slug":"paddleDetection-è§†é¢‘OCR","date":"2023-08-14T03:15:55.000Z","updated":"2023-08-29T09:18:54.671Z","comments":true,"path":"2023/08/14/paddleDetection-è§†é¢‘OCR/","link":"","permalink":"http://yoursite.com/2023/08/14/paddleDetection-è§†é¢‘OCR/","excerpt":"PPOCR_V4å®‰è£…ç™¾åº¦æœ€æ–°ppocr_v4åº“ï¼Œä½¿ç”¨è™šæ‹Ÿç¯å¢ƒä¸ºpy39_vioï¼Œæœ¬è™šæ‹Ÿç¯å¢ƒä¸å¯ä¸äººè„¸è¯†åˆ«ï¼ˆpy38_arcfaceï¼‰å…¼å®¹ï¼ˆopencvç‰ˆæœ¬ä¸å…¼å®¹ï¼‰ 1pip install paddleocr --user -i https://mirror.baidu.com/pypi/simple ä»£ç cfg_utils.pyæ–°å¢cfg--ocrï¼Œè®¾ç½®Trueä¸ºå¼€å¯ï¼Œé»˜è®¤False 12345parser.add_argument( \"--ocr\", type=bool, default=False, help=\"use paddlepaddle-ocr\") pipeline.py 1from python.visualize import visualize_box_mask, visualize_attr, visualize_pose, visualize_action, visualize_vehicleplate, visualize_vehiclepress, visualize_lane, visualize_vehicle_retrograde, visualize_ocr 123class PipePredictor(object): def __init__(self, args, cfg, is_video=True, multi_camera=False): self.ocr = args.ocr 1234567891011121314151617181920212223def visualize_video(self, image_rgb, result, collector, frame_id, fps, entrance=None, records=None, center_traj=None, do_illegal_parking_recognition=False, illegal_parking_dict=None): image = cv2.cvtColor(image_rgb, cv2.COLOR_RGB2BGR) mot_res = copy.deepcopy(result.get('mot')) if self.ocr: lock.acquire() # åŠ é”ï¼ŒpaddleOCRæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ ocr_result = ocr.ocr(image, cls=True)[0] lock.release() ocr_boxes = [line[0] for line in ocr_result] ocr_txts = [line[1][0] for line in ocr_result] ocr_scores = [line[1][1] for line in ocr_result] image = visualize_ocr(image, ocr_boxes, ocr_txts, ocr_scores) visualize.py 12345678910111213141516171819202122232425262728293031323334353637383940414243def visualize_ocr(im, boxes, texts, score): if isinstance(im, str): im = Image.open(im) im = np.ascontiguousarray(np.copy(im)) im = cv2.cvtColor(im, cv2.COLOR_RGB2BGR) else: im = np.ascontiguousarray(np.copy(im)) # åˆ›å»ºé€æ˜å›¾å±‚ï¼Œä¸ºå›¾åƒæ·»åŠ æ–‡å­—æ°´å° im = Image.fromarray(im) im = im.convert('RGBA') im_canvas = Image.new('RGBA', im.size, (255, 255, 255, 0)) for i, res in enumerate(texts): if boxes is not None: box = boxes[i] text = res if text == \"\": continue text_scale = max(1.0, int(box[2][1] - box[1][1])) draw = ImageDraw.Draw(im_canvas) draw.text( (box[0][0], box[0][1]), text, font=ImageFont.truetype(font_file, size=int(text_scale)), fill=(255, 255, 0, 85)) # ç¬¬å››ä½æ˜¯é€æ˜åº¦ try: draw.rectangle( ((box[0][0], box[0][1]), (box[2][0], box[2][1])), fill=None, outline=(255, 255, 0), width=1) except ValueError: pass # å¤åˆå›¾å±‚ im = Image.alpha_composite(im, im_canvas) im = im.convert('RGB') # è¿˜åŸè¿ç»­å­˜å‚¨æ•°ç»„ im = np.ascontiguousarray(np.copy(im)) return im","text":"PPOCR_V4å®‰è£…ç™¾åº¦æœ€æ–°ppocr_v4åº“ï¼Œä½¿ç”¨è™šæ‹Ÿç¯å¢ƒä¸ºpy39_vioï¼Œæœ¬è™šæ‹Ÿç¯å¢ƒä¸å¯ä¸äººè„¸è¯†åˆ«ï¼ˆpy38_arcfaceï¼‰å…¼å®¹ï¼ˆopencvç‰ˆæœ¬ä¸å…¼å®¹ï¼‰ 1pip install paddleocr --user -i https://mirror.baidu.com/pypi/simple ä»£ç cfg_utils.pyæ–°å¢cfg--ocrï¼Œè®¾ç½®Trueä¸ºå¼€å¯ï¼Œé»˜è®¤False 12345parser.add_argument( \"--ocr\", type=bool, default=False, help=\"use paddlepaddle-ocr\") pipeline.py 1from python.visualize import visualize_box_mask, visualize_attr, visualize_pose, visualize_action, visualize_vehicleplate, visualize_vehiclepress, visualize_lane, visualize_vehicle_retrograde, visualize_ocr 123class PipePredictor(object): def __init__(self, args, cfg, is_video=True, multi_camera=False): self.ocr = args.ocr 1234567891011121314151617181920212223def visualize_video(self, image_rgb, result, collector, frame_id, fps, entrance=None, records=None, center_traj=None, do_illegal_parking_recognition=False, illegal_parking_dict=None): image = cv2.cvtColor(image_rgb, cv2.COLOR_RGB2BGR) mot_res = copy.deepcopy(result.get('mot')) if self.ocr: lock.acquire() # åŠ é”ï¼ŒpaddleOCRæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ ocr_result = ocr.ocr(image, cls=True)[0] lock.release() ocr_boxes = [line[0] for line in ocr_result] ocr_txts = [line[1][0] for line in ocr_result] ocr_scores = [line[1][1] for line in ocr_result] image = visualize_ocr(image, ocr_boxes, ocr_txts, ocr_scores) visualize.py 12345678910111213141516171819202122232425262728293031323334353637383940414243def visualize_ocr(im, boxes, texts, score): if isinstance(im, str): im = Image.open(im) im = np.ascontiguousarray(np.copy(im)) im = cv2.cvtColor(im, cv2.COLOR_RGB2BGR) else: im = np.ascontiguousarray(np.copy(im)) # åˆ›å»ºé€æ˜å›¾å±‚ï¼Œä¸ºå›¾åƒæ·»åŠ æ–‡å­—æ°´å° im = Image.fromarray(im) im = im.convert('RGBA') im_canvas = Image.new('RGBA', im.size, (255, 255, 255, 0)) for i, res in enumerate(texts): if boxes is not None: box = boxes[i] text = res if text == \"\": continue text_scale = max(1.0, int(box[2][1] - box[1][1])) draw = ImageDraw.Draw(im_canvas) draw.text( (box[0][0], box[0][1]), text, font=ImageFont.truetype(font_file, size=int(text_scale)), fill=(255, 255, 0, 85)) # ç¬¬å››ä½æ˜¯é€æ˜åº¦ try: draw.rectangle( ((box[0][0], box[0][1]), (box[2][0], box[2][1])), fill=None, outline=(255, 255, 0), width=1) except ValueError: pass # å¤åˆå›¾å±‚ im = Image.alpha_composite(im, im_canvas) im = im.convert('RGB') # è¿˜åŸè¿ç»­å­˜å‚¨æ•°ç»„ im = np.ascontiguousarray(np.copy(im)) return im å¯åŠ¨åœ¨deploy/pipeline/configä¸‹åˆ›å»ºè§†é¢‘ocrçš„ymlæ–‡ä»¶infer_cfg_ppocr.ymlï¼Œå†™å…¥åŸºæœ¬å‚æ•° 123crop_thresh: 0.5visual: Truewarmup_frame: 50 1python deploy/pipeline/pipeline.py --config deploy/pipeline/config/infer_cfg_ppocr.yml --device=gpu --video_file=demo_input/car_t1.mp4 --output_dir=demo_output --ocr=True","categories":[],"tags":[{"name":"OCR","slug":"OCR","permalink":"http://yoursite.com/tags/OCR/"},{"name":"paddlepaddle","slug":"paddlepaddle","permalink":"http://yoursite.com/tags/paddlepaddle/"}]},{"title":"paddleDetection:OpenCVæ£€æµ‹æ¡†è½¬ä¸­æ–‡","slug":"paddleDetection-OpenCVæ£€æµ‹æ¡†è½¬ä¸­æ–‡","date":"2023-08-09T08:29:45.000Z","updated":"2024-01-25T09:20:13.155Z","comments":true,"path":"2023/08/09/paddleDetection-OpenCVæ£€æµ‹æ¡†è½¬ä¸­æ–‡/","link":"","permalink":"http://yoursite.com/2023/08/09/paddleDetection-OpenCVæ£€æµ‹æ¡†è½¬ä¸­æ–‡/","excerpt":"æ³¨ï¼šOpenCVä¸èƒ½ç›´æ¥æ˜¾ç¤ºä¸­æ–‡ï¼Œé€šè¿‡PILè½¬æ¢ä¼šæŸå¤±ä¸€éƒ¨åˆ†ç®—åŠ›æ€§èƒ½ ä¿®æ”¹æºç ï¼ˆå¯è§†åŒ–ï¼‰./deploy/python/visualize.py å¢åŠ å¯¼å…¥å­—ä½“åº“å’Œå­—ä½“æ–‡ä»¶123from PIL import Image, ImageDraw, ImageFile, ImageFontfont_file = '/exp/work/video/PaddleDetection/deploy/pipeline/SourceHanSansCN-Medium.otf' visualize_attr123456789101112131415161718192021222324252627282930313233343536373839def visualize_attr(im, results, boxes=None, is_mtmct=False): if isinstance(im, str): im = Image.open(im) im = np.ascontiguousarray(np.copy(im)) im = cv2.cvtColor(im, cv2.COLOR_RGB2BGR) else: im = np.ascontiguousarray(np.copy(im)) line_inter = im.shape[0] / 40. text_scale = max(0.5, im.shape[0] / 100.) # å°†nparrayå›¾åƒè½¬PILå›¾åƒ im = Image.fromarray(im) for i, res in enumerate(results): print(i, res) if boxes is None: text_w = 3 text_h = 1 elif is_mtmct: box = boxes[i] # multi camera, bbox shape is x,y, w,h text_w = int(box[0]) + 3 text_h = int(box[1]) else: box = boxes[i] # single camera, bbox shape is 0, 0, x,y, w,h text_w = int(box[2]) + 3 text_h = int(box[3]) for text in res: text_h += int(line_inter) text_loc = (text_w, text_h) # å†™å…¥ draw = ImageDraw.Draw(im) draw.text( text_loc, text, font=ImageFont.truetype(font_file, size=int(text_scale)), # å­—ä½“ä½ç½® fill=(0, 255, 255)) # è¿˜åŸè¿ç»­å­˜å‚¨æ•°ç»„ im = np.ascontiguousarray(np.copy(im)) return im","text":"æ³¨ï¼šOpenCVä¸èƒ½ç›´æ¥æ˜¾ç¤ºä¸­æ–‡ï¼Œé€šè¿‡PILè½¬æ¢ä¼šæŸå¤±ä¸€éƒ¨åˆ†ç®—åŠ›æ€§èƒ½ ä¿®æ”¹æºç ï¼ˆå¯è§†åŒ–ï¼‰./deploy/python/visualize.py å¢åŠ å¯¼å…¥å­—ä½“åº“å’Œå­—ä½“æ–‡ä»¶123from PIL import Image, ImageDraw, ImageFile, ImageFontfont_file = '/exp/work/video/PaddleDetection/deploy/pipeline/SourceHanSansCN-Medium.otf' visualize_attr123456789101112131415161718192021222324252627282930313233343536373839def visualize_attr(im, results, boxes=None, is_mtmct=False): if isinstance(im, str): im = Image.open(im) im = np.ascontiguousarray(np.copy(im)) im = cv2.cvtColor(im, cv2.COLOR_RGB2BGR) else: im = np.ascontiguousarray(np.copy(im)) line_inter = im.shape[0] / 40. text_scale = max(0.5, im.shape[0] / 100.) # å°†nparrayå›¾åƒè½¬PILå›¾åƒ im = Image.fromarray(im) for i, res in enumerate(results): print(i, res) if boxes is None: text_w = 3 text_h = 1 elif is_mtmct: box = boxes[i] # multi camera, bbox shape is x,y, w,h text_w = int(box[0]) + 3 text_h = int(box[1]) else: box = boxes[i] # single camera, bbox shape is 0, 0, x,y, w,h text_w = int(box[2]) + 3 text_h = int(box[3]) for text in res: text_h += int(line_inter) text_loc = (text_w, text_h) # å†™å…¥ draw = ImageDraw.Draw(im) draw.text( text_loc, text, font=ImageFont.truetype(font_file, size=int(text_scale)), # å­—ä½“ä½ç½® fill=(0, 255, 255)) # è¿˜åŸè¿ç»­å­˜å‚¨æ•°ç»„ im = np.ascontiguousarray(np.copy(im)) return im visualize_vehicleplate12345678910111213141516171819202122232425262728293031323334def visualize_vehicleplate(im, results, boxes=None): if isinstance(im, str): im = Image.open(im) im = np.ascontiguousarray(np.copy(im)) im = cv2.cvtColor(im, cv2.COLOR_RGB2BGR) else: im = np.ascontiguousarray(np.copy(im)) text_scale = max(1.0, im.shape[0] / 400.) line_inter = im.shape[0] / 40. # å°†nparrayå›¾åƒè½¬PILå›¾åƒ im = Image.fromarray(im) for i, res in enumerate(results): if boxes is None: text_w = 3 text_h = 1 else: box = boxes[i] text = res if text == \"\": continue text_w = int(box[2]) text_h = int(box[5] + box[3]) text_loc = (text_w, text_h) # å†™å…¥ draw = ImageDraw.Draw(im) draw.text( text_loc, text, font=ImageFont.truetype(font_file, size=int(text_scale)), # å­—ä½“ä½ç½® fill=(0, 255, 255)) # è¿˜åŸè¿ç»­å­˜å‚¨æ•°ç»„ im = np.ascontiguousarray(np.copy(im)) return im visualize_action1234567891011121314151617181920212223242526272829303132333435363738394041424344def visualize_action(im, mot_boxes, action_visual_collector=None, action_text=\"\", video_action_score=None, video_action_text=\"\"): im = cv2.imread(im) if isinstance(im, str) else im im_h, im_w = im.shape[:2] text_scale = max(1, im.shape[1] / 40.) text_thickness = 2 # å°†nparrayå›¾åƒè½¬PILå›¾åƒ im = Image.fromarray(im) if action_visual_collector: id_action_dict = &#123;&#125; for collector, action_type in zip(action_visual_collector, action_text): id_detected = collector.get_visualize_ids() for pid in id_detected: id_action_dict[pid] = id_action_dict.get(pid, []) id_action_dict[pid].append(action_type) for mot_box in mot_boxes: # mot_box is a format with [mot_id, class, score, xmin, ymin, w, h] if mot_box[0] in id_action_dict: text_position = (int(mot_box[3] + mot_box[5] * 0.75), int(mot_box[4] - 10)) display_text = ', '.join(id_action_dict[mot_box[0]]) draw = ImageDraw.Draw(im) draw.text( text_position, display_text, font=ImageFont.truetype(size=int(text_scale)), # å­—ä½“ä½ç½® fill=(0, 0, 255)) if video_action_score: draw = ImageDraw.Draw(im) draw.text( (int(im_w / 2), int(15 * text_scale) + 5), video_action_text + ': %.2f' % video_action_score, font=ImageFont.truetype(font_file, size=int(text_scale)), # å­—ä½“ä½ç½® fill=(0, 0, 255)) # è¿˜åŸè¿ç»­å­˜å‚¨æ•°ç»„ im = np.ascontiguousarray(np.copy(im)) return im ä¿®æ”¹æºç ï¼ˆå±æ€§ï¼‰ä¿®æ”¹å¯¹åº”ä¸­æ–‡æ¨¡å— ./deploy/pipeline/ pipeline.py ./deploy/pipeline/ppvehicle vehicle_attr.py vehicle_plate.py ./deploy/pipeline/pphuman attr_infer.py æ‰§è¡Œè„šæœ¬12345# pphumanpython deploy/pipeline/pipeline.py --config deploy/pipeline/config/infer_cfg_pphuman.yml --video_file=demo_input/act1.mp4 --device=gpu --output_dir=demo_output# ppvehiclepython deploy/pipeline/pipeline.py --config deploy/pipeline/config/infer_cfg_ppvehicle.yml --video_file=demo_input/car_t1.mp4 --device=gpu --output_dir=demo_output","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://yoursite.com/categories/æ·±åº¦å­¦ä¹ /"}],"tags":[{"name":"paddlepaddle","slug":"paddlepaddle","permalink":"http://yoursite.com/tags/paddlepaddle/"},{"name":"opencv","slug":"opencv","permalink":"http://yoursite.com/tags/opencv/"}]},{"title":"arcface_paddle","slug":"arcface-paddle","date":"2023-08-08T09:12:11.000Z","updated":"2023-08-09T10:03:27.504Z","comments":true,"path":"2023/08/08/arcface-paddle/","link":"","permalink":"http://yoursite.com/2023/08/08/arcface-paddle/","excerpt":"ç¯å¢ƒGPUï¼ˆç‰©ç†ï¼‰ NVIDIA 3090*2 æ˜¾å¡é©±åŠ¨ 515.43.04 CUDAç‰ˆæœ¬ 11.7 CUDAtoolkit (cuda_11.7.0_515.43.04_linux) cuDNN (v8.4.1) paddlepaddle å¤šå¡è®­ç»ƒéœ€è¦NCLLæ”¯æŒ (ncll v2.12.12 cuda11.7) paddlepaddleç‰ˆæœ¬ paddlepaddle-gpu==2.2.0rc0ï¼ˆè™šæ‹Ÿç¯å¢ƒcuda11.2ï¼‰ pythonç¯å¢ƒ CentOS7.9 anaconda3 python3.8 anacondaå®‰è£…insightfaceé‡è¦ï¼špillowç‰ˆæœ¬å»ºè®®é€‰æ‹©9.5 å¦åˆ™è¿‡é«˜ä¼šå¯¼è‡´å®‰è£…insightfaceæŠ¥é”™ ï¼ˆé”™è¯¯åŸå› ï¼špillow10ç§»é™¤äº†getsizeæ–¹æ³•ï¼Œéœ€è¦ä¿®æ”¹å¯¹åº”ä½ç½®æºç ä¸ºgetbboxæˆ– getlengthï¼‰ å‘Šè­¦ä¿¡æ¯ï¼š 12tools/test_recognition.py:627: DeprecationWarning: getsize is deprecated and will be removed in Pillow 10 (2023-07-01). Use getbbox or getlength instead. tw = font.getsize(text)[0] ç¯å¢ƒå®‰è£…12345678# .conda install paddlepaddle-gpu==2.2.0rc0 cudatoolkit=11.2 -c https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/Paddle/ -c conda-forge# insightfacepip install -r requirements.txt -i https://mirror.baidu.com/pypi/simple# insightface/recongition/arcface_paddle/pip install -r requirement.txt -i https://mirror.baidu.com/pypi/simple# insightface-paddlepip install insightface-paddle -i https://mirror.baidu.com/pypi/simple","text":"ç¯å¢ƒGPUï¼ˆç‰©ç†ï¼‰ NVIDIA 3090*2 æ˜¾å¡é©±åŠ¨ 515.43.04 CUDAç‰ˆæœ¬ 11.7 CUDAtoolkit (cuda_11.7.0_515.43.04_linux) cuDNN (v8.4.1) paddlepaddle å¤šå¡è®­ç»ƒéœ€è¦NCLLæ”¯æŒ (ncll v2.12.12 cuda11.7) paddlepaddleç‰ˆæœ¬ paddlepaddle-gpu==2.2.0rc0ï¼ˆè™šæ‹Ÿç¯å¢ƒcuda11.2ï¼‰ pythonç¯å¢ƒ CentOS7.9 anaconda3 python3.8 anacondaå®‰è£…insightfaceé‡è¦ï¼špillowç‰ˆæœ¬å»ºè®®é€‰æ‹©9.5 å¦åˆ™è¿‡é«˜ä¼šå¯¼è‡´å®‰è£…insightfaceæŠ¥é”™ ï¼ˆé”™è¯¯åŸå› ï¼špillow10ç§»é™¤äº†getsizeæ–¹æ³•ï¼Œéœ€è¦ä¿®æ”¹å¯¹åº”ä½ç½®æºç ä¸ºgetbboxæˆ– getlengthï¼‰ å‘Šè­¦ä¿¡æ¯ï¼š 12tools/test_recognition.py:627: DeprecationWarning: getsize is deprecated and will be removed in Pillow 10 (2023-07-01). Use getbbox or getlength instead. tw = font.getsize(text)[0] ç¯å¢ƒå®‰è£…12345678# .conda install paddlepaddle-gpu==2.2.0rc0 cudatoolkit=11.2 -c https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/Paddle/ -c conda-forge# insightfacepip install -r requirements.txt -i https://mirror.baidu.com/pypi/simple# insightface/recongition/arcface_paddle/pip install -r requirement.txt -i https://mirror.baidu.com/pypi/simple# insightface-paddlepip install insightface-paddle -i https://mirror.baidu.com/pypi/simple è·å–æ•°æ®é›†https://github.com/deepinsight/insightface/tree/master/recognition/_datasets_ MS1M_v2: MS1M-ArcFace MS1M_v3: MS1M-RetinaFace ä» MXNet æ ¼å¼æ•°æ®é›†æŠ½å–å›¾åƒ 1python tools/mx_recordio_2_images.py --root_dir ms1m-retinaface-t1/ --output_dir MS1M_v3/ æ•°æ®æŠ½å–å®Œæˆåï¼Œæ ¼å¼å¦‚ä¸‹ 12345678910MS1M_v3|_ images| |_ 00000001.jpg| |_ ...| |_ 05179510.jpg|_ label.txt|_ agedb_30.bin|_ cfp_ff.bin|_ cfp_fp.bin|_ lfw.bin æ ‡ç­¾æ•°æ®æ ¼å¼å¦‚ä¸‹ 1234# å›¾åƒè·¯å¾„ä¸æ ‡ç­¾çš„åˆ†éš”ç¬¦: &quot;\\t&quot;# ä»¥ä¸‹æ˜¯ label.txt æ¯è¡Œçš„æ ¼å¼images/00000001.jpg 0... æ¨¡å‹è®­ç»ƒä½¿ç”¨åŒå¡ 1export CUDA_VISIBLE_DEVICES=0,1 è®­ç»ƒè„šæœ¬scripts/train_static.sh 12# é™çº§scipy,scipyç‰ˆæœ¬è¿‡é«˜ä¼šæŠ¥é”™pip install scipy==1.7.1 -i https://mirror.baidu.com/pypi/simple è®­ç»ƒé™æ€æ¨¡å‹ 123456789101112131415161718192021222324252627python -m paddle.distributed.launch --gpus=1 tools/train.py \\ --config_file configs/ms1mv3_r50.py \\ --is_static True \\ --backbone FresResNet50 \\ --classifier LargeScaleClassifier \\ --embedding_size 512 \\ --model_parallel True \\ --dropout 0.0 \\ --sample_ratio 0.1 \\ --loss ArcFace \\ --batch_size 64 \\ --dataset MS1M_v3 \\ --num_classes 93431 \\ --data_dir MS1M_v3/ \\ --label_file MS1M_v3/label.txt \\ --is_bin False \\ --log_interval_step 100 \\ --validation_interval_step 2000 \\ --fp16 True \\ --use_dynamic_loss_scaling True \\ --init_loss_scaling 27648.0 \\ --num_workers 8 \\ --train_unit 'epoch' \\ --warmup_num 0 \\ --train_num 25 \\ --decay_boundaries \"10,16,22\" \\ --output MS1M_v3_arcface_static_0.1 3090å•å¡å®¹æ˜“çˆ†æ˜¾å­˜ batch_sizeå¯ç”±128è°ƒæ•´è‡³64ï¼Œæˆ–å¼€å¯å¤šå¡è®­ç»ƒï¼Œéœ€ncll æ¨¡å‹è¯„ä»·sh scripts/validation_static.sh 12345678python tools/validation.py \\ --is_static True \\ --backbone FresResNet50 \\ --embedding_size 512 \\ --checkpoint_dir MS1M_v3_arcface_static_0.1/FresResNet50/24 \\ --data_dir MS1M_v3/ \\ --val_targets lfw,cfp_fp,agedb_30 \\ --batch_size 64 æ¨¡å‹å¯¼å‡ºsh scripts/export_static.sh 1234567python tools/export.py \\ --is_static True \\ --export_type paddle \\ --backbone FresResNet50 \\ --embedding_size 512 \\ --checkpoint_dir MS1M_v3_arcface_static_0.1/FresResNet50/24 \\ --output_dir MS1M_v3_arcface_static_0.1/FresResNet50/exported_model æ¨¡å‹æ¨ç†sh scripts/inference.sh 12345python tools/inference.py \\ --export_type paddle \\ --model_file MS1M_v3_arcface_static_0.1/FresResNet50/exported_model/FresResNet50.pdmodel \\ --params_file MS1M_v3_arcface_static_0.1/FresResNet50/exported_model/FresResNet50.pdiparams \\ --image_path MS1M_v3/images/00000001.jpg æ„å»ºäººåƒç´¢å¼• å»ºç«‹å›¾åƒæ–‡ä»¶å¤¹ 123456789101112fridends|_ gallery| |_ Chandler| |_ Chandler01.jpg| |_ ...| |_ Chandler50.jpg| |_ ...| |_ Ross| |_ Ross01.jpg| |_ ...| |_ Ross50.jpg|_ label.txt å»ºç«‹ç´¢å¼•æ–‡ä»¶label.txt 123456789101112131415161718./Chandler/Chandler00037.jpg Chandler./Chandler/Chandler00021.png Chandler./Chandler/Chandler00040.jpg Chandler./Chandler/Chandler00041.jpg Chandler./Chandler/Chandler00004.png Chandler./Chandler/Chandler00034.png Chandler./Chandler/Chandler00008.png Chandler..../Ross/Ross00016.jpg Ross./Ross/Ross00022.jpg Ross./Ross/Ross00019.jpg Ross./Ross/Ross00024.jpg Ross./Ross/Ross00001.jpg Ross./Ross/Ross00039.jpg Ross./Ross/Ross00038.jpg Ross./Ross/Ross00017.jpg Ross./Ross/Ross00034.jpg Ross./Ross/Ross00002.png Ross æ„å»ºç´¢å¼• 1insightfacepaddle --build_index ./demo/friends/index.bin --img_dir ./demo/friends/gallery --label ./demo/friends/gallery/label.txt æ£€æµ‹å›¾ç‰‡1python tools/test_recognition.py --det --rec --index=./demo/friends/index.bin --input=./test/æµ‹è¯•2.jpg --output=./output é¢„æµ‹å›¾ç‰‡1python tools/test_recognition.py --det --rec --index=./demo/friends/index.bin --input=./test/æµ‹è¯•2.jpg --output=./output é¢„æµ‹è§†é¢‘1python tools/test_recognition.py --det --rec --index=./demo/friends/index.bin --input=./test/mp4v.mp4 --output=./output pythonè„šæœ¬è„šæœ¬å°è£…ä½ç½®ï¼šarcface_paddle/python æ„å»ºç´¢å¼• 1234567891011import osimport insightface_paddle as faceimport loggingparser = face.parser()args = parser.parse_args()args.build_index = \"./demo/friends/index.bin\"args.img_dir = \"./demo/friends/gallery\"args.label = \"./demo/friends/gallery/label.txt\"predictor = face.InsightFace(args)predictor.build_index() è§†é¢‘ 123456789101112131415161718192021import osimport insightface_paddle as faceimport loggingPR = os.path.dirname(os.path.abspath(__file__))logging.basicConfig(level=logging.INFO)parser = face.parser()args = parser.parse_args()args.det = Trueargs.rec = Trueargs.index = os.path.join(PR, \"demo/friends/index.bin\")args.output = os.path.join(PR, \"output\")input_path = os.path.join(PR, \"test/MP4V.mp4\")predictor = face.InsightFace(args)res = predictor.predict(input_path, print_info=True)for _ in res: print(_.get('labels'))","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://yoursite.com/categories/æ·±åº¦å­¦ä¹ /"}],"tags":[{"name":"paddlepaddle","slug":"paddlepaddle","permalink":"http://yoursite.com/tags/paddlepaddle/"}]},{"title":"paddleDetectionå‰ç½®","slug":"paddleDetectionå‰ç½®","date":"2023-08-07T08:20:53.000Z","updated":"2024-01-25T08:50:19.855Z","comments":true,"path":"2023/08/07/paddleDetectionå‰ç½®/","link":"","permalink":"http://yoursite.com/2023/08/07/paddleDetectionå‰ç½®/","excerpt":"ç¯å¢ƒGPU NVIDIA 3090*2 æ˜¾å¡é©±åŠ¨ 515.43.04 CUDAç‰ˆæœ¬ 11.7 CUDAtoolkit (cuda_11.7.0_515.43.04_linux) cuDNN (v8.4.1) paddlepaddle å¤šå¡è®­ç»ƒéœ€è¦NCLLæ”¯æŒ (ncll v2.12.12 cuda11.7) paddlepaddleç‰ˆæœ¬ v2.4.2 paddleDetectionç‰ˆæœ¬ v2.6.0 pythonç¯å¢ƒ CentOS7.9 anaconda3 python3.8 æ™®é€šè§†é¢‘å¤„ç†h264æ ¼å¼è§†é¢‘è¢«opencvè§£æå¸§ç‡è¶…è¿‡65535æŠ¥é”™ æºç ï¼š ./deploy/pipeline/pipeline.py predict_video 123out_path = os.path.join(self.output_dir, video_out_name + \".mp4\")fourcc = cv2.VideoWriter_fourcc(* 'mp4v')writer = cv2.VideoWriter(out_path, fourcc, fps, (width, height)) è¾“å…¥ï¼šcv2.VideoCapture() è¾“å‡ºï¼šcv2.VideoWriter(ï¼‰ æœ¬GPUæ¨¡å¼ä¸‹å¯¹æ—¶é•¿5åˆ†é’Ÿçš„è¡Œäººæ£€æµ‹è§†é¢‘å¤„ç†æ—¶é—´çº¦20åˆ†é’Ÿï¼ˆé«˜ç²¾åº¦æ¨¡å‹ï¼‰ï¼Œè§†é¢‘ä½“ç§¯å¢å¤§13å€ï¼ˆ100M-&gt;1.3Gï¼‰","text":"ç¯å¢ƒGPU NVIDIA 3090*2 æ˜¾å¡é©±åŠ¨ 515.43.04 CUDAç‰ˆæœ¬ 11.7 CUDAtoolkit (cuda_11.7.0_515.43.04_linux) cuDNN (v8.4.1) paddlepaddle å¤šå¡è®­ç»ƒéœ€è¦NCLLæ”¯æŒ (ncll v2.12.12 cuda11.7) paddlepaddleç‰ˆæœ¬ v2.4.2 paddleDetectionç‰ˆæœ¬ v2.6.0 pythonç¯å¢ƒ CentOS7.9 anaconda3 python3.8 æ™®é€šè§†é¢‘å¤„ç†h264æ ¼å¼è§†é¢‘è¢«opencvè§£æå¸§ç‡è¶…è¿‡65535æŠ¥é”™ æºç ï¼š ./deploy/pipeline/pipeline.py predict_video 123out_path = os.path.join(self.output_dir, video_out_name + \".mp4\")fourcc = cv2.VideoWriter_fourcc(* 'mp4v')writer = cv2.VideoWriter(out_path, fourcc, fps, (width, height)) è¾“å…¥ï¼šcv2.VideoCapture() è¾“å‡ºï¼šcv2.VideoWriter(ï¼‰ æœ¬GPUæ¨¡å¼ä¸‹å¯¹æ—¶é•¿5åˆ†é’Ÿçš„è¡Œäººæ£€æµ‹è§†é¢‘å¤„ç†æ—¶é—´çº¦20åˆ†é’Ÿï¼ˆé«˜ç²¾åº¦æ¨¡å‹ï¼‰ï¼Œè§†é¢‘ä½“ç§¯å¢å¤§13å€ï¼ˆ100M-&gt;1.3Gï¼‰ è§†é¢‘æµé—®é¢˜ h264æ ¼å¼å­˜åœ¨é—®é¢˜ï¼ˆéœ€è¦é‡æ–°ç¼–è¯‘opencvï¼‰ï¼Œå®æ—¶å¸§æ•°è¿‡é«˜ï¼ˆ&gt;65535ï¼‰cv2.VideoWriteræŠ¥é”™ï¼Œæ— æ³•ä¿å­˜è§†é¢‘ é—®é¢˜åŸå› ï¼šlibx264åŸºäºGPLï¼Œffmpegç¼–ç å™¨è¦ä½¿ç”¨libx264ï¼Œå¿…é¡»--enable-gplï¼Œè€Œopencvä½¿ç”¨çš„æ˜¯MITè®¸å¯ å¦‚æœè§†é¢‘æµä¼ è¾“åŠ è½½è¾ƒæ…¢ï¼Œè·å–ä¸åˆ°è§†é¢‘æŠ¥é”™(ä¿®æ”¹pipeline.py predict_video) 1234567891011121314151617class FrameQueueEmptyException(Exception): \"\"\"An Exception for check frame queue\"\"\" def __init__(self, time): self.time = time def __str__(self): print(f\"&#123;self.time&#125;ç§’æ— æ³•è·å–frameé˜Ÿåˆ—ï¼Œè¯·æ£€æŸ¥æ‘„åƒå¤´æ˜¯å¦æ­£å¸¸è¿è½¬\")for i in range(1, 11): if framequeue.empty(): time.sleep(1) print(f\"Couldn't catch framequeue for &#123;i&#125; seconds\") else: break if i == 10: raise FrameQueueEmptyException æ‘„åƒå¤´ &amp; åº”ç”¨ä»¥liveCMSåº”ç”¨ä¸ºä¾‹ï¼ˆå›½æ ‡è®¾å¤‡è§æ–‡æ¡£ï¼šLiveGBSå›½æ ‡GB-T28181è§†é¢‘æµåª’ä½“å¹³å°ï¼‰ æ¯26å¤©éœ€æ›´æ–°ä¸€æ¬¡ liveCMSåº”ç”¨å®‰è£…åœ¨192.168.9.165æœºå™¨ å›½æ ‡è®¾å¤‡æœåŠ¡ç«¯å£ï¼š192.168.9.165:10005è´¦å·ï¼šadminï¼Œå¯†ç ï¼šA12345678 è¿‘ç«¯è®¾å¤‡åœ°å€ï¼š192.168.9.207 è®¾å¤‡ä¸»æ¿ipï¼š192.168.177.177è´¦æˆ·ï¼šrootï¼Œå¯†ç ï¼šadmin æ‘„åƒå¤´è®¾å¤‡åœ°å€ï¼š192.168.1.131ã€192.168.1.133 æ‘„åƒå¤´æ¨æµæ‘„åƒå¤´æ¨æµapiï¼šhttp://&lt;livecms_host&gt;:&lt;ip&gt;/api/v1/stream/list 12345678910111213141516171819202122232425262728293031323334353637383940414243&#123; \"StreamCount\": 1, \"Streams\": [ &#123; \"AudioEnable\": false, \"CDN\": \"\", \"CascadeSize\": 0, \"ChannelID\": \"34020000001320000131\", \"ChannelName\": \"192.168.1.131\", \"CloudRecord\": false, \"DeviceID\": \"34020000002000000207\", \"Duration\": 20520, \"FLV\": \"http://192.168.9.165:10005/sms/34020000002020000001/flv/hls/34020000002000000207_34020000001320000131.flv\", \"HLS\": \"http://192.168.9.165:10005/sms/34020000002020000001/hls/34020000002000000207_34020000001320000131/live.m3u8\", \"InBitRate\": 914, \"InBytes\": 2196788210, \"NumOutputs\": 1, \"Ondemand\": true, \"OutBytes\": 2308731853, \"RTMP\": \"rtmp://192.168.9.165:11935/hls/34020000002000000207_34020000001320000131\", \"RTPCount\": 2049812, \"RTPLostCount\": 3526, \"RTPLostRate\": 0.6256656017039404, \"RTSP\": \"rtsp://192.168.9.165:554/34020000002000000207_34020000001320000131\", \"RecordStartAt\": \"\", \"RelaySize\": 0, \"SMSID\": \"34020000002020000001\", \"SnapURL\": \"/sms/34020000002020000001/snap/34020000002000000207/34020000001320000131.jpg?t=1690332332290541800\", \"SourceAudioCodecName\": \"aac\", \"SourceAudioSampleRate\": 8000, \"SourceVideoCodecName\": \"h264\", \"SourceVideoFrameRate\": 30, \"SourceVideoHeight\": 720, \"SourceVideoWidth\": 1280, \"StartAt\": \"2023-07-26 08:45:30\", \"StreamID\": \"stream:34020000002000000207:34020000001320000131\", \"Transport\": \"UDP\", \"VideoFrameCount\": 605632, \"WEBRTC\": \"webrtc://192.168.9.165:10005/sms/34020000002020000001/rtc/34020000002000000207_34020000001320000131\", \"WS_FLV\": \"ws://192.168.9.165:10005/sms/34020000002020000001/ws-flv/hls/34020000002000000207_34020000001320000131.flv\" &#125; ]&#125; æ‰§è¡ŒpaddleDetection â€“rtstæŒ‡ä»¤1python deploy/pipeline/pipeline.py --config deploy/pipeline/config/examples/infer_cfg_human_attr.yml --rtsp http://192.168.9.165:10005/sms/34020000002020000001/flv/hls/34020000002000000207_34020000001320000131.flv --device=gpu è§£å†³rtspè§†é¢‘æµä¸­æ–­é—®é¢˜ï¼ˆæ ·ä¾‹ï¼‰pipline.py - class PipePredictor 1self.rtsp = args.rtsp pipline.py - predict_video 12345678910111213141516171819202122232425262728293031323334353637383940414243while True: flag = False if not framequeue.empty(): ... else: if self.rtsp: count = 1 capture = cv2.VideoCapture(video_file) try: fps = int(capture.get(cv2.CAP_PROP_FPS)) except OverflowError: fps = 20 frame_count = int(capture.get(cv2.CAP_PROP_FRAME_COUNT)) print(\"restart camera fps: %d, frame_count: %d\" % (fps, frame_count)) framequeue = queue.Queue(10) thread = threading.Thread( target=self.capturevideo, args=(capture, framequeue, execute_time)) thread.start() time.sleep(1) while True: if framequeue.empty(): time.sleep(1) print(f\"Couldn't catch framequeue for &#123;count&#125; seconds\") count += 1 if count == 11: flag = True break else: break else: flag = True if self.dbconfig: if self.dbconfig.rtsp: frame_thread_ = threading.Thread( target=self.video_composition, args=(self.frame_dir, self.out_path, video_fps) ) if not os.listdir(os.path.dirname(self.out_path)): if not self.frame_flag: frame_thread_.start() if flag: break ä½¿ç”¨Pythonè„šæœ¬pipeline/pipeline.pyåœ¨å¯¹åº”configæ–‡ä»¶ä¸­å°†MOTçš„tracker_configä¿®æ”¹ä¸ºç»å¯¹è·¯å¾„ 12345MOT: model_dir: https://bj.bcebos.com/v1/paddledet/models/pipeline/mot_ppyoloe_l_36e_pipeline.zip tracker_config: /exp/work/video/PaddleDetection/deploy/pipeline/config/tracker_config.yml batch_size: 1 enable: True ä¿®æ”¹pipeline.pyå¯åŠ¨è„šæœ¬ 123456789101112131415if __name__ == '__main__': paddle.enable_static() # parse params from command parser = argsparser() FLAGS = parser.parse_args() FLAGS.device = 'gpu' FLAGS.config = '/exp/work/video/PaddleDetection/deploy/pipeline/config/examples/infer_cfg_human_attr.yml' FLAGS.video_file = '/exp/work/video/PaddleDetection/demo_input/t2.mp4' FLAGS.output_dir = '/exp/work/video/PaddleDetection/demo_output/' FLAGS.device = FLAGS.device.upper() assert FLAGS.device in ['CPU', 'GPU', 'XPU', 'NPU' ], \"device should be CPU, GPU, XPU or NPU\" main() ä¿®æ”¹cfg_utils.py argsparserï¼›parse_argsï¼Œä¿®æ”¹å’Œæ³¨é‡Šæ‰configä½œä¸ºå¿…è¦æ¡ä»¶ 123456def parse_args(self, argv=None): args = super(ArgsParser, self).parse_args(argv) # assert args.config is not None, \\ # \"Please specify --config=configure_file_path.\" args.opt = self._parse_opt(args.opt) return args 123456parser.add_argument( \"--config\", type=str, default=None, help=(\"Path of configure\"), required=False) # True â€”â€”&gt; False å¯åŠ¨è„šæœ¬ï¼š 1python pipeline.py æˆ–å°†å…¶å°è£…ä¸ºæ¥å£ python/infer.pyå¯¼å‡ºé¢„æµ‹æ¨¡å‹ 123456789101112131415# å¯¼å‡ºYOLOv3æ£€æµ‹æ¨¡å‹python tools/export_model.py -c configs/yolov3/yolov3_darknet53_270e_coco.yml --output_dir=./inference_model \\ -o weights=https://paddledet.bj.bcebos.com/models/yolov3_darknet53_270e_coco.pdparams# å¯¼å‡ºHigherHRNet(bottom-up)å…³é”®ç‚¹æ£€æµ‹æ¨¡å‹python tools/export_model.py -c configs/keypoint/higherhrnet/higherhrnet_hrnet_w32_512.yml -o weights=https://paddledet.bj.bcebos.com/models/keypoint/higherhrnet_hrnet_w32_512.pdparams# å¯¼å‡ºHRNet(top-down)å…³é”®ç‚¹æ£€æµ‹æ¨¡å‹python tools/export_model.py -c configs/keypoint/hrnet/hrnet_w32_384x288.yml -o weights=https://paddledet.bj.bcebos.com/models/keypoint/hrnet_w32_384x288.pdparams# å¯¼å‡ºFairMOTå¤šç›®æ ‡è·Ÿè¸ªæ¨¡å‹python tools/export_model.py -c configs/mot/fairmot/fairmot_dla34_30e_1088x608.yml -o weights=https://paddledet.bj.bcebos.com/models/mot/fairmot_dla34_30e_1088x608.pdparams# å¯¼å‡ºByteTrackå¤šç›®æ ‡è·Ÿè¸ªæ¨¡å‹(ç›¸å½“äºåªå¯¼å‡ºæ£€æµ‹å™¨)python tools/export_model.py -c configs/mot/bytetrack/detector/ppyoloe_crn_l_36e_640x640_mot17half.yml -o weights=https://paddledet.bj.bcebos.com/models/mot/ppyoloe_crn_l_36e_640x640_mot17half.pdparams é¢„æµ‹ ä¿®æ”¹deploy/python/infer.pyå¯åŠ¨è„šæœ¬ 12345678910111213141516171819if __name__ == '__main__': paddle.enable_static() parser = argsparser() FLAGS = parser.parse_args() FLAGS.device = 'gpu' FLAGS.video_file = '/exp/work/video/PaddleDetection/demo_input/t2.mp4' FLAGS.output_dir = '/exp/work/video/PaddleDetection/demo_output/' FLAGS.model_dir = '/exp/work/video/PaddleDetection/inference_model/yolov3_darknet53_270e_coco' print_arguments(FLAGS) FLAGS.device = FLAGS.device.upper() assert FLAGS.device in ['CPU', 'GPU', 'XPU', 'NPU' ], \"device should be CPU, GPU, XPU or NPU\" assert not FLAGS.use_gpu, \"use_gpu has been deprecated, please use --device\" assert not ( FLAGS.enable_mkldnn == False and FLAGS.enable_mkldnn_bfloat16 == True ), 'To enable mkldnn bfloat, please turn on both enable_mkldnn and enable_mkldnn_bfloat16' main() pp-humanè¡Œäººæ£€æµ‹æ¨¡å—ï¼Œå¯¹åº”é…ç½®æ–‡ä»¶ä½ç½®ï¼šdeploy/pipeline/config/examples/infer_cfg_pphuman.yml é€šè¿‡å‘½ä»¤å¯åŠ¨æ£€æµ‹è„šæœ¬ 1python deploy/pipeline/pipeline.py --config deploy/pipeline/config/examples/infer_cfg_human_attr.yml --device=gpu --video_file=demo_input/t1.mp4 --output_dir=demo_output/ pp-vehicleè½¦è¾†æ£€æµ‹æ¨¡å—ï¼Œå¯¹åº”é…ç½®æ–‡ä»¶ä½ç½®ï¼šdeploy/pipeline/config/examples/infer_cfg_ppvehicle.yml é€šè¿‡å‘½ä»¤å¯åŠ¨æ£€æµ‹è„šæœ¬ 1python deploy/pipeline/pipeline.py --config deploy/pipeline/config/infer_cfg_ppvehicle.yml --video_file=demo_input/car.mp4 --device=gpu --output_dir=demo_output","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://yoursite.com/categories/æ·±åº¦å­¦ä¹ /"}],"tags":[{"name":"paddlepaddle","slug":"paddlepaddle","permalink":"http://yoursite.com/tags/paddlepaddle/"},{"name":"opencv","slug":"opencv","permalink":"http://yoursite.com/tags/opencv/"}]},{"title":"æ­å»ºnebula-CentOSé›†ç¾¤ï¼ˆæé€Ÿç‰ˆï¼‰","slug":"æ­å»ºnebula-CentOSé›†ç¾¤ï¼ˆæé€Ÿç‰ˆï¼‰","date":"2023-07-10T01:05:06.000Z","updated":"2023-08-10T01:38:30.425Z","comments":true,"path":"2023/07/10/æ­å»ºnebula-CentOSé›†ç¾¤ï¼ˆæé€Ÿç‰ˆï¼‰/","link":"","permalink":"http://yoursite.com/2023/07/10/æ­å»ºnebula-CentOSé›†ç¾¤ï¼ˆæé€Ÿç‰ˆï¼‰/","excerpt":"ç¯å¢ƒå‡†å¤‡ ç³»ç»Ÿ CentOS7.9 æœºå™¨ ä¸‰å°ï¼Œåˆ†åˆ«ä¸ºnebula01ã€nebula02ã€nebula03ã€ å®‰è£…ä½ç½® /usr/local nebulaç‰ˆæœ¬ 2.6.1 nebula-graph-studioç‰ˆæœ¬ 3.2.3 å¿«é€Ÿå¼€å§‹ ä¸‹è½½tar.gzæ–‡ä»¶ 123cd /usr/localwget https://oss-cdn.nebula-graph.com.cn/package/2.6.1/nebula-graph-2.6.1.el7.x86_64.tar.gzwget https://oss-cdn.nebula-graph.com.cn/nebula-graph-studio/3.2.3/nebula-graph-studio-3.2.3.x86_64.tar.gz è§£å‹ç¼©å¹¶é‡å‘½åæ–‡ä»¶ 12tar -zxvf nebula-graph-2.6.1.el7.x86_64.tar.gz &amp;&amp; mv nebula-graph-2.6.1.el7.x86_64 nebulatar -zxvf nebula-graph-studio-3.2.3.x86_64.tar.gz &amp;&amp; mv nebula-graph-studio-3.2.3.x86_64 nebula-graph-studio å¤åˆ¶é…ç½®æ–‡ä»¶ 1234cd nebula/etccp nebula-graphd.conf.default nebula-graphd.confcp nebula-metad.conf.default nebula-metad.confcp nebula-storaged.conf.default nebula-storaged.conf","text":"ç¯å¢ƒå‡†å¤‡ ç³»ç»Ÿ CentOS7.9 æœºå™¨ ä¸‰å°ï¼Œåˆ†åˆ«ä¸ºnebula01ã€nebula02ã€nebula03ã€ å®‰è£…ä½ç½® /usr/local nebulaç‰ˆæœ¬ 2.6.1 nebula-graph-studioç‰ˆæœ¬ 3.2.3 å¿«é€Ÿå¼€å§‹ ä¸‹è½½tar.gzæ–‡ä»¶ 123cd /usr/localwget https://oss-cdn.nebula-graph.com.cn/package/2.6.1/nebula-graph-2.6.1.el7.x86_64.tar.gzwget https://oss-cdn.nebula-graph.com.cn/nebula-graph-studio/3.2.3/nebula-graph-studio-3.2.3.x86_64.tar.gz è§£å‹ç¼©å¹¶é‡å‘½åæ–‡ä»¶ 12tar -zxvf nebula-graph-2.6.1.el7.x86_64.tar.gz &amp;&amp; mv nebula-graph-2.6.1.el7.x86_64 nebulatar -zxvf nebula-graph-studio-3.2.3.x86_64.tar.gz &amp;&amp; mv nebula-graph-studio-3.2.3.x86_64 nebula-graph-studio å¤åˆ¶é…ç½®æ–‡ä»¶ 1234cd nebula/etccp nebula-graphd.conf.default nebula-graphd.confcp nebula-metad.conf.default nebula-metad.confcp nebula-storaged.conf.default nebula-storaged.conf ä¿®æ”¹é…ç½®æ–‡ä»¶ 1vim nebula-graphd.conf 1234567891011...# The directory to host logging files--log_dir=/data/nebula/logs...# Comma separated Meta Server Addresses--meta_server_addrs=nebula01:9559,nebula02:9559,nebula03:9559# Local IP used to identify the nebula-graphd process.# Change it to an address other than loopback if the service is distributed or# will be accessed remotely.--local_ip=nebula01... 1vim nebula-metad.conf 1234567891011121314...# The directory to host logging files--log_dir=/data/nebula/logs...# Comma separated Meta Server addresses--meta_server_addrs=nebula01:9559,nebula02:9559,nebula03:9559# Local IP used to identify the nebula-metad process.# Change it to an address other than loopback if the service is distributed or# will be accessed remotely.--local_ip=nebula01...# Root data path, here should be only single path for metad--data_path=/data/nebula/meta... 1vim nebula-storaged.conf 123456789101112131415...# The directory to host logging files--log_dir=/data/nebula/logs...# Comma separated Meta server addresses--meta_server_addrs=nebula01:9559,nebula02:9559,nebula03:9559# Local IP used to identify the nebula-storaged process.# Change it to an address other than loopback if the service is distributed or# will be accessed remotely.--local_ip=nebula01...# Root data path. Split by comma. e.g. --data_path=/disk1/path1/,/disk2/path2/# One path per Rocksdb instance.--data_path=/data/nebula/storage... åˆ†å‘nebulaæ–‡ä»¶ï¼Œå¹¶ä¿®æ”¹å¯¹åº”çš„--local_ip 123cd ../..scp -r nebula nebula02:`pwd`/scp -r nebula nebula03:`pwd`/ å¯åŠ¨é›†ç¾¤ æ³¨ï¼šå› ä¸ºmetaæœºå™¨é€‰æ‹©äº†nebula01ã€02ã€03å…±ä¸‰å°æœºå™¨ï¼Œå¯åŠ¨æ—¶éœ€è¦å°†ä¸‰å°åŒæ—¶æ‰§è¡Œå‘½ä»¤æ‹‰èµ· 1nebula/scripts/nebula.service start all æ£€æŸ¥é›†ç¾¤çŠ¶æ€ 1nebula/scripts/nebula.service status all 123[INFO] nebula-metad(de03025): Running as 24680, Listening on 9559 [INFO] nebula-graphd(de03025): Running as 25453, Listening on 9669 [INFO] nebula-storaged(de03025): Running as 24787, Listening on 9779 æ­¤æ—¶nebulaæ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆcluster.idæ–‡ä»¶ï¼Œé›†ç¾¤æˆåŠŸå¯åŠ¨ å¯åŠ¨nebula-graph-studio 12cd nebula-graph-studionohup ./server &amp; æ³¨ï¼šåŒæ ·å¯ç”¨äºé›†ç¾¤æ•°æ®æ¢å¤ï¼ˆ/dataä¸‹çš„æ•°æ®å·²å¤‡ä»½ï¼‰","categories":[{"name":"BigData","slug":"BigData","permalink":"http://yoursite.com/categories/BigData/"}],"tags":[{"name":"database","slug":"database","permalink":"http://yoursite.com/tags/database/"},{"name":"nebua","slug":"nebua","permalink":"http://yoursite.com/tags/nebua/"}]},{"title":"Nebula-Sparkå’Œå›¾ç®—æ³•","slug":"Nebula-Spark","date":"2023-03-24T06:34:47.000Z","updated":"2024-01-08T07:52:12.236Z","comments":true,"path":"2023/03/24/Nebula-Spark/","link":"","permalink":"http://yoursite.com/2023/03/24/Nebula-Spark/","excerpt":"Nebula Spark Connectorä¸‹è½½åœ°å€&amp;å®˜æ–¹æ–‡æ¡£ï¼šã€https://github.com/vesoft-inc/nebula-spark-connectorã€‘ ç¯å¢ƒÂ· nebulaï¼š2.6.1Â· hadoopï¼š2.7Â· sparkï¼š2.4.7Â· pysparkï¼š2.4.7Â· pythonï¼š3.7.16Â· nebula-spark-connectorï¼š2.6.1 ç¼–è¯‘æ‰“åŒ…nebula-spark-connector12$ cd nebula-spark-connector-2.6.1/nebula-spark-connector$ mvn clean package -Dmaven.test.skip=true -Dgpg.skip -Dmaven.javadoc.skip=true æˆåŠŸååœ¨nebula-spark-connector/target/ ç›®å½•ä¸‹å¾—åˆ° nebula-spark-connector-2.6.1.jaræ–‡ä»¶ 123456789101112(base) [root@root target]# lltotal 106792drwxr-xr-x 3 root root 17 Mar 11 14:14 classes-rw-r--r-- 1 root root 1 Mar 11 14:14 classes.-497386701.timestamp-rw-r--r-- 1 root root 1 Mar 11 14:14 classes.timestamp-rw-r--r-- 1 root root 30701 Mar 11 14:15 jacoco.execdrwxr-xr-x 2 root root 28 Mar 11 14:15 maven-archiver-rw-r--r-- 1 root root 108375457 Mar 11 14:16 nebula-spark-connector-2.6.1.jar-rw-r--r-- 1 root root 583482 Mar 11 14:16 nebula-spark-connector-2.6.1-javadoc.jar-rw-r--r-- 1 root root 36358 Mar 11 14:16 nebula-spark-connector-2.6.1-sources.jar-rw-r--r-- 1 root root 315392 Mar 11 14:15 original-nebula-spark-connector-2.6.1.jardrwxr-xr-x 4 root root 37 Mar 11 14:15 site PySpark è¯»å– NebulaGraph æ•°æ®ä» metaAddress ä¸º &quot;metad0:9559&quot; çš„ Nebula Graph ä¸­è¯»å–æ•´ä¸ª tag ä¸‹çš„æ•°æ®ä¸ºä¸€ä¸ª dataframeï¼š 12345678df = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"basketballplayer\").option( \"label\", \"player\").option( \"returnCols\", \"name,age\").option( \"metaAddress\", \"metad0:9559\").option( \"partitionNumber\", 1).load() ç„¶åå¯ä»¥åƒè¿™æ · show è¿™ä¸ª dataframeï¼š 12345678&gt;&gt;&gt; df.show(n=2)+---------+--------------+---+|_vertexId| name|age|+---------+--------------+---+|player105| Danny Green| 31||player109|Tiago Splitter| 34|+---------+--------------+---+only showing top 2 rows","text":"Nebula Spark Connectorä¸‹è½½åœ°å€&amp;å®˜æ–¹æ–‡æ¡£ï¼šã€https://github.com/vesoft-inc/nebula-spark-connectorã€‘ ç¯å¢ƒÂ· nebulaï¼š2.6.1Â· hadoopï¼š2.7Â· sparkï¼š2.4.7Â· pysparkï¼š2.4.7Â· pythonï¼š3.7.16Â· nebula-spark-connectorï¼š2.6.1 ç¼–è¯‘æ‰“åŒ…nebula-spark-connector12$ cd nebula-spark-connector-2.6.1/nebula-spark-connector$ mvn clean package -Dmaven.test.skip=true -Dgpg.skip -Dmaven.javadoc.skip=true æˆåŠŸååœ¨nebula-spark-connector/target/ ç›®å½•ä¸‹å¾—åˆ° nebula-spark-connector-2.6.1.jaræ–‡ä»¶ 123456789101112(base) [root@root target]# lltotal 106792drwxr-xr-x 3 root root 17 Mar 11 14:14 classes-rw-r--r-- 1 root root 1 Mar 11 14:14 classes.-497386701.timestamp-rw-r--r-- 1 root root 1 Mar 11 14:14 classes.timestamp-rw-r--r-- 1 root root 30701 Mar 11 14:15 jacoco.execdrwxr-xr-x 2 root root 28 Mar 11 14:15 maven-archiver-rw-r--r-- 1 root root 108375457 Mar 11 14:16 nebula-spark-connector-2.6.1.jar-rw-r--r-- 1 root root 583482 Mar 11 14:16 nebula-spark-connector-2.6.1-javadoc.jar-rw-r--r-- 1 root root 36358 Mar 11 14:16 nebula-spark-connector-2.6.1-sources.jar-rw-r--r-- 1 root root 315392 Mar 11 14:15 original-nebula-spark-connector-2.6.1.jardrwxr-xr-x 4 root root 37 Mar 11 14:15 site PySpark è¯»å– NebulaGraph æ•°æ®ä» metaAddress ä¸º &quot;metad0:9559&quot; çš„ Nebula Graph ä¸­è¯»å–æ•´ä¸ª tag ä¸‹çš„æ•°æ®ä¸ºä¸€ä¸ª dataframeï¼š 12345678df = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"basketballplayer\").option( \"label\", \"player\").option( \"returnCols\", \"name,age\").option( \"metaAddress\", \"metad0:9559\").option( \"partitionNumber\", 1).load() ç„¶åå¯ä»¥åƒè¿™æ · show è¿™ä¸ª dataframeï¼š 12345678&gt;&gt;&gt; df.show(n=2)+---------+--------------+---+|_vertexId| name|age|+---------+--------------+---+|player105| Danny Green| 31||player109|Tiago Splitter| 34|+---------+--------------+---+only showing top 2 rows PySpark å†™ NebulaGraph æ•°æ®é»˜è®¤ä¸æŒ‡å®šçš„æƒ…å†µä¸‹ writeMode æ˜¯ insertï¼š å†™å…¥ç‚¹1234567891011df.write.format(\"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"basketballplayer\").option( \"label\", \"player\").option( \"vidPolicy\", \"\").option( \"vertexField\", \"_vertexId\").option( \"batch\", 1).option( \"metaAddress\", \"metad0:9559\").option( \"graphAddress\", \"graphd1:9669\").option( \"passwd\", \"nebula\").option( \"user\", \"root\").save() åˆ é™¤ç‚¹å¦‚æœæƒ³æŒ‡å®š delete æˆ–è€… update çš„éé»˜è®¤å†™å…¥æ¨¡å¼ï¼Œå¢åŠ  writeMode çš„é…ç½®ï¼Œæ¯”å¦‚ delete çš„ä¾‹å­ï¼š 123456789101112df.write.format(\"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"basketballplayer\").option( \"label\", \"player\").option( \"vidPolicy\", \"\").option( \"vertexField\", \"_vertexId\").option( \"batch\", 1).option( \"metaAddress\", \"metad0:9559\").option( \"graphAddress\", \"graphd1:9669\").option( \"passwd\", \"nebula\").option( \"writeMode\", \"delete\").option( \"user\", \"root\").save() å†™å…¥è¾¹12345678910111213141516df.write.format(\"com.vesoft.nebula.connector.NebulaDataSource\")\\ .mode(\"overwrite\")\\ .option(\"srcPolicy\", \"\")\\ .option(\"dstPolicy\", \"\")\\ .option(\"metaAddress\", \"metad0:9559\")\\ .option(\"graphAddress\", \"graphd:9669\")\\ .option(\"user\", \"root\")\\ .option(\"passwd\", \"nebula\")\\ .option(\"type\", \"edge\")\\ .option(\"spaceName\", \"basketballplayer\")\\ .option(\"label\", \"server\")\\ .option(\"srcVertexField\", \"srcid\")\\ .option(\"dstVertexField\", \"dstid\")\\ .option(\"rankField\", \"\")\\ .option(\"batch\", 100)\\ .option(\"writeMode\", \"insert\").save() # delete to delete edge, update to update edge åˆ é™¤è¾¹12345678910111213141516df.write.format(\"com.vesoft.nebula.connector.NebulaDataSource\")\\ .mode(\"overwrite\")\\ .option(\"srcPolicy\", \"\")\\ .option(\"dstPolicy\", \"\")\\ .option(\"metaAddress\", \"metad0:9559\")\\ .option(\"graphAddress\", \"graphd:9669\")\\ .option(\"user\", \"root\")\\ .option(\"passwd\", \"nebula\")\\ .option(\"type\", \"edge\")\\ .option(\"spaceName\", \"basketballplayer\")\\ .option(\"label\", \"server\")\\ .option(\"srcVertexField\", \"srcid\")\\ .option(\"dstVertexField\", \"dstid\")\\ .option(\"randkField\", \"\")\\ .option(\"batch\", 100)\\ .option(\"writeMode\", \"delete\").save() # delete to delete edge, update to update edge å…³äº PySpark è¯»å†™çš„ optionå¯¹äºå…¶ä»–çš„ optionï¼Œæ¯”å¦‚åˆ é™¤ç‚¹çš„æ—¶å€™çš„ withDeleteEdge å¯ä»¥å‚è€ƒ [nebula/connector/NebulaOptions.scala ](https://github.com/vesoft-inc/nebula-spark-connector/blob/master/nebula-spark-connector/src/main/scala/com/vesoft/nebula/connector/NebulaOptions.scala) çš„å­—ç¬¦ä¸²é…ç½®å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒçš„å­—ç¬¦ä¸²å®šä¹‰å­—æ®µæ˜¯ deleteEdge ï¼š 12345678910111213141516/** write config */val RATE_LIMIT: String = \"rateLimit\"val VID_POLICY: String = \"vidPolicy\"val SRC_POLICY: String = \"srcPolicy\"val DST_POLICY: String = \"dstPolicy\"val VERTEX_FIELD = \"vertexField\"val SRC_VERTEX_FIELD = \"srcVertexField\"val DST_VERTEX_FIELD = \"dstVertexField\"val RANK_FIELD = \"randkField\"val BATCH: String = \"batch\"val VID_AS_PROP: String = \"vidAsProp\"val SRC_AS_PROP: String = \"srcAsProp\"val DST_AS_PROP: String = \"dstAsProp\"val RANK_AS_PROP: String = \"rankAsProp\"val WRITE_MODE: String = \"writeMode\"val DELETE_EDGE: String = \"deleteEdge\" PySpark è°ƒç”¨ Nebula Spark ConnectorPycharm12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061# å¯¼å…¥SparkSessionã€findsparkè‡ªåŠ¨è·å–$&#123;SPARK_HOME&#125;ï¼Œå®šä¹‰è™šæ‹Ÿç¯å¢ƒimport osimport findsparkfrom pyspark.sql import SparkSessionos.environ[\"HADOOP_CONF_DIR\"] = \"/exp/server/hadoop-2.7.7/etc/hadoop\"os.environ[\"YARN_CONF_DIR\"] = \"/exp/server/hadoop-2.7.7/etc/hadoop\"os.environ[\"SPARK_HOME\"] = \"/exp/server/spark-2.4.7-bin-hadoop2.7\"os.environ[\"PYSPARK_PYTHON\"] = \"/root/anaconda3/envs/pyspark38/bin/python\"os.environ[\"PYSPARK_DRIVER_PYTHON\"] = \"/root/anaconda3/envs/pyspark38/bin/python\"findspark.init()# æ„å»ºSparkSessionå¯¹è±¡ï¼Œå¯¼å…¥targetä¸‹çš„jaråŒ…spark = SparkSession.builder.config( \"spark.jars\", \"/exp/work/pyspark/nebula-spark-connector/nebula-spark-connector/target/nebula-spark-connector-2.6.1.jar\").config( \"spark.driver.extraClassPath\", \"/exp/work/pyspark/nebula-spark-connector/nebula-spark-connector/target/nebula-spark-connector-2.6.1.jar\").appName( \"nebula-connector\").getOrCreate()# è¯»å–nebula-graphæ•°æ®# read vertexdf_tag = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"sep\", \"\\t\").option( \"type\", \"vertex\").option( \"spaceName\", \"space\").option( \"label\", \"tag\").option( \"returnCols\", \"\").option( \"metaAddress\", \"metahost:9559\").option( \"partitionNumber\", 1).load()# read edgedf_edge = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"sep\", \"\\t\").option( \"type\", \"edge\").option( \"spaceName\", \"space\").option( \"label\", \"edge\").option( \"returnCols\", \"\").option( \"metaAddress\", \"metahost:9559\").option( \"partitionNumber\", 1).load()# å†™å›nebula-graph# write vertexdf_tag.write.format(\"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", \"space\").option( \"label\", \"tag\").option( \"vidPolicy\", \"\").option( \"vertexField\", \"_vertexId\").option( \"batch\", 1).option( \"metaAddress\", \"metahost:9559\").option( \"graphAddress\", \"graphhost:9669\").option( \"passwd\", \"nebula\").option( \"writeMode\", \"update\").option( \"user\", \"root\").save()df_tag.show()df_edge.show() Spark-submit1234$&#123;SPARK_HOME&#125;/bin/spark-submit --master local[*] \\--deploy-mode client \\--jars file:/exp/work/pyspark/nebula-spark-connector/nebula-spark-connector/target/nebula-spark-connector-2.6.1.jar \\/exp/work/pyspark/nebula/nebula_reader.py NebulaAlgorithmä¸‹è½½åœ°å€&amp;å®˜æ–¹æ–‡æ¡£ï¼šã€&lt;https://github.com/vesoft-inc/nebula-algorithmã€‘ ç¯å¢ƒÂ· nebulaï¼š2.6.1Â· hadoopï¼š2.7Â· sparkï¼š2.4.7Â· pysparkï¼š2.4.7Â· pythonï¼š3.7.16Â· nebula-spark-connectorï¼š2.6.1Â· nebula-algorithmï¼š2.6.1 ç¼–è¯‘æ‰“åŒ…nebula-spark-connector12$ cd nebula-algorithm-2.6.1/nebula-algorithm$ mvn clean package -Dgpg.skip -Dmaven.javadoc.skip=true -Dmaven.test.skip=true æˆåŠŸååœ¨nebula-algorithm/target/ ç›®å½•ä¸‹å¾—åˆ° nebula-algorithm-2.6.1.jaræ–‡ä»¶ PySpark è°ƒç”¨ Nebula AlgorithmPycharm123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115import osimport findsparkfrom pyspark.sql import SparkSession, DataFramefrom pyspark.sql.functions import *from pyspark.sql.window import Windowfrom py4j.java_gateway import java_importos.environ[\"HADOOP_CONF_DIR\"] = \"/exp/server/hadoop-2.7.7/etc/hadoop\"os.environ[\"YARN_CONF_DIR\"] = \"/exp/server/hadoop-2.7.7/etc/hadoop\"os.environ[\"SPARK_HOME\"] = \"/exp/server/spark-2.4.7-bin-hadoop2.7\"os.environ[\"PYSPARK_PYTHON\"] = \"/root/anaconda3/envs/pyspark37/bin/python\"os.environ[\"PYSPARK_DRIVER_PYTHON\"] = \"/root/anaconda3/envs/pyspark37/bin/python\"findspark.init()spark = SparkSession.builder.config( \"spark.jars\", \"/exp/work/pyspark/nebula-spark-connector/nebula-spark-connector/target/nebula-spark-connector-2.6.1.jar\").config( \"spark.driver.extraClassPath\", \"/exp/work/pyspark/nebula-spark-connector/nebula-spark-connector/target/nebula-spark-connector-2.6.1.jar\").config( \"spark.jars\", \"/exp/work/pyspark/nebula-algorithm/nebula-algorithm/target/nebula-algorithm-2.6.1.jar\").config( \"spark.driver.extraClassPath\", \"/exp/work/pyspark/nebula-algorithm/nebula-algorithm/target/nebula-algorithm-2.6.1.jar\").appName( \"nebula-connector\").getOrCreate()# spark = SparkSession.builder.appName(\"PageRankExample\").getOrCreate()jspark = spark._jsparkSession# import \"com.vesoft.nebula.algorithm.config.SparkConfig\"java_import(spark._jvm, \"com.vesoft.nebula.algorithm.config.SparkConfig\")# import \"com.vesoft.nebula.algorithm.config.PRConfig\"java_import(spark._jvm, \"com.vesoft.nebula.algorithm.config.PRConfig\")# import \"com.vesoft.nebula.algorithm.lib.PageRankAlgo\"java_import(spark._jvm, \"com.vesoft.nebula.algorithm.lib.PageRankAlgo\")# å°†stringç±»å‹vidè½¬intç±»å‹viddef convert_string_id_to_long_id(df): df = df.drop(\"display_desc\").drop(\"creation_time\") src_id_df = df.select(\"_srcId\").withColumnRenamed(\"_srcId\", \"id\") dst_id_df = df.select(\"_dstId\").withColumnRenamed(\"_dstId\", \"id\") id_df = src_id_df.union(dst_id_df).distinct() encode_id = id_df.withColumn(\"encodedId\", dense_rank().over(Window.orderBy(\"id\"))) # encode_id.write.option(\"header\", True).csv(\"file:///tmp/encodeId.csv\") src_join_df = df.join(encode_id, df._srcId == encode_id.id) \\ .drop(\"_srcId\") \\ .drop(\"id\") \\ .withColumnRenamed(\"encodedId\", \"_srcId\") df_sv = df.join(encode_id, df._srcId == encode_id.id) \\ .drop(\"_srcId\") \\ .drop(\"_rank\") \\ .drop(\"_dstId\") \\ .withColumnRenamed(\"id\", \"src_vid\") \\ .withColumnRenamed(\"encodedId\", \"_srcId\") df_dv = src_join_df.join(encode_id, src_join_df._dstId == encode_id.id) \\ .drop(\"_dstId\") \\ .drop(\"_rank\") \\ .drop(\"degree\") \\ .withColumnRenamed(\"encodedId\", \"_dstId\") \\ .withColumnRenamed(\"_srcID\", \"_src\") \\ .withColumnRenamed(\"id\", \"dst_vid\") dst_join_df = src_join_df.join(encode_id, src_join_df._dstId == encode_id.id) \\ .drop(\"_dstId\") \\ .drop(\"_rank\") \\ .drop(\"degree\") \\ .withColumnRenamed(\"encodedId\", \"_dstId\").drop(\"id\") df_v = df_dv.join(df_sv, df_dv._src == df_sv._srcId).drop(\"_src\") return dst_join_df, df_vdf = spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( # \"sep\", \"\\t\").option( \"type\", \"edge\").option( \"spaceName\", \"DWD_GRAPH_LY_V3_2023\").option( \"label\", \"edge_phone\").option( \"returnCols\", \"\").option( \"metaAddress\", \"192.168.100.45:9559\").option( \"partitionNumber\", 1).load()df.orderBy(\"creation_time\").show()df_int, df_v = convert_string_id_to_long_id(df)prConfig = spark._jvm.PRConfig(1, 0.8)prResult = spark._jvm.PageRankAlgo.apply(jspark, df_int._jdf, prConfig, False)df_v.show(20, False)prResult.show(20, False)# å°†jdfè½¬dfprResult = prResult.toDF()pagerank_df = DataFrame(prResult, spark)pagerank_df.sort(col(\"pagerank\").desc()).show(60, False)# TODO: PYSPARK (pyspark=2.4.7, python=3.7)# conda activate pyspark37# TODO: SPARK-SUBMIT# $&#123;SPARK_HOME&#125;/bin/spark-submit --master local[*] \\# --deploy-mode client \\# --driver-class-path file:/exp/work/pyspark/nebula-spark-connector/nebula-spark-connector/target/nebula-spark-connector-2.6.1.jar \\# --driver-class-path file:/exp/work/pyspark/nebula-algorithm/nebula-algorithm/target/nebula-algorithm-2.6.1.jar \\# --jars file:/exp/work/pyspark/nebula-spark-connector/nebula-spark-connector/target/nebula-spark-connector-2.6.1.jar \\# --jars file:/exp/work/pyspark/nebula-algorithm/nebula-algorithm/target/nebula-algorithm-2.6.1.jar \\# /exp/work/pyspark/nebula/pagerank.py Spark-submit1234567$&#123;SPARK_HOME&#125;/bin/spark-submit --master local[*] \\--deploy-mode client \\--driver-class-path file:/exp/work/pyspark/nebula-spark-connector/nebula-spark-connector/target/nebula-spark-connector-2.6.1.jar \\--driver-class-path file:/exp/work/pyspark/nebula-algorithm/nebula-algorithm/target/nebula-algorithm-2.6.1.jar \\--jars file:/exp/work/pyspark/nebula-spark-connector/nebula-spark-connector/target/nebula-spark-connector-2.6.1.jar \\--jars file:/exp/work/pyspark/nebula-algorithm/nebula-algorithm/target/nebula-algorithm-2.6.1.jar \\/exp/work/pyspark/nebula/pagerank.py Result123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158ssh://root@192.168.100.43:22/root/anaconda3/envs/pyspark37/bin/python -u /exp/work/pyspark/nebula/pagerank.pySLF4J: Class path contains multiple SLF4J bindings.SLF4J: Found binding in [jar:file:/exp/work/pyspark/nebula-algorithm/nebula-algorithm/target/nebula-algorithm-2.6.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]SLF4J: Found binding in [jar:file:/exp/server/spark-2.4.7-bin-hadoop2.7/jars/slf4j-log4j12-1.7.16.jar!/org/slf4j/impl/StaticLoggerBinder.class]SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]23/03/24 14:42:29 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicableSetting default log level to &quot;WARN&quot;.To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).+--------------------+--------------------+-----+-------------+------------+| _srcId| _dstId|_rank|creation_time|display_desc|+--------------------+--------------------+-----+-------------+------------+|dwd_accounttelegr...|dwd_phone66802018560| 0| 1678692201| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone12366827389| 0| 1678692201| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone86151162...| 0| 1678692201| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone79653470394| 0| 1678692210| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone99890918...| 0| 1678692210| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone99890535...| 0| 1678692210| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone85620578...| 0| 1678692210| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone99899666...| 0| 1678692210| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone88802607465| 0| 1678692219| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone62831556...| 0| 1678692228| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone95965067...| 0| 1678692228| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone85595212324| 0| 1678692228| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone86132873...| 0| 1678692279| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone63948774...| 0| 1678692279| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone85590645678| 0| 1678692279| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone63948229...| 0| 1678692288| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone99899913...| 0| 1678692288| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone99890302...| 0| 1678692288| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone99890986...| 0| 1678692288| æ³¨å†Œæ‰‹æœºå·||dwd_accounttelegr...|dwd_phone16728042478| 0| 1678692297| æ³¨å†Œæ‰‹æœºå·|+--------------------+--------------------+-----+-------------+------------+only showing top 20 rows23/03/24 14:42:39 WARN window.WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.23/03/24 14:42:39 WARN window.WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.[Stage 3:&gt; (0 + 1) / 1][Stage 4:&gt; (0 + 1) / 1]23/03/24 14:42:49 WARN storage.BlockManager: Block rdd_29_0 already exists on this machine; not re-adding it23/03/24 14:42:50 WARN window.WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.23/03/24 14:42:50 WARN window.WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.23/03/24 14:42:50 WARN window.WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.+----------------------+------+---------------------------------+------+|dst_vid |_dstId|src_vid |_srcId|+----------------------+------+---------------------------------+------+|dwd_phone8613951884225|18141 |dwd_accountctrip1187326021 |1 ||dwd_phone8618705166775|19486 |dwd_accountctrip18705166775 |2 ||dwd_phone8613006584273|17582 |dwd_accountctripM2295153681 |3 ||dwd_phone8615668271999|18526 |dwd_accountctripM2494074526 |4 ||dwd_phone8616653556969|18757 |dwd_accountctripM2682271769 |5 ||dwd_phone8613562835888|17938 |dwd_accountctripM3011519721 |6 ||dwd_phone8618506413343|19344 |dwd_accountctripM4761127290 |7 ||dwd_phone8618112957512|19178 |dwd_accountctripM4915141465 |8 ||dwd_phone8615119464037|18222 |dwd_accountctripM548327259 |9 ||dwd_phone8613123368388|17719 |dwd_accountctripM601536478 |10 ||dwd_phone8617605442050|18905 |dwd_accountctrip_WeChat2269232661|11 ||dwd_phone8613123368388|17719 |dwd_accountdidi101108284 |12 ||dwd_phone8616653556969|18757 |dwd_accountdidi1641492054156 |13 ||dwd_phone8615851895366|18609 |dwd_accountdidi1746082933402 |14 ||dwd_phone8617561929739|18889 |dwd_accountdidi17598416475664 |15 ||dwd_phone8615119464037|18222 |dwd_accountdidi25441524 |16 ||dwd_phone8613006584273|17582 |dwd_accountdidi2881218873540 |17 ||dwd_phone8613951884225|18141 |dwd_accountdidi3099925 |18 ||dwd_phone8618600764544|19397 |dwd_accountdidi486186360832 |19 ||dwd_phone8618705166775|19486 |dwd_accountdidi772722 |20 |+----------------------+------+---------------------------------+------+only showing top 20 rows+-----+------------------+|_id |pagerank |+-----+------------------+|19021|1.1105466561585526||9831 |0.8884373249268421||5354 |0.8884373249268421||4926 |0.8884373249268421||21377|1.1105466561585526||14609|1.1105466561585526||11852|1.1105466561585526||8390 |0.8884373249268421||10837|0.8884373249268421||4992 |0.8884373249268421||20894|1.1105466561585526||21780|1.1105466561585526||1813 |0.8884373249268421||9025 |0.8884373249268421||14554|1.1105466561585526||1780 |0.8884373249268421||16132|1.1105466561585526||22467|1.1105466561585526||2117 |0.8884373249268421||16321|1.1105466561585526|+-----+------------------+only showing top 20 rows+-----+------------------+|_id |pagerank |+-----+------------------+|18222|3.331639968475657 ||19178|2.8874213060122367||19486|2.8874213060122367||12765|1.9989839810853947||13332|1.9989839810853947||13505|1.9989839810853947||17582|1.9989839810853947||18889|1.776874649853684 ||19176|1.776874649853684 ||12470|1.776874649853684 ||19397|1.5547653186219736||18141|1.5547653186219736||11750|1.5547653186219736||18555|1.5547653186219736||13216|1.5547653186219736||18905|1.5547653186219736||17688|1.5547653186219736||19734|1.5547653186219736||12768|1.5547653186219736||18609|1.5547653186219736||18347|1.332655987390263 ||19473|1.332655987390263 ||12007|1.332655987390263 ||12100|1.332655987390263 ||16268|1.332655987390263 ||19298|1.332655987390263 ||23258|1.332655987390263 ||17938|1.332655987390263 ||20042|1.332655987390263 ||12639|1.332655987390263 ||13309|1.332655987390263 ||12739|1.332655987390263 ||18037|1.332655987390263 ||18757|1.332655987390263 ||18344|1.332655987390263 ||12461|1.332655987390263 ||20037|1.332655987390263 ||13754|1.332655987390263 ||18864|1.332655987390263 ||21713|1.332655987390263 ||16872|1.332655987390263 ||15710|1.332655987390263 ||12229|1.332655987390263 ||19183|1.332655987390263 ||17928|1.332655987390263 ||19118|1.332655987390263 ||20243|1.332655987390263 ||12223|1.332655987390263 ||23219|1.332655987390263 ||12529|1.332655987390263 ||20865|1.332655987390263 ||16538|1.332655987390263 ||13253|1.332655987390263 ||13329|1.332655987390263 ||13198|1.332655987390263 ||17719|1.332655987390263 ||14661|1.1105466561585526||18584|1.1105466561585526||12532|1.1105466561585526||20466|1.1105466561585526|+-----+------------------+only showing top 60 rows å°è£…å¹¶å†™å›nebula-graphå®ä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185import osimport findsparkfrom pyspark.sql import SparkSession, DataFramefrom pyspark.sql.functions import *from pyspark.sql.window import Windowfrom py4j.java_gateway import java_importfrom config import nebula_config# TODO: environment variablesos.environ[\"HADOOP_CONF_DIR\"] = \"/exp/server/hadoop-2.7.7/etc/hadoop\"os.environ[\"YARN_CONF_DIR\"] = \"/exp/server/hadoop-2.7.7/etc/hadoop\"os.environ[\"SPARK_HOME\"] = \"/exp/server/spark-2.4.7-bin-hadoop2.7\"os.environ[\"PYSPARK_PYTHON\"] = \"/root/anaconda3/envs/pyspark37/bin/python\"os.environ[\"PYSPARK_DRIVER_PYTHON\"] = \"/root/anaconda3/envs/pyspark37/bin/python\"findspark.init()class PageRank: \"\"\" pagerank \"\"\" def __init__(self): self.df = None self.dfc = None self.tag = None self.id_df = None self.df_int = None self.encode_id = None self.src_id_df = None self.dst_id_df = None self.src_join_df = None self.dst_join_df = None # TODO: spark object with nebula-spark-connector &amp; nebula-algorithm self.spark = SparkSession.builder.appName( \"pagerank\")\\ .master( \"local[*]\")\\ .config( \"spark.jars\", \"/exp/work/pyspark/nebula-spark-connector/nebula-spark-connector/target/nebula-spark-connector-2.6.1.jar\")\\ .config( \"spark.driver.extraClassPath\", \"/exp/work/pyspark/nebula-spark-connector/nebula-spark-connector/target/nebula-spark-connector-2.6.1.jar\")\\ .config( \"spark.jars\", \"/exp/work/pyspark/nebula-algorithm/nebula-algorithm/target/nebula-algorithm-2.6.1.jar\")\\ .config( \"spark.driver.extraClassPath\", \"/exp/work/pyspark/nebula-algorithm/nebula-algorithm/target/nebula-algorithm-2.6.1.jar\")\\ .getOrCreate() # TODO: java import self.jspark = self.spark._jsparkSession # import \"com.vesoft.nebula.algorithm.config.SparkConfig\" java_import(self.spark._jvm, \"com.vesoft.nebula.algorithm.config.SparkConfig\") # import \"com.vesoft.nebula.algorithm.config.PRConfig\" java_import(self.spark._jvm, \"com.vesoft.nebula.algorithm.config.PRConfig\") # import \"com.vesoft.nebula.algorithm.lib.PageRankAlgo\" java_import(self.spark._jvm, \"com.vesoft.nebula.algorithm.lib.PageRankAlgo\") def set_tag(self, tag: list): self.tag = tag def exe(self): self.sdf_create() # TODO: covert fixed_string vid 2 long vid def convert(self, df): self.df = df.drop(\"creation_time\") self.src_id_df = self.df.select(\"_srcId\").withColumnRenamed(\"_srcId\", \"id\") self.dst_id_df = self.df.select(\"_dstId\").withColumnRenamed(\"_dstId\", \"id\") self.id_df = self.src_id_df.union(self.dst_id_df).distinct() self.encode_id = self.id_df.withColumn(\"encodedId\", dense_rank().over(Window.orderBy(\"id\"))) self.src_join_df = self.df.join(self.encode_id, self.df._srcId == self.encode_id.id) \\ .drop(\"_srcId\") \\ .drop(\"id\") \\ .withColumnRenamed(\"encodedId\", \"_srcId\") self.dst_join_df = self.src_join_df.join(self.encode_id, self.src_join_df._dstId == self.encode_id.id) \\ .drop(\"_dstId\") \\ .drop(\"_rank\") \\ .drop(\"degree\") \\ .withColumnRenamed(\"encodedId\", \"_dstId\").drop(\"id\") # self.dst_join_df.write.option(\"header\", True).csv(\"file:/exp/work/pyspark/nebula/pr_file/1.csv\") # TODO: sdf build by nebula_reader def sdf_create(self): for i in range(len(self.tag)): self.dfc = self.spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"edge\").option( \"spaceName\", nebula_config.get(\"space\")).option( \"label\", f\"&#123;self.tag[i]&#125;\").option( \"returnCols\", \"creation_time\").option( \"metaAddress\", nebula_config.get(\"metaAddress\")).option( \"partitionNumber\", nebula_config.get(\"partitionNumber\")).load() if i == 0: self.df = self.dfc else: self.df = self.df.unionByName(self.dfc) self.convert(self.df)# TODO: NEBULA-READERdef nebula_reader(sth, tag): dataframe = sth.spark.read.format( \"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", nebula_config.get(\"space\")).option( \"label\", f\"&#123;tag&#125;\").option( \"returnCols\", \"pagerank\").option( \"metaAddress\", nebula_config.get(\"metaAddress\")).option( \"partitionNumber\", nebula_config.get(\"partitionNumber\")).load().drop(\"pagerank\") return dataframe# TODO: UPDATE NEBULA-GRAPHdef nebula_writer(tag, dataframe): dataframe.write.format(\"com.vesoft.nebula.connector.NebulaDataSource\").option( \"type\", \"vertex\").option( \"spaceName\", nebula_config.get(\"space\")).option( \"label\", f\"&#123;tag&#125;\").option( \"vidPolicy\", \"\").option( \"vertexField\", \"_vertexId\").option( \"writeMode\", \"update\").option( \"batch\", nebula_config.get(\"batch\")).option( \"metaAddress\", nebula_config.get(\"metaAddress\")).option( \"graphAddress\", nebula_config.get(\"graphAddress\")).option( \"passwd\", nebula_config.get(\"passwd\")).option( \"user\", nebula_config.get(\"user\")).save()# TODO: process datadef process(tag: list, *args): # TODO: algorithm object obj = PageRank() obj.set_tag(tag) obj.exe() encode_id = obj.encode_id df_int = obj.dst_join_df df_spark = df_int # TODO: nebula-algorithm config = obj.spark._jvm.PRConfig(1, 0.8) result = obj.spark._jvm.PageRankAlgo.apply(obj.jspark, df_spark._jdf, config, False) # TODO: jdf to sdf result = result.toDF() algo_df = DataFrame(result, obj.spark) # TODO: long vid mapping fixed_string vid df = encode_id.join(algo_df, encode_id.encodedId == algo_df._id) \\ .drop(\"encodedId\") \\ .drop(\"_id\") \\ .withColumnRenamed(\"id\", \"_vertexId\") for arg in args: df_ = nebula_reader(obj, arg) df_ = df_.join(df, df_._vertexId == df._vertexId, \"leftsemi\") df__ = df.join(df_, df._vertexId == df_._vertexId, \"leftsemi\") nebula_writer(arg, df__)if __name__ == '__main__': process([\"edge_phone\"], \"dwd_phone\", \"dwd_account\")# TODO: PYSPARK (pyspark=2.4.7, python=3.7)# conda activate pyspark37# TODO: SPARK-SUBMIT# $&#123;SPARK_HOME&#125;/bin/spark-submit --master local[*] \\# --deploy-mode client \\# --driver-class-path file:/exp/work/pyspark/nebula-spark-connector/nebula-spark-connector/target/nebula-spark-connector-2.6.1.jar \\# --driver-class-path file:/exp/work/pyspark/nebula-algorithm/nebula-algorithm/target/nebula-algorithm-2.6.1.jar \\# --jars file:/exp/work/pyspark/nebula-spark-connector/nebula-spark-connector/target/nebula-spark-connector-2.6.1.jar \\# --jars file:/exp/work/pyspark/nebula-algorithm/nebula-algorithm/target/nebula-algorithm-2.6.1.jar \\# /exp/work/pyspark/nebula/pagerank.py fastapiæ¥å£å®ä¾‹`pythonimport os import findspark from pyspark.sql import SparkSessionfrom pyspark.sql import DataFramefrom pyspark.sql.functions import *from typing import Listfrom fastapi import FastAPI, Queryfrom fastapi.middleware.cors import CORSMiddlewarefrom pydantic import BaseModel from config import nebula_config, pagerank_dictfrom algorithm.pagerank import PageRankfrom algorithm.louvain import Louvain app_router = FastAPI(docs_url=None, redoc_url=None) CORSorigins = [ â€œ*â€] app_router.add_middleware( CORSMiddleware, allow_origins=origins, allow_credentials=True, allow_methods=[â€œâ€œ], allow_headers=[â€œâ€œ]) class NebulaAlgorithm(BaseModel): algo: str tag_list: List[str] algorithm_dict = { â€œpagerankâ€: PageRank(), â€œlouvainâ€: Louvain()} @app_router.post(â€œ/nebula/algoâ€)async def nebula_algorithm( args: NebulaAlgorithm): # TODO: algorithm object tags = [] for line in args.tag_list: for item in pagerank_dict.get(line): tags.append(item) algo = algorithm_dict.get(args.algo) obj = algo obj.set_tag(tags) obj.exe() # TODO: nebula-algorithm encode_id = obj.encode_id df_int = obj.dst_join_df if algo.__doc__.strip() == &apos;pagerank&apos;: if len(tags) == 1: df_spark = df_int else: df_pd = df_int.toPandas() values = df_pd.values.tolist() columns = df_pd.columns.tolist() df_spark = obj.spark.createDataFrame(values, columns) config = obj.spark._jvm.PRConfig(1, 0.8) result = obj.spark._jvm.PageRankAlgo.apply(obj.jspark, df_spark._jdf, config, False) elif algo.__doc__.strip() == &apos;louvain&apos;: if len(tags) == 1: df_spark = df_int else: df_pd = df_int.toPandas() values = df_pd.values.tolist() columns = df_pd.columns.tolist() df_spark = obj.spark.createDataFrame(values, columns) config = obj.spark._jvm.LouvainConfig(20, 10, 0.5) result = obj.spark._jvm.LouvainAlgo.apply(obj.jspark, df_spark._jdf, config, False) else: return # TODO: jdf to sdf result = result.toDF() algo_df = DataFrame(result, obj.spark) # TODO: long vid mapping fixed_string vid df = encode_id.join(algo_df, encode_id.encodedId == algo_df._id) \\ .drop(&quot;encodedId&quot;) \\ .drop(&quot;_id&quot;) \\ .withColumnRenamed(&quot;id&quot;, &quot;_vertexId&quot;) df.show() if name == â€œmainâ€œ: import uvicorn uvicorn.run(app=â€main:app_routerâ€, reload=True, host=â€™0.0.0.0â€™, port=7792) TODO: PYSPARK (pyspark=2.4.7, python=3.7)conda activate pyspark37TODO: SPARK-SUBMIT${SPARK_HOME}/bin/spark-submit â€“master local[*] \\â€“deploy-mode client \\â€“driver-class-path file:/exp/work/pyspark/nebula-spark-connector/nebula-spark-connector/target/nebula-spark-connector-2.6.1.jar \\â€“driver-class-path file:/exp/work/pyspark/nebula-algorithm/nebula-algorithm/target/nebula-algorithm-2.6.1.jar \\â€“jars file:/exp/work/pyspark/nebula-spark-connector/nebula-spark-connector/target/nebula-spark-connector-2.6.1.jar \\â€“jars file:/exp/work/pyspark/nebula-algorithm/nebula-algorithm/target/nebula-algorithm-2.6.1.jar \\/exp/work/pyspark/nebula/main.py","categories":[{"name":"BigData","slug":"BigData","permalink":"http://yoursite.com/categories/BigData/"}],"tags":[{"name":"nebula","slug":"nebula","permalink":"http://yoursite.com/tags/nebula/"},{"name":"spark","slug":"spark","permalink":"http://yoursite.com/tags/spark/"},{"name":"å›¾ç®—æ³•","slug":"å›¾ç®—æ³•","permalink":"http://yoursite.com/tags/å›¾ç®—æ³•/"}]},{"title":"ElasticSearchç¯å¢ƒæ­å»º","slug":"ElasticSearchç¯å¢ƒæ­å»º","date":"2023-02-16T03:16:07.000Z","updated":"2023-03-24T06:52:51.416Z","comments":true,"path":"2023/02/16/ElasticSearchç¯å¢ƒæ­å»º/","link":"","permalink":"http://yoursite.com/2023/02/16/ElasticSearchç¯å¢ƒæ­å»º/","excerpt":"* é…åˆnebulaå…¨æ–‡æ£€ç´¢æµ‹è¯•ç¯å¢ƒè€Œæ­å»ºçš„eså•æœºç¯å¢ƒ å®‰è£…ä¸‹è½½åœ°å€ã€https://www.elastic.co/cn/downloads/elasticsearch#ga-releaseã€‘ (æˆ–å‰å¾€elasticä¸­æ–‡ç¤¾åŒºä¸‹è½½ä¸­å¿ƒã€https://elasticsearch.cn/download/ã€‘) é€‰æ‹©linuxç‰ˆæœ¬ å®‰è£…ES è§£å‹ç¼© 1$ tar xf elasticsearch-7.14.2-linux-x86_64.tar.gz åˆ›å»ºesç”¨æˆ· 1$ useradd es &amp;&amp; passwd es æ›´å 1$ mv elasticsearch-7.14.2 elasticsearch èµ‹äºˆesç”¨æˆ·æƒé™ 1$ chown -R es:es elasticsearch é…ç½®* å¯ä½¿ç”¨esè‡ªå¸¦çš„javaç¯å¢ƒï¼šES_JAVA_HOME 1$ vim /etc/profile 123# ES_JAVA_HOMEexport ES_JAVA_HOME=/data/elasticsearch/jdk/export PATH=$ES_JAVA_HOME/bin:$PATH 1$ source /etc/profile elasticsearch config 12$ cd elasticsearch/config$ vim elasticsearch.yml 1234567891011node.name: node-1 ##èŠ‚ç‚¹åç§°path.data: /usr/local/elasticsearch/data ##æ•°æ®å­˜æ”¾è·¯å¾„path.logs: /usr/local/elasticsearch/logs ##æ—¥å¿—å­˜æ”¾è·¯å¾„ bootstrap.memory_lock: true ##é¿å…esä½¿ç”¨swapäº¤æ¢åˆ†åŒºindices.requests.cache.size: 5% ##ç¼“å­˜é…ç½®indices.queries.cache.size: 10% ##ç¼“å­˜é…ç½®network.host: 192.168.80.128 ##æœ¬æœºIPhttp.port: 9200 ##é»˜è®¤ç«¯å£cluster.initial_master_nodes: [\"node-1\"] ##è®¾ç½®ç¬¦åˆä¸»èŠ‚ç‚¹æ¡ä»¶çš„èŠ‚ç‚¹çš„ä¸»æœºåæˆ– IP åœ°å€æ¥å¼•å¯¼å¯åŠ¨é›†ç¾¤http.cors.enabled: true ##è·¨åŸŸhttp.cors.allow-origin: \"*\" å°†å½“å‰ç”¨æˆ·è½¯ç¡¬é™åˆ¶è°ƒå¤§ 1$ vim /etc/security/limits.conf 1234es soft nofile 65535es hard nofile 65537es soft memlock unlimitedes hard memlock unlimited ä¿®æ”¹vm.max_map_countå†…å­˜ 1vim /etc/sysctl.conf 1vm.max_map_count=655360 å¯åŠ¨123$ su es$ cd ../bin$ ./elasticsearch -d","text":"* é…åˆnebulaå…¨æ–‡æ£€ç´¢æµ‹è¯•ç¯å¢ƒè€Œæ­å»ºçš„eså•æœºç¯å¢ƒ å®‰è£…ä¸‹è½½åœ°å€ã€https://www.elastic.co/cn/downloads/elasticsearch#ga-releaseã€‘ (æˆ–å‰å¾€elasticä¸­æ–‡ç¤¾åŒºä¸‹è½½ä¸­å¿ƒã€https://elasticsearch.cn/download/ã€‘) é€‰æ‹©linuxç‰ˆæœ¬ å®‰è£…ES è§£å‹ç¼© 1$ tar xf elasticsearch-7.14.2-linux-x86_64.tar.gz åˆ›å»ºesç”¨æˆ· 1$ useradd es &amp;&amp; passwd es æ›´å 1$ mv elasticsearch-7.14.2 elasticsearch èµ‹äºˆesç”¨æˆ·æƒé™ 1$ chown -R es:es elasticsearch é…ç½®* å¯ä½¿ç”¨esè‡ªå¸¦çš„javaç¯å¢ƒï¼šES_JAVA_HOME 1$ vim /etc/profile 123# ES_JAVA_HOMEexport ES_JAVA_HOME=/data/elasticsearch/jdk/export PATH=$ES_JAVA_HOME/bin:$PATH 1$ source /etc/profile elasticsearch config 12$ cd elasticsearch/config$ vim elasticsearch.yml 1234567891011node.name: node-1 ##èŠ‚ç‚¹åç§°path.data: /usr/local/elasticsearch/data ##æ•°æ®å­˜æ”¾è·¯å¾„path.logs: /usr/local/elasticsearch/logs ##æ—¥å¿—å­˜æ”¾è·¯å¾„ bootstrap.memory_lock: true ##é¿å…esä½¿ç”¨swapäº¤æ¢åˆ†åŒºindices.requests.cache.size: 5% ##ç¼“å­˜é…ç½®indices.queries.cache.size: 10% ##ç¼“å­˜é…ç½®network.host: 192.168.80.128 ##æœ¬æœºIPhttp.port: 9200 ##é»˜è®¤ç«¯å£cluster.initial_master_nodes: [\"node-1\"] ##è®¾ç½®ç¬¦åˆä¸»èŠ‚ç‚¹æ¡ä»¶çš„èŠ‚ç‚¹çš„ä¸»æœºåæˆ– IP åœ°å€æ¥å¼•å¯¼å¯åŠ¨é›†ç¾¤http.cors.enabled: true ##è·¨åŸŸhttp.cors.allow-origin: \"*\" å°†å½“å‰ç”¨æˆ·è½¯ç¡¬é™åˆ¶è°ƒå¤§ 1$ vim /etc/security/limits.conf 1234es soft nofile 65535es hard nofile 65537es soft memlock unlimitedes hard memlock unlimited ä¿®æ”¹vm.max_map_countå†…å­˜ 1vim /etc/sysctl.conf 1vm.max_map_count=655360 å¯åŠ¨123$ su es$ cd ../bin$ ./elasticsearch -d Kibanaä¸‹è½½åœ°å€[https://elasticsearch.cn/download/] é€‰æ‹©å’Œesç›¸åŒç‰ˆæœ¬ å®‰è£…kibana è§£å‹ç¼© 1$ tar -zxvf kibana-7.14.2-linux-x86_64.tar.gz æ›´å 1$ mv kibana-7.14.2-linux-x86_64 kibana é…ç½®12cd kibanavim config/kibana.yml 1234server.port: 5601server.host: \"0.0.0.0\"elasticsearch.hosts: \"http://192.168.80.128:9200\"kibana.index: \".kibana\" 12345678910# ä¿®æ”¹/etc/sudoersæ–‡ä»¶ï¼Œè¿›å…¥è¶…çº§ç”¨æˆ·, ç»™äºˆesç”¨æˆ·å†™æƒé™(base) [root@localhost kibana]# chmod u+w /etc/sudoers# ç¼–è¾‘/etc/sudoersæ–‡ä»¶(base) [root@localhost kibana]# vim /etc/sudoers# èµ‹äºˆesç”¨æˆ·æƒé™es ALL=(ALL) ALL(base) [root@localhost kibana]# chmod u-w /etc/sudoers# æ’¤é”€esç”¨æˆ·æ–‡ä»¶å†™æƒé™(base) [root@localhost kibana]# sudo chown -R es:es /usr/local/kibana(base) [root@localhost kibana]# su es å¯åŠ¨12[es@localhost kibana]$ cd bin[es@localhost bin]$ ./kibana è¿›å…¥kibana http:192.168.80.128:5601","categories":[{"name":"BigData","slug":"BigData","permalink":"http://yoursite.com/categories/BigData/"}],"tags":[{"name":"elastic search","slug":"elastic-search","permalink":"http://yoursite.com/tags/elastic-search/"}]},{"title":"Spark-SQL","slug":"Spark-SQL","date":"2022-12-08T08:50:52.000Z","updated":"2022-12-09T08:58:34.011Z","comments":true,"path":"2022/12/08/Spark-SQL/","link":"","permalink":"http://yoursite.com/2022/12/08/Spark-SQL/","excerpt":"SparkSQLSparkSQLæ˜¯sparkçš„ä¸€ä¸ªç”¨äºå¤„ç†æµ·é‡ç»“æ„åŒ–æ•°æ®çš„æ¨¡å— æ”¯æŒSQLè¯­è¨€ è‡ªåŠ¨ä¼˜åŒ– æ€§èƒ½å¼º å…¼å®¹HIVE APIæµç¨‹ç®€å• æ”¯æŒæ ‡å‡†åŒ–JDBCå’ŒODBCè¿æ¥ â€¦ SparkSQLæ•°æ®æŠ½è±¡ Pandas Â· DataFrame Â· äºŒç»´è¡¨æ•°æ®ç»“æ„ Â· å•æœºï¼ˆæœ¬åœ°ï¼‰é›†åˆ SparkCore Â· RDD Â· æ— æ ‡å‡†æ•°æ®ç»“æ„ Â· åˆ†å¸ƒå¼ï¼ˆåˆ†åŒºï¼‰é›†åˆ SparkSQL Â· DataFrame Â· äºŒç»´è¡¨æ•°æ®ç»“æ„ Â· åˆ†å¸ƒå¼ï¼ˆåˆ†åŒºï¼‰é›†åˆ SparkSessionå¯¹è±¡RDDç¨‹åºçš„æ‰§è¡Œå…¥å£å¯¹è±¡ï¼šSparkContext åœ¨Spark2.0ä»¥åï¼Œæ¨å‡ºäº†SparkSessionå¯¹è±¡ï¼Œæ¥ä½œä¸ºSparkç¼–ç çš„ç»Ÿä¸€å…¥å£å¯¹è±¡ã€‚SparkSessionï¼š ç”¨äºSparkSQLç¼–ç¨‹ï¼Œä½œä¸ºå…¥å£å¯¹è±¡ ç”¨äºSparkCoreç¼–ç¨‹ï¼Œé€šè¿‡SparkSessionå¯¹è±¡è·å–SparkContext æ„å»ºSparkSessionå¯¹è±¡ï¼š 1234567from pyspark.sql import SparkSession# é€šè¿‡builderæ–¹æ³•æ¥æ„å»ºSparkSessionå¯¹è±¡# appNameï¼šè®¾ç½®ç¨‹åºåç§°# configï¼šé…ç½®å¸¸ç”¨å±æ€§# getOrCreateï¼šå®Œæˆåˆ›å»ºSparkSessionå¯¹è±¡spark = SparkSession.builder.appName(\"test\").master(\"local[*]\").config(\"spark.sql.shuffle.partitions\", \"4\").getOrCreate() é€šè¿‡SparkSesionå¯¹è±¡è·å–SparkContextå¯¹è±¡ï¼š 12345from pyspark.sql import SparkSessionspark = SparkSession.builder.appName(\"test\").master(\"local[*]\").config(\"spark.sql.shuffle.partitions\", \"4\").getOrCreate()sc = spark.sparkContext","text":"SparkSQLSparkSQLæ˜¯sparkçš„ä¸€ä¸ªç”¨äºå¤„ç†æµ·é‡ç»“æ„åŒ–æ•°æ®çš„æ¨¡å— æ”¯æŒSQLè¯­è¨€ è‡ªåŠ¨ä¼˜åŒ– æ€§èƒ½å¼º å…¼å®¹HIVE APIæµç¨‹ç®€å• æ”¯æŒæ ‡å‡†åŒ–JDBCå’ŒODBCè¿æ¥ â€¦ SparkSQLæ•°æ®æŠ½è±¡ Pandas Â· DataFrame Â· äºŒç»´è¡¨æ•°æ®ç»“æ„ Â· å•æœºï¼ˆæœ¬åœ°ï¼‰é›†åˆ SparkCore Â· RDD Â· æ— æ ‡å‡†æ•°æ®ç»“æ„ Â· åˆ†å¸ƒå¼ï¼ˆåˆ†åŒºï¼‰é›†åˆ SparkSQL Â· DataFrame Â· äºŒç»´è¡¨æ•°æ®ç»“æ„ Â· åˆ†å¸ƒå¼ï¼ˆåˆ†åŒºï¼‰é›†åˆ SparkSessionå¯¹è±¡RDDç¨‹åºçš„æ‰§è¡Œå…¥å£å¯¹è±¡ï¼šSparkContext åœ¨Spark2.0ä»¥åï¼Œæ¨å‡ºäº†SparkSessionå¯¹è±¡ï¼Œæ¥ä½œä¸ºSparkç¼–ç çš„ç»Ÿä¸€å…¥å£å¯¹è±¡ã€‚SparkSessionï¼š ç”¨äºSparkSQLç¼–ç¨‹ï¼Œä½œä¸ºå…¥å£å¯¹è±¡ ç”¨äºSparkCoreç¼–ç¨‹ï¼Œé€šè¿‡SparkSessionå¯¹è±¡è·å–SparkContext æ„å»ºSparkSessionå¯¹è±¡ï¼š 1234567from pyspark.sql import SparkSession# é€šè¿‡builderæ–¹æ³•æ¥æ„å»ºSparkSessionå¯¹è±¡# appNameï¼šè®¾ç½®ç¨‹åºåç§°# configï¼šé…ç½®å¸¸ç”¨å±æ€§# getOrCreateï¼šå®Œæˆåˆ›å»ºSparkSessionå¯¹è±¡spark = SparkSession.builder.appName(\"test\").master(\"local[*]\").config(\"spark.sql.shuffle.partitions\", \"4\").getOrCreate() é€šè¿‡SparkSesionå¯¹è±¡è·å–SparkContextå¯¹è±¡ï¼š 12345from pyspark.sql import SparkSessionspark = SparkSession.builder.appName(\"test\").master(\"local[*]\").config(\"spark.sql.shuffle.partitions\", \"4\").getOrCreate()sc = spark.sparkContext e.g. 1234567891011121314151617from pyspark.sql import SparkSessionspark = SparkSession.builder.appName(\"test\").master(\"local[*]\").config(\"spark.sql.shuffle.partitions\", \"4\").getOrCreate()sc = spark.sparkContextdf1 = spark.read.csv(\"hdfs://master:8020/input/pip_file.txt\", sep=',', header=False)df2 = df1.toDF(\"id\", \"package\", \"version\")df2.printSchema() # è¡¨ç»“æ„df2.show() # å±•ç¤ºè¡¨df2.createTempView(\"pip\") # åˆ›å»º\"pip\"è¡¨,ä¿å­˜åœ¨å†…å­˜ä¸­# SQLé£æ ¼spark.sql(\"\"\" SELECT * FROM pip WHERE package='pyspark'\"\"\").show# DSLé£æ ¼df2.where(\"package='pyspark'\").limit(5).show() 123456789101112131415161718192021222324252627282930313233343536root |-- id: string (nullable = true) |-- package: string (nullable = true) |-- version: string (nullable = true)+---+-------------+--------+| id| package| version|+---+-------------+--------+| 1| flask| 1.1.4|| 2| fastapi| 0.78.0|| 3| h5py| 2.10.0|| 4| keras| 2.6.0|| 5| jieba| 0.42.1|| 6| numpy| 1.23.3|| 7|opencv-python|4.6.0.66|| 8| pandas| 1.4.3|| 9| pillow| 9.2.0|| 10| py4j|0.10.9.5|| 11| pyspark| 3.3.1|| 12| sklearn| 0.0|| 13| tensorfolw| 2.6.2|| 14| requests| 2.28.1|| 15| redis| 3.5.3|+---+-------------+--------++---+-------+-------+| id|package|version|+---+-------+-------+| 11|pyspark| 3.3.1|+---+-------+-------++---+-------+-------+| id|package|version|+---+-------+-------+| 11|pyspark| 3.3.1|+---+-------+-------+ DataFrameDataFrameçš„ç»„æˆDataFrameæ˜¯ä¸€ä¸ªäºŒç»´è¡¨ç»“æ„ï¼Œåœ¨ç»“æ„å±‚é¢ï¼š StructureTypeå¯¹è±¡æè¿°æ•´ä¸ªDataFrameçš„è¡¨ç»“æ„ StructFieldå¯¹è±¡æè¿°ä¸€ä¸ªåˆ—çš„ä¿¡æ¯ åœ¨æ•°æ®å±‚é¢ï¼š Rowå¯¹è±¡è®°å½•ä¸€è¡Œæ•°æ® Columnå¯¹è±¡è®°å½•ä¸€åˆ—æ•°æ®å¹¶åŒ…å«åˆ—çš„ä¿¡æ¯ DataFrameçš„æ„å»ºRDDè½¬æ¢DataFrameå¯¹è±¡å¯ä»¥ä»RDDè½¬æ¢è€Œæ¥ 1df = spark.createDataFrame(rdd, schema=['id', 'package']) e.g. 123456789101112from pyspark.sql import SparkSessionspark = SparkSession.builder.appName(\"test\").master(\"local[*]\").getOrCreate()sc = spark.sparkContextrdd = sc.textFile(\"hdfs://master:8020/input/pip_file.txt\").map(lambda x: x.split(\",\")).map(lambda x:(int(x[0]), x[1]))df = spark.createDataFrame(rdd, schema=['id', 'package'])df.printSchema()df.show(10, False) # è¾“å‡ºå‰åè¡Œæ•°æ®ï¼Œè¦å…¨éƒ¨æ˜¾ç¤ºé»˜è®¤è®¾ç½®ä¸ºTruedf.createOrReplaceTempView(\"pip\")spark.sql(\"SELECT * FROM pip WHERE id &lt; 5\").show() 12345678910111213141516171819202122232425262728root |-- id: long (nullable = true) |-- package: string (nullable = true)+---+-------------+|id |package |+---+-------------+|1 |flask ||2 |fastapi ||3 |h5py ||4 |keras ||5 |jieba ||6 |numpy ||7 |opencv-python||8 |pandas ||9 |pillow ||10 |py4j |+---+-------------+only showing top 10 rows+---+-------+| id|package|+---+-------+| 1| flask|| 2|fastapi|| 3| h5py|| 4| keras|+---+-------+ StructTypeé€šè¿‡StructTypeå¯¹è±¡æ¥å®šä¹‰DataFrameçš„è¡¨ç»“æ„ï¼Œè½¬æ¢RDD 12345# å¯¼å…¥StructTypeå¯¹è±¡å’Œç±»å‹from pyspark.sql.types import StructType, StringType, IntegerType# å®šä¹‰è¡¨ç»“æ„schema = StructType().add(\"id\", IntegerType(), nullable=True).add(\"package\", StringType(), nullable=True) e.g. 12345678910111213from pyspark.sql import SparkSessionfrom pyspark.sql.types import StructType, StringType, IntegerTypespark = SparkSession.builder.appName(\"test\").master(\"local[*]\").getOrCreate()sc = spark.sparkContextrdd = sc.textFile(\"hdfs://master:8020/input/pip_file.txt\").map(lambda x: x.split(\",\")).map(lambda x:(int(x[0]), x[1]))schema = StructType().add(\"id\", IntegerType(), nullable=True).add(\"package\", StringType(), nullable=True)df = spark.createDataFrame(rdd, schema=schema)df.printSchema()df.show() 1234567891011121314151617181920212223root |-- id: integer (nullable = true) |-- package: string (nullable = true)+---+-------------+| id| package|+---+-------------+| 1| flask|| 2| fastapi|| 3| h5py|| 4| keras|| 5| jieba|| 6| numpy|| 7|opencv-python|| 8| pandas|| 9| pillow|| 10| py4j|| 11| pyspark|| 12| sklearn|| 13| tensorfolw|| 14| requests|| 15| redis|+---+-------------+ toDF12345678910111213141516171819from pyspark.sql import SparkSessionfrom pyspark.sql.types import StructType, StringType, IntegerTypespark = SparkSession.builder.appName(\"test\").master(\"local[*]\").getOrCreate()sc = spark.sparkContextrdd = sc.textFile(\"hdfs://master:8020/input/pip_file.txt\").map(lambda x: x.split(\",\")).map(lambda x:(int(x[0]), x[1]))# toDFå¿«é€Ÿæ„å»ºDataFrame# å¯¹åˆ—ç±»å‹ä¸æ•æ„Ÿï¼Œé»˜è®¤stringç±»å‹df1 = rdd.toDF([\"id\", \"package\"])df1.printSchema()df1.show(5, False)# è®¾ç½®schemaé€šè¿‡toDFæ„å»ºDataFrameschema = StructType().add(\"id\", IntegerType(), nullable=True).add(\"package\", StringType(), nullable=True)df2 = rdd.toDF(schema=schema)df2.printSchema()df2.show(5, False) 1234567891011121314151617181920212223242526272829root |-- id: long (nullable = true) |-- package: string (nullable = true)+---+-------+|id |package|+---+-------+|1 |flask ||2 |fastapi||3 |h5py ||4 |keras ||5 |jieba |+---+-------+only showing top 5 rowsroot |-- id: integer (nullable = true) |-- package: string (nullable = true)+---+-------+|id |package|+---+-------+|1 |flask ||2 |fastapi||3 |h5py ||4 |keras ||5 |jieba |+---+-------+only showing top 5 rows Pandas1234567891011121314151617import pandas as pdfrom pyspark.sql import SparkSessionspark = SparkSession.builder.appName(\"test\").master(\"local[*]\").getOrCreate()sc = spark.sparkContextpddf = pd.DataFrame( &#123; \"id\": [1, 2, 3], \"package\": [\"flask\", \"fastapi\", \"h5py\"], \"version\": [\"1.1.4\", \"0.78.0\", \"2.10.0\"] &#125;)df = spark.createDataFrame(pddf)df.printSchema()df.show() 123456789101112root |-- id: long (nullable = true) |-- package: string (nullable = true) |-- version: string (nullable = true)+---+-------+-------+| id|package|version|+---+-------+-------+| 1| flask| 1.1.4|| 2|fastapi| 0.78.0|| 3| h5py| 2.10.0|+---+-------+-------+ é€šè¿‡æ–‡ä»¶æ„å»ºDataFrametext1sparksession.read.format(\"text|csv|json|jdbc|...\").option(\"K\", \"V\").schema(StructType|String).load(\"æ–‡ä»¶è·¯å¾„ï¼Œæ”¯æŒæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå’ŒHDFS\") e.g. 1234567891011from pyspark.sql import SparkSessionfrom pyspark.sql.types import StructType, StringTypespark = SparkSession.builder.appName(\"test\").master(\"local[*]\").getOrCreate()sc = spark.sparkContext# æ„å»ºStructTypeï¼Œtextæ•°æ®æºï¼Œè¯»å–æ•°æ®çš„ç‰¹ç‚¹æ˜¯å°†ä¸€æ•´è¡Œå½“ä½œä¸€åˆ—æ¥è¯»å–ï¼Œé»˜è®¤åˆ—åä¸ºvalueï¼Œç±»å‹ä¸ºstringschema = StructType().add(\"data\", StringType(), nullable=True)df = spark.read.format(\"text\").schema(schema=schema).load(\"hdfs://master:8020/input/pip_file.txt\")df.printSchema()df.show() 12345678910111213141516171819202122root |-- data: string (nullable = true)+--------------------+| data|+--------------------+| 1,flask,1.1.4|| 2,fastapi,0.78.0|| 3,h5py,2.10.0|| 4,keras,2.6.0|| 5,jieba,0.42.1|| 6,numpy,1.23.3||7,opencv-python,4...|| 8,pandas,1.4.3|| 9,pillow,9.2.0|| 10,py4j,0.10.9.5|| 11,pyspark,3.3.1|| 12,sklearn,0.0|| 13,tensorfolw,2.6.2|| 14,requests,2.28.1|| 15,redis,3.5.3|+--------------------+ jsonjsonæ–‡ä»¶è‡ªå¸¦ä¸€å®šæ•°æ®ç»“æ„ 12345678from pyspark.sql import SparkSessionspark = SparkSession.builder.appName(\"test\").master(\"local[*]\").getOrCreate()sc = spark.sparkContextdf = spark.read.format(\"json\").load(\"hdfs://master:8020/input/pip_file.json\")df.printSchema()df.show() 1234567891011121314root |-- id: long (nullable = true) |-- package: string (nullable = true) |-- version: string (nullable = true)+---+-------+-------+| id|package|version|+---+-------+-------+| 1| flask| 1.1.4|| 2|fastapi| 0.78.0|| 3| h5py| 2.10.0|| 4| keras| 2.6.0|| 5| jieba| 0.42.1|+---+-------+-------+ csv123456789from pyspark.sql import SparkSessionspark = SparkSession.builder.appName(\"test\").master(\"local[*]\").getOrCreate()sc = spark.sparkContext# é€šè¿‡.optionæŒ‡å®šå±æ€§df = spark.read.format(\"csv\").option(\"sep\", \";\").option(\"header\", True).option(\"encoding\", \"utf-8\").schema(\"id INT, package STRING, version STRING\").load(\"hdfs://master:8020/input/pip_file.csv\")df.printSchema()df.show() 123456789101112131415161718192021222324root |-- id: integer (nullable = true) |-- package: string (nullable = true) |-- version: string (nullable = true)+---+-------------+--------+| id| package| version|+---+-------------+--------+| 1| flask| 1.1.4|| 2| fastapi| 0.78.0|| 3| h5py| 2.10.0|| 4| keras| 2.6.0|| 5| jieba| 0.42.1|| 6| numpy| 1.23.3|| 7|opencv-python|4.6.0.66|| 8| pandas| 1.4.3|| 9| pillow| 9.2.0|| 10| py4j|0.10.9.5|| 11| pyspark| 3.3.1|| 12| sklearn| 0.0|| 13| tensorfolw| 2.6.2|| 14| requests| 2.28.1|| 15| redis| 3.5.3|+---+-------------+--------+ parquetparquetæ˜¯sparkä¸­å¸¸ç”¨çš„ä¸€ç§åˆ—ç¤ºå­˜å‚¨æ–‡ä»¶æ ¼å¼ å†…ç½®schemaï¼ˆåˆ—åï¼Œåˆ—ç±»å‹ï¼Œæ˜¯å¦ä¸ºç©ºï¼‰ å­˜å‚¨æ˜¯ä»¥åˆ—ä½œä¸ºå­˜å‚¨æ ¼å¼ å­˜å‚¨æ˜¯åºåˆ—åŒ–å­˜å‚¨åœ¨æ–‡ä»¶ä¸­ï¼ˆæœ‰å‹ç¼©å±æ€§ä½“ç§¯å°ï¼‰ 123456789from pyspark.sql import SparkSessionspark = SparkSession.builder.appName(\"test\").master(\"local[*]\").getOrCreate()sc = spark.sparkContext# é€šè¿‡.optionæŒ‡å®šå±æ€§df = spark.read.format(\"parquet\").load(\"hdfs://master:8020/input/suers.parquet\")df.printSchema()df.show() 123456789101112root |-- name: string (nullable = true) |-- favorite_color: string (nullable = true) |-- favorite_numbers: array (nullable = true) | |-- element: integer (containsNull = true)+------+--------------+----------------+| name|favorite_color|favorite_numbers|+------+--------------+----------------+|Alyssa| null| [3, 9, 15, 20]|| Ben| red| []|+------+--------------+----------------+ DataFrameç¼–ç¨‹DataFrameæ”¯æŒä¸¤ç§ç¼–ç¨‹é£æ ¼ DSLé£æ ¼ è¢«ç§°ä¸ºé¢†åŸŸç‰¹å®šè¯­è¨€ï¼Œæ˜¯DataFrameçš„ç‰¹æœ‰API SQLé£æ ¼ ä½¿ç”¨SQLè¯­å¥æ¥ç›´æ¥å¤„ç†DataFrame DSLé£æ ¼12345678910111213141516171819202122232425262728293031323334353637from pyspark.sql import SparkSessionspark = SparkSession.builder.appName(\"test\").master(\"local[*]\").getOrCreate()sc = spark.sparkContextdf = spark.read.format(\"csv\").schema(\"id INT, package STRING, version STRING\").load(\"hdfs://master:8020/input/pip_file.txt\")# è·å–Columå¯¹è±¡id_colum = df['id']package_colum = df['package']# DSLé£æ ¼# select APIdf.select(['id', 'package']).show() # listdf.select('id', 'package').show() # å¯å˜å‚æ•°df.select(id_colum, package_colum).show() # Columå¯¹è±¡# filter APIdf.filter('id &lt; 5').show()df.filter(df['id'] &lt; 5).show() # Columå¯¹è±¡# where APIdf.where('id &lt; 5').show()df.where(df['id'] &lt; 5).show() # Columå¯¹è±¡# groupBy APIdf.groupBy('package').count().show()df.groupBy(df['package']).count().show() # Columå¯¹è±¡# è¿”å›å€¼ä¸æ˜¯DataFrameï¼Œè€Œæ˜¯GroupedDataå¯¹è±¡# æ˜¯ä¸€ä¸ªæœ‰åˆ†ç»„å…³ç³»çš„æ•°æ®ç»“æ„ï¼Œæä¾›APIåšåˆ†ç»„èšåˆ# SQLï¼šgroup byåæ¥èšåˆï¼šsumã€avgã€countã€minã€max# GroupedDataç±»ä¼¼äºSQLåˆ†ç»„åçš„æ•°æ®ç»“æ„ï¼ŒåŒæ ·æ‹¥æœ‰ä¸Šè¿°5ç§èšåˆæ–¹æ³•# GroupedDataè°ƒç”¨èšåˆæ–¹æ³•åï¼Œè¿”å›å€¼ä¾æ—§æ˜¯DataFrameå¯¹è±¡# GroupedDataåªæ˜¯ä¸€ä¸ªä¸­è½¬å¯¹è±¡ï¼Œæœ€ç»ˆè¿˜æ˜¯è¦è·å¾—DataFrameå¯¹è±¡r = df.groupBy('package')print(r.sum().show(), r.avg().show(), r.count().show(), r.min().show(), r.max().show()) SQLé£æ ¼ä½¿ç”¨SQLé£æ ¼ï¼Œéœ€è¦å°†DataFrameæå‰æ³¨å†Œæˆè¡¨ 123df.createTempView(\"pip\") # æ³¨å†Œä¸€ä¸ªä¸´æ—¶è§†å›¾ï¼ˆè¡¨ï¼‰df.createOrReplaceTempView(\"pip\") # æ³¨å†Œä¸€ä¸ªä¸´æ—¶è¡¨ï¼Œå¦‚æœå·²å­˜åœ¨åˆ™è¿›è¡Œæ›¿æ¢df.createGlobalTempView(\"pip\") # æ³¨å†Œä¸€ä¸ªå…¨å±€è¡¨ å…¨å±€è¡¨ï¼šå¯è·¨SparkSessionå¯¹è±¡ä½¿ç”¨ï¼Œåœ¨ä¸€ä¸ªç¨‹åºå†…çš„å¤šä¸ªSparkSessionä¸­å‡å¯è°ƒç”¨ï¼ŒæŸ¥è¯¢æ—¶å¸¦ä¸Šå‰ç¼€global_temp ä¸´æ—¶è¡¨ï¼šä»…åœ¨å½“å‰SparkSessionä¸­å¯ç”¨ 123456789101112131415from pyspark.sql import SparkSessionspark = SparkSession.builder.appName(\"test\").master(\"local[*]\").getOrCreate()sc = spark.sparkContextdf = spark.read.format(\"csv\").schema(\"id INT, package STRING, version STRING\").load(\"hdfs://master:8020/input/pip_file.txt\")# æ³¨å†Œä¸´æ—¶è¡¨df.createTempView(\"pip\")df.createOrReplaceTempView(\"pip\")df.createGlobalTempView(\"pip_2\")# é€šè¿‡SparkSession SQL APIæ‰§è¡Œsqlè¯­å¥spark.sql(\"SELECT package, COUNT(*) AS cnt FROM pip GROUP BY package\").show()spark.sql(\"SELECT package, COUNT(*) AS cnt FROM global_temp.pip_2 GROUP BY package\").show() pyspark.sql.functionsPySparkæä¾›çš„pyspark.sql.functionsåŒ…åŒ…å«ä¸€ç³»åˆ—å¯ä¾›SparkSQLä½¿ç”¨çš„è®¡ç®—å‡½æ•° 1from pyspark.sql import functions as F å³å¯è°ƒç”¨Få¯¹è±¡è°ƒç”¨å‡½æ•°è¿›è¡Œè®¡ç®—ã€‚è¿™äº›åŠŸèƒ½å‡½æ•°çš„è¿”å›å€¼å¤§å¤šæ˜¯Columå¯¹è±¡ WordCountç¤ºä¾‹1234567891011121314151617181920from pyspark.sql import SparkSessionfrom pyspark.sql import functions as Fspark = SparkSession.builder.appName(\"test\").master(\"local[*]\").getOrCreate()sc = spark.sparkContext# SQLé£æ ¼å¤„ç†rdd = sc.textFile(\"hdfs://master:8020/input/words.txt\").flatMap(lambda x: x.split(\" \")).map(lambda x: [x])df = rdd.toDF([\"word\"])df.createTempView(\"words\")spark.sql(\"SELECT word, COUNT(*) AS cnt FROM words GROUP BY word ORDER BY cnt DESC\").show()# DSLé£æ ¼å¤„ç†df = spark.read.format(\"text\").load(\"hdfs://master:8020/input/words.txt\")# withColumnæ–¹æ³•# ï¼šå¯¹å·²å­˜åœ¨çš„åˆ—è¿›è¡Œæ“ä½œï¼Œè¿”å›ä¸ä¸€ä¸ªæ–°çš„åˆ—ï¼Œå¦‚æœåå­—å’Œä¹‹å‰ç›¸åŒåˆ™æ›¿æ¢ï¼Œå¦åˆ™æ–°å»ºåˆ—df.withColumn(\"value\", F.explode(F.split(df['value'], \" \"))).show()df2 = df.withColumn(\"value\", F.explode(F.split(df['value'], \" \"))).show()df2.groupBy(\"value\").count().show()df2.groupBy(\"value\").count().withColumnRenamed(\"value\", \"name\").withColumnRenamed(\"count\", \"cnt\").orderBy(\"cnt\", ascending=False).show() SparkSQL Shufflespark.sql.shuffle.partitionså‚æ•°æ˜¯åœ¨spark sqlè®¡ç®—è¿‡ç¨‹ä¸­ï¼Œshuffleç®—å­é˜¶æ®µé»˜è®¤çš„åˆ†åŒºæ•°æ˜¯200ä¸ªã€‚å¯¹äºé›†ç¾¤æ¨¡å¼ï¼Œ200è¾ƒä¸ºåˆé€‚ï¼Œå¦‚æœåœ¨localæ¨¡å¼ä¸‹è¿è¡Œï¼Œ200è¾ƒå¤šï¼Œä¼šåœ¨è°ƒåº¦ä¸Šå¸¦æ¥é¢å¤–çš„æŸè€—ï¼Œæ‰€ä»¥åœ¨localæ¨¡å¼ä¸‹å»ºè®®ä¿®æ”¹è¾ƒä½ï¼Œä¾‹å¦‚2/4/10ã€‚è¿™ä¸ªå‚æ•°å’ŒRDDä¸­è®¾ç½®å¹¶è¡Œåº¦çš„å‚æ•°ç›¸äº’ç‹¬ç«‹ å¯ä»¥æŒ‰ä¼˜å…ˆçº§åœ¨ä¸‰å¤„è®¾ç½®ï¼š ä»£ç è®¾ç½® 1spark = SparkSession.builder.appName(\"test\").master(\"local[*]\").config(\"spark.sql.shuffle.partitions\", \"2\").getOrCreate() å®¢æˆ·ç«¯å‚æ•°è®¾ç½® bin/spark-submit --conf &quot;spark.sql.shuffle.partitions=100&quot; é…ç½®æ–‡ä»¶è®¾ç½® conf/spark-defaults.conf spark.sql.shuffle.partitions 100 SparkSQLæ•°æ®æ¸…æ´—æ•°æ®å»é‡APIdropDuplicates 1234# DataFrame API# ä¸è®¾ç½®å‚æ•°ï¼Œå¯¹å…¨å±€çš„åˆ—è”åˆèµ·æ¥è¿›è¡Œæ¯”è¾ƒï¼Œå»é™¤é‡å¤å€¼ï¼Œåªä¿ç•™ä¸€æ¡df.dropDuplicates().show()df.dropDuplicates(['id', 'version']).show() ç¼ºå¤±å€¼å¤„ç†APIdropna 1234567# DataFrame API# å¯¹ç¼ºå¤±å€¼çš„æ•°æ®è¿›è¡Œåˆ é™¤# ä¸è®¾ç½®å‚æ•°ï¼Œåªè¦åˆ—ä¸­å­˜åœ¨nullå³åˆ é™¤æ•´è¡Œdf.dropna().show()# tresh=3è¡¨ç¤ºï¼Œæœ€å°‘æ»¡è¶³3ä¸ªæœ‰æ•ˆåˆ—ï¼Œä¸æ»¡è¶³å³åˆ é™¤å½“å‰æ•°æ®df.dropna(thresh=3).show()df.dropna(tresh=2,subset['id', 'version']).show() fillna 1234567# DataFrame API# å¯¹ç¼ºå¤±å€¼çš„æ•°æ®è¿›è¡Œå¡«å……df.fillna(\"loss\").show()# å¯¹æŒ‡å®šåˆ—è¿›è¡Œå¡«å……df.fillna(\"M/A\", subset['version']).show()# æŒ‡å®šä¸€ä¸ªå­—å…¸ï¼Œå¯¹æ‰€æœ‰çš„åˆ—æä¾›å¡«å……ä¾æ®df.fillna(&#123;\"id\": \"unknown\", \"package\": \"unknown\", \"version\": \"none\"&#125;).show() DataFrameæ•°æ®å†™å‡º123456# modeï¼šä¼ å…¥æ¨¡å¼ï¼Œappend-è¿½åŠ ï¼Œoverwrite-è¦†ç›–ï¼Œignore-å¿½ç•¥ï¼Œerror-é‡å¤å¼‚å¸¸ï¼ˆé»˜è®¤ï¼‰# formatï¼šä¼ å…¥æ ¼å¼ï¼štext/csv/json/parquet/orc/avro/jdbc# ï¼ˆtextæºä»…æ”¯æŒå•åˆ—dfå†™å‡ºï¼‰# optionï¼šè®¾ç½®å±æ€§ï¼Œå¦‚.option(\"sep\", \",\")# saveï¼šä¿å­˜è·¯å¾„ï¼Œæ”¯æŒæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå’ŒHDFSdf.write.mode().format().option(K, V).save(PATH) e.g. 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647from pyspark.sql import SparkSessionfrom pyspark.sql.types import StructType, StringType, IntegerTypefrom pyspark.sql import functions as F# 0. æ„å»ºæ‰§è¡Œç¯å¢ƒå…¥å£å¯¹è±¡SparkSessionspark = SparkSession.builder.\\ appName(\"test\").\\ master(\"local[*]\").\\ config(\"spark.sql.shuffle.partitions\", 2).\\ getOrCreate()sc = spark.sparkContext# 1. è¯»å–æ•°æ®é›†schema = StructType().add(\"user_id\", StringType(), nullable=True). \\ add(\"movie_id\", IntegerType(), nullable=True). \\ add(\"rank\", IntegerType(), nullable=True). \\ add(\"ts\", StringType(), nullable=True)df = spark.read.format(\"csv\"). \\ option(\"sep\", \"\\t\"). \\ option(\"header\", False). \\ option(\"encoding\", \"utf-8\"). \\ schema(schema=schema). \\ load(\"hdfs://master:8020/input/u.data\")# Write text å†™å‡º, åªèƒ½å†™å‡ºä¸€ä¸ªåˆ—çš„æ•°æ®, éœ€è¦å°†dfè½¬æ¢ä¸ºå•åˆ—dfdf.select(F.concat_ws(\"---\", \"user_id\", \"movie_id\", \"rank\", \"ts\")).\\ write.\\ mode(\"overwrite\").\\ format(\"text\").\\ save(\"hdfs://master:8020/output/sql/text\")# Write csvdf.write.mode(\"overwrite\").\\ format(\"csv\").\\ option(\"sep\", \";\").\\ option(\"header\", True).\\ save(\"hdfs://master:8020/output/sql/csv\")# Write jsondf.write.mode(\"overwrite\").\\ format(\"json\").\\ save(\"hdfs://master:8020/output/sql/json\")# Write parquetdf.write.mode(\"overwrite\").\\ format(\"parquet\").\\ save(\"hdfs://master:8020/output/sql/parquet\") DataFrame JDBCå°†mysqlåŒ…æ·»åŠ è¿›pyspark 12cd /usr/local/anaconda3/envs/pyspark/lib/python3.8/site-packages/pyspark/jars/rz DataFrameè¯»å†™æ•°æ®åº“1234567891011121314151617181920# å°†DataFrameé€šè¿‡JDBCå†™å…¥mysqldf.write.mode(\"overwrite\").\\ format(\"jdbc\").\\ option(\"url\", \"jdbc:mysql://master:3306/...\").\\ option(\"dbtable\", \"test\").\\ option(\"user\", \"root\").\\ option(\"password\", \"123456\").\\ save()# JDBCä¼šè‡ªåŠ¨å»ºè¡¨ï¼Œå› ä¸ºDataFrameä¸­å«æœ‰è¡¨ç»“æ„çš„ä¿¡æ¯# è¯»mysqldf = spark.read.format(\"jdbc\").\\ option(\"url\", \"jdbc:mysql://master:3306/...\").\\ option(\"dbtable\", \"test\").\\ option(\"user\", \"root\").\\ option(\"password\", \"123456\").\\ load()df.printSchema()df.show() SparkSQLå‡½æ•°å®šä¹‰SparkSQLå®šä¹‰UDFå‡½æ•°SparkSQLæ¨¡å—è‡ªå¸¦å®ç°å…¬å…±æ–¹æ³•çš„ä½ç½®åœ¨pyspark.sql.functionsä¸­ï¼ŒåŒæ—¶SparkSQLå’ŒHiveä¸€æ ·æ”¯æŒè‡ªå®šä¹‰å‡½æ•°ï¼šUDFå’ŒUDAF ç›®å‰pythonä»…æ”¯æŒSparkSQL UDFè‡ªå®šå‡½æ•° 1234567891011# æ³¨å†Œçš„UDFå¯ç”¨äºDSLå’ŒSQLé£æ ¼# è¿”å›å€¼ç”¨äºDSLé£æ ¼ï¼Œä¼ å‚å†…çš„åç§°ç”¨äºSQLé£æ ¼# arg1ï¼šæ³¨å†Œçš„UDFåç§°ï¼Œä»…å¯ç”¨äºSQLé£æ ¼# arg2ï¼šUDFå¤„ç†é€»è¾‘ï¼Œæ˜¯ä¸€ä¸ªå•ç‹¬çš„æ–¹æ³•# arg3ï¼šå£°æ˜UDFçš„è¿”å›å€¼ç±»å‹ï¼ŒUDFæ³¨å†Œæ—¶ï¼Œå¿…é¡»å£°æ˜è¿”å›å€¼ç±»å‹ï¼Œå¹¶ä¸”UDFçš„çœŸå®è¿”å›å€¼ä¸€å®šè¦å’Œå£°æ˜çš„è¿”å›å€¼ä¸€è‡´# è¿”å›å€¼å¯¹è±¡ï¼šæ˜¯ä¸€ä¸ªUDFå¯¹è±¡ï¼Œä»…å¯ç”¨äºDSLè¯­æ³•# è¿™ç§æ–¹å¼å®šä¹‰çš„UDFï¼Œå¯ä»¥é€šè¿‡arg1çš„åç§°ç”¨äºSQLé£æ ¼ï¼Œé€šè¿‡è¿”å›å€¼å¯¹è±¡ç”¨äºDSLé£æ ¼sparksession.udf.register(arg1, arg2, arg3)# ä»…èƒ½ç”¨äºDSLé£æ ¼pyspark.sql.functions.udf e.g. 12345678910111213141516171819202122232425262728293031from pyspark.sql import SparkSessionfrom pyspark.sql.types import IntegerTypefrom pyspark.sql import functions as Fspark = SparkSession.builder.appName(\"test\").master(\"local[*]\").config(\"spark.sql.shuffle.partitions\", 2).getOrCreate()sc = spark.sparkContextrdd = sc.parallelize([1, 2, 3, 4, 5, 6, 7, 8, 9, 10]).map(lambda x: [x])df = rdd.toDF(['num'])# sparksession.udf.register()def num_ride_10(num): return num * 10udf1 = spark.udf.register(\"udf1\", num_ride_10, IntegerType())# SQLé£æ ¼ä½¿ç”¨# selectExprï¼šä»¥SELECTçš„è¡¨è¾¾å¼æ‰§è¡Œï¼ˆSQLå­—ç¬¦ä¸²ï¼‰# æ™®é€šselectæ–¹æ³•æ¥å—æ™®é€šå­—ç¬¦ä¸²å­—æ®µåï¼Œæˆ–è€…è¿”å›å€¼æ˜¯Columnå¯¹è±¡çš„è®¡ç®—df.selectExpr(\"udf1(num)\").show()# DSLé£æ ¼# è¿”å›å€¼UDFå¯¹è±¡å¦‚æœä½œä¸ºæ–¹æ³•ä½¿ç”¨ï¼Œä¼ å…¥çš„å‚æ•°ä¸€å®šæ˜¯Columnå¯¹è±¡df.select(udf1(df['num'])).show()# pyspark.sql.functions.udfudf2 = F.udf(num_ride_10, IntegerType())df.select(udf2(df['num'])).show()df.selectExpr(\"udf2(num)\").show() 1234567891011121314151617181920212223242526272829303132333435363738394041+---------+|udf1(num)|+---------+| 10|| 20|| 30|| 40|| 50|| 60|| 70|| 80|| 90|| 100|+---------++---------+|udf1(num)|+---------+| 10|| 20|| 30|| 40|| 50|| 60|| 70|| 80|| 90|| 100|+---------++----------------+|num_ride_10(num)|+----------------+| 10|| 20|| 30|| 40|| 50|| 60|| 70|+----------------+ æ³¨å†Œè¿”å›å€¼ä¸ºæ•°ç»„ç±»å‹çš„UDF123456789101112131415161718192021222324252627282930from pyspark.sql import SparkSessionfrom pyspark.sql.types import StringType, ArrayTypeimport pandas as pdfrom pyspark.sql import functions as F# 0. æ„å»ºæ‰§è¡Œç¯å¢ƒå…¥å£å¯¹è±¡SparkSessionspark = SparkSession.builder.appName(\"test\").master(\"local[*]\").config(\"spark.sql.shuffle.partitions\", 2).getOrCreate()sc = spark.sparkContext# æ„å»ºä¸€ä¸ªRDDrdd = sc.parallelize([[\"hadoop spark flink\"], [\"hadoop flink java\"]])df = rdd.toDF([\"line\"])# æ³¨å†ŒUDF, UDFçš„æ‰§è¡Œå‡½æ•°å®šä¹‰def split_line(data): return data.split(\" \") # è¿”å›å€¼æ˜¯ä¸€ä¸ªArrayå¯¹è±¡# TODO1 æ–¹å¼1 æ„å»ºUDFudf2 = spark.udf.register(\"udf1\", split_line, ArrayType(StringType()))# DLSé£æ ¼df.select(udf2(df['line'])).show()# SQLé£æ ¼df.createTempView(\"lines\")spark.sql(\"SELECT udf1(line) FROM lines\").show(truncate=False)# TODO 2 æ–¹å¼2çš„å½¢å¼æ„å»ºUDFudf3 = F.udf(split_line, ArrayType(StringType()))df.select(udf3(df['line'])).show(truncate=False) 1234567891011121314151617181920+--------------------+| udf1(line)|+--------------------+|[hadoop, spark, f...||[hadoop, flink, j...|+--------------------++----------------------+|udf1(line) |+----------------------+|[hadoop, spark, flink]||[hadoop, flink, java] |+----------------------++----------------------+|split_line(line) |+----------------------+|[hadoop, spark, flink]||[hadoop, flink, java] |+----------------------+ æ³¨å†Œè¿”å›å€¼ä¸ºå­—å…¸ç±»å‹çš„UDF12345678910111213141516171819202122232425262728import stringfrom pyspark.sql import SparkSessionfrom pyspark.sql.types import StructType, StringType, IntegerType, ArrayType# 0. æ„å»ºæ‰§è¡Œç¯å¢ƒå…¥å£å¯¹è±¡SparkSessionspark = SparkSession.builder.master(\"local[*]\").config(\"spark.sql.shuffle.partitions\", 2).getOrCreate()sc = spark.sparkContext# å‡è®¾ æœ‰ä¸‰ä¸ªæ•°å­— 1 2 3 æˆ‘ä»¬ä¼ å…¥æ•°å­— ,è¿”å›æ•°å­—æ‰€åœ¨åºå·å¯¹åº”çš„ å­—æ¯ ç„¶åå’Œæ•°å­—ç»“åˆå½¢æˆdictè¿”å›# æ¯”å¦‚ä¼ å…¥1 æˆ‘ä»¬è¿”å› &#123;\"num\":1, \"letters\": \"a\"&#125;rdd = sc.parallelize([[1], [2], [3]])df = rdd.toDF([\"num\"])# æ³¨å†ŒUDFdef process(data): return &#123;\"num\": data, \"letters\": string.ascii_letters[data]&#125;\"\"\"UDFçš„è¿”å›å€¼æ˜¯å­—å…¸çš„è¯, éœ€è¦ç”¨StructTypeæ¥æ¥æ”¶\"\"\"udf1 = spark.udf.register(\"udf1\", process, StructType().add(\"num\", IntegerType(), nullable=True).\\ add(\"letters\", StringType(), nullable=True))df.selectExpr(\"udf1(num)\").show(truncate=False)df.select(udf1(df['num'])).show(truncate=False) 123456789101112131415+---------+|udf1(num)|+---------+|&#123;1, b&#125; ||&#123;2, c&#125; ||&#123;3, d&#125; |+---------++---------+|udf1(num)|+---------+|&#123;1, b&#125; ||&#123;2, c&#125; ||&#123;3, d&#125; |+---------+ é€šè¿‡RDDæ¨¡æ‹ŸUDAF1234567891011121314151617181920212223from pyspark.sql import SparkSession# 0. æ„å»ºæ‰§è¡Œç¯å¢ƒå…¥å£å¯¹è±¡SparkSessionspark = SparkSession.builder.appName(\"test\").master(\"local[*]\").config(\"spark.sql.shuffle.partitions\", 2).getOrCreate()sc = spark.sparkContextrdd = sc.parallelize([1, 2, 3, 4, 5], 3)df = rdd.map(lambda x: [x]).toDF(['num'])# æŠ˜ä¸­çš„æ–¹å¼ å°±æ˜¯ä½¿ç”¨RDDçš„mapPartitions ç®—å­æ¥å®Œæˆèšåˆæ“ä½œ# å¦‚æœç”¨mapPartitions API å®ŒæˆUDAFèšåˆ, ä¸€å®šè¦å•åˆ†åŒºsingle_partition_rdd = df.rdd.repartition(1)def process(iter): sum = 0 for row in iter: sum += row['num'] return [sum] # ä¸€å®šè¦åµŒå¥—list, å› ä¸ºmapPartitionsæ–¹æ³•è¦æ±‚çš„è¿”å›å€¼æ˜¯listå¯¹è±¡print(single_partition_rdd.mapPartitions(process).collect()) 1[15] SparkSQLçª—å£å‡½æ•°å¼€çª—å‡½æ•°å¼€çª—å‡½æ•°çš„å¼•å…¥æ˜¯ä¸ºäº†æ—¢æ˜¾ç¤ºèšé›†å‰çš„æ•°æ®åˆæ˜¾ç¤ºèšé›†åçš„æ•°æ®ï¼Œå³åœ¨æ¯ä¸€è¡Œçš„æœ€åä¸€åˆ—æ·»åŠ èšåˆå‡½æ•°çš„ç»“æœ å¼€çª—ç”¨äºä¸ºè¡Œä¸ºå®šä¹‰ä¸€ä¸ªçª—å£ï¼ˆè¿ç®—å°†è¦æ“ä½œçš„è¡Œä¸ºé›†åˆï¼‰ï¼Œå¯¹ä¸€ç»„å€¼è¿›è¡Œæ“ä½œï¼Œä¸éœ€è¦ä½¿ç”¨GROUP BYå­—å¥å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œèƒ½å¤Ÿåœ¨åŒä¸€è¡Œä¸­åŒæ—¶è¿”å›åŸºç¡€è¡Œçš„åˆ—å’Œèšåˆåˆ— èšåˆå‡½æ•°å’Œå¼€çª—å‡½æ•° èšåˆå‡½æ•°æ˜¯å°†å¤šè¡Œå˜ä¸ºä¸€è¡Œï¼Œcountã€avgâ€¦ï¼›å¦‚æœè¦æ˜¾ç¤ºå…¶ä»–çš„åˆ—å¿…é¡»å°†åˆ—åŠ å…¥åˆ°GROUP BYä¸­ å¼€çª—å‡½æ•°æ˜¯å°†ä¸€è¡Œå˜æˆå¤šè¡Œï¼Œå¯ä»¥ä¸ä½¿ç”¨GROUP BYç›´æ¥æ˜¾ç¤ºæ‰€æœ‰æ•°æ® å¼€çª—å‡½æ•°åˆ†ç±» èšåˆå¼€çª—å‡½æ•° æ’åºå¼€çª—å‡½æ•° åˆ†åŒºç±»å‹NTILEçš„çª—å£å‡½æ•°","categories":[{"name":"BigData","slug":"BigData","permalink":"http://yoursite.com/categories/BigData/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://yoursite.com/tags/spark/"}]},{"title":"Spark-Core","slug":"Spark-Core","date":"2022-12-07T08:58:49.000Z","updated":"2022-12-08T09:05:29.171Z","comments":true,"path":"2022/12/07/Spark-Core/","link":"","permalink":"http://yoursite.com/2022/12/07/Spark-Core/","excerpt":"å¹¿æ’­å˜é‡æœ¬åœ°å¯¹è±¡è¢«å‘é€åˆ°åŒä¸ªExecutorå†…æ¯ä¸ªåˆ†åŒºçš„å¤„ç†çº¿ç¨‹ä¸Šä½¿ç”¨ï¼Œè¿™æ ·æ¯ä¸ªåˆ†åŒºå®é™…ä¸Šå­˜æ”¾äº†é‡å¤çš„æ•°æ®ã€‚è€ŒExecutoræœ¬è´¨ä¸Šæ˜¯è¿›ç¨‹ï¼Œè¿›ç¨‹å†…èµ„æºå…±äº«ï¼Œæ²¡å¿…è¦å°†æœ¬åœ°å¯¹è±¡åˆ†å‘ç»™æ‰€æœ‰åˆ†åŒºï¼Œé€ æˆå†…å­˜æµªè´¹ è§£å†³æ–¹æ¡ˆï¼šå°†æœ¬åœ°å¯¹è±¡è®¾ç½®ä¸ºå¹¿æ’­å˜é‡ 12345# 1.å°†æœ¬åœ°å¯¹è±¡æ ‡è®°ä¸ºå¹¿æ’­å˜é‡broadcast = sc.broadcast(var)# 2.ä½¿ç”¨å¹¿æ’­å˜é‡ï¼Œä»broadcastå¯¹è±¡ä¸­å–å‡ºæœ¬åœ°å¯¹è±¡value = broadcast.value# å½“ä¼ è¾“çš„æ˜¯å¹¿æ’­å¯¹è±¡æ—¶ï¼Œsparkä¼šåªç»™æ¯ä¸ªExecutoråˆ†å‘ä¸€ä»½æ•°æ® å½“æœ¬åœ°é›†åˆå¯¹è±¡å’Œåˆ†å¸ƒå¼é›†åˆå¯¹è±¡ï¼ˆRDDï¼‰è¿›è¡Œå…³è”æ—¶ï¼Œéœ€è¦å°†æœ¬åœ°é›†åˆå¯¹è±¡å°è£…ä¸ºå¹¿æ’­å˜é‡ èŠ‚çœç½‘ç»œIOæ¬¡æ•° é™ä½Executorå†…å­˜å ç”¨ ç´¯åŠ å™¨å½“æ‰§è¡Œç´¯åŠ æ“ä½œæ—¶ï¼Œå„ä¸ªåˆ†åŒºç´¯åŠ è‡ªèº«çš„å†…å®¹ 12# sparkæä¾›ç´¯åŠ å™¨å˜é‡ï¼Œå‚æ•°æ˜¯åˆå§‹å€¼acmlt = sc.accumulator(0) e.g. 123456789101112131415161718from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)acmlt = sc.accumulator(0)def counts(data): global acmlt acmlt += 1 return datardd1 = sc.parallelize([1, 2, 3], 3)rdd2 = rdd1.map(counts)print(rdd2.collect())print(acmlt) 12[1, 2, 3]3 æ³¨ï¼šç´¯åŠ å™¨å¯èƒ½å› è¡€ç¼˜å…³ç³»å¯¼è‡´é‡å¤çš„ç´¯åŠ ï¼Œä¾‹å¦‚ä¸€ä¸ªRDDè¢«é‡Šæ”¾åç´¯åŠ å·²ç»å®Œæˆï¼Œæ­¤æ—¶å†ä½¿ç”¨è¯¥RDDå°†ä¼šå¯¼è‡´é‡å¤ç´¯åŠ ã€‚å¯é€šè¿‡cacheç¼“å­˜æœºåˆ¶æ¥è§£å†³","text":"å¹¿æ’­å˜é‡æœ¬åœ°å¯¹è±¡è¢«å‘é€åˆ°åŒä¸ªExecutorå†…æ¯ä¸ªåˆ†åŒºçš„å¤„ç†çº¿ç¨‹ä¸Šä½¿ç”¨ï¼Œè¿™æ ·æ¯ä¸ªåˆ†åŒºå®é™…ä¸Šå­˜æ”¾äº†é‡å¤çš„æ•°æ®ã€‚è€ŒExecutoræœ¬è´¨ä¸Šæ˜¯è¿›ç¨‹ï¼Œè¿›ç¨‹å†…èµ„æºå…±äº«ï¼Œæ²¡å¿…è¦å°†æœ¬åœ°å¯¹è±¡åˆ†å‘ç»™æ‰€æœ‰åˆ†åŒºï¼Œé€ æˆå†…å­˜æµªè´¹ è§£å†³æ–¹æ¡ˆï¼šå°†æœ¬åœ°å¯¹è±¡è®¾ç½®ä¸ºå¹¿æ’­å˜é‡ 12345# 1.å°†æœ¬åœ°å¯¹è±¡æ ‡è®°ä¸ºå¹¿æ’­å˜é‡broadcast = sc.broadcast(var)# 2.ä½¿ç”¨å¹¿æ’­å˜é‡ï¼Œä»broadcastå¯¹è±¡ä¸­å–å‡ºæœ¬åœ°å¯¹è±¡value = broadcast.value# å½“ä¼ è¾“çš„æ˜¯å¹¿æ’­å¯¹è±¡æ—¶ï¼Œsparkä¼šåªç»™æ¯ä¸ªExecutoråˆ†å‘ä¸€ä»½æ•°æ® å½“æœ¬åœ°é›†åˆå¯¹è±¡å’Œåˆ†å¸ƒå¼é›†åˆå¯¹è±¡ï¼ˆRDDï¼‰è¿›è¡Œå…³è”æ—¶ï¼Œéœ€è¦å°†æœ¬åœ°é›†åˆå¯¹è±¡å°è£…ä¸ºå¹¿æ’­å˜é‡ èŠ‚çœç½‘ç»œIOæ¬¡æ•° é™ä½Executorå†…å­˜å ç”¨ ç´¯åŠ å™¨å½“æ‰§è¡Œç´¯åŠ æ“ä½œæ—¶ï¼Œå„ä¸ªåˆ†åŒºç´¯åŠ è‡ªèº«çš„å†…å®¹ 12# sparkæä¾›ç´¯åŠ å™¨å˜é‡ï¼Œå‚æ•°æ˜¯åˆå§‹å€¼acmlt = sc.accumulator(0) e.g. 123456789101112131415161718from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)acmlt = sc.accumulator(0)def counts(data): global acmlt acmlt += 1 return datardd1 = sc.parallelize([1, 2, 3], 3)rdd2 = rdd1.map(counts)print(rdd2.collect())print(acmlt) 12[1, 2, 3]3 æ³¨ï¼šç´¯åŠ å™¨å¯èƒ½å› è¡€ç¼˜å…³ç³»å¯¼è‡´é‡å¤çš„ç´¯åŠ ï¼Œä¾‹å¦‚ä¸€ä¸ªRDDè¢«é‡Šæ”¾åç´¯åŠ å·²ç»å®Œæˆï¼Œæ­¤æ—¶å†ä½¿ç”¨è¯¥RDDå°†ä¼šå¯¼è‡´é‡å¤ç´¯åŠ ã€‚å¯é€šè¿‡cacheç¼“å­˜æœºåˆ¶æ¥è§£å†³ DAGSparkçš„æ ¸å¿ƒæ˜¯æ ¹æ®RDDæ¥å®ç°çš„ï¼ŒSpark Schedulerï¼ˆsparkä»»åŠ¡è°ƒåº¦ï¼‰æ˜¯sparkæ ¸å¿ƒå®ç°çš„é‡è¦ä¸€ç¯ï¼Œå…¶åŠŸèƒ½æ˜¯ç»„ç»‡å¤„ç†RDDä¸­æ¯ä¸ªåˆ†åŒºçš„æ•°æ®ï¼Œæ ¹æ®RDDçš„ä¾èµ–å…³ç³»æ„å»ºDAGæœ‰å‘æ— ç¯å›¾ï¼Œå†åŸºäºDAGåˆ’åˆ†Stageï¼Œå°†æ¯ä¸ªStageä¸­çš„ä»»åŠ¡å‘é€åˆ°æŒ‡å®šèŠ‚ç‚¹è¿è¡Œï¼Œåˆç†è§„åˆ’èµ„æºçš„åˆ©ç”¨ DAGæ ‡å‡†å®šä¹‰æœ‰å‘æ— ç¯å›¾ï¼šæœ‰æ–¹å‘è€Œæ²¡æœ‰å½¢æˆé—­ç¯çš„æ‰§è¡Œæµç¨‹å›¾ æœ‰å‘ï¼šå…·æœ‰æ‰§è¡Œæ–¹å‘ æ— ç¯ï¼šæ²¡æœ‰é—­ç¯ Actionç®—å­å’ŒJobä¸€ä¸ªActionä¼šäº§ç”Ÿä¸€ä¸ªDAGï¼Œå¦‚æœä»£ç ä¸­å­˜åœ¨3ä¸ªActionåˆ™ä¼šäº§ç”Ÿ3ä¸ªDAGï¼› æ¯ä¸ªDAGåœ¨åº”ç”¨ç¨‹åºè¿è¡Œæ—¶äº§ç”Ÿä¸€ä¸ªJobï¼ˆåº”ç”¨ç¨‹åºå†…çš„å­ä»»åŠ¡ï¼‰ 1ä¸ªAction = 1ä¸ªDAG = 1ä¸ªJob è¿™æ ·çš„ä»£ç è¿è¡Œèµ·æ¥åœ¨sparkä¸­è¢«ç§°ä¸ºApplication DAGå’Œåˆ†åŒºDAGçš„æœ€ç»ˆä½œç”¨æ˜¯ä¸ºäº†æ„å»ºsparkè¯¦ç»†æ‰§è¡Œçš„ç‰©ç†è®¡åˆ’ï¼Œç”±äºsparkæ˜¯åˆ†å¸ƒå¼å¤šåˆ†åŒºçš„ï¼Œæ‰€ä»¥DAGå’Œåˆ†åŒºé—´ä¹Ÿå…·æœ‰å…³è” DAGçš„å®½çª„ä¾èµ–å’Œé˜¶æ®µåˆ’åˆ†åœ¨Spark RDDå‰åä¹‹é—´çš„è¡€ç¼˜å…³ç³»ï¼Œåˆ†ä¸ºï¼š çª„ä¾èµ–ï¼šçˆ¶RDDçš„ä¸€ä¸ªåˆ†åŒºï¼Œå°†å…¨éƒ¨æ•°æ®å‘é€ç»™å­RDDçš„ä¸€ä¸ªåˆ†åŒºï¼› å®½ä¾èµ–ï¼šçˆ¶RDDçš„ä¸€ä¸ªåˆ†åŒºï¼Œå°†æ•°æ®å‘é€ç»™å­RDDçš„å¤šä¸ªåˆ†åŒºï¼Œåˆ«åï¼šshuffle å¯¹äºsparkï¼Œä¼šæ ¹æ®DAGï¼ŒæŒ‰ç…§å®½ä¾èµ–åˆ’åˆ†ä¸åŒçš„DAGé˜¶æ®µã€‚åˆ’åˆ†ä¾æ®ï¼šä»åå‘å‰ï¼Œæ¯é‡åˆ°å®½ä¾èµ–å°±åˆ’åˆ†å‡ºä¸€ä¸ªé˜¶æ®µï¼Œç§°ä¹‹ä¸ºstageã€‚åœ¨stageå†…éƒ¨ï¼Œä¸€å®šæ˜¯çª„ä¾èµ– Sparkçš„å†…å­˜è¿­ä»£è®¡ç®—çª„ä¾èµ–åŒä¸€çº¿ç¨‹å†…èµ°ç®¡é“äº¤äº’ï¼Œè¿›å…¥å®½ä¾èµ–èµ°ç½‘ç»œIOäº¤äº’ Sparké»˜è®¤æ”¶åˆ°å…¨å±€å¹¶è¡Œåº¦çš„é™åˆ¶ï¼Œé™¤äº†ä¸ªåˆ«ç®—å­æœ‰ç‰¹æ®Šåˆ†åŒºçš„æƒ…å†µï¼Œå¤§éƒ¨åˆ†ç®—å­éƒ½ä¼šéµå¾ªå…¨å±€å¹¶è¡Œåº¦çš„è¦æ±‚æ¥åˆ’åˆ†è‡ªå·±çš„åˆ†åŒºæ•°ã€‚ä¾‹å¦‚å…¨å±€å¹¶è¡Œåº¦æ˜¯3ï¼Œå¤§éƒ¨åˆ†ç®—å­çš„é»˜è®¤åˆ†åŒºéƒ½æ˜¯3-&gt;ä¸å»ºè®®å†ç‹¬ç«‹é€šè¿‡argæ¥æŒ‡å®šåˆ†åŒºæ•° Sparkå¹¶è¡Œåº¦Sparkçš„å¹¶è¡Œï¼šåœ¨åŒä¸€æ—¶é—´å†…ï¼Œæœ‰å¤šå°‘taskåœ¨åŒæ—¶è¿è¡Œ Sparkçš„å¹¶è¡Œåº¦ï¼šå¹¶è¡Œèƒ½åŠ›ï¼Œå½“è®¾ç½®ä¸º6ï¼Œå³å…±æœ‰6ä¸ªtaskåœ¨å¹¶è¡Œè¿è¡Œï¼ŒRDDçš„åˆ†åŒºè¢«è§„åˆ’ä¸º6ä¸ªåˆ†åŒº Sparkå¹¶è¡Œåº¦è®¾ç½®ï¼ˆä¼˜å…ˆçº§ç”±é«˜åˆ°ä½ï¼‰ï¼š ä»£ç  å®¢æˆ·ç«¯å‚æ•° é…ç½®æ–‡ä»¶ é»˜è®¤å€¼ï¼ˆ1ï¼‰ï¼Œå¹¶ä¸ä¼šå…¨éƒ¨ä»¥1æ¥è¿è¡Œï¼Œå¤šæ•°æƒ…å†µä¸‹åŸºäºè¯»å–æ–‡ä»¶çš„åˆ†ç‰‡æ•°é‡æ¥ä½œä¸ºé»˜è®¤å¹¶è¡Œåº¦ å…¨å±€å¹¶è¡Œåº¦é…ç½®å‚æ•°ï¼š spark.default.parallelism ä»£ç ä¸­è®¾ç½®ï¼š 12conf = SparkConf()conf.set(\"spark.default.parallelism\", \"100\") å®¢æˆ·ç«¯æäº¤å‚æ•°ä¸­è®¾ç½®bin/spark-submit --conf &quot;spark.default.parallelism=100&quot; é…ç½®æ–‡ä»¶conf/spark-defaults.confä¸­è®¾ç½®spark.default.parallelism 100 æ³¨ï¼šå…¨å±€å¹¶è¡Œåº¦æ˜¯æ¨èè®¾ç½®ï¼Œä¸è¦é’ˆå¯¹RDDæ›´æ”¹åˆ†åŒºï¼Œå¯èƒ½ä¼šå½±å“å†…å­˜è¿­ä»£ç®¡é“çš„æ„å»ºï¼Œæˆ–è€…äº§ç”Ÿé¢å¤–çš„shuffle é’ˆå¯¹RDDå¹¶è¡Œåº¦çš„è®¾ç½®ï¼ˆä¸æ¨èï¼‰ï¼š Â· repartitionç®—å­ Â· coalesceç®—å­ Â· partitionByç®—å­ è§„åˆ’Sparké›†ç¾¤å¹¶è¡Œåº¦è®¾ç½®ä¸ºCPUæ€»æ ¸å¿ƒçš„2~10å€ï¼ˆæˆ–æ›´é«˜ï¼‰* æ¯”å¦‚é›†ç¾¤å¯ç”¨çš„CPUæ ¸å¿ƒæ•°é‡ä¸º100ä¸ªï¼Œå»ºè®®å¹¶è¡Œåº¦200~1000ï¼ˆç¡®ä¿æ˜¯CPUæ ¸å¿ƒçš„æ•´æ•°å€ï¼‰ è®¾ç½®ä¸ºæœ€å°‘2å€ï¼š CPUçš„ä¸€ä¸ªæ ¸å¿ƒåŒä¸€æ—¶é—´åªèƒ½åšä¸€ä»¶äº‹ï¼Œå½“æ‹¥æœ‰100ä¸ªæ ¸å¿ƒçš„æƒ…å†µä¸‹ï¼Œè®¾ç½®100å¹¶è¡Œåº¦ï¼Œèƒ½åˆ©ç”¨å…¨éƒ¨çš„CPUï¼Œä½†taskçš„å‹åŠ›ä¸å‡è¡¡ï¼Œä¸€æ—¦æŸä¸ªtaskå…ˆæ‰§è¡Œå®Œæ¯•ï¼Œä¼šå¯¼è‡´æŸä¸ªCPUæ ¸å¿ƒçš„ç©ºé—²ã€‚æ‰€ä»¥å°†taskå¹¶è¡Œåˆ†é…çš„æ•°é‡å¢å¤šï¼Œä¾‹å¦‚è®¾ç½®1000å¹¶è¡Œåº¦ï¼ŒåŒä¸€æ—¶é—´å†…æœ‰100ä¸ªtaskåœ¨è¿è¡Œï¼Œ900ä¸ªåœ¨ç­‰å¾…ï¼Œä½†å¯ä»¥ç¡®ä¿æŸä¸ªtaskè¿è¡Œå®Œæ¯•åä¼šä¸æ–­æœ‰taskè¡¥ä¸Šï¼Œä¸è®©CPUå¤„äºç©ºé—²çŠ¶æ€ï¼Œæœ€å¤§ç¨‹åº¦åˆ©ç”¨é›†ç¾¤çš„èµ„æº Sparkä»»åŠ¡è°ƒåº¦Sparkä»»åŠ¡ç”±Driverè¿›è¡Œè°ƒåº¦åŒ…æ‹¬ï¼š é€»è¾‘DAGäº§ç”Ÿ åˆ†åŒºDAGäº§ç”Ÿ åŸºäºåˆ†åŒºDAGæ„å»ºçº¿ç¨‹taskå¹¶åˆ’åˆ† å°†taskåˆ†é…ç»™Executorå¹¶ç›‘æ§å…¶å·¥ä½œ Sparkç¨‹åºè°ƒåº¦æµç¨‹ æ„å»ºDriverï¼ˆDriverï¼‰ æ„å»ºSparkContextæ‰§è¡Œç¯å¢ƒå…¥å£å¯¹è±¡ï¼ˆDriverï¼‰ åŸºäºDAG schedulerè°ƒåº¦å™¨æ„å»ºé€»è¾‘taskåˆ†é…ï¼ˆDriverï¼‰ åŸºäºtask schedulerè°ƒåº¦å™¨å°†é€»è¾‘taskåˆ†é…åˆ°å„ä¸ªExecutorä¸Šæ‰§è¡Œå¹¶ç›‘æ§ï¼ˆDriverï¼‰ Workerï¼ˆExecutorï¼‰è¢«task schedulerç®¡ç†ç›‘æ§ï¼Œéµä»æŒ‡ä»¤å¹²æ´»å¹¶æ±‡æŠ¥è¿›åº¦ï¼ˆWorkerï¼‰ Driverå†…éƒ¨ç»„ä»¶ DAGè°ƒåº¦å™¨ å°†é€»è¾‘DAGè¿›è¡Œå¤„ç†ï¼Œæœ€ç»ˆå¾—åˆ°é€»è¾‘ä¸Šçš„taskåˆ’åˆ† Taskè°ƒåº¦å™¨ åŸºäºDAGè°ƒåº¦å™¨çš„äº§å‡ºï¼Œæ¥è§„åˆ’è¿™äº›é€»è¾‘çš„taskåº”è¯¥åœ¨å“ªäº›ç‰©ç†çš„Executorä¸Šè¿è¡Œï¼Œä»¥åŠç›‘æ§å®ƒä»¬ å±‚çº§å…³ç³»æ¢³ç† 1ä¸ªsparkç¯å¢ƒå¯è¿è¡Œå¤šä¸ªApplicationï¼› 1ä¸ªä»£ç æˆåŠŸè¿è¡Œç”Ÿæˆä¸€ä¸ªApplicationï¼› 1ä¸ªApplicationå†…éƒ¨æœ‰å¤šä¸ªJobï¼› 1ä¸ªActionç®—å­äº§ç”Ÿ1ä¸ªJobï¼Œæ¯ä¸ªJobæœ‰è‡ªå·±çš„DAGæ‰§è¡Œå›¾ï¼› 1ä¸ªJobçš„DAGåŸºäºå®½çª„ä¾èµ–åˆ’åˆ†ä¸åŒçš„é˜¶æ®µï¼› 1ä¸ªé˜¶æ®µé‡ŒåŸºäºåˆ†åŒºæ•°é‡å½¢æˆå¤šä¸ªå¹¶è¡Œçš„å†…å­˜è¿­ä»£ç®¡é“ï¼› 1ä¸ªå†…å­˜è¿­ä»£ç®¡é“å½¢æˆ1ä¸ªtaskï¼ˆDAGè°ƒåº¦å™¨åˆ’åˆ†å°†Jobå†…åˆ’åˆ†å‡ºå…·ä½“çš„taskä»»åŠ¡ï¼Œ1ä¸ªJobè¢«åˆ’åˆ†å‡ºçš„taskåœ¨é€»è¾‘ä¸Šè¢«ç§°ä¸ºè¿™ä¸ªjobçš„tasksetï¼‰","categories":[{"name":"BigData","slug":"BigData","permalink":"http://yoursite.com/categories/BigData/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://yoursite.com/tags/spark/"}]},{"title":"Pyspark-RDD","slug":"Pyspark-RDD","date":"2022-12-07T05:45:49.000Z","updated":"2022-12-08T06:09:52.881Z","comments":true,"path":"2022/12/07/Pyspark-RDD/","link":"","permalink":"http://yoursite.com/2022/12/07/Pyspark-RDD/","excerpt":"RDDRDDï¼ˆResilient Distributed Datasetï¼‰å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼Œæ˜¯sparkä¸­æœ€åŸºæœ¬çš„æ•°æ®æŠ½è±¡ï¼Œä»£è¡¨ä¸€ä¸ªä¸å¯å˜ã€å¯åˆ†åŒºã€å…¶ä¸­å…ƒç´ å¯å¹¶è¡Œè®¡ç®—çš„é›†åˆ Resilientï¼šRDDä¸­çš„æ•°æ®å¯å­˜å‚¨å†å†…å­˜æˆ–ç£ç›˜ä¸­ Distributedï¼šåˆ†å¸ƒå¼å­˜å‚¨æ•°æ®ï¼ˆè·¨æœºå™¨/è·¨è¿›ç¨‹ï¼‰ï¼Œç”¨äºåˆ†å¸ƒå¼è®¡ç®— Datasetï¼šä¸€ä¸ªç”¨äºå­˜æ”¾æ•°æ®çš„æ•°æ®é›†åˆ ç‰¹æ€§åˆ†åŒºRDDåˆ†åŒºæ˜¯RDDæ•°æ®å­˜å‚¨çš„æœ€å°å•ä½ï¼Œä¸€ä»½RDDæ•°æ®æœ¬è´¨ä¸Šåˆ†éš”æˆäº†å¤šä¸ªåˆ†åŒº 123# å­˜å‚¨9ä¸ªæ•°å­—ï¼Œè®¾ç«‹ä¸‰ä¸ªåˆ†åŒºrdd = sc.parallelize([1, 2, 3, 4, 5, 6, 7, 8, 9], 3)rdd.glom().collect() 1[[1,2,3],[4,5,6],[7,8,9]] RDDæ–¹æ³•ä¼šä½œç”¨åœ¨å…¶æ‰€æœ‰æ–¹æ³•ä¸Š1rdd.map(lambda x: x * 10).collect() 1[10,20,30,40,50,60,70,80,90] RDDä¹‹é—´å…·æœ‰ä¾èµ–å…³ç³»123456sc = SparkContext(conf=conf)rdd1 = sc.textFile(\"../test.text\")rdd2 = rdd1.flatMap(lambda x: x.split(' '))rdd3 = rdd2.map(lambda x: (x, 1))rdd4 = rdd3.reduceByKey(lambda a, b: a+b)print(rdd4.collect()) Key-Valueå‹RDDå¯ä»¥æœ‰åˆ†åŒºå™¨KVå‹RDDï¼šRDDå†…å­˜å‚¨çš„æ•°æ®æ˜¯åªæœ‰ä¸¤ä¸ªå…ƒç´ çš„äºŒå…ƒå…ƒç»„ é»˜è®¤åˆ†åŒºå™¨ï¼šHashåˆ†åŒºè§„åˆ™ï¼Œä¹Ÿå¯æ‰‹åŠ¨è®¾ç½®åˆ†åŒºå™¨ï¼šrdd.partitionBy()æ–¹æ³• æ³¨ï¼šä¸æ˜¯æ‰€æœ‰RDDéƒ½æ˜¯KVå‹ RDDçš„åˆ†åŒºè§„åˆ’ï¼šä¼šå°½é‡é è¿‘æ•°æ®æ‰€åœ¨çš„æœåŠ¡å™¨åœ¨åˆå§‹RDDè¯»å–æ•°æ®è§„åˆ’é˜¶æ®µï¼Œåˆ†åŒºä¼šå°½é‡è§„åˆ’åˆ°å­˜å‚¨æ•°æ®æ‰€åœ¨æœåŠ¡å™¨ï¼Œç›´æ¥è¯»å–æœ¬åœ°æ•°æ®ï¼Œé¿å…ä»ç½‘ç»œè¯»å–æ•°æ® Sparkä¼šåœ¨ç¡®ä¿å¹¶è¡Œè®¡ç®—èƒ½åŠ›çš„å‰æä¸‹ï¼Œå°½é‡ç¡®ä¿æœ¬åœ°è¯»å– RDDåˆ›å»º é€šè¿‡å¹¶è¡ŒåŒ–é›†åˆåˆ›å»ºï¼ˆæœ¬åœ°å¯¹è±¡è½¬åŒ–ä¸ºåˆ†å¸ƒå¼RDDï¼‰ è¯»å–å¤–éƒ¨æ•°æ®æºï¼ˆè¯»æ–‡ä»¶ï¼‰ å¹¶è¡ŒåŒ–åˆ›å»º123# arg1: é›†åˆå¯¹è±¡ï¼Œå¦‚ï¼šlist# arg2ï¼šå¯é€‰ï¼ŒæŒ‡å®šåˆ†åŒºæ•°é‡rdd = SparkContext.parallelize(arg1, arg2) è¯»å–æ–‡ä»¶é€šè¿‡textFile APIæ¥è¯»å–æœ¬åœ°æˆ–è€…hdfsçš„æ•°æ® 1234# arg1: æ–‡ä»¶è·¯å¾„# arg2ï¼šå¯é€‰ï¼Œæœ€å°åˆ†åŒºæ•°é‡# å½“arg2è¶…å‡ºsparkå…è®¸èŒƒå›´ï¼Œå‚æ•°å¤±æ•ˆSparkContext.textFile(arg1, arg2) é€šè¿‡wholeTextFile APIæ¥è¯»å–å°æ–‡ä»¶ï¼Œè¿™ä¸ªapiåå‘äºå°‘é‡åˆ†åŒºè¯»å–æ•°æ®ï¼Œæ˜¯pysparkåŸºäºå°æ–‡ä»¶çš„ä¼˜åŒ– 1234# arg1ï¼šæ–‡ä»¶è·¯å¾„# arg2ï¼šå¯é€‰ï¼Œæœ€å°åˆ†åŒºæ•°é‡# å½“arg2è¶…å‡ºsparkå…è®¸èŒƒå›´ï¼Œå‚æ•°å¤±æ•ˆSparkContext.wholeTextFiles(arg1, arg2)","text":"RDDRDDï¼ˆResilient Distributed Datasetï¼‰å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼Œæ˜¯sparkä¸­æœ€åŸºæœ¬çš„æ•°æ®æŠ½è±¡ï¼Œä»£è¡¨ä¸€ä¸ªä¸å¯å˜ã€å¯åˆ†åŒºã€å…¶ä¸­å…ƒç´ å¯å¹¶è¡Œè®¡ç®—çš„é›†åˆ Resilientï¼šRDDä¸­çš„æ•°æ®å¯å­˜å‚¨å†å†…å­˜æˆ–ç£ç›˜ä¸­ Distributedï¼šåˆ†å¸ƒå¼å­˜å‚¨æ•°æ®ï¼ˆè·¨æœºå™¨/è·¨è¿›ç¨‹ï¼‰ï¼Œç”¨äºåˆ†å¸ƒå¼è®¡ç®— Datasetï¼šä¸€ä¸ªç”¨äºå­˜æ”¾æ•°æ®çš„æ•°æ®é›†åˆ ç‰¹æ€§åˆ†åŒºRDDåˆ†åŒºæ˜¯RDDæ•°æ®å­˜å‚¨çš„æœ€å°å•ä½ï¼Œä¸€ä»½RDDæ•°æ®æœ¬è´¨ä¸Šåˆ†éš”æˆäº†å¤šä¸ªåˆ†åŒº 123# å­˜å‚¨9ä¸ªæ•°å­—ï¼Œè®¾ç«‹ä¸‰ä¸ªåˆ†åŒºrdd = sc.parallelize([1, 2, 3, 4, 5, 6, 7, 8, 9], 3)rdd.glom().collect() 1[[1,2,3],[4,5,6],[7,8,9]] RDDæ–¹æ³•ä¼šä½œç”¨åœ¨å…¶æ‰€æœ‰æ–¹æ³•ä¸Š1rdd.map(lambda x: x * 10).collect() 1[10,20,30,40,50,60,70,80,90] RDDä¹‹é—´å…·æœ‰ä¾èµ–å…³ç³»123456sc = SparkContext(conf=conf)rdd1 = sc.textFile(\"../test.text\")rdd2 = rdd1.flatMap(lambda x: x.split(' '))rdd3 = rdd2.map(lambda x: (x, 1))rdd4 = rdd3.reduceByKey(lambda a, b: a+b)print(rdd4.collect()) Key-Valueå‹RDDå¯ä»¥æœ‰åˆ†åŒºå™¨KVå‹RDDï¼šRDDå†…å­˜å‚¨çš„æ•°æ®æ˜¯åªæœ‰ä¸¤ä¸ªå…ƒç´ çš„äºŒå…ƒå…ƒç»„ é»˜è®¤åˆ†åŒºå™¨ï¼šHashåˆ†åŒºè§„åˆ™ï¼Œä¹Ÿå¯æ‰‹åŠ¨è®¾ç½®åˆ†åŒºå™¨ï¼šrdd.partitionBy()æ–¹æ³• æ³¨ï¼šä¸æ˜¯æ‰€æœ‰RDDéƒ½æ˜¯KVå‹ RDDçš„åˆ†åŒºè§„åˆ’ï¼šä¼šå°½é‡é è¿‘æ•°æ®æ‰€åœ¨çš„æœåŠ¡å™¨åœ¨åˆå§‹RDDè¯»å–æ•°æ®è§„åˆ’é˜¶æ®µï¼Œåˆ†åŒºä¼šå°½é‡è§„åˆ’åˆ°å­˜å‚¨æ•°æ®æ‰€åœ¨æœåŠ¡å™¨ï¼Œç›´æ¥è¯»å–æœ¬åœ°æ•°æ®ï¼Œé¿å…ä»ç½‘ç»œè¯»å–æ•°æ® Sparkä¼šåœ¨ç¡®ä¿å¹¶è¡Œè®¡ç®—èƒ½åŠ›çš„å‰æä¸‹ï¼Œå°½é‡ç¡®ä¿æœ¬åœ°è¯»å– RDDåˆ›å»º é€šè¿‡å¹¶è¡ŒåŒ–é›†åˆåˆ›å»ºï¼ˆæœ¬åœ°å¯¹è±¡è½¬åŒ–ä¸ºåˆ†å¸ƒå¼RDDï¼‰ è¯»å–å¤–éƒ¨æ•°æ®æºï¼ˆè¯»æ–‡ä»¶ï¼‰ å¹¶è¡ŒåŒ–åˆ›å»º123# arg1: é›†åˆå¯¹è±¡ï¼Œå¦‚ï¼šlist# arg2ï¼šå¯é€‰ï¼ŒæŒ‡å®šåˆ†åŒºæ•°é‡rdd = SparkContext.parallelize(arg1, arg2) è¯»å–æ–‡ä»¶é€šè¿‡textFile APIæ¥è¯»å–æœ¬åœ°æˆ–è€…hdfsçš„æ•°æ® 1234# arg1: æ–‡ä»¶è·¯å¾„# arg2ï¼šå¯é€‰ï¼Œæœ€å°åˆ†åŒºæ•°é‡# å½“arg2è¶…å‡ºsparkå…è®¸èŒƒå›´ï¼Œå‚æ•°å¤±æ•ˆSparkContext.textFile(arg1, arg2) é€šè¿‡wholeTextFile APIæ¥è¯»å–å°æ–‡ä»¶ï¼Œè¿™ä¸ªapiåå‘äºå°‘é‡åˆ†åŒºè¯»å–æ•°æ®ï¼Œæ˜¯pysparkåŸºäºå°æ–‡ä»¶çš„ä¼˜åŒ– 1234# arg1ï¼šæ–‡ä»¶è·¯å¾„# arg2ï¼šå¯é€‰ï¼Œæœ€å°åˆ†åŒºæ•°é‡# å½“arg2è¶…å‡ºsparkå…è®¸èŒƒå›´ï¼Œå‚æ•°å¤±æ•ˆSparkContext.wholeTextFiles(arg1, arg2) RDDç®—å­æ–¹æ³•ã€å‡½æ•°ï¼šæœ¬åœ°å¯¹è±¡çš„API ç®—å­ï¼šåˆ†å¸ƒå¼é›†åˆå¯¹è±¡çš„API RDDçš„ç®—å­åˆ†ä¸ºä¸¤ç±»ï¼š Transformationï¼šè½¬æ¢ç®—å­ è¿”å›å€¼ä»æ—§æ˜¯RDDçš„ç®—å­ï¼Œæ„å»ºæ‰§è¡Œè®¡åˆ’ Actionï¼šè¡ŒåŠ¨ç®—å­ è¿”å›å€¼ä¸å†æ˜¯RDDï¼Œä½¿æ‰§è¡Œè®¡åˆ’å¼€å§‹å·¥ä½œ Transformationç®—å­mapå°†RDDçš„æ•°æ®ä¸€æ¡æ¡å¤„ç†ï¼ˆå¤„ç†é€»è¾‘åŸºäºmapç®—å­æ¥æ”¶çš„å¤„ç†å‡½æ•°ï¼‰ï¼Œè¿”å›æ–°çš„RDD 1rdd.map(func) e.g. 12345678910111213from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"TEST\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([1, 2, 3, 4, 5, 6], 3)def add(data): return data * 10print(rdd.map(add).collect()) 1[10, 20, 30, 40, 50, 60] flatMapå¯¹RDDæ‰§è¡Œmapæ“ä½œï¼Œæ¥ç€è¿›è¡Œè§£é™¤åµŒå¥—ï¼š 1234# åµŒå¥—lst = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]# è§£é™¤åµŒå¥—lst = [1, 2, 3, 4, 5, 6, 7, 8, 9] e.g. 123456789from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([\"hadoop spark hadoop\", \"spark hadoop hadoop\", \"hadoop flink spark\"])# å¾—åˆ°æ‰€æœ‰çš„å•è¯, ç»„æˆRDD, flatMapçš„ä¼ å…¥å‚æ•° å’Œmapä¸€è‡´, å°±æ˜¯ç»™mapé€»è¾‘ç”¨çš„, è§£é™¤åµŒå¥—æ— éœ€é€»è¾‘(ä¼ å‚)rdd2 = rdd.flatMap(lambda line: line.split(\" \"))print(rdd2.collect()) 1[&apos;hadoop&apos;, &apos;spark&apos;, &apos;hadoop&apos;, &apos;spark&apos;, &apos;hadoop&apos;, &apos;hadoop&apos;, &apos;hadoop&apos;, &apos;flink&apos;, &apos;spark&apos;] reduceByKeyé’ˆå¯¹KVå‹RDDè‡ªåŠ¨æŒ‰ç…§keyè¿›è¡Œåˆ†ç»„ï¼Œç„¶åæ ¹æ®æä¾›çš„èšåˆé€»è¾‘å®Œæˆç»„å†…æ•°æ®ï¼ˆvalueï¼‰èšåˆæ“ä½œ 12# æ¥å—ä¸¤ä¸ªç±»å‹ä¸€è‡´çš„ä¼ å…¥å‚æ•°ï¼Œè¿”å›èšåˆå€¼rdd.reduceByKey(func) e.g. 123456789from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([('a', 1), ('a', 1), ('b', 1), ('b', 1), ('a', 1)])# reduceByKey å¯¹ç›¸åŒkey çš„æ•°æ®æ‰§è¡Œèšåˆç›¸åŠ print(rdd.reduceByKey(lambda a, b: a + b).collect()) 1[(&apos;b&apos;, 2), (&apos;a&apos;, 3)] mapValuesé’ˆå¯¹äºŒå…ƒå…ƒç»„RDDï¼Œå¯¹å…¶å†…éƒ¨çš„äºŒå…ƒå…ƒç»„valueå€¼è¿›è¡Œmap 12# ä¼ å…¥äºŒå…ƒå…ƒç»„çš„valueå€¼ï¼Œfuncåªå¯¹valueè¿›è¡Œå¤„ç†rdd.mapValues(func) e.g. 123456789from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([('a', 1), ('a', 1), ('b', 1), ('b', 1), ('a', 1)])# reduceByKey å¯¹ç›¸åŒkey çš„æ•°æ®æ‰§è¡Œèšåˆç›¸åŠ print(rdd.mapValues(lambda x: x * 10).collect()) 1[(&apos;a&apos;, 10), (&apos;a&apos;, 10), (&apos;b&apos;, 10), (&apos;b&apos;, 10), (&apos;a&apos;, 10)] groupByå°†RDDçš„æ•°æ®è¿›è¡Œåˆ†ç»„ 123# funcè¦æ±‚ä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå€¼ï¼Œç±»å‹ä¸åšè¦æ±‚ã€‚ç›¸åŒçš„è¿”å›å€¼å°†è¢«æ”¾å…¥åŒä¸€ä¸ªç»„ä¸­ã€‚# åˆ†ç»„å®Œæˆåï¼Œæ¯ä¸€ä¸ªç»„æ˜¯ä¸€ä¸ªäºŒå…ƒå…ƒç»„ï¼Œkeyå°±æ˜¯è¿”å›å€¼ï¼Œæ‰€æœ‰åŒç»„æ•°æ®æ”¾å…¥ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ä¸­ä½œä¸ºvaluerdd.groupBy(func) e.g. 123456789101112from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([('a', 1), ('a', 1), ('b', 1), ('b', 2), ('b', 3)])# é€šè¿‡groupByå¯¹æ•°æ®è¿›è¡Œåˆ†ç»„# groupByä¼ å…¥çš„å‡½æ•°çš„ æ„æ€æ˜¯: é€šè¿‡è¿™ä¸ªå‡½æ•°, ç¡®å®šæŒ‰ç…§è°æ¥åˆ†ç»„(è¿”å›è°å³å¯)# åˆ†ç»„è§„åˆ™ å’ŒSQLæ˜¯ä¸€è‡´çš„, ä¹Ÿå°±æ˜¯ç›¸åŒçš„åœ¨ä¸€ä¸ªç»„(Hashåˆ†ç»„)result = rdd.groupBy(lambda t: t[0])print(result.map(lambda t:(t[0], list(t[1]))).collect()) 1[(&apos;b&apos;, [(&apos;b&apos;, 1), (&apos;b&apos;, 2), (&apos;b&apos;, 3)]), (&apos;a&apos;, [(&apos;a&apos;, 1), (&apos;a&apos;, 1)])] Filterè¿‡æ»¤æ•°æ® 12# funcè¿”å›å€¼ä¸ºTrueçš„å‚æ•°ä¿ç•™ï¼ŒFalseä¸¢å¼ƒrdd.filter(func) e.g. 1234567891011from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([1, 2, 3, 4, 5, 6])# é€šè¿‡Filterç®—å­, è¿‡æ»¤å¥‡æ•°result = rdd.filter(lambda x: x % 2 == 1)print(result.collect()) 1[1, 3, 5] distinctå¯¹RDDæ•°æ®è¿›è¡Œå»é‡ 12# argï¼šå»é‡åˆ†åŒºæ•°é‡ï¼Œä¸€èˆ¬çœç•¥rdd.distinct(arg) e.g. 123456789101112from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([1, 1, 1, 2, 2, 2, 3, 3, 3])# distinct è¿›è¡ŒRDDæ•°æ®å»é‡æ“ä½œprint(rdd.distinct().collect())rdd2 = sc.parallelize([('a', 1), ('a', 1), ('a', 3)])print(rdd2.distinct().collect()) 12[2, 1, 3][(&apos;a&apos;, 1), (&apos;a&apos;, 3)] unionå°†ä¸¤ä¸ªRDDåˆå¹¶æˆä¸€ä¸ªRDDè¿”å› 123# ä»…åˆå¹¶ï¼Œä¸ä¼šå»é‡# å¯ä»¥åˆå¹¶ä¸åŒç±»å‹çš„RDDrdd.union(other_rdd) e.g. 12345678910from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd1 = sc.parallelize([1, 1, 3, 3])rdd2 = sc.parallelize([\"a\", \"b\", \"a\"])rdd3 = rdd1.union(rdd2)print(rdd3.collect()) 1[1, 1, 3, 3, &apos;a&apos;, &apos;b&apos;, &apos;a&apos;] joinå¯¹ä¸¤ä¸ªRDDæ‰§è¡ŒJOINæ“ä½œï¼ˆå¯å®ç°SQLçš„å†…/å¤–è¿æ¥ï¼‰ 1234# jionç®—å­åªèƒ½ç”¨äºäºŒå…ƒå…ƒç»„rdd.join(other_rdd) # å†…è¿æ¥rdd.leftOuterJoin(other_rdd) # å·¦å¤–è¿æ¥rdd.rightOuterJoin(other_rdd) # å³å¤–è¿æ¥ e.g. 1234567891011121314from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd1 = sc.parallelize([ (1001, \"zhangsan\"), (1002, \"lisi\"), (1003, \"wangwu\"), (1004, \"zhaoliu\") ])rdd2 = sc.parallelize([ (1001, \"é”€å”®éƒ¨\"), (1002, \"ç§‘æŠ€éƒ¨\")])# é€šè¿‡joinç®—å­æ¥è¿›è¡Œrddä¹‹é—´çš„å…³è”# å¯¹äºjoinç®—å­æ¥è¯´ å…³è”æ¡ä»¶ æŒ‰ç…§äºŒå…ƒå…ƒç»„çš„keyæ¥è¿›è¡Œå…³è”print(rdd1.join(rdd2).collect())# å·¦å¤–è¿æ¥, å³å¤–è¿æ¥ å¯ä»¥æ›´æ¢ä¸€ä¸‹rddçš„é¡ºåº æˆ–è€…è°ƒç”¨rightOuterJoinå³å¯print(rdd1.leftOuterJoin(rdd2).collect()) 12[(1001, (&apos;zhangsan&apos;, &apos;é”€å”®éƒ¨&apos;)), (1002, (&apos;lisi&apos;, &apos;ç§‘æŠ€éƒ¨&apos;))][(1004, (&apos;zhaoliu&apos;, None)), (1001, (&apos;zhangsan&apos;, &apos;é”€å”®éƒ¨&apos;)), (1002, (&apos;lisi&apos;, &apos;ç§‘æŠ€éƒ¨&apos;)), (1003, (&apos;wangwu&apos;, None))] intersectionæ±‚ä¸¤ä¸ªRDDçš„äº¤é›†ï¼Œè¿”å›ä¸€ä¸ªæ–°RDD 1rdd.intersection(other_rdd) e.g. 123456789101112from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd1 = sc.parallelize([('a', 1), ('a', 3)])rdd2 = sc.parallelize([('a', 1), ('b', 3)])# é€šè¿‡intersectionç®—å­æ±‚RDDä¹‹é—´çš„äº¤é›†, å°†äº¤é›†å–å‡º è¿”å›æ–°RDDrdd3 = rdd1.intersection(rdd2)print(rdd3.collect()) 1[(&apos;a&apos;, 1)] glomå°†RDDçš„æ•°æ®æŒ‰ç…§åˆ†åŒºåŠ ä¸ŠåµŒå¥— ä¾‹å¦‚RDDæ•°æ®[1,2,3,4,5]æœ‰ä¸¤ä¸ªåˆ†åŒºï¼Œç»è¿‡glomå¤„ç†åå˜æˆï¼š[[1,2,3]],[4,5]] 1rdd.glom() e.g. 123456789from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([1, 2, 3, 4, 5, 6, 7, 8, 9], 2)print(rdd.glom().collect())print(rdd.glom().flatMap(lambda x: x).collect()) # tipsï¼šè§£åµŒå¥— 12[[1, 2, 3, 4], [5, 6, 7, 8, 9]][1, 2, 3, 4, 5, 6, 7, 8, 9] groupByKeyé’ˆå¯¹KVå‹RDDè‡ªåŠ¨æŒ‰keyåˆ†ç»„ 1rdd.groupByKey() e.g. 12345678910from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([('a', 1), ('a', 1), ('b', 1), ('b', 1), ('b', 1)])rdd2 = rdd.groupByKey()print(rdd2.map(lambda x: (x[0], list(x[1]))).collect()) 1[(&apos;b&apos;, [1, 1, 1]), (&apos;a&apos;, [1, 1])] sortByåŸºäºæŒ‡å®šçš„æ’åºå‡½æ•°å¯¹RDDæ•°æ®è¿›è¡Œæ’åº 123# ascendingï¼šTrue-å‡åºï¼ŒFalse-é™åº# numPartitionsï¼šç”¨äºæ’åºçš„åˆ†åŒºæ•°é‡ï¼Œè¦è¿›è¡Œå…¨å±€æ’åºï¼Œè®¾ç½®ä¸º1rdd.sortBy(func, ascending=False, numPartitions=1) e.g. 123456789101112131415161718from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([('c', 3), ('f', 1), ('b', 11), ('c', 3), ('a', 1), ('c', 5), ('e', 1), ('n', 9), ('a', 1)], 3)# ä½¿ç”¨sortByå¯¹rddæ‰§è¡Œæ’åº# æŒ‰ç…§value æ•°å­—è¿›è¡Œæ’åº# å‚æ•°1å‡½æ•°ï¼Œå‘ŠçŸ¥Spark æŒ‰ç…§æ•°æ®çš„å“ªä¸ªåˆ—è¿›è¡Œæ’åº# å‚æ•°2: Trueè¡¨ç¤ºå‡åº Falseè¡¨ç¤ºé™åº# å‚æ•°3: æ’åºçš„åˆ†åŒºæ•°\"\"\"æ³¨æ„: å¦‚æœè¦å…¨å±€æœ‰åº, æ’åºåˆ†åŒºæ•°éœ€è®¾ç½®ä¸º1\"\"\"print(rdd.sortBy(lambda x: x[1], ascending=True, numPartitions=1).collect())# æŒ‰ç…§keyæ¥è¿›è¡Œæ’åºprint(rdd.sortBy(lambda x: x[0], ascending=False, numPartitions=1).collect()) 12[(&apos;f&apos;, 1), (&apos;a&apos;, 1), (&apos;e&apos;, 1), (&apos;a&apos;, 1), (&apos;c&apos;, 3), (&apos;c&apos;, 3), (&apos;c&apos;, 5), (&apos;n&apos;, 9), (&apos;b&apos;, 11)][(&apos;n&apos;, 9), (&apos;f&apos;, 1), (&apos;e&apos;, 1), (&apos;c&apos;, 3), (&apos;c&apos;, 3), (&apos;c&apos;, 5), (&apos;b&apos;, 11), (&apos;a&apos;, 1), (&apos;a&apos;, 1)] sortByKeyé’ˆå¯¹KVå‹RDDæŒ‰ç…§keyè¿›è¡Œæ’åº 1234# ascendingï¼šTrue-å‡åºï¼ŒFalse-é™åº# numPartitionsï¼šç”¨äºæ’åºçš„åˆ†åŒºæ•°é‡ï¼Œè¦è¿›è¡Œå…¨å±€æ’åºï¼Œè®¾ç½®ä¸º1# keyfuncï¼šåœ¨æ’åºå‰å¯¹keyè¿›è¡Œçš„å¤„ç†rdd.sortByKey(ascending=True, numPartitions=None, keyfunc=&lt;function RDD.&lt;lambda&gt;&gt;) e.g. 12345678910from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([('a', 1), ('E', 1), ('C', 1), ('D', 1), ('b', 1), ('g', 1), ('f', 1), ('y', 1), ('u', 1), ('i', 1), ('o', 1), ('p', 1), ('m', 1), ('n', 1), ('j', 1), ('k', 1), ('l', 1)], 3)print(rdd.sortByKey(ascending=True, numPartitions=1, keyfunc=lambda key: str(key).lower()).collect()) 1[(&apos;a&apos;, 1), (&apos;b&apos;, 1), (&apos;C&apos;, 1), (&apos;D&apos;, 1), (&apos;E&apos;, 1), (&apos;f&apos;, 1), (&apos;g&apos;, 1), (&apos;i&apos;, 1), (&apos;j&apos;, 1), (&apos;k&apos;, 1), (&apos;l&apos;, 1), (&apos;m&apos;, 1), (&apos;n&apos;, 1), (&apos;o&apos;, 1), (&apos;p&apos;, 1), (&apos;u&apos;, 1), (&apos;y&apos;, 1)] repartition &amp; coalesceå¯¹RDDçš„åˆ†åŒºæ‰§è¡Œé‡æ–°åˆ†åŒºï¼ˆä»…æ•°é‡ï¼‰ æ³¨ï¼šå°½é‡é¿å…ä½¿ç”¨ï¼Œå½±å“å¹¶è¡Œè®¡ç®—æ€§èƒ½ã€‚åœ¨åˆå¹¶åˆ°1ä¸ªåˆ†åŒºè¿›è¡Œå…¨å±€æ’åºç­‰åœºæ™¯ä¸‹ä½¿ç”¨ï¼Œå°½å¯èƒ½é¿å…å¢åŠ åˆ†åŒºï¼Œå¯èƒ½ç ´åå†…å­˜è¿­ä»£çš„è®¡ç®—ç®¡é“ 1234# nï¼šå†³å®šæ–°çš„åˆ†åŒºæ•°é‡# coalesceä¸­å¢åŠ åˆ†åŒºå¿…é¡»æŒ‡å®šshuffle=Truerdd.repartition(n)rdd.coalesce(n, shuffle) e.g. 12345678910111213141516from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([1, 2, 3, 4, 5], 3)# repartition ä¿®æ”¹åˆ†åŒºprint(rdd.repartition(1).getNumPartitions())print(rdd.repartition(5).getNumPartitions())# coalesce ä¿®æ”¹åˆ†åŒºprint(rdd.coalesce(1).getNumPartitions())print(rdd.coalesce(5, shuffle=True).getNumPartitions()) 12341515 Actionç®—å­countByKeyç”¨äºç»Ÿè®¡keyå‡ºç°çš„æ¬¡æ•°ï¼ˆä¸€èˆ¬é€‚ç”¨äºKVå‹RDDï¼‰ 1rdd.countByKey() e.g. 12345678910111213from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.textFile(\"hdfs://master:8020/input/words.txt\")rdd2 = rdd.flatMap(lambda x: x.split(\" \")).map(lambda x: (x, 1))# é€šè¿‡countByKeyæ¥å¯¹keyè¿›è¡Œè®¡æ•°, è¿™æ˜¯ä¸€ä¸ªActionç®—å­result = rdd2.countByKey()print(result)print(type(result)) 12defaultdict(&lt;class &apos;int&apos;&gt;, &#123;&apos;hadoop&apos;: 7, &apos;spark&apos;: 5, &apos;flink&apos;: 3&#125;)&lt;class &apos;collections.defaultdict&apos;&gt; collectå°†RDDå„ä¸ªåˆ†åŒºå†…çš„æ•°æ®ç»Ÿä¸€æ”¶é›†åˆ°Driverä¸­ï¼Œå½¢æˆä¸€ä¸ªlistå¯¹è±¡ 1rdd.collect() æ³¨ï¼šæ•°æ®é›†å¤§å°ä¸èƒ½è¶…è¿‡Driverå†…å­˜ reduceå¯¹RDDæ•°æ®é›†æŒ‰ç…§funcé€»è¾‘è¿›è¡Œèšåˆ 12# å¯¹funcï¼šä¼ å…¥2ä¸ªå‚æ•°å¾—åˆ°1ä¸ªè¿”å›å€¼ï¼Œè¦æ±‚è¿”å›å€¼å’Œå‚æ•°çš„ç±»å‹ä¿æŒä¸€è‡´rdd.reduce(func) e.g. 12345678from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([1, 2, 3, 4, 5])print(rdd.reduce(lambda a, b: a + b)) 115 foldåŒreduceï¼Œæ¥å—ä¼ å…¥é€»è¾‘è¿›è¡Œèšåˆï¼Œä½†æ˜¯èšåˆæ˜¯å¸¦æœ‰åˆå§‹å€¼çš„ã€‚è¿™ä¸ªåˆå§‹å€¼çš„èšåˆä½œç”¨åœ¨ï¼š åˆ†åŒºå†…èšåˆ åˆ†åŒºé—´èšåˆ ä¾‹å¦‚ï¼š[[1, 2, 3], [4, 5, 6], [7, 8, 9]] æ•°æ®åˆ†å¸ƒåœ¨ä¸‰ä¸ªåˆ†åŒºä¸Š åˆ†åŒº1ï¼š123èšåˆæ—¶å¸¦ä¸Š10ä½œä¸ºåˆå§‹å€¼å¾—åˆ°16 åˆ†åŒº2ï¼š456èšåˆæ—¶å¸¦ä¸Š10ä½œä¸ºåˆå§‹å€¼å¾—åˆ°25 åˆ†åŒº3ï¼š789èšåˆæ—¶å¸¦ä¸Š10ä½œä¸ºåˆå§‹å€¼å¾—åˆ°34 æœ€åå†åš3ä¸ªåˆ†åŒºé—´çš„èšåˆï¼š16+25+34å¾—åˆ°85 1rdd.fold(src, func) e.g. 12345678from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([1, 2, 3, 4, 5, 6, 7, 8, 9], 3)print(rdd.fold(10, lambda a, b: a + b)) 185 firstÂ·takeÂ·countÂ·topfirst å–å‡ºRDDçš„ç¬¬ä¸€ä¸ªå…ƒç´  12&gt;&gt;&gt;sc.parallelize([3, 2, 1]).first()3 take å–å‡ºRDDçš„å‰nä¸ªå…ƒç´ ï¼Œç»„åˆæˆlistè¿”å› 12&gt;&gt;&gt;sc.parallelize([1, 2, 3, 4, 5, 6]).take(5)[1, 2, 3, 4, 5] count è®¡ç®—RDDæœ‰å¤šå°‘æ¡æ•°æ®ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªæ•°å­— 12&gt;&gt;&gt;sc.parallelize([3, 2, 1, 4, 5, 6]).count()6 top å¯¹RDDæ•°æ®é›†è¿›è¡Œé™åºæ’åºï¼Œå–ç»“æœå‰nä¸ª 12&gt;&gt;&gt;sc.parallelize([3, 2, 1, 4, 5, 6]).top(3)[6, 5, 4] takeSampleéšæœºæŠ½æ ·RDDæ•°æ®ï¼Œå¯ç”¨äºæ•°æ®æ£€æŸ¥ 1234# arg1ï¼šTrueè¡¨ç¤ºè¿è¡Œå–åŒä¸€ä¸ªæ•°æ®ï¼ŒFalseè¡¨ç¤ºä¸å…è®¸å–åŒä¸€ä¸ªæ•°æ®ï¼ˆå’Œæ•°æ®å†…å®¹æ— å…³ï¼Œæ˜¯å¦é‡å¤è¡¨ç¤ºçš„æ˜¯åŒä¸€ä¸ªä½ç½®çš„æ•°æ®ï¼‰# arg2ï¼šæŠ½æ ·æ•°ç›®# arg3ï¼šå¯é€‰ï¼Œéšæœºæ•°ç§å­ï¼Œéšæ„ä¼ è¿›ä¸€ä¸ªæ•°å­—takeSample(arg1ï¼šTrue/False, arg2:é‡‡æ ·æ•°, arg3:éšæœºæ•°ç§å­) e.g. 12345678from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([1, 3, 5, 3, 1, 3, 2, 6, 7, 8, 6], 1)print(rdd.takeSample(False, 5, 1)) 1[2, 7, 6, 6, 3] takeOrderedå¯¹RDDè¿›è¡Œæ’åºï¼Œå–ç»“æœå‰nä¸ª 123# arg1ï¼šéœ€è¦å‡ ä¸ªæ•°æ®# arg2ï¼šå¯¹æ’åºçš„æ•°æ®è¿›è¡Œæ›´æ”¹ï¼ˆä¸ä¼šæ›´æ”¹æ•°æ®æœ¬èº«ï¼Œä»…åœ¨æ’åºæ—¶ä½¿ç”¨ï¼‰rdd.takeOrdered(arg1, arg2) e.g. 12345678910from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([1, 3, 2, 4, 7, 9, 6], 1)print(rdd.takeOrdered(3))print(rdd.takeOrdered(3, lambda x: -x)) 12[1, 2, 3][9, 7, 6] foreachå¯¹RDDçš„æ¯ä¸€ä¸ªå…ƒç´ æ‰§è¡Œæä¾›çš„é€»è¾‘æ“ä½œï¼ˆåŒmapï¼‰ï¼Œæ— è¿”å›å€¼ 1rdd.foreach(func) e.g. 12345678from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([1, 3, 2, 4, 7, 9, 6], 1)result = rdd.foreach(lambda x: print(x * 10)) 123456710302040709060 ç‰¹æ€§ï¼šç”±Executorç›´æ¥è¾“å‡º saveAsTextFileå°†RDDæ•°æ®å†™å…¥æ–‡æœ¬æ–‡ä»¶ æ”¯æŒï¼šæœ¬åœ°å†™å‡ºæˆ–hdfsç­‰æ–‡ä»¶ç³»ç»Ÿ 1rdd.saveAsTextFile() e.g. 12345678from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([1, 3, 2, 4, 7, 9, 6], 3)rdd.saveAsTextFile(\"hdfs://master:8020/output/out_test1\") 12hadoop fs -ls /output/out_test1hadoop fs -cat /output/out_test1/* 12345Found 4 items-rw-r--r-- 3 root supergroup 0 2022-12-06 17:44 /output/out_test1/_SUCCESS-rw-r--r-- 3 root supergroup 4 2022-12-06 17:44 /output/out_test1/part-00000-rw-r--r-- 3 root supergroup 4 2022-12-06 17:44 /output/out_test1/part-00001-rw-r--r-- 3 root supergroup 6 2022-12-06 17:44 /output/out_test1/part-00002 12345671324796 ç‰¹æ€§ï¼šç”±Executorç›´æ¥å†™å…¥æ–‡ä»¶ mapPartitionsä¸åŒäºmapæ¯æ¬¡æ“ä½œä¸€ä¸ªåˆ†åŒºçš„å•ä¸€å¯¹è±¡ï¼ŒmapPartitionsä¸€æ¬¡æ“ä½œä¸€æ•´ä¸ªåˆ†åŒºçš„æ•°æ®ï¼Œä½œä¸ºä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ä¼ å…¥è¿›æ¥ 1rdd.mapPartitions(func) e.g. 1234567891011121314151617from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([1, 3, 2, 4, 7, 9, 6], 3)def process(iter): result = list() for it in iter: result.append(it * 10) return result print(rdd.mapPartitions(process).collect()) 1[10, 20, 70] foreachPartitionå’Œforeachä¸€è‡´ï¼Œforeachä¸€æ¡æ¡å¤„ç†ï¼Œè€ŒforeachPartitionä¸€æ¬¡å¤„ç†ä¸€æ•´ä¸ªåˆ†åŒºçš„æ•°æ®ï¼Œç±»ä¼¼äºæ²¡æœ‰è¿”å›å€¼çš„mapPartitions 1rdd.foreachPartition(func) e.g. 1234567891011121314151617from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([1, 3, 2, 4, 7, 9, 6], 3)def process(iter): result = list() for it in iter: result.append(it * 10) print(result)rdd.foreachPartition(process) 1234567[20][20, 40][10][10, 30][70][70, 90][70, 90, 60] partitionByå¯¹RDDè¿›è¡Œè‡ªå®šä¹‰åˆ†åŒºæ“ä½œ 123# arg1ï¼šé‡æ–°åˆ†åŒºåçš„åˆ†åŒºæ•°é‡# arg2ï¼šè‡ªå®šä¹‰åˆ†åŒºè§„åˆ™ï¼Œé€šè¿‡å‡½æ•°ä¼ å…¥ï¼Œå‡½æ•°è¿”å›å€¼å¿…é¡»ä½intå‹ï¼ˆåˆ†åŒºç¼–å·ä»0å¼€å§‹ï¼Œä¸å¾—è¶…è¿‡åˆ†åŒºæ•°-1ï¼‰rdd.partitionBy(arg1, arg2) e.g. 12345678910111213141516from pyspark import SparkConf, SparkContextconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd = sc.parallelize([('hadoop', 1), ('spark', 1), ('hello', 1), ('flink', 1), ('hadoop', 1), ('spark', 1)])# ä½¿ç”¨partitionBy è‡ªå®šä¹‰ åˆ†åŒºdef process(k): if 'hadoop' == k or 'hello' == k: return 0 if 'spark' == k: return 1 return 2print(rdd.partitionBy(3, process).glom().collect()) 1[[(&apos;hadoop&apos;, 1), (&apos;hello&apos;, 1), (&apos;hadoop&apos;, 1)], [(&apos;spark&apos;, 1), (&apos;spark&apos;, 1)], [(&apos;flink&apos;, 1)]] RDDçš„æ•°æ®æ˜¯è¿‡ç¨‹æ•°æ®RDDä¹‹é—´è¿›è¡Œç›¸äº’è¿­ä»£è®¡ç®—ï¼ˆTransformationçš„è½¬æ¢ï¼‰ï¼Œå½“æ‰§è¡Œå¼€å¯ä»¥åï¼Œæ–°RDDç”Ÿæˆï¼Œæ—§RDDæ¶ˆå¤±ã€‚æ‰€ä»¥RDDçš„æ•°æ®æ˜¯è¿‡ç¨‹æ•°æ®ï¼Œä»…åœ¨å¤„ç†çš„è¿‡ç¨‹ä¸­å­˜åœ¨ï¼Œä¸€æ—¦å¤„ç†å®Œæˆä¾¿ä¼šè¢«é‡Šæ”¾ï¼Œæ—¨åœ¨æœ€å¤§åŒ–çš„åˆç†åˆ©ç”¨ç³»ç»Ÿèµ„æº å½“RDDè¢«é‡Šæ”¾åéœ€è¦è¢«é‡æ–°ä½¿ç”¨ï¼Œä¼šä»å¤´å¼€å§‹æ‰§è¡Œ RDDç¼“å­˜é˜²æ­¢å½“RDDè¢«é‡Šæ”¾è€Œåˆè¦è¢«é‡æ–°è°ƒç”¨çš„æƒ…å†µä¸‹ï¼Œé¿å…ä»å¤´æ‰§è¡Œä»£ç ï¼Œä½¿ç”¨RDDç¼“å­˜API 12345678910rdd.cache() # ç¼“å­˜åˆ°å†…å­˜ä¸­rdd.persist(StorageLevel.MEMORY_ONLY) # ä»…åœ¨å†…å­˜ç¼“å­˜rdd.persist(StorageLevel.MEMORY_ONLY_2) # ä»…åœ¨å†…å­˜ç¼“å­˜ï¼Œç”Ÿæˆ2ä¸ªå‰¯æœ¬rdd.persist(StorageLevel.DISK_ONLY) # ä»…ç¼“å­˜åˆ°ç¡¬ç›˜rdd.persist(StorageLevel.DISK_ONLY_2) # ä»…ç¼“å­˜åˆ°ç¡¬ç›˜ï¼Œç”Ÿæˆ2ä¸ªå‰¯æœ¬rdd.persist(StorageLevel.DISK_ONLY_3) # ä»…ç¼“å­˜åˆ°ç¡¬ç›˜ï¼Œç”Ÿæˆ3ä¸ªå‰¯æœ¬rdd.persist(StorageLevel.MEMORY_AND_DISK) # å…ˆåœ¨å†…å­˜ç¼“å­˜ï¼Œå†…å­˜ä¸å¤Ÿç¼“å­˜åˆ°ç¡¬ç›˜rdd.persist(StorageLevel.MEMORY_AND_DISK_2) # å…ˆåœ¨å†…å­˜ç¼“å­˜ï¼Œå†…å­˜ä¸å¤Ÿç¼“å­˜åˆ°ç¡¬ç›˜ï¼Œç”Ÿæˆ2ä¸ªå‰¯æœ¬rdd.persist(StorageLevel.OFF_HEAP) # å †å¤–å†…å­˜rdd.unpersist() # ä¸»åŠ¨æ¸…ç†ç¼“å­˜ e.g. 1234567891011121314151617181920212223import timefrom pyspark import SparkConf, SparkContextfrom pyspark.storagelevel import StorageLevelconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)rdd1 = sc.textFile(\"hdfs://master:8020/input/words.txt\")rdd2 = rdd1.flatMap(lambda x: x.split(\" \"))rdd3 = rdd2.map(lambda x: (x, 1))rdd3.cache()rdd3.persist(StorageLevel.MEMORY_AND_DISK_2)rdd4 = rdd3.reduceByKey(lambda a, b: a + b)print(rdd4.collect())rdd5 = rdd3.groupByKey()rdd6 = rdd5.mapValues(lambda x: sum(x))print(rdd6.collect())rdd3.unpersist()time.sleep(100000) 12[(&apos;hadoop&apos;, 1), (&apos;hello&apos;, 3), (&apos;spark&apos;, 1), (&apos;flink&apos;, 1)][(&apos;hadoop&apos;, 1), (&apos;hello&apos;, 3), (&apos;spark&apos;, 1), (&apos;flink&apos;, 1)] æ³¨ï¼šç¼“å­˜åˆ†æ•£å­˜å‚¨åœ¨å„Executoræ‰€åœ¨æœåŠ¡å™¨ä¸­ã€‚ç¼“å­˜ä»è®¾è®¡ä¸Šæ¥è¯´æ˜¯ä¸å®‰å…¨çš„ï¼Œç¼“å­˜ä¸€æ—¦ä¸¢å¤±ï¼Œéœ€è¦é‡æ–°è®¡ç®—ç¼“å­˜ï¼Œå¿…é¡»ä¿ç•™è¢«ç¼“å­˜RDDçš„å‰ç½®è¡€ç¼˜å…³ç³» RDD CheckPointç”¨äºä¿å­˜RDDæ•°æ®ï¼Œä»…æ”¯æŒç¡¬ç›˜å­˜å‚¨ï¼Œä¸”å¯ä»¥å†™å…¥HDFSï¼ˆcacheä¸è¡Œï¼‰ï¼Œä»è®¾è®¡ä¸Šæ¥è¯´æ˜¯å®‰å…¨çš„ï¼Œä¸ä¿ç•™RDDçš„å‰ç½®è¡€ç¼˜å…³ç³» ChickPointé›†ä¸­æ”¶é›†å„ä¸ªåˆ†åŒºçš„æ•°æ®è¿›è¡Œå­˜å‚¨ï¼Œè€Œécacheçš„åˆ†æ•£å­˜å‚¨ e.g. 12345678910111213141516171819202122232425import timefrom pyspark import SparkConf, SparkContextfrom pyspark.storagelevel import StorageLevelconf = SparkConf().setAppName(\"test\").setMaster(\"local[*]\")sc = SparkContext(conf=conf)# 1. å‘ŠçŸ¥spark, å¼€å¯CheckPointåŠŸèƒ½sc.setCheckpointDir(\"hdfs://master:8020/output/ckp\")rdd1 = sc.textFile(\"hdfs://master:8020/input/words.txt\")rdd2 = rdd1.flatMap(lambda x: x.split(\" \"))rdd3 = rdd2.map(lambda x: (x, 1))# è°ƒç”¨checkpoint API ä¿å­˜æ•°æ®å³å¯rdd3.checkpoint()rdd4 = rdd3.reduceByKey(lambda a, b: a + b)print(rdd4.collect())rdd5 = rdd3.groupByKey()rdd6 = rdd5.mapValues(lambda x: sum(x))print(rdd6.collect())rdd3.unpersist()time.sleep(100000) 12[(&apos;hadoop&apos;, 1), (&apos;hello&apos;, 3), (&apos;spark&apos;, 1), (&apos;flink&apos;, 1)][(&apos;hadoop&apos;, 1), (&apos;hello&apos;, 3), (&apos;spark&apos;, 1), (&apos;flink&apos;, 1)]","categories":[{"name":"BigData","slug":"BigData","permalink":"http://yoursite.com/categories/BigData/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://yoursite.com/tags/spark/"},{"name":"pyspark","slug":"pyspark","permalink":"http://yoursite.com/tags/pyspark/"}]},{"title":"Pyspark","slug":"Pyspark","date":"2022-12-05T08:45:40.000Z","updated":"2022-12-07T05:47:29.586Z","comments":true,"path":"2022/12/05/Pyspark/","link":"","permalink":"http://yoursite.com/2022/12/05/Pyspark/","excerpt":"Pysparkåº“å®‰è£…ï¼ˆæœ¬æ–‡åŸºäºä¸Šæ–‡sparkåŸºç¡€ï¼‰ Pythonåº“å®‰è£…åœ¨ä¸‰å°æœºå™¨åˆ†åˆ«å®‰è£…pyspark 12conda activate pysparkpip install pyspark -i https://mirror.baidu.com/pypi/simple Windowsè¡¥ä¸å°†hadoop.dllç½®äºC:/windows/system32/ç›®å½•ä¸‹ï¼Œç„¶åé…ç½®hadoopå·¥å…·åŒ…çš„ç¯å¢ƒå˜é‡ å®‰è£…ç›¸å…³pythonåº“ 1pip install pyspark pyhive pymysql jieba -i https://mirror.baidu.com/pypi/simple ä¸ºpycharmæ·»åŠ sshè§£é‡Šå™¨ç¯å¢ƒ","text":"Pysparkåº“å®‰è£…ï¼ˆæœ¬æ–‡åŸºäºä¸Šæ–‡sparkåŸºç¡€ï¼‰ Pythonåº“å®‰è£…åœ¨ä¸‰å°æœºå™¨åˆ†åˆ«å®‰è£…pyspark 12conda activate pysparkpip install pyspark -i https://mirror.baidu.com/pypi/simple Windowsè¡¥ä¸å°†hadoop.dllç½®äºC:/windows/system32/ç›®å½•ä¸‹ï¼Œç„¶åé…ç½®hadoopå·¥å…·åŒ…çš„ç¯å¢ƒå˜é‡ å®‰è£…ç›¸å…³pythonåº“ 1pip install pyspark pyhive pymysql jieba -i https://mirror.baidu.com/pypi/simple ä¸ºpycharmæ·»åŠ sshè§£é‡Šå™¨ç¯å¢ƒ SparkContextå¯¹è±¡Spark Applicationç¨‹åºçš„å…¥å£ä¸ºSparkContextã€‚ä»»ä½•ä¸€ä¸ªsparkåº”ç”¨éƒ½è¦å…ˆæ„å»ºSparkContextå¯¹è±¡ï¼š åˆ›å»ºSparkConfå¯¹è±¡ åŸºäºSparkConfåˆ›å»ºSparkContext 12conf = SparkConf().setAppName(appName).setMaster(master)sc = SparkContext(conf=conf) WorldCountæµ‹è¯•ç¨‹åºWindowsåœ¨pycharmä¸­æ–°å»ºpythonè„šæœ¬ï¼Œé€šè¿‡è§£é‡Šå™¨æ‰§è¡Œ 1234567891011121314151617181920212223242526272829303132# coding:utf8from pyspark import SparkConf, SparkContext# æäº¤åˆ°yarné›†ç¾¤æ‰§è¡Œæ—¶ï¼Œéœ€é…ç½®ç¯å¢ƒå˜é‡# import os# os.environ[\"HADOOP_CONF_DIR\"] = \"/usr/local/hadoop/etc/hadoop\"# os.environ[\"YARN_CONF_DIR\"] = \"/usr/local/hadoop/etc/hadoop\"if __name__ == '__main__': # é€šè¿‡è„šæœ¬æ‰§è¡Œæ—¶æ— éœ€åœ¨ä»£ç ä¸­æŒ‡å®šMaster # conf = SparkConf().setAppName(\"WordCountHelloWorld\") # ç›´æ¥åœ¨pycharmæ‰§è¡Œ conf = SparkConf().setAppName(\"WordCountHelloWorld\").setMaster(\"local[*]\") # é€šè¿‡SparkConfå¯¹è±¡æ„å»ºSparkContextå¯¹è±¡ sc = SparkContext(conf=conf) # éœ€æ±‚ : wordcountå•è¯è®¡æ•°, è¯»å–HDFSä¸Šçš„words.txtæ–‡ä»¶, å¯¹å…¶å†…éƒ¨çš„å•è¯ç»Ÿè®¡å‡ºç° çš„æ•°é‡ # è¯»å–hdfsæ–‡ä»¶ file_rdd = sc.textFile(\"hdfs://master:8020/input/words.txt\") # è¯»å–æœ¬åœ°æ–‡ä»¶ # file_rdd = sc.textFile(\"/usr/local/words.txt\") # å°†å•è¯è¿›è¡Œåˆ‡å‰², å¾—åˆ°ä¸€ä¸ªå­˜å‚¨å…¨éƒ¨å•è¯çš„é›†åˆå¯¹è±¡ words_rdd = file_rdd.flatMap(lambda line: line.split(\" \")) # å°†å•è¯è½¬æ¢ä¸ºå…ƒç»„å¯¹è±¡, keyæ˜¯å•è¯, valueæ˜¯æ•°å­—1 words_with_one_rdd = words_rdd.map(lambda x: (x, 1)) # å°†å…ƒç»„çš„value æŒ‰ç…§keyæ¥åˆ†ç»„, å¯¹æ‰€æœ‰çš„valueæ‰§è¡Œèšåˆæ“ä½œ(ç›¸åŠ ) result_rdd = words_with_one_rdd.reduceByKey(lambda a, b: a + b) # é€šè¿‡collectæ–¹æ³•æ”¶é›†RDDçš„æ•°æ®æ‰“å°è¾“å‡ºç»“æœ print(result_rdd.collect()) CentOSåœ¨æ ¹ç›®å½•åˆ›å»ºä¸€ä»½pyè„šæœ¬ï¼Œé€šè¿‡sparkå®¢æˆ·ç«¯æ‰§è¡Œ 12/usr/local/spark/bin/spark-submit --master local[*] /root/helloworld.py/usr/local/spark/bin/spark-submit --master yarn /root/helloworld.py åŸºæœ¬åŸç†Codeæ„å»ºSparkContextå¯¹è±¡ç­‰éä»»åŠ¡å¤„ç†ç”±Driveræ‰§è¡Œï¼ŒRDDæ•°æ®ä»»åŠ¡å¤„ç†ç”±Executoræ‰§è¡Œï¼Œå†ç”±Driverå¤„ç†åˆ†å¸ƒå¼è®¡ç®—ç»“æœ Master Nodesparkè‡ªèº«çš„JVMæ¡†æ¶JVM Driverå’ŒJVM Executorä¹‹é—´å¯ä»¥ç›¸äº’é€šè®¯ï¼ŒPythoné€šè¿‡æ„å»ºSparkContextå¯¹è±¡ä¸JVM Driverè¿›è¡Œè¿æ¥ï¼ˆPythonçš„Driverä»£ç ç¿»è¯‘æˆJVMä»£ç -py4jåº“ï¼Œå˜æˆJVM Driverï¼‰ Worker NodeDriverçš„æ“ä½œæŒ‡ä»¤å‘é€ç»™JVM Executorï¼ˆRPCï¼‰ï¼ŒJVM Executorå†é€šè¿‡pysparkå®ˆæŠ¤è¿›ç¨‹å°†æŒ‡ä»¤å‘é€ç»™pysparkå®ˆæŠ¤è¿›ç¨‹ï¼Œpysparkå®ˆæŠ¤è¿›ç¨‹å°†æŒ‡ä»¤è°ƒåº¦åˆ°è¿è¡Œçš„pythonè¿›ç¨‹ä¸­å»ã€‚Executorç«¯æœ¬è´¨ä¸Šæ˜¯ç”±pythonè¿›ç¨‹å†å·¥ä½œ Driveræ®µæ˜¯ç›´æ¥ç”±py4jç›´æ¥ç¿»è¯‘è¿‡å»ï¼ŒExecutorç«¯åˆ™æ˜¯è½¬å‘","categories":[{"name":"BigData","slug":"BigData","permalink":"http://yoursite.com/categories/BigData/"}],"tags":[{"name":"spark","slug":"spark","permalink":"http://yoursite.com/tags/spark/"},{"name":"pyspark","slug":"pyspark","permalink":"http://yoursite.com/tags/pyspark/"}]},{"title":"SparkåŸºç¡€","slug":"SparkåŸºç¡€","date":"2022-12-01T07:40:17.000Z","updated":"2023-04-13T01:43:42.844Z","comments":true,"path":"2022/12/01/SparkåŸºç¡€/","link":"","permalink":"http://yoursite.com/2022/12/01/SparkåŸºç¡€/","excerpt":"å®šä¹‰ï¼šApache Sparkæ˜¯ç”¨äºå¤§è§„æ¨¡æ•°æ®å¤„ç†çš„ç»Ÿä¸€åˆ†æå¼•æ“ã€‚å…¶æ ¸å¿ƒæ•°æ®ç»“æ„ï¼šå¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼ˆRDDï¼‰èƒ½å¤Ÿåœ¨å¤§è§„æ¨¡é›†ç¾¤ä¸­åšå†…å­˜è¿ç®—ï¼Œä¸”å…·æœ‰ä¸€å®šå®¹é”™æ–¹å¼ã€‚ Sparkæ¡†æ¶ç»„æˆÂ· Spark Coreï¼šä»¥RDDä¸ºæ•°æ®æŠ½è±¡ï¼Œæä¾›Pythonã€Javaã€Scalaã€Rè¯­è¨€çš„APIå’ŒSparkçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œæ˜¯Sparkè¿è¡Œçš„åŸºç¡€ï¼› Â· SparkSQLï¼šåŸºäºSparkCoreï¼Œæä¾›æœºæ„åŒ–æ•°æ®å¤„ç†æ¨¡å—ï¼Œæ”¯æŒä»¥SQLè¯­è¨€å¯¹æ•°æ®è¿›è¡Œå¤„ç†ï¼›åŒæ—¶å¯ä»¥ä½œä¸ºStructuredStreamingæ¨¡å—çš„åŸºç¡€ï¼Œè¿›è¡Œæ•°æ®æµå¼è®¡ç®—ï¼› Â· SparkStreamingï¼šåŸºäºSparkCoreï¼Œæä¾›æ•°æ®æµå¼è®¡ç®—ï¼› Â· MLlibï¼šåŸºäºSparkCoreï¼Œå†…ç½®å¤§é‡æœºå™¨å­¦ä¹ åº“å’Œç®—æ³•APIï¼Œè¿›è¡Œæœºå™¨å­¦ä¹ è®¡ç®—ï¼› Â· GraphXï¼šåŸºäºSparkCoreï¼Œæä¾›äº†å¤§é‡å›¾è®¡ç®—APIï¼Œç”¨äºåˆ†å¸ƒå¼å›¾è®¡ç®— è¿è¡Œæ¨¡å¼Â· æœ¬åœ°æ¨¡å¼ï¼ˆå•æœº/localï¼‰ï¼šä»¥ä¸€ä¸ªç‹¬ç«‹è¿›ç¨‹ï¼Œé€šè¿‡å†…éƒ¨çš„å¤šçº¿ç¨‹æ¨¡æ‹ŸSparkè¿è¡Œç¯å¢ƒ Â· Standaloneæ¨¡å¼ï¼ˆé›†ç¾¤ï¼‰ï¼šSparkçš„å„ä¸ªè§’è‰²ä»¥ç‹¬ç«‹è¿›ç¨‹å½¢å¼å­˜åœ¨ï¼Œç»„æˆé›†ç¾¤ç¯å¢ƒ Â· Hadoop YARNæ¨¡å¼ï¼ˆé›†ç¾¤ï¼‰ï¼šSparkçš„å„ä¸ªè§’è‰²è¿è¡Œåœ¨YARNå®¹å™¨å†…éƒ¨ï¼Œç»„æˆé›†ç¾¤ç¯å¢ƒ Â· Kubernetesæ¨¡å¼ï¼ˆå®¹å™¨é›†ç¾¤ï¼‰ï¼šSparkçš„å„ä¸ªè§’è‰²è¿è¡Œåœ¨Kuberneteså®¹å™¨å†…éƒ¨ï¼Œç»„æˆé›†ç¾¤ç¯å¢ƒ Â· äº‘æœåŠ¡æ¨¡å¼ è§’è‰² èµ„æº Â· Masterè§’è‰²ï¼šé›†ç¾¤èµ„æºç®¡ç† Â· Workerè§’è‰²ï¼šå•æœºèµ„æºç®¡ç†(æ‰€åœ¨æœåŠ¡å™¨èµ„æºç®¡ç†) ä»»åŠ¡ Â· Driverè§’è‰²ï¼šå•ä¸ªä»»åŠ¡ç®¡ç† Â· Executorè§’è‰²ï¼šå•ä¸ªä»»åŠ¡è®¡ç®—","text":"å®šä¹‰ï¼šApache Sparkæ˜¯ç”¨äºå¤§è§„æ¨¡æ•°æ®å¤„ç†çš„ç»Ÿä¸€åˆ†æå¼•æ“ã€‚å…¶æ ¸å¿ƒæ•°æ®ç»“æ„ï¼šå¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼ˆRDDï¼‰èƒ½å¤Ÿåœ¨å¤§è§„æ¨¡é›†ç¾¤ä¸­åšå†…å­˜è¿ç®—ï¼Œä¸”å…·æœ‰ä¸€å®šå®¹é”™æ–¹å¼ã€‚ Sparkæ¡†æ¶ç»„æˆÂ· Spark Coreï¼šä»¥RDDä¸ºæ•°æ®æŠ½è±¡ï¼Œæä¾›Pythonã€Javaã€Scalaã€Rè¯­è¨€çš„APIå’ŒSparkçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œæ˜¯Sparkè¿è¡Œçš„åŸºç¡€ï¼› Â· SparkSQLï¼šåŸºäºSparkCoreï¼Œæä¾›æœºæ„åŒ–æ•°æ®å¤„ç†æ¨¡å—ï¼Œæ”¯æŒä»¥SQLè¯­è¨€å¯¹æ•°æ®è¿›è¡Œå¤„ç†ï¼›åŒæ—¶å¯ä»¥ä½œä¸ºStructuredStreamingæ¨¡å—çš„åŸºç¡€ï¼Œè¿›è¡Œæ•°æ®æµå¼è®¡ç®—ï¼› Â· SparkStreamingï¼šåŸºäºSparkCoreï¼Œæä¾›æ•°æ®æµå¼è®¡ç®—ï¼› Â· MLlibï¼šåŸºäºSparkCoreï¼Œå†…ç½®å¤§é‡æœºå™¨å­¦ä¹ åº“å’Œç®—æ³•APIï¼Œè¿›è¡Œæœºå™¨å­¦ä¹ è®¡ç®—ï¼› Â· GraphXï¼šåŸºäºSparkCoreï¼Œæä¾›äº†å¤§é‡å›¾è®¡ç®—APIï¼Œç”¨äºåˆ†å¸ƒå¼å›¾è®¡ç®— è¿è¡Œæ¨¡å¼Â· æœ¬åœ°æ¨¡å¼ï¼ˆå•æœº/localï¼‰ï¼šä»¥ä¸€ä¸ªç‹¬ç«‹è¿›ç¨‹ï¼Œé€šè¿‡å†…éƒ¨çš„å¤šçº¿ç¨‹æ¨¡æ‹ŸSparkè¿è¡Œç¯å¢ƒ Â· Standaloneæ¨¡å¼ï¼ˆé›†ç¾¤ï¼‰ï¼šSparkçš„å„ä¸ªè§’è‰²ä»¥ç‹¬ç«‹è¿›ç¨‹å½¢å¼å­˜åœ¨ï¼Œç»„æˆé›†ç¾¤ç¯å¢ƒ Â· Hadoop YARNæ¨¡å¼ï¼ˆé›†ç¾¤ï¼‰ï¼šSparkçš„å„ä¸ªè§’è‰²è¿è¡Œåœ¨YARNå®¹å™¨å†…éƒ¨ï¼Œç»„æˆé›†ç¾¤ç¯å¢ƒ Â· Kubernetesæ¨¡å¼ï¼ˆå®¹å™¨é›†ç¾¤ï¼‰ï¼šSparkçš„å„ä¸ªè§’è‰²è¿è¡Œåœ¨Kuberneteså®¹å™¨å†…éƒ¨ï¼Œç»„æˆé›†ç¾¤ç¯å¢ƒ Â· äº‘æœåŠ¡æ¨¡å¼ è§’è‰² èµ„æº Â· Masterè§’è‰²ï¼šé›†ç¾¤èµ„æºç®¡ç† Â· Workerè§’è‰²ï¼šå•æœºèµ„æºç®¡ç†(æ‰€åœ¨æœåŠ¡å™¨èµ„æºç®¡ç†) ä»»åŠ¡ Â· Driverè§’è‰²ï¼šå•ä¸ªä»»åŠ¡ç®¡ç† Â· Executorè§’è‰²ï¼šå•ä¸ªä»»åŠ¡è®¡ç®— ç¯å¢ƒæ­å»ºHadoopä¼ªåˆ†å¸ƒå¼æ­å»ºå‡†å¤‡masterè™šæ‹Ÿæœº é…ç½®é™æ€ip 1vim /etc/sysconfig/network-scripts/ifcfg-ens33 1234567891011#ä¿®æ”¹BOOTPROTO=&quot;static&quot;ONBOOT=&quot;yes&quot;# æ–°å¢IPADDR=&quot;192.168.80.129&quot;GATEWAY=&quot;192.168.80.2&quot;NETMASK=&quot;255.255.255.0&quot;DNS1=&quot;8.8.8.8&quot;DNS2=&quot;114.114.114.114&quot;IPV6_PRIVACY=&quot;no&quot; é‡å¯ç½‘å¡æœåŠ¡ 1service network restart å…³é—­é˜²ç«å¢™ï¼Œå¹¶ç¦æ­¢é˜²ç«å¢™å¼€æœºè‡ªå¯ 12systemctl stop firewalldsystemctl disable firewalld å…³é—­selinux 1vim /etc/selinux/config 1234567891011# This file controls the state of SELinux on the system.# SELINUX= can take one of these three values:# enforcing - SELinux security policy is enforced.# permissive - SELinux prints warnings instead of enforcing.# disabled - No SELinux policy is loaded.SELINUX=disabled# SELINUXTYPE= can take one of three values:# targeted - Targeted processes are protected,# minimum - Modification of targeted policy. Only selected processes are protected. # mls - Multi Level Security protection.SELINUXTYPE=targeted é‡å¯master 1reboot é‡å¯å®Œæˆåå°†ç›¸å…³è½¯ä»¶åŒ…ï¼ˆjdkã€hadoopã€sparkç­‰ï¼‰å¯¼å…¥è‡³/usr/localç›®å½•ä¸‹å¹¶è§£å‹ è§£å‹jdk 1tar -zxvf jdk-8u211-linux-x64.tar.gz -C /usr/local é…ç½®jdkç¯å¢ƒå˜é‡ 1vim /etc/profile 12345#set java environment JAVA_HOME=/usr/local/jdk1.8.0_211CLASSPATH=.:$JAVA_HOME/lib PATH=$JAVA_HOME/bin:$PATH export JAVA_HOME CLASSPATH PATH é‡å¯ç¯å¢ƒå˜é‡ 1source /etc/profile æ£€æŸ¥å®‰è£… 1java -version 123java version &quot;1.8.0_211&quot;Java(TM) SE Runtime Environment (build 1.8.0_211-b12)Java HotSpot(TM) 64-Bit Server VM (build 25.211-b12, mixed mode) é…ç½®linuxé›†ç¾¤å°†masterå®Œæ•´å…‹éš†ä¸¤å°node1ã€node2æœºå™¨ï¼Œé…ç½®é™æ€ip é…ç½®ä¸»æœºåï¼Œåˆ†åˆ«æ‰§è¡Œï¼š 1vim /etc/hostname å°†ä¸‰å°æœºå™¨çš„ä¸»æœºåè®¾ç½®ä¸ºmasterã€node1ã€node2 é…ç½®ä¸‰å°è™šæ‹Ÿæœºçš„åŸŸåæ˜ å°„ 1vim /etc/hosts 123456127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4::1 localhost localhost.localdomain localhost6 localhost6.localdomain6192.168.80.129 master192.168.80.130 node1192.168.80.131 node2 æ­¤æ—¶ä¸‰å°æœºå™¨å·²ç»å¯ä»¥äº’ç›¸pingé€š 123ping masterping node1ping node2 åˆ†åˆ«é‡å¯ä¸‰å°æœºå™¨ ç”Ÿæˆä¸‰å°æœºå™¨çš„å…¬é’¥å’Œç§é’¥ï¼Œåˆ†åˆ«æ‰§è¡Œï¼š 1ssh-keygen -t rsa åå¤å›è½¦ï¼Œåœ¨/root/.sshéšè—ç›®å½•ä¸‹ç”Ÿæˆç§é’¥id_rsaå’Œå…¬é’¥id_rsa.pub 123456789101112131415161718192021Generating public/private rsa key pair.Enter file in which to save the key (/root/.ssh/id_rsa): Created directory &apos;/root/.ssh&apos;.Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /root/.ssh/id_rsa.Your public key has been saved in /root/.ssh/id_rsa.pub.The key fingerprint is:SHA256:/Vd3sEsHhz3CcxGwbRp5lj6+srZ7OpwAvyKS+qoTi9Q root@masterThe key&apos;s randomart image is:+---[RSA 2048]----+| ..o.|| . +oo|| B+Oo|| o @=.|| . S + .oo=|| o E + ..++||o o . = +. ||.o o . . . B ..|| .oo+.. . . .=O. |+----[SHA256]-----+ åœ¨ä¸‰å°è™šæ‹Ÿæœºæ‰§è¡Œå‘½ä»¤å°†å…¬é’¥æ‹·è´åˆ°master 1ssh-copy-id master 123456789101112The authenticity of host &apos;master (192.168.80.129)&apos; can&apos;t be established.ECDSA key fingerprint is SHA256:9UGNQgh5SWXh/1Z9iWTOzBSbqXf8kjbxc5SC73j9ct4.ECDSA key fingerprint is MD5:ee:b1:5d:3c:a5:2b:2e:08:cd:85:44:68:fe:c7:29:d9.Are you sure you want to continue connecting (yes/no)? yes/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keysroot@master&apos;s password: Number of key(s) added: 1Now try logging into the machine, with: &quot;ssh &apos;master&apos;&quot;and check to make sure that only the key(s) you wanted were added. å°†masterçš„å…¬é’¥æ‹·è´åˆ°nodeä¸Š 12scp /root/.ssh/authorized_keys node1:/root/.sshscp /root/.ssh/authorized_keys node2:/root/.ssh 1234567The authenticity of host &apos;node1 (192.168.80.130)&apos; can&apos;t be established.ECDSA key fingerprint is SHA256:9UGNQgh5SWXh/1Z9iWTOzBSbqXf8kjbxc5SC73j9ct4.ECDSA key fingerprint is MD5:ee:b1:5d:3c:a5:2b:2e:08:cd:85:44:68:fe:c7:29:d9.Are you sure you want to continue connecting (yes/no)? yesWarning: Permanently added &apos;node1,192.168.80.130&apos; (ECDSA) to the list of known hosts.root@node1&apos;s password: authorized_keys 100% 1177 1.2MB/s 00:00 æµ‹è¯•sshå…å¯†ç™»å½• 123ssh node1ssh node2exit å®‰è£…hadoopè§£å‹å®‰è£…åŒ…å¹¶é‡å‘½å 12tar -zxvf hadoop-3.3.1.tar.gz -C /usr/localmv hadoop-3.3.1 hadoop ä¿®æ”¹é…ç½®æ–‡ä»¶ 1cd /usr/local/hadoop/etc/hadoop hadoop-env.sh 1vim hadoop-env.sh 123456export JAVA_HOME=/usr/local/jdk1.8.0_211export HDFS_NAMENODE_USER=rootexport HDFS_DATANODE_USER=rootexport HDFS_SECONDARYNAMENODE_USER=rootexport YARN_RESOURCEMANAGER_USER=rootexport YARN_NODEMANAGER_USER=root core-site.xml 1vim core-site.xml 123456789101112131415161718192021222324252627282930&lt;configuration&gt; &lt;!-- è®¾ç½®é»˜è®¤ä½¿ç”¨çš„æ–‡ä»¶ç³»ç»Ÿ Hadoopæ”¯æŒfileã€HDFSã€GFSã€ali|Amazonäº‘ç­‰æ–‡ä»¶ç³»ç»Ÿ --&gt; &lt;property&gt; &lt;name&gt;fs.defaultFS&lt;/name&gt; &lt;value&gt;hdfs://master:8020&lt;/value&gt; &lt;/property&gt; &lt;!-- è®¾ç½®Hadoopæœ¬åœ°ä¿å­˜æ•°æ®è·¯å¾„ --&gt; &lt;property&gt; &lt;name&gt;hadoop.tmp.dir&lt;/name&gt; &lt;value&gt;/usr/local/data/hadoop&lt;/value&gt; &lt;/property&gt; &lt;!-- è®¾ç½®HDFS web UIç”¨æˆ·èº«ä»½ --&gt; &lt;property&gt; &lt;name&gt;hadoop.http.staticuser.user&lt;/name&gt; &lt;value&gt;root&lt;/value&gt; &lt;/property&gt; &lt;!-- æ•´åˆhive ç”¨æˆ·ä»£ç†è®¾ç½® --&gt; &lt;property&gt; &lt;name&gt;hadoop.proxyuser.root.hosts&lt;/name&gt; &lt;value&gt;*&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;hadoop.proxyuser.root.groups&lt;/name&gt; &lt;value&gt;*&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; hdfs-site.xml 1vim hdfs-site.xml 1234567&lt;configuration&gt; &lt;!-- è®¾ç½®SNNè¿›ç¨‹è¿è¡Œæœºå™¨ä½ç½®ä¿¡æ¯ --&gt; &lt;property&gt; &lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt; &lt;value&gt;node1:9868&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; mapred-site.xml 1vim mapred-site.xml 12345678910111213141516171819202122232425262728293031323334&lt;configuration&gt; &lt;!-- è®¾ç½®MRç¨‹åºé»˜è®¤è¿è¡Œæ¨¡å¼ï¼š yarné›†ç¾¤æ¨¡å¼ localæœ¬åœ°æ¨¡å¼ --&gt; &lt;property&gt; &lt;name&gt;mapreduce.framework.name&lt;/name&gt; &lt;value&gt;yarn&lt;/value&gt; &lt;/property&gt; &lt;!-- MRç¨‹åºå†å²æœåŠ¡å™¨ç«¯åœ°å€ --&gt; &lt;property&gt; &lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt; &lt;value&gt;master:10020&lt;/value&gt; &lt;/property&gt; &lt;!-- å†å²æœåŠ¡å™¨webç«¯åœ°å€ --&gt; &lt;property&gt; &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt; &lt;value&gt;master:19888&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.app.mapreduce.am.env&lt;/name&gt; &lt;value&gt;HADOOP_MAPRED_HOME=$&#123;HADOOP_HOME&#125;&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;mapreduce.map.env&lt;/name&gt; &lt;value&gt;HADOOP_MAPRED_HOME=$&#123;HADOOP_HOME&#125;&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;mapreduce.reduce.env&lt;/name&gt; &lt;value&gt;HADOOP_MAPRED_HOME=$&#123;HADOOP_HOME&#125;&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; yarn-site.xml 1vim yarn-site.xml 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;configuration&gt; &lt;!-- è®¾ç½®YARNé›†ç¾¤ä¸»è§’è‰²è¿è¡Œæœºå™¨ä½ç½® --&gt; &lt;property&gt; &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt; &lt;value&gt;master&lt;/value&gt; &lt;/property&gt; &lt;property&gt; &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt; &lt;value&gt;mapreduce_shuffle&lt;/value&gt; &lt;/property&gt; &lt;!-- æ˜¯å¦å°†å¯¹å®¹å™¨å®æ–½ç‰©ç†å†…å­˜é™åˆ¶ --&gt; &lt;property&gt; &lt;name&gt;yarn.nodemanager.pmem-check-enabled&lt;/name&gt; &lt;value&gt;false&lt;/value&gt; &lt;/property&gt; &lt;!-- æ˜¯å¦å°†å¯¹å®¹å™¨å®æ–½è™šæ‹Ÿå†…å­˜é™åˆ¶ã€‚ --&gt; &lt;property&gt; &lt;name&gt;yarn.nodemanager.vmem-check-enabled&lt;/name&gt; &lt;value&gt;false&lt;/value&gt; &lt;/property&gt; &lt;!-- å¼€å¯æ—¥å¿—èšé›† --&gt; &lt;property&gt; &lt;name&gt;yarn.log-aggregation-enable&lt;/name&gt; &lt;value&gt;true&lt;/value&gt; &lt;/property&gt; &lt;!-- è®¾ç½®yarnå†å²æœåŠ¡å™¨åœ°å€ --&gt; &lt;property&gt; &lt;name&gt;yarn.log.server.url&lt;/name&gt; &lt;value&gt;http://master:19888/jobhistory/logs&lt;/value&gt; &lt;/property&gt; &lt;!-- ä¿å­˜çš„æ—¶é—´7å¤© --&gt; &lt;property&gt; &lt;name&gt;yarn.log-aggregation.retain-seconds&lt;/name&gt; &lt;value&gt;604800&lt;/value&gt; &lt;/property&gt;&lt;/configuration&gt; workers 1vim workers 123masternode1node2 slaves 1vim workers 123masternode1node2 å°†å®‰è£…åŒ…åˆ†å‘è‡³å…¶ä»–æœºå™¨ 123cd /usr/localscp -r hadoop root@node1:/usr/localscp -r hadoop root@node2:/usr/local é…ç½®hadoopç¯å¢ƒå˜é‡ï¼Œåˆ†å‘è‡³å…¶ä»–æœºå™¨ 1vim /etc/profile 123# set hadoop envexport HADOOP_HOME=/usr/local/hadoopexport PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin 12scp /etc/profile node1:/etc/scp /etc/profile node2:/etc/ åœ¨ä¸‰å°æœºå™¨åˆ†åˆ«é‡å¯ç¯å¢ƒå˜é‡ 1source /etc/profile é¦–æ¬¡å¯åŠ¨ï¼Œå…ˆæ ¼å¼åŒ–namenode 1./bin hdfs namenode -format å¯åŠ¨ 123start-dfs.shstart-yarn.shmapred --daemon start historyserver æˆ–è€… 12start-all.shmapred --daemon start historyserver æŸ¥çœ‹ä»»åŠ¡ 1jps 12345661488 Jps60417 NameNode60597 DataNode60981 ResourceManager61133 NodeManager61567 JobHistoryServer æŸ¥çœ‹webé¡µé¢ï¼ˆhadoop3.0ç‰ˆæœ¬ä»¥åwebç«¯å£è·Ÿæ”¹ä¸º9870ï¼‰ master:9870 å…³é—­ä»»åŠ¡ 123stop-dfs.shstop-yarn.shmapred --daemon stop historyserver æˆ–è€… 12stop-all.shmapred --daemon stop historyserver Anaconda3å®‰è£…1sh ./Anaconda3-2021.05-Linux-x86_64.sh é…ç½®æ¸…åæº 1vim ~/.condarc 1234567891011121314channels: - defaultsshow_channel_urls: truedefault_channels: - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2custom_channels: conda-forge: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud msys2: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud bioconda: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud menpo: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud pytorch: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud simpleitk: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud åˆ›å»ºpysparkè™šæ‹Ÿç¯å¢ƒ 1conda create -n pyspark python=3.8 Spark localæ¨¡å¼æ­å»ºå®‰è£…è§£å‹sparkå®‰è£…åŒ…å¹¶é‡å‘½å 12tar -zxvf spark-3.2.0-bin-hadoop3.2.tgz -C /usr/localmv spark-3.2.0-bin-hadoop3.2 spark é…ç½®ç¯å¢ƒå˜é‡ 1vim /etc/profile 123export SPARK_HOME=/usr/local/sparkexport PYSPARK_PYTHON=/usr/local/anaconda3/envs/pyspark/bin/python3.8export HADOOP_CONF_DIR=$HADOOP_HOME/etc/hadoop 1source /etc/profile æ³¨ï¼šæŸ¥æ‰¾pysparkè™šæ‹Ÿç¯å¢ƒä½ç½®ï¼š 1cd /usr/local/anaconda3/envs/pyspark/bin 1vim ~/.bashrc 12export JAVA_HOME=/usr/local/jdk1.8.0_211export PYSPARK_PYTHON=/usr/local/anaconda3/envs/pyspark/bin/python3.8 å¯åŠ¨pysparkäº¤äº’å¼è§£é‡Šå™¨1./bin/pyspark 12345678910111213141516171819Python 3.8.8 (default, Apr 13 2021, 19:58:26) [GCC 7.3.0] :: Anaconda, Inc. on linuxType &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.Using Spark&apos;s default log4j profile: org/apache/spark/log4j-defaults.propertiesSetting default log level to &quot;WARN&quot;.To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).22/12/02 17:38:56 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicableWelcome to ____ __ / __/__ ___ _____/ /__ _\\ \\/ _ \\/ _ `/ __/ &apos;_/ /__ / .__/\\_,_/_/ /_/\\_\\ version 3.2.0 /_/Using Python version 3.8.8 (default, Apr 13 2021 19:58:26)Spark context Web UI available at http://master:4040Spark context available as &apos;sc&apos; (master = local[*], app id = local-1669973937905).SparkSession available as &apos;spark&apos;.&gt;&gt;&gt; è¿›å…¥æµè§ˆå™¨ä»»åŠ¡é¡µé¢master:4040ï¼Œå¯ä»¥æŸ¥çœ‹ä¿¡æ¯ æ‰§è¡Œä¸€æ¡pysparkæŒ‡ä»¤åï¼š Spark StandAloneæ¨¡å¼æ­å»ºStandAloneStandAloneæ¨¡å¼æ˜¯Sparkè‡ªå¸¦çš„é›†ç¾¤æ¨¡å¼ï¼ŒMasterè§’è‰²ä»¥Masterè¿›ç¨‹å½¢å¼å­˜åœ¨ï¼ŒWorkerè§’è‰²ä»¥Workerè¿›ç¨‹å½¢å¼å­˜åœ¨ã€‚å…¶ä¸­Driverè§’è‰²è¿è¡Œåœ¨Masterè¿›ç¨‹å†…ï¼ŒExecutorè§’è‰²è¿è¡Œåœ¨Workerè¿›ç¨‹å†…ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥å¼€å¯ç¬¬ä¸‰ä¸ªè¿›ç¨‹ï¼šå†å²æœåŠ¡å™¨ï¼ˆHistoryServerï¼‰ï¼Œç”¨äºä¿å­˜Spark appè¿è¡Œåçš„äº‹ä»¶æ—¥å¿—ã€‚ ç¯å¢ƒåˆ†å‘12scp Anaconda3-2021.05-Linux-x86_64.sh node1:`pwd`/scp Anaconda3-2021.05-Linux-x86_64.sh node2:`pwd`/ è¿›å…¥node1ã€node2å®‰è£…anacondaï¼ŒåŒmasterï¼šé…ç½®condaæºï¼Œåˆ›å»ºè™šæ‹Ÿç¯å¢ƒ å°†master:/etc/profileå’Œbashrcä¸­çš„ç¯å¢ƒå˜é‡å¤åˆ¶åˆ°node1ã€2ä¸­ 1234scp /etc/profile node1:/etc/profilescp /etc/profile node2:/etc/profilescp ~/.bashrc node1:~/scp ~/.bashrc node2:~/ åˆ›å»ºhadoopç”¨æˆ·ï¼ˆä»…æœ‰rootç”¨æˆ·å¯è·³è¿‡ï¼‰hadoopç”¨æˆ·æ‹¥æœ‰yarnçš„æœ€é«˜æƒé™ æ–°å»ºç”¨æˆ· 12sudo adduser hadooppasswd hadoop æ·»åŠ ç”¨æˆ·ç»„ 1sudo usermod -a -G hadoop hadoop èµ‹äºˆrootæƒé™ 1vim /etc/sudoers 123## Allow root to run any commands anywhere root ALL=(ALL) ALLhadoop ALL=(ALL) ALL æ·»åŠ æƒé™ 123cd /usr/local/chown -R hadoop:hadoop hadoop*chown -R hadoop:hadoop spark* é…ç½®sparké…ç½®æ–‡ä»¶1234su - hadoopcd /usr/local/spark/confmv workers.template workersvim workers 123masternode1node2 12mv spark-env.sh.template spark-env.shvim spark-env.sh 123456789101112131415161718192021222324252627## è®¾ç½®JAVAå®‰è£…ç›®å½•JAVA_HOME=/usr/local/jdk1.8.0_211## HADOOPè½¯ä»¶é…ç½®æ–‡ä»¶ç›®å½•ï¼Œè¯»å–HDFSä¸Šæ–‡ä»¶å’Œè¿è¡ŒYARNé›†ç¾¤HADOOP_CONF_DIR=/usr/local/hadoop/etc/hadoopYARN_CONF_DIR=/usr/local/hadoop/etc/hadoop## æŒ‡å®šspark masterçš„IPå’Œæäº¤ä»»åŠ¡çš„é€šä¿¡ç«¯å£# å‘ŠçŸ¥sparkçš„masterè¿è¡Œåœ¨å“ªä¸ªæœºå™¨ä¸Šexport SPARK_MASTER_HOST=master# å‘ŠçŸ¥sparkmasterçš„é€šè®¯ç«¯å£export SPARK_MASTER_PORT=7077# å‘ŠçŸ¥spark masterçš„ webuiç«¯å£SPARK_MASTER_WEBUI_PORT=8080# worker cpuå¯ç”¨æ ¸æ•°SPARK_WORKER_CORES=1# workerå¯ç”¨å†…å­˜SPARK_WORKER_MEMORY=1g# workerçš„å·¥ä½œé€šè®¯åœ°å€SPARK_WORKER_PORT=7078# workerçš„ webuiåœ°å€SPARK_WORKER_WEBUI_PORT=8081## è®¾ç½®å†å²æœåŠ¡å™¨# é…ç½®çš„æ„æ€æ˜¯ å°†sparkç¨‹åºè¿è¡Œçš„å†å²æ—¥å¿— å­˜åˆ°hdfsçš„/sparklogæ–‡ä»¶å¤¹ä¸­SPARK_HISTORY_OPTS=\"-Dspark.history.fs.logDirectory=hdfs://master:8020/sparklog/ -Dspark.history.fs.cleaner.enabled=true\" å¯åŠ¨hadoop 1hadoop fs -ls / æ­¤æ—¶æ²¡æœ‰sparklogæ–‡ä»¶ã€‚åˆ›å»ºsparklogæ–‡ä»¶,èµ‹äºˆæƒé™ 12hadoop fs -mkdir /sparkloghadoop fs -chmod 777 /sparklog ç»§ç»­é…ç½® 12mv spark-defaults.conf.template spark-defaults.confvim spark-defaults.conf 123456# å¼€å¯sparkçš„æ—¥æœŸè®°å½•åŠŸèƒ½spark.eventLog.enabled true# è®¾ç½®sparkæ—¥å¿—è®°å½•çš„è·¯å¾„spark.eventLog.dir hdfs://master:8020/sparklog/ # è®¾ç½®sparkæ—¥å¿—æ˜¯å¦å¯åŠ¨å‹ç¼©spark.eventLog.compress true 12mv log4j.properties.template log4j.propertiesvim log4j.properties å°†INFOæ”¹ä¸ºWARNï¼Œå‡å°‘å†—ä½™æ—¥å¿— 12# Set everything to be logged to the consolelog4j.rootCategory=WARN, console åˆ†å‘sparké…ç½®æ–‡ä»¶123cd /usr/localscp -r spark node1:`pwd`/scp -r spark node2:`pwd`/ å¯åŠ¨sparké›†ç¾¤å¯åŠ¨å†å²æœåŠ¡å™¨è¿›ç¨‹ 123cd sparksbin/start-history-server.shjps 123456749297 JobHistoryServer49778 HistoryServer48296 DataNode49835 Jps48734 ResourceManager48910 NodeManager48127 NameNode å¯åŠ¨é›†ç¾¤ 12sbin/start-all.shjps 12345678949297 JobHistoryServer50162 Jps50020 Master48296 DataNode50107 Worker48734 ResourceManager48910 NodeManager48127 NameNode49903 HistoryServer è¿›å…¥master:8080webç«¯å£å¯ä»¥çœ‹åˆ°sparké›†ç¾¤ç•Œé¢ StandAloneé›†ç¾¤æµ‹è¯•12cd /usr/local/spark/bin./pyspark --master spark://master:7077 12345678910111213141516Python 3.8.15 (default, Nov 24 2022, 15:19:38) [GCC 11.2.0] :: Anaconda, Inc. on linuxType &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.22/12/05 11:54:36 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicableWelcome to ____ __ / __/__ ___ _____/ /__ _\\ \\/ _ \\/ _ `/ __/ &apos;_/ /__ / .__/\\_,_/_/ /_/\\_\\ version 3.2.0 /_/Using Python version 3.8.15 (default, Nov 24 2022 15:19:38)Spark context Web UI available at http://master:4040Spark context available as &apos;sc&apos; (master = spark://master:7077, app id = app-20221205115438-0000).SparkSession available as &apos;spark&apos;.&gt;&gt;&gt; åœ¨/usr/localä¸‹åˆ›å»ºä¸€ä¸ªwords.txtæ–‡ä»¶ï¼Œå†™å…¥ 123hadoop spark flinkhadoop spark flink hadoop hadoophadoop spark flink hadoop hadoop spark spark åˆ›å»ºinputæ–‡ä»¶å¤¹ï¼Œå°†æ–‡ä»¶ä¸Šä¼ è‡³hdfs 1234hadoop fs -mkdir /input/hdfs dfs -put /usr/local/words.txt /input/hadoop fs -ls /inputhadoop fs -cat /input/words.txt æ‰§è¡Œï¼š 1sc.textFile(\"hdfs://master:8020/input/words.txt\").flatMap(lambda line: line.split(\" \")).map(lambda x:(x,1)).reduceByKey(lambda a,b:a+b).collect() 1[(&apos;hadoop&apos;, 7), (&apos;spark&apos;, 5), (&apos;flink&apos;, 3)] Spark on YARN å°†sparkéƒ¨ç½²åˆ°yarné›†ç¾¤ä¸­å¯ä»¥æé«˜å¯¹èµ„æºçš„åˆ©ç”¨ç‡ï¼Œæ— éœ€éƒ¨ç½²sparké›†ç¾¤ï¼Œåªéœ€è¦ä¸€å°å……å½“sparkå®¢æˆ·ç«¯çš„æœåŠ¡å™¨å³å¯æäº¤ä»»åŠ¡åˆ°yarné›†ç¾¤è¿è¡Œ Masterè§’è‰²ç”±yarnçš„ResourceManageræ‹…ä»» Workerè§’è‰²ç”±yarnçš„NodeManageræ‹…ä»» Driverè§’è‰²è¿è¡Œåœ¨yarnå®¹å™¨å†…æˆ–æäº¤ä»»åŠ¡çš„å®¢æˆ·ç«¯è¿›ç¨‹ä¸­ Executorè¿è¡Œåœ¨yarnæä¾›çš„å®¹å™¨å†… è®©sparkè®¡ç®—ä»»åŠ¡è¿è¡Œåœ¨yarnå®¹å™¨å†…éƒ¨ï¼Œèµ„æºç®¡ç†äº¤å‹yarnçš„ResourceManagerå’ŒNodeManagerä»£æ›¿ å¯åŠ¨Spark on YARN123cd /usr/local/spark./sbin/stop-all.sh #å…³é—­standaloneé›†ç¾¤bin/pyspark --master yarn 12345678910111213141516171819Python 3.8.15 (default, Nov 24 2022, 15:19:38) [GCC 11.2.0] :: Anaconda, Inc. on linuxType &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.22/12/05 15:27:46 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable22/12/05 15:27:49 WARN Client: Neither spark.yarn.jars nor spark.yarn.archive is set, falling back to uploading libraries under SPARK_HOME. Welcome to ____ __ / __/__ ___ _____/ /__ _\\ \\/ _ \\/ _ `/ __/ &apos;_/ /__ / .__/\\_,_/_/ /_/\\_\\ version 3.2.0 /_/Using Python version 3.8.15 (default, Nov 24 2022 15:19:38)Spark context Web UI available at http://master:4040Spark context available as &apos;sc&apos; (master = yarn, app id = application_1670210110128_0001).SparkSession available as &apos;spark&apos;.&gt;&gt;&gt; sc.parallelize([1,2,3,4,5]).map(lambda x:x*10).collect()[10, 20, 30, 40, 50] &gt;&gt;&gt; æ‰§è¡Œç¨‹åºæµ‹è¯•ï¼Œæˆ–é€šè¿‡sparkå®¢æˆ·ç«¯spark-submitæäº¤ä»£ç ï¼Œsparkâ€˜ç®—æ³•ä¼šè¿è¡Œåœ¨å®¹å™¨ä¸­ 1./bin/spark-submit --master yarn /usr/local/spark/examples/src/main/python/pi.py 100 Spark on YARNéƒ¨ç½²æ¨¡å¼ Clusterï¼ˆé›†ç¾¤æ¨¡å¼ï¼‰ Driverè¿è¡Œåœ¨yarnå®¹å™¨å†…éƒ¨ï¼Œå’ŒApplicationMasteråœ¨åŒä¸€ä¸ªå®¹å™¨å†… Clientï¼ˆå®¢æˆ·ç«¯æ¨¡å¼ï¼‰ Driverè¿è¡Œåœ¨å®¢æˆ·ç«¯è¿›ç¨‹ä¸­ï¼Œä¾‹å¦‚Driverè¿è¡Œåœ¨spark-submitå®¢æˆ·ç«¯çš„è¿›ç¨‹ä¸­ å…¶ä¸­é›†ç¾¤æ¨¡å¼åœ¨å®¹å™¨å†…è¿›è¡Œé€šè®¯ï¼Œæ•ˆç‡é«˜ï¼Œä½†æ˜¯æ—¥å¿—åŒæ ·å­˜æ”¾äºå®¹å™¨å†…éƒ¨ Client1bin/spark-submit --master yarn --deploy-mode client /usr/local/spark/examples/src/main/python/pi.py 100 Cluster1bin/spark-submit --master yarn --deploy-mode cluster /usr/local/spark/examples/src/main/python/pi.py 100","categories":[{"name":"BigData","slug":"BigData","permalink":"http://yoursite.com/categories/BigData/"}],"tags":[{"name":"Spark","slug":"Spark","permalink":"http://yoursite.com/tags/Spark/"}]},{"title":"Nebula-å…¨æ–‡æ£€ç´¢","slug":"Nebula-å…¨æ–‡æ£€ç´¢","date":"2022-11-25T06:17:41.000Z","updated":"2022-11-25T08:35:41.947Z","comments":true,"path":"2022/11/25/Nebula-å…¨æ–‡æ£€ç´¢/","link":"","permalink":"http://yoursite.com/2022/11/25/Nebula-å…¨æ–‡æ£€ç´¢/","excerpt":"è¿æ¥ESæ·»åŠ Nebulaå…¨æ–‡ç´¢å¼•æ¨¡æ¿æ–‡ä»¶http://localhost:5601/app/dev_tools#/console 1234567891011121314151617curl -H \"Content-Type: application/json; charset=utf-8\" -XPUT http://localhost:9200/_template/nebula_index_template -d '&#123; \"template\": \"nebula*\", \"settings\": &#123; \"index\": &#123; \"number_of_shards\": 3, \"number_of_replicas\": 1 &#125; &#125;, \"mappings\": &#123; \"properties\" : &#123; \"tag_id\" : &#123; \"type\" : \"long\" &#125;, \"column_id\" : &#123; \"type\" : \"text\" &#125;, \"value\" :&#123; \"type\" : \"keyword\"&#125; &#125; &#125;&#125;' ç™»å½•ESå®¢æˆ·ç«¯SIGN IN TEXT SERVICE (localhost:9200,&quot;admin&quot;,&quot;123456&quot;) æŸ¥çœ‹ESå®¢æˆ·ç«¯è¯¦æƒ…SHOW TEXT SEARCH CLIENTS; é€€å‡ºESå®¢æˆ·ç«¯SIGN OUT TEXT SERVICE é…ç½®Nebulaå®‰è£…storageæœåŠ¡è¿›å…¥/usr/local/nebulaæ ¹ç›®å½•ä¸‹ï¼Œè¿›å…¥/etcå­ç›®å½•ï¼Œæ‰¾åˆ°nebula-storaged-listener.conf.productionæ–‡ä»¶ï¼Œå¤åˆ¶ä¸€ä»½å¹¶å»é™¤.productionåç¼€ã€‚å°†æ–‡ä»¶ä¸­çš„listenråœ°å€æ”¹ä¸ºçœŸå®åœ°å€ã€‚ éšåå¯åŠ¨listenerï¼š./bin/nebula-storaged --flagfile etc/nebula-storaged-listener.conf æ·»åŠ listenerADD LISTENER ELASTICSEARCH 192.168.100.1:9789,192.168.100.2:9789;(æ³¨ï¼šå¦‚æœæœ‰å¤šå°å›¾åº“é›†ç¾¤ï¼Œéƒ½è¦é…ç½®) è¿›å…¥nebula-consoleï¼Œæ‰§è¡ŒSHOW LISTENERå¯ä»¥æŸ¥çœ‹å›¾ç©ºé—´çš„æ‰€æœ‰listenerã€‚ è¦åˆ é™¤æ‰€æœ‰listenerï¼Œæ‰§è¡Œï¼šREMOVE LISTENER ELASTICSEARCH(æ³¨ï¼šä¸€ä¸ªå›¾ç©ºé—´ä»…å¯æ‰§è¡Œä¸€æ¬¡)","text":"è¿æ¥ESæ·»åŠ Nebulaå…¨æ–‡ç´¢å¼•æ¨¡æ¿æ–‡ä»¶http://localhost:5601/app/dev_tools#/console 1234567891011121314151617curl -H \"Content-Type: application/json; charset=utf-8\" -XPUT http://localhost:9200/_template/nebula_index_template -d '&#123; \"template\": \"nebula*\", \"settings\": &#123; \"index\": &#123; \"number_of_shards\": 3, \"number_of_replicas\": 1 &#125; &#125;, \"mappings\": &#123; \"properties\" : &#123; \"tag_id\" : &#123; \"type\" : \"long\" &#125;, \"column_id\" : &#123; \"type\" : \"text\" &#125;, \"value\" :&#123; \"type\" : \"keyword\"&#125; &#125; &#125;&#125;' ç™»å½•ESå®¢æˆ·ç«¯SIGN IN TEXT SERVICE (localhost:9200,&quot;admin&quot;,&quot;123456&quot;) æŸ¥çœ‹ESå®¢æˆ·ç«¯è¯¦æƒ…SHOW TEXT SEARCH CLIENTS; é€€å‡ºESå®¢æˆ·ç«¯SIGN OUT TEXT SERVICE é…ç½®Nebulaå®‰è£…storageæœåŠ¡è¿›å…¥/usr/local/nebulaæ ¹ç›®å½•ä¸‹ï¼Œè¿›å…¥/etcå­ç›®å½•ï¼Œæ‰¾åˆ°nebula-storaged-listener.conf.productionæ–‡ä»¶ï¼Œå¤åˆ¶ä¸€ä»½å¹¶å»é™¤.productionåç¼€ã€‚å°†æ–‡ä»¶ä¸­çš„listenråœ°å€æ”¹ä¸ºçœŸå®åœ°å€ã€‚ éšåå¯åŠ¨listenerï¼š./bin/nebula-storaged --flagfile etc/nebula-storaged-listener.conf æ·»åŠ listenerADD LISTENER ELASTICSEARCH 192.168.100.1:9789,192.168.100.2:9789;(æ³¨ï¼šå¦‚æœæœ‰å¤šå°å›¾åº“é›†ç¾¤ï¼Œéƒ½è¦é…ç½®) è¿›å…¥nebula-consoleï¼Œæ‰§è¡ŒSHOW LISTENERå¯ä»¥æŸ¥çœ‹å›¾ç©ºé—´çš„æ‰€æœ‰listenerã€‚ è¦åˆ é™¤æ‰€æœ‰listenerï¼Œæ‰§è¡Œï¼šREMOVE LISTENER ELASTICSEARCH(æ³¨ï¼šä¸€ä¸ªå›¾ç©ºé—´ä»…å¯æ‰§è¡Œä¸€æ¬¡) åˆ·è¡¨åˆ›å»ºå›¾ç©ºé—´1CREATE SPACE nebula_graph (partition_num = 20, replica_factor = 2, vid_type = FIXED_STRING(128)) Tag123CREATE TAG IF NOT EXISTS player(name string, age string);CREATE TAG INDEX IF NOT EXISTS name ON player(name(20),age(10));CREATE FULLTEXT TAG INDEX nebula_index_1 ON player(name,age); Edge Type1CREATE EDGE IF NOT EXISTS edge_player(created_time TIMESTAMP NULL DEFAULT now()); å…¨æ–‡ç´¢å¼•æ³¨ï¼š1.è¦å°†å›¾åº“ç´¢å¼•åŒæ­¥åˆ°esä¸­å»ï¼Œéœ€è¦åœ¨åˆ›å»ºç´¢å¼•æ—¶å°†ç´¢å¼•ä»¥nebulaä¸ºå¼€å¤´å‘½åã€‚ 2.æ‰§è¡ŒREBUILD FULLTEXT INDEXå°†ç´¢å¼•åŒæ­¥åˆ°esï¼Œæ­¤æ—¶esä¸­è¿˜æœªå®Œæˆç´¢å¼•çš„åˆ›å»ºï¼Œéœ€è¦åœ¨å›¾åº“å½•å…¥æ•°æ®åè‡ªåŠ¨åŒæ­¥åˆ°esï¼ˆå¯èƒ½å­˜åœ¨å»¶è¿Ÿï¼Œæ—¶é—´ä¸å®šï¼‰ 3.ä»…å¯ä½¿ç”¨LOOKUPè¯­å¥è¿›è¡Œæ¨¡ç³Šæ£€ç´¢ 4.åˆ é™¤å›¾ç©ºé—´ï¼Œå…¨æ–‡ç´¢å¼•ä¸ä¼šè‡ªåŠ¨åˆ é™¤ï¼Œéœ€è¦æ‰‹åŠ¨æ‰§è¡Œï¼šDROP FULLTEXT INDEX &lt;nebula_index*&gt; æŸ¥çœ‹å…¨æ–‡ç´¢å¼•SHOW FULLTEXT INDEXES æ•°æ®æµ‹è¯•æ’å…¥æ•°æ®123456789101112INSERT VERTEX player(name, age) VALUES \\ \"Russell Westbrook\": (\"Russell Westbrook\", 30), \\ \"Chris Paul\": (\"Chris Paul\", 33),\\ \"Boris Diaw\": (\"Boris Diaw\", 36),\\ \"David West\": (\"David West\", 38),\\ \"Danny Green\": (\"Danny Green\", 31),\\ \"Tim Duncan\": (\"Tim Duncan\", 42),\\ \"James Harden\": (\"James Harden\", 29),\\ \"Tony Parker\": (\"Tony Parker\", 36),\\ \"Aron Baynes\": (\"Aron Baynes\", 32),\\ \"Ben Simmons\": (\"Ben Simmons\", 22),\\ \"Blake Griffin\": (\"Blake Griffin\", 30); æ¨¡ç³Šæ£€ç´¢LOOKUP ON player WHERE PREFIX(player.name, &quot;B&quot;); LOOKUP ON player WHERE WILDCARD(player.name, &quot;*ri*&quot;) YIELD player.name, player.age; LOOKUP ON player WHERE WILDCARD(player.name, &quot;*ri*&quot;) | YIELD count(*); LOOKUP ON player WHERE REGEXP(player.name, &quot;R.*&quot;) YIELD player.name, player.age; LOOKUP ON player WHERE REGEXP(player.name, &quot;.*&quot;); LOOKUP ON player WHERE FUZZY(player.name, &quot;Tim Dunncan&quot;, AUTO, OR, 100) YIELD player.name;","categories":[{"name":"BigData","slug":"BigData","permalink":"http://yoursite.com/categories/BigData/"}],"tags":[{"name":"-database -nebula","slug":"database-nebula","permalink":"http://yoursite.com/tags/database-nebula/"}]},{"title":"Docker","slug":"Docker","date":"2022-09-16T07:15:39.000Z","updated":"2023-02-14T03:51:35.127Z","comments":true,"path":"2022/09/16/Docker/","link":"","permalink":"http://yoursite.com/2022/09/16/Docker/","excerpt":"CentOS Dockerå®‰è£…CentOS7è¦æ±‚64ä½ï¼Œä¸”å†…æ ¸ç‰ˆæœ¬é«˜äº3.10 æŸ¥çœ‹CentOSå†…æ ¸ç‰ˆæœ¬ï¼šuname -r Â· å®‰è£…Dockerï¼šå¸è½½æ—§ç‰ˆæœ¬ 12345678$ sudo yum remove docker \\ docker-client \\ docker-client-latest \\ docker-common \\ docker-latest \\ docker-latest-logrotate \\ docker-logrotate \\ docker-engine Â· å®‰è£…æ‰€éœ€è½¯ä»¶åŒ… 123$ sudo yum install -y yum-utils \\ device-mapper-persistent-data \\ lvm2 Â· è®¾ç½®Dockerä»“åº“ï¼ˆæ¸…åæºï¼‰ 123$ sudo yum-config-manager \\ --add-repo \\ https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/docker-ce.repo Â· å®‰è£…Docker Engine-Community 1$ sudo yum install docker-ce docker-ce-cli containerd.io","text":"CentOS Dockerå®‰è£…CentOS7è¦æ±‚64ä½ï¼Œä¸”å†…æ ¸ç‰ˆæœ¬é«˜äº3.10 æŸ¥çœ‹CentOSå†…æ ¸ç‰ˆæœ¬ï¼šuname -r Â· å®‰è£…Dockerï¼šå¸è½½æ—§ç‰ˆæœ¬ 12345678$ sudo yum remove docker \\ docker-client \\ docker-client-latest \\ docker-common \\ docker-latest \\ docker-latest-logrotate \\ docker-logrotate \\ docker-engine Â· å®‰è£…æ‰€éœ€è½¯ä»¶åŒ… 123$ sudo yum install -y yum-utils \\ device-mapper-persistent-data \\ lvm2 Â· è®¾ç½®Dockerä»“åº“ï¼ˆæ¸…åæºï¼‰ 123$ sudo yum-config-manager \\ --add-repo \\ https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/docker-ce.repo Â· å®‰è£…Docker Engine-Community 1$ sudo yum install docker-ce docker-ce-cli containerd.io å¯åŠ¨Docker1$ sudo systemctl start docker é€šè¿‡è¿è¡Œè‡ªå¸¦çš„hello-worldé•œåƒæ¥éªŒè¯æ˜¯å¦æ­£ç¡®å®‰è£…äº†Docker 1$ sudo docker run hello-world è¿è¡Œåº”ç”¨ç¨‹åºä½¿ç”¨docker runå‘½ä»¤åœ¨å®¹å™¨å†…è¿è¡Œä¸€ä¸ªè„šæœ¬ 1$ docker run centos /bin/echo \"hello docker\" å…¶ä¸­centosä¸ºæŒ‡å®šè¦è¿è¡Œçš„é•œåƒã€‚Docker ä¼šå…ˆä»æœ¬åœ°ä¸»æœºä¸ŠæŸ¥æ‰¾é•œåƒæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™åˆ°Docker Hubé•œåƒä»“åº“ä¸‹è½½å…¬å…±é•œåƒ è¿è¡Œäº¤äº’å¼å®¹å™¨ä½¿ç”¨dockerå‘½ä»¤çš„ä¸¤ä¸ªå‚æ•° -i -t å®ç°å¯¹è¿è¡Œå®¹å™¨çš„äº¤äº’ Â· -tï¼šåœ¨æ–°çš„å®¹å™¨å†…æŒ‡å®šä¸€ä¸ªä¼ªç»ˆç«¯æˆ–ç»ˆç«¯ Â· -iï¼šå…è®¸å¯¹å®¹å™¨å†…çš„æ ‡å‡†è¾“å…¥ï¼ˆSTDINï¼‰è¿›è¡Œäº¤äº’ 1$ docker run -i -t centos /bin/bash è¿è¡Œ exit å‘½ä»¤æˆ–è€…ä½¿ç”¨é”®ç›˜CTRL+Dé€€å‡ºè¯¥å®¹å™¨ åå°æ¨¡å¼è¿è¡Œå®¹å™¨ä½¿ç”¨ä¸‹åˆ—å‘½ä»¤åˆ›å»ºä¸€ä¸ªä»¥è¿›ç¨‹æ–¹å¼è¿è¡Œçš„å®¹å™¨ 1$ docker run -d centos /bin/sh -c \"while true; do echo hello world; sleep 1; done\" æ‰§è¡Œåå¹¶æ²¡æœ‰è¾“å‡ºâ€hello worldâ€ï¼Œè€Œæ˜¯è¾“å‡ºäº†ä¸€ä¸²å­—ç¬¦ï¼ˆå®¹å™¨IDï¼‰ï¼Œå¯ä»¥é€šè¿‡è¯¥å®¹å™¨IDæ¥æŸ¥çœ‹å¯¹åº”çš„å®¹å™¨é‡Œæ‰§è¡Œäº†ä»€ä¹ˆ æ‰§è¡Œdocker pså‘½ä»¤æŸ¥çœ‹è¿è¡Œçš„å®¹å™¨ï¼Œå…¶ä¸­ï¼š Â· CONTAINER ID ï¼šå®¹å™¨ID Â· IMAGEï¼šä½¿ç”¨çš„é•œåƒ Â· COMMANDï¼šå¯åŠ¨å®¹å™¨æ—¶æ‰§è¡Œçš„å‘½ä»¤ Â· CREATEDï¼šå®¹å™¨åˆ›å»ºæ—¶é—´ Â· STATUSï¼šå®¹å™¨çŠ¶æ€ï¼ˆcreatedï¼šå·²åˆ›å»ºï¼›restartingï¼šé‡å¯ä¸­ï¼›running/Upï¼šè¿è¡Œä¸­ï¼›removingï¼šè¿ç§»ä¸­ï¼›pausedï¼šæš‚åœä¸­ï¼›exitedï¼šå·²åœæ­¢ï¼›deadï¼šæ­»äº¡ï¼‰ Â· PORTSï¼šç«¯å£ä¿¡æ¯å’Œä½¿ç”¨çš„è¿æ¥ç±»å‹ï¼ˆtcp\\udpï¼‰ Â· NAMESï¼šè‡ªåŠ¨åˆ†é…çš„å®¹å™¨åç§° è¦æŸ¥çœ‹å®¹å™¨å†…éƒ¨çš„æ ‡å‡†è¾“å‡ºï¼Œæ‰§è¡Œdocker logs &lt;CONTAINER ID&gt; åœæ­¢å®¹å™¨1$ docker stop &lt;CONTAINER ID&gt; Docker å®¹å™¨è·å–é•œåƒå‡è®¾æœ¬åœ°æ²¡æœ‰ubuntué•œåƒï¼Œä½¿ç”¨docker pullå‘½ä»¤æ¥è½½å…¥ä¸€ä¸ªubuntué•œåƒ 1$ docker pull ubuntu å¯åŠ¨å®¹å™¨1$ docker run -it ubuntu /bin/bash æŸ¥çœ‹å…¨éƒ¨å®¹å™¨1$ docker ps -a å¯åŠ¨åœæ­¢è¿è¡Œçš„å®¹å™¨12$ docker ps -a # è·å–å®¹å™¨ID$ docker start &lt;CONTAINER ID&gt; åå°è¿è¡Œå®¹å™¨-då¯ä»¥æŒ‡å®šå®¹å™¨çš„è¿è¡Œæ¨¡å¼ 1$ docker run -itd --name ubuntu-test ubuntu /bin/bash åœæ­¢å®¹å™¨1$ docker stop &lt;CONTAINER ID&gt; é‡å¯å®¹å™¨1$ docker restart &lt;CONTAINER ID&gt; è¿›å…¥å®¹å™¨ä½¿ç”¨äº†-då‚æ•°åï¼Œå®¹å™¨è¿›å…¥åå°è¿è¡Œï¼Œæ­¤æ—¶éœ€è¦è¿›å…¥å®¹å™¨ï¼Œéœ€è¦æŒ‡ä»¤docker attachæˆ–docker exec å…¶ä¸­docker attachå‘½ä»¤ä¸‹å¦‚æœå®¹å™¨é€€å‡ºï¼Œåˆ™å®¹å™¨ä¼šåœæ­¢ï¼Œè€Œdocker execå‘½ä»¤ä¼šé€€å‡ºå®¹å™¨ç»ˆç«¯ï¼Œä½†ä¸ä¼šå¯¼è‡´å®¹å™¨çš„åœæ­¢ 12$ docker attach &lt;CONTAINER ID&gt;$ docker exec -it &lt;CONTAINER ID&gt; /bin/bash å¯¼å‡ºä¸å¯¼å…¥å®¹å™¨å¯¼å‡ºå®¹å™¨ï¼šå¯¼å‡ºæœ¬åœ°æŸä¸ªå®¹å™¨ 1$ docker export &lt;CONTAINER ID&gt; &gt; centos.tar å¯¼å…¥å®¹å™¨ï¼šå°†å®¹å™¨å¿«ç…§æ–‡ä»¶å¯¼å…¥åˆ°é•œåƒ 1$ cat docker/centos.tar | docker import - test/centos:v1 æˆ–é€šè¿‡æŒ‡å®šURL/ç›®å½•æ¥å¯¼å…¥ 1$ docker import http://example.com/exampleimage.tgz example/imagerepo åˆ é™¤å®¹å™¨1$ docker rm -f &lt;CONTAINER ID&gt; æ¸…ç†æ‰€æœ‰å¤„äºç»ˆæ­¢çŠ¶æ€çš„å®¹å™¨ï¼š 1$ docker container prune Dockeré•œåƒè¿è¡Œå®¹å™¨æ—¶ï¼Œä½¿ç”¨çš„é•œåƒå¦‚æœåœ¨æœ¬åœ°ä¸­ä¸å­˜åœ¨ï¼Œdockerä¼šè‡ªåŠ¨ä»dockeré•œåƒä»“åº“ä¸­ä¸‹è½½ã€‚é»˜è®¤Docker Hubå…¬å…±é•œåƒæº è·å–Dockeré•œåƒ1$ docker images å…¶ä¸­ï¼š Â· REPOSITORY ï¼šé•œåƒä»“åº“æº Â· TAGï¼šé•œåƒæ ‡ç­¾ Â· IMAGE IDï¼šé•œåƒID Â· CREATEDï¼šé•œåƒåˆ›å»ºæ—¶é—´ Â· SIZEï¼šé•œåƒå¤§å° åŒä¸€ä»“åº“æºå¯ä»¥æœ‰å¤šä¸ª TAGï¼Œä»£è¡¨è¿™ä¸ªä»“åº“æºçš„ä¸åŒä¸ªç‰ˆæœ¬ï¼Œå¦‚pythonä»“åº“æºé‡Œï¼Œæœ‰3.6.7ã€3.9.0ä¸¤ä¸ªä¸åŒçš„ç‰ˆæœ¬äº†ã€‚ä½¿ç”¨ &lt;REPOSITORY> : &lt;TAG> æ¥å®šä¹‰ä¸åŒçš„é•œåƒ ä¾‹ï¼šä½¿ç”¨3.9.0ç‰ˆæœ¬çš„pythobæ¥è¿è¡Œå®¹å™¨ï¼Œæ‰§è¡Œï¼š 1$ docker run -it python:3.9.0 /usr/bin/env python é•œåƒåçš„/usr/bin/env pythonæ˜¯å…·ä½“çš„å‘½ä»¤ï¼Œè¿™é‡Œçš„ä½œç”¨æ˜¯å¯åŠ¨äº¤äº’å¼python IDLEã€‚å¦‚æœä¸æŒ‡å®šé•œåƒçš„ç‰ˆæœ¬æ ‡ç­¾ï¼Œdockerå°†é»˜è®¤ä½¿ç”¨python:latesté•œåƒ æŸ¥æ‰¾é•œåƒ1$ docker search centos å…¶ä¸­ï¼š Â· NAME ï¼šé•œåƒä»“åº“æºåç§° Â· DESCRIPTIONï¼šé•œåƒæè¿° Â· STARSï¼šç‚¹èµæ•° Â· OFFICIALï¼šæ˜¯å¦ä¸ºDockerå®˜æ–¹å‘å¸ƒé•œåƒ Â· AUTOMATEDï¼šè‡ªåŠ¨æ„å»º é¢„åŠ è½½é•œåƒå½“åœ¨æœ¬åœ°ä¸»æœºå½“ä¸­ä½¿ç”¨ä¸å­˜åœ¨çš„é•œåƒæ—¶Dockerå°†ä¼šè‡ªåŠ¨ä¸‹è½½é•œåƒã€‚å¦‚æœè¦é¢„åŠ è½½é•œåƒï¼Œå¯ä»¥ä½¿ç”¨docker pullå‘½ä»¤ 1$ docker pull centos:7 ä¸‹è½½å®Œæˆåï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªé•œåƒè¿è¡Œå®¹å™¨ åˆ é™¤é•œåƒ1$ docker rmi &lt;IMAGE ID&gt; åˆ›å»ºè‡ªå·±çš„é•œåƒÂ· ä»å·²åˆ›å»ºå®¹å™¨å½“ä¸­æ›´æ–°é•œåƒé€šè¿‡é•œåƒè¿›å…¥ä¸€ä¸ªå®¹å™¨ 1$ docker run -it centos:7 bin/bash ä¾‹ï¼šå®‰è£…vim 1$ yum install vim æ‰§è¡Œexitå‘½ä»¤é€€å‡ºå®¹å™¨ï¼Œæ¥ç€ä½¿ç”¨docker commitå‘½ä»¤æäº¤å®¹å™¨å‰¯æœ¬ 1$ docker commit -m=\"add vim\" -a=\"9.9\" &lt;CONTAINER ID&gt; centos7:vim å…¶ä¸­ï¼š Â· -m ï¼šé•œåƒæè¿°ä¿¡æ¯ Â· -aï¼šé•œåƒä½œè€… Â· CONTAINER IDï¼šå®¹å™¨ID Â· centos7ï¼šé•œåƒåç§° Â· vimï¼šé•œåƒæ ‡ç­¾ å¯åŠ¨å®‰è£…vimçš„é•œåƒå®¹å™¨ 1$ docker run -it centos:vim /bin/bash Â· ä½¿ç”¨Dockerfileæ„å»ºé•œåƒä½¿ç”¨docker buildå‘½ä»¤ï¼Œæ„å»ºä¸€ä¸ªå…¨æ–°çš„é•œåƒã€‚éœ€è¦åœ¨è‡ªå®šç›®å½•ä¸‹åˆ›å»ºDockerfileæ–‡ä»¶ï¼Œå¹¶æ·»åŠ æ„å»ºæŒ‡ä»¤ 1234567FROM python:3.9.0ADD fastapi /WORKDIR /RUN /usr/local/bin/python -m pip install --upgrade pip -i https://pypi.tuna.tsinghua.edu.cn/simple --trusted-host pypi.tuna.tsinghua.edu.cnRUN pip install fastapi[all] -i https://pypi.tuna.tsinghua.edu.cn/simple --trusted-host pypi.tuna.tsinghua.edu.cnEXPOSE 8089CMD [\"python\",\"main.py\"] 1$ docker images ä½¿ç”¨æ„å»ºçš„é•œåƒåˆ›å»ºå®¹å™¨ 1$ docker run -it -p 8089:8089 fastapi:v1.0 è®¾ç½®é•œåƒæ ‡ç­¾1$ dcoker tag &lt;IMAGE ID&gt; &lt;REPOSITORY&gt;:&lt;TAG&gt; 1$ dcoker tag 8720FB78CF34 fastapi:v1.1 ä¸ºå·²æœ‰æ ‡ç­¾çš„é•œåƒæ·»åŠ æ ‡ç­¾ï¼Œè¯¥é•œåƒå°†å…±ç”¨ä¸¤ä¸ªæ ‡ç­¾è€Œä¸ä¼šè¢«æ›¿æ¢ è¿è¡Œåº”ç”¨ç¤ºä¾‹å¯åŠ¨åº”ç”¨è½½å…¥å¹¶è¿è¡Œé•œåƒï¼Œå…¶ä¸­-På‘½ä»¤ä½¿å®¹å™¨å†…éƒ¨ä½¿ç”¨çš„ç½‘ç»œç«¯å£éšæœºæ˜ å°„åˆ°ä¸»æœºä¸Š 12$ docker pull training/webapp$ docker run -d -P training/webapp python app.py 1$ docker ps å¯ä»¥é€šè¿‡-på‚æ•°æ¥è®¾ç½®ç«¯å£ 1$ docker run -d -p 5000:5000 training/webapp python app.py æŸ¥çœ‹å®¹å™¨å†…ç«¯å£çš„æŒ‡ä»¤ï¼š 1$ docker port &lt;CONTAINER ID&gt; æŸ¥çœ‹åº”ç”¨ç¨‹åºæ—¥å¿—/è¿›ç¨‹ï¼š 12$ docker logs -f &lt;CONTAINER ID&gt;$ docker top &lt;CONTAINER ID&gt; æŸ¥çœ‹Dockeråº”ç”¨åº•å±‚ä¿¡æ¯ï¼š 1$ docker inspect åœæ­¢åº”ç”¨å®¹å™¨1$ docker stop &lt;CONTAINER ID&gt; é‡å¯åº”ç”¨å®¹å™¨å¯¹åœæ­¢çš„åº”ç”¨ï¼šdocker start å¯¹è¿è¡Œä¸­çš„åº”ç”¨ï¼šdocker restart æŸ¥è¯¢æœ€åä¸€æ¬¡åˆ›å»ºçš„å®¹å™¨ï¼šdocker ps -l 12docker start 707a9f61dd9adocker ps -l ç§»é™¤åº”ç”¨å®¹å™¨æ³¨ï¼šå®¹å™¨å¿…é¡»æ˜¯åœæ­¢çŠ¶æ€1$docker rm &lt;CONTAINER ID&gt;### Dockerç½‘ç»œç«¯å£æ˜ å°„ä»¥fastapié•œåƒä¸ºä¾‹Â· -Pï¼šéšæœºæ˜ å°„1$ docker run -it -P &lt;REPOSITORY&gt;:&lt;TAG&gt; ...Â· -pï¼šæŒ‡å®šç«¯å£æ˜ å°„ã€æŒ‡å®šå®¹å™¨ç»‘å®šçš„ipåœ°å€1$ docker run -it -p 8089:8089 &lt;REPOSITORY&gt;:&lt;TAG&gt; ...1$ docker run -it -p 127.0.0.1:8089:8089 &lt;REPOSITORY&gt;:&lt;TAG&gt; ...é»˜è®¤éƒ½æ˜¯ç»‘å®štcpç«¯å£ï¼Œå¦‚è¦ç»‘å®šUPDåè®®ç«¯å£ï¼Œéœ€è¦åœ¨ç«¯å£ååŠ ä¸Š\\udp 1$ docker run -it -p 127.0.0.1:8089:8089/udp &lt;REPOSITORY&gt;:&lt;TAG&gt; ... Â· portï¼šå¿«é€ŸæŸ¥çœ‹ç«¯å£ç»‘å®šæƒ…å†µ 1$ docker port &lt;CONTAINER ID&gt; &lt;PORT&gt; æŒ‡å®šå®¹å™¨åç§°ã€ç”¨æˆ·ï¼š 1$ docker run -it -p 127.0.0.1:8089:8089 --name fastapi --user=root &lt;REPOSITORY&gt;:&lt;TAG&gt; ... DockerfileDockerfileæ˜¯ç”¨äºæ„å»ºé•œåƒçš„æ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†æ„å»ºé•œåƒæ—¶éœ€è¦ç”¨åˆ°çš„å„ä¸ªæŒ‡ä»¤å’Œè¯´æ˜ Dockerfileçš„æŒ‡ä»¤æ¯æ‰§è¡Œä¸€æ¬¡éƒ½ä¼šåœ¨dockerä¸Šæ–°å»ºä¸€å±‚é•œåƒï¼Œå¦‚æœæ‰§è¡Œè¿‡å¤šä¼šè„æˆé•œåƒè†¨èƒ€è¿‡å¤§ï¼Œä¾‹å¦‚ä¹‹å‰çš„fastapié•œåƒ 1234567FROM python:3.9.0ADD fastapi /WORKDIR /RUN /usr/local/bin/python -m pip install --upgrade pip -i https://pypi.tuna.tsinghua.edu.cn/simple --trusted-host pypi.tuna.tsinghua.edu.cnRUN pip install fastapi[all] -i https://pypi.tuna.tsinghua.edu.cn/simple --trusted-host pypi.tuna.tsinghua.edu.cnEXPOSE 8089CMD [\"python\",\"main.py\"] å¯ä»¥å°†å…¶ä¿®æ”¹ä¸ºï¼š 1234567FROM python:3.9.0ADD fastapi /WORKDIR /RUN /usr/local/bin/python -m pip install --upgrade pip -i https://pypi.tuna.tsinghua.edu.cn/simple --trusted-host pypi.tuna.tsinghua.edu.cn \\ &amp;&amp; pip install fastapi[all] -i https://pypi.tuna.tsinghua.edu.cn/simple --trusted-host pypi.tuna.tsinghua.edu.cnEXPOSE 8089CMD [\"python\",\"main.py\"] ä»¥&amp;&amp;ç¬¦å·è¿æ¥çš„å‘½ä»¤ï¼Œåœ¨æ‰§è¡Œååªä¼šæ„å»ºä¸€å±‚é•œåƒ æ„å»ºå‘½ä»¤1$ docker build -t &lt;REPOSITORY&gt;:&lt;TAG&gt; . æœ€å.ä»£è¡¨æœ¬æ¬¡æ‰§è¡Œçš„ä¸Šä¸‹æ–‡è·¯å¾„ï¼ˆæ‰“åŒ…æœ¬æœºç›®å½•ä¸‹æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹ï¼‰ Dockerfileå¸¸ç”¨æ„å»ºæŒ‡ä»¤Â· COPY å¤åˆ¶æŒ‡ä»¤ï¼Œä»ä¸Šä¸‹æ–‡ç›®å½•ä¸­å¤åˆ¶æ–‡ä»¶æˆ–è€…ç›®å½•åˆ°å®¹å™¨é‡ŒæŒ‡å®šè·¯å¾„ 1COPY [--chown=&lt;user&gt;:&lt;group&gt;][&lt;source&gt;,... &lt;target&gt;] 1COPY fastapi / å…¶ä¸­ï¼š Â· [â€“chown=&lt;user&gt;:&lt;group&gt;] ï¼šå¯é€‰å‚æ•°ï¼Œç”¨æˆ·æ”¹å˜å¤åˆ¶åˆ°å®¹å™¨å†…æ–‡ä»¶çš„æ‹¥æœ‰è€…å’Œå±ç»„ Â· &lt;source&gt;ï¼šæºæ–‡ä»¶æˆ–æºç›®å½• Â· &lt;targer&gt;ï¼šç›®æ ‡è·¯å¾„ï¼Œå®¹å™¨å†…çš„æŒ‡å®šè·¯å¾„ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä¼šè‡ªåŠ¨åˆ›å»º Â· ADD ä¸COPYä½¿ç”¨æ–¹æ³•ç±»ä¼¼ï¼Œä¸»è¦ç”¨äºæ‰§è¡Œçš„æºæ–‡ä»¶ä¸ºtarå‹ç¼©æ–‡ä»¶æƒ…å†µä¸‹ï¼Œä¼šè‡ªåŠ¨å¤åˆ¶å¹¶è§£å‹åˆ°ç›®æ ‡è·¯å¾„ä¸­ Â· CMD 123CMD &lt;shell å‘½ä»¤&gt; CMD [\"&lt;å¯æ‰§è¡Œæ–‡ä»¶æˆ–å‘½ä»¤&gt;\",\"&lt;param1&gt;\",\"&lt;param2&gt;\",...] CMD [\"&lt;param1&gt;\",\"&lt;param2&gt;\",...] # è¯¥å†™æ³•æ˜¯ä¸º ENTRYPOINT æŒ‡ä»¤æŒ‡å®šçš„ç¨‹åºæä¾›é»˜è®¤å‚æ•° è¿è¡Œç¨‹åºï¼Œåœ¨æ‰§è¡Œdocker runæ—¶æ‰§è¡Œ Â· ENTRYPOINT 1ENTRYPOINT [\"&lt;executeable&gt;\",\"&lt;param1&gt;\",\"&lt;param2&gt;\",...] æ‰§è¡Œdocker runæ—¶æ¥å—å‘½ä»¤è¡Œå‚æ•°ï¼Œä½†åœ¨å‘½ä»¤è¡ŒæŒ‡å®šäº† â€“entrypoint æ—¶ï¼Œå°†è¦†ç›–ENTRYPOINTæŒ‡ä»¤æŒ‡å®šçš„ç¨‹åºï¼Œä¸”å¦‚æœå­˜åœ¨å¤šä¸ªï¼Œä»…æœ‰æœ€åä¸€ä¸ªç”Ÿæ•ˆ Â· WORKDIR æŒ‡å®šå·¥ä½œç›®å½•ã€‚ç”¨WORKDIRæŒ‡å®šçš„å·¥ä½œç›®å½•ï¼Œä¼šåœ¨æ„å»ºé•œåƒçš„æ¯ä¸€å±‚ä¸­éƒ½å­˜åœ¨ï¼ˆWORKDIRæŒ‡å®šçš„å·¥ä½œç›®å½•ï¼Œå¿…é¡»æ˜¯æå‰åˆ›å»ºå¥½çš„ï¼‰ docker buildæ„å»ºé•œåƒè¿‡ç¨‹ä¸­çš„ï¼Œæ¯ä¸€ä¸ªRUNå‘½ä»¤éƒ½æ˜¯æ–°å»ºçš„ä¸€å±‚ã€‚åªæœ‰é€šè¿‡WORKDIRåˆ›å»ºçš„ç›®å½•æ‰ä¼šä¸€ç›´å­˜åœ¨ 1WORKDIR &lt;å·¥ä½œç›®å½•è·¯å¾„&gt; Â· EXPOSE å£°æ˜ç«¯å£ã€‚åœ¨è¿è¡Œæ—¶ä½¿ç”¨éšæœºç«¯å£æ˜ å°„æ—¶ï¼Œæ‰§è¡Œdocker run -Pï¼Œä¼šè‡ªåŠ¨éšæœºæ˜ å°„EXPOSEçš„ç«¯å£ 1EXPOSE &lt;ç«¯å£1&gt; [&lt;ç«¯å£2&gt;...] Â· ENV è®¾ç½®ç¯å¢ƒå˜é‡ 12ENV &lt;key&gt; &lt;value&gt;ENV &lt;key1&gt;=&lt;value1&gt; &lt;key2&gt;=&lt;value2&gt;... Â· ARG æ„å»ºå‚æ•°ï¼Œä¸ ENV ä½œç”¨ä¸€è‡´ã€‚ä¸è¿‡ä½œç”¨åŸŸä¸ä¸€æ ·ã€‚ARG è®¾ç½®çš„ç¯å¢ƒå˜é‡ä»…å¯¹ Dockerfile å†…æœ‰æ•ˆï¼Œä¹Ÿå°±æ˜¯è¯´åªæœ‰ docker build çš„è¿‡ç¨‹ä¸­æœ‰æ•ˆï¼Œæ„å»ºå¥½çš„é•œåƒå†…ä¸å­˜åœ¨æ­¤ç¯å¢ƒå˜é‡ æ„å»ºå‘½ä»¤ docker build ä¸­å¯ä»¥ç”¨ â€“build-arg &lt;å‚æ•°å&gt;=&lt;å€¼&gt; æ¥è¦†ç›– 1ARG &lt;å‚æ•°å&gt;[=&lt;é»˜è®¤å€¼&gt;] Â· VOLUME å®šä¹‰åŒ¿åæ•°æ®å·ã€‚åœ¨å¯åŠ¨å®¹å™¨æ—¶å¿˜è®°æŒ‚è½½æ•°æ®å·ï¼Œä¼šè‡ªåŠ¨æŒ‚è½½åˆ°åŒ¿åå·ï¼Œç”¨äºé¿å…é‡è¦çš„æ•°æ®å› å®¹å™¨é‡å¯è€Œä¸¢å¤±ã€é¿å…å®¹å™¨ä½“ç§¯ä¸æ–­å˜å¤§ã€‚åœ¨æ‰§è¡Œdocker runæ—¶ï¼Œå¯ä»¥é€šè¿‡-vå‚æ•°ä¿®æ”¹æŒ‚è½½ç‚¹ 12VOLUME [\"&lt;è·¯å¾„1&gt;\", \"&lt;è·¯å¾„2&gt;\"...]VOLUME &lt;è·¯å¾„&gt; Â· USER æŒ‡å®šæ‰§è¡Œåç»­å‘½ä»¤çš„ç”¨æˆ·å’Œç”¨æˆ·ç»„ï¼Œç”¨äºåˆ‡æ¢åç»­å‘½ä»¤æ‰§è¡Œçš„ç”¨æˆ·ï¼ˆç”¨æˆ·å’Œç”¨æˆ·ç»„å¿…é¡»æå‰å·²ç»å­˜åœ¨ï¼‰ 1USER &lt;ç”¨æˆ·å&gt;[:&lt;ç”¨æˆ·ç»„&gt;] Â· HEALTHCHECK æŒ‡å®šæŸä¸ªç¨‹åºæˆ–è€…æŒ‡ä»¤æ¥ç›‘æ§ docker å®¹å™¨æœåŠ¡çš„è¿è¡ŒçŠ¶æ€ 123HEALTHCHECK [é€‰é¡¹] CMD &lt;å‘½ä»¤&gt;ï¼šè®¾ç½®æ£€æŸ¥å®¹å™¨å¥åº·çŠ¶å†µçš„å‘½ä»¤HEALTHCHECK NONEï¼šå¦‚æœåŸºç¡€é•œåƒæœ‰å¥åº·æ£€æŸ¥æŒ‡ä»¤ï¼Œä½¿ç”¨è¿™è¡Œå¯ä»¥å±è”½æ‰å…¶å¥åº·æ£€æŸ¥æŒ‡ä»¤HEALTHCHECK [é€‰é¡¹] CMD &lt;å‘½ä»¤&gt; : è¿™è¾¹ CMD åé¢è·Ÿéšçš„å‘½ä»¤ä½¿ç”¨ï¼Œå¯ä»¥å‚è€ƒ CMD çš„ç”¨æ³•ã€‚ Â· ONBUILD ç”¨äºå»¶è¿Ÿæ„å»ºå‘½ä»¤çš„æ‰§è¡Œã€‚å°±æ˜¯ Dockerfile é‡Œä½¿ç”¨ONBUILDæŒ‡å®šçš„å‘½ä»¤ï¼Œåœ¨æœ¬æ¬¡æ„å»ºé•œåƒçš„è¿‡ç¨‹ä¸­ä¸ä¼šæ‰§è¡Œï¼ˆå‡è®¾é•œåƒä¸º test-buildï¼‰ã€‚å½“æœ‰æ–°çš„Dockerfileä½¿ç”¨äº†ä¹‹å‰æ„å»ºçš„é•œåƒFROM test-build ï¼Œè¿™æ—¶æ‰§è¡Œæ–°é•œåƒçš„Dockerfileæ„å»ºæ—¶å€™ï¼Œä¼šæ‰§è¡Œtest-buildçš„Dockerfileé‡ŒONBUILDæŒ‡å®šçš„å‘½ä»¤ 1ONBUILD &lt;å…¶å®ƒæŒ‡ä»¤&gt; Â· LABEL LABEL æŒ‡ä»¤ä»¥é”®å€¼å¯¹çš„å½¢å¼ç»™é•œåƒæ·»åŠ ä¸€äº›å…ƒæ•°æ®ï¼ˆmetadataï¼‰ 1LABEL &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; ... Dockeræ‰“åŒ…æ‰“åŒ…tar1$ docker save -o &lt;filename&gt; &lt;REPOSITORY&gt;:&lt;TAG&gt; 1$ docker save -o fastapi.tar fastapi:v1.0 åŠ è½½tar1$ docker load &lt; fastapi.tar è¿›å…¥å®¹å™¨å†…éƒ¨ç¼–è¾‘å®¹å™¨è¿è¡Œä¸€ä¸ªå®¹å™¨ 1$ docker run -d -P &lt;REPOSITORY&gt;:&lt;TAG&gt; è¿›å…¥å®¹å™¨å†…éƒ¨ 1$ docker exec -it &lt;CONTAINER ID&gt; [bash]/[/bin/sh]/[/bin/bash] é€€å‡ºå®¹å™¨å†…éƒ¨ 1$ quit å¤åˆ¶å®¹å™¨å†…ä»£ç æ–‡ä»¶1$ docker cp &lt;CONTAINER ID&gt;:/file/path/within/container /root/path/target","categories":[{"name":"Docker","slug":"Docker","permalink":"http://yoursite.com/categories/Docker/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"http://yoursite.com/tags/Docker/"}]},{"title":"Nebula-fastapiæ¥å£ç»´æŠ¤æ–‡æ¡£","slug":"Nebula-fastapiæ¥å£ç»´æŠ¤æ–‡æ¡£","date":"2022-08-19T09:40:40.000Z","updated":"2022-11-25T09:10:52.210Z","comments":true,"path":"2022/08/19/Nebula-fastapiæ¥å£ç»´æŠ¤æ–‡æ¡£/","link":"","permalink":"http://yoursite.com/2022/08/19/Nebula-fastapiæ¥å£ç»´æŠ¤æ–‡æ¡£/","excerpt":"æ™®é€šæ¥å£1.å¯¼å…¥fastapiã€è¿æ¥nebulaè¿æ¥æ± 123456789101112131415161718192021222324from fastapi import FastAPIfrom nebula2.gclient.net import ConnectionPoolfrom nebula2.Config import Config# å…³é—­åœ¨çº¿æ–‡æ¡£ï¼Œé˜²æ­¢æ”»å‡»app_router = FastAPI(docs_url=None, redoc_url=None)config = Config()config.max_connection_pool_size = 10# è¿æ¥è¶…æ—¶æ—¶é—´config.timeout = 60000# å…³é—­ç©ºé—²è¿æ¥æ—¶é—´config.idle_time = 0# æ£€æŸ¥ç©ºé—²è¿æ¥æ—¶é—´é—´éš”config.interval_check = -1# åˆå§‹åŒ–è¿æ¥æ± connection_pool = ConnectionPool()# å¦‚æœç»™å®šçš„æœåŠ¡å™¨æ­£å¸¸ï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseok = connection_pool.init([('host', 9669)], config)if __name__ == \"__main__\": import uvicorn uvicorn.run(app=\"nebula_api:app_router\", reload=True, debug=True, host=host, port=port) 2.CORSè·¨åŸŸè®¿é—®è®¾ç½®123456789101112131415from fastapi.middleware.cors import CORSMiddleware# CORSorigins = [ \"*\"]app_router.add_middleware( CORSMiddleware, allow_origins=origins, allow_credentials=True, allow_methods=[\"*\"], allow_headers=[\"*\"])","text":"æ™®é€šæ¥å£1.å¯¼å…¥fastapiã€è¿æ¥nebulaè¿æ¥æ± 123456789101112131415161718192021222324from fastapi import FastAPIfrom nebula2.gclient.net import ConnectionPoolfrom nebula2.Config import Config# å…³é—­åœ¨çº¿æ–‡æ¡£ï¼Œé˜²æ­¢æ”»å‡»app_router = FastAPI(docs_url=None, redoc_url=None)config = Config()config.max_connection_pool_size = 10# è¿æ¥è¶…æ—¶æ—¶é—´config.timeout = 60000# å…³é—­ç©ºé—²è¿æ¥æ—¶é—´config.idle_time = 0# æ£€æŸ¥ç©ºé—²è¿æ¥æ—¶é—´é—´éš”config.interval_check = -1# åˆå§‹åŒ–è¿æ¥æ± connection_pool = ConnectionPool()# å¦‚æœç»™å®šçš„æœåŠ¡å™¨æ­£å¸¸ï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseok = connection_pool.init([('host', 9669)], config)if __name__ == \"__main__\": import uvicorn uvicorn.run(app=\"nebula_api:app_router\", reload=True, debug=True, host=host, port=port) 2.CORSè·¨åŸŸè®¿é—®è®¾ç½®123456789101112131415from fastapi.middleware.cors import CORSMiddleware# CORSorigins = [ \"*\"]app_router.add_middleware( CORSMiddleware, allow_origins=origins, allow_credentials=True, allow_methods=[\"*\"], allow_headers=[\"*\"]) 3.ä¸€èˆ¬æŸ¥è¯¢æ¥å£1.å•ç‚¹æŸ¥è¯¢1234567891011121314151617181920212223242526272829303132333435363738394041# ä»è¿æ¥æ± ä¸­è·å–ä¼šè¯session = connection_pool.get_session('root', 'nebula')session.execute('USE ai_project')data_final = []errorcode = 0result = &#123; \"data\": data_final, \"errorcode\": errorcode&#125;# ä¸¾ä¾‹ï¼ŒæŸ¥è¯¢æ ‡ç­¾exampledata_select = session.execute( str(f'match (v:example) return id(v),v.name;'))# æŸ¥è¯¢å‡ºé”™ï¼Œé”™è¯¯ä»£ç 1if not data_select.is_succeeded(): session.release() result[\"errorcode\"] = 1 return result# æŸ¥è¯¢ç»“æœä¸ä¸ºç©ºï¼Œæ˜¾ç¤ºæ•°æ®if not data_select.is_empty(): size = data_select.row_size() for index in range(size): data1 = data_select.row_values(index)[0].as_string() data2 = data_select.row_values(index)[1].as_string() data_dict = &#123; \"entity_id\": data1, \"name\": data2, &#125; data_final.append(data_dict) session.release() return result# æŸ¥è¯¢ç±»å‹ä¸‹å®ä½“ä¸ºç©ºï¼Œé”™è¯¯ä»£ç 2session.release()result[\"errorcode\"] = 2return result 2.æ ‘å‹æŸ¥è¯¢ä¸»å‡½æ•°ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465# è‡ªå®šä¹‰ç±»å’Œå‡½æ•°from api_class import *session = connection_pool.get_session('root', 'nebula')session.execute('USE ai_project')data_final = []errorcode = 0result = &#123; \"data\": data_final, \"errorcode\": errorcode&#125;# ä»¥example_idä¸ºæ ¹èŠ‚ç‚¹data_select = session.execute( str(f'match Ret=(v)-[e:edge_example*0..15]-&gt;(p) where id(v)==\"&#123;example_id&#125;\" return nodes(Ret);'))# æŸ¥è¯¢å‡ºé”™ï¼Œé”™è¯¯ä»£ç 1if not data_select.is_succeeded(): session.release() result[\"errorcode\"] = 1 return result# æŸ¥è¯¢ä¸ä¸ºç©ºï¼Œæ˜¾ç¤ºæ•°æ®if not data_select.is_empty(): size = data_select.row_size() data_list = [] for index in range(size): data1 = data_select.row_values(index)[0].as_list() item = re.finditer(r'\\(\\\"(.*?)\\\" :(.*?)\\&#123;(.*?)\\&#125;\\)', str(data1)) parent_id = '0' for match in item: kv_dict = &#123; 'parent_id': parent_id, 'entity_id': match.group(1).strip(), 'entity_type': match.group(2).strip() &#125; kvs = match.group(3).replace(\" \", \"\").split(\",\") for kv in kvs: kv_dict[kv.strip().split(':')[0]] = kv.split(':')[1][1:-1] if kv_dict not in data_list: data_list.append(kv_dict) parent_id = match.group(1).strip() # jsonå¯¹è±¡åˆ—è¡¨è½¬æ¢ä¸ºæ ‘å½¢jsonå¯¹è±¡ data_final = ApiFuncs.list_to_tree(data_list) # æ ‘å½¢jsonå¯¹è±¡æŒ‰å‚æ•°æ’åº ApiFuncs.data_sort(data_final) for item in data_final: del item[\"parent_id\"] session.release() result[\"data\"] = data_final return resultsession.release()result[\"errorcode\"] = 2return result å°†jsonå¯¹è±¡åˆ—è¡¨è½¬æ¢ä¸ºæ ‘å½¢jsonå¯¹è±¡çš„å‡½æ•°ï¼š 1234567891011121314151617181920212223242526272829303132333435363738class ApiFuncs: @staticmethod def list_to_tree(data): root = [] node = [] for d in data: if d.get(\"parent_id\") == '0': root.append(d) else: node.append(d) for p in root: ApiFuncs.add_node(p, node) if len(root) == 0: return node return root @staticmethod def add_node(p, node): p[\"children\"] = [] for n in node: if n.get(\"parent_id\") == p.get(\"entity_id\"): p[\"children\"].append(n) for t in p[\"children\"]: if not t.get(\"children\"): t[\"children\"] = [] t[\"children\"].append(ApiFuncs.add_node(t, node)) if not t[\"children\"]: del t[\"children\"] if len(p[\"children\"]) == 0: return å°†æ ‘å½¢jsonå¯¹è±¡æŒ‰å‚æ•°æ’åºçš„å‡½æ•°ï¼š 1234567891011121314151617class SerialNameError(Exception): def __init__(self, message): self.message = message... @staticmethod def data_sort(data): for elem in data: if elem[\"serial\"] == \"_NULL_\": elem[\"serial\"] = \"0\" try: data.sort(key=lambda x: int(x[\"serial\"])) except ValueError: raise SerialNameError(\"åºå·ä¼¼ä¹æ— æ•ˆ\") for item in data: if \"children\" in item.keys(): ApiFuncs.data_sort(item[\"children\"]) return 4.ä¸€èˆ¬ç¼–è¾‘æ¥å£123456# ç»§æ‰¿BaseModelç±»çš„å‚æ•°from typing import Listfrom pydantic import BaseModelclass SampleEdit(BaseModel): example_kv: List[dict] 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859session = connection_pool.get_session('root', 'nebula')session.execute('USE ai_project')result = &#123; \"msg\": True, \"errorcode\": 0&#125;for item in eg.example_kv: # æ–°å¢ if item[\"type_operation\"] == 'add': \"\"\" ==========å¢========== \"\"\" temp_id = item[\"name\"] + \"_\" + ApiFuncs.create_time() temp_md5 = ApiFuncs.create_md5(temp_id) # æ£€ç´¢å½“å‰ç¼–å·ï¼Œåˆ›å»ºå®ä½“æ—¶å¯¹ç¼–å·è‡ªå¢ serial_list = session.execute( str(f'match (v:example) return v.seq;') ) data = [] size = serial_list.row_size() for index in range(size): if serial_list.row_values(index)[0].is_string(): data1 = serial_list.row_values(index)[0].as_string() data.append(int(data1)) if data: count = max(data) count += 1 else: count = 1 session.execute( str(f'INSERT VERTEX example ( name,seq ) VALUES \"&#123;temp_md5&#125;\":(\"&#123;item[\"name\"]&#125;\", \"&#123;count&#125;\");') ) # åˆ é™¤ elif item[\"type_operation\"] == 'delete': \"\"\" ==========åˆ ========== \"\"\" session.execute(str(f'DELETE VERTEX \"&#123;item[\"id\"]&#125;\";')) # ä¿®æ”¹ elif item[\"type_operation\"] == 'update': \"\"\" ==========æ”¹========== \"\"\" temp_md5 = item[\"id\"] session.execute( str(f'UPDATE VERTEX ON example \"&#123;temp_md5&#125;\" SET name = \"&#123;item[\"name\"]&#125;\";') )# å…³é—­è¿æ¥æ± session.release()return result æµ‹è¯•æ¥å£ï¼š 1234567891011121314import requestsimport jsondata = &#123; 'example_kv': [ &#123;\"type_operation\": \"add\", \"name\": \"test\"&#125;, &#123;...&#125;, ... ],&#125;body = json.dumps(data)response = requests.post('http://127.0.0.1:8888/example', data=body)print(response.text) 5.åŠŸèƒ½å‡½æ•°æŸ¥æ‰¾æ ‘å‹jsonç»“æ„ä¸­å…³é”®å­— 12345678910import redef find_name(json_data, e): for element in json_data: match = re.search(e, element[\"name\"]) if match: id_collect.append(element[\"entity_id\"]) if \"children\" in element.keys(): find_name(element[\"children\"], e) return id_collect åˆ†é¡µ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495from __future__ import annotationsimport mathfrom fastapi import FastAPI, Dependsfrom fastapi_pagination import paginate, add_paginationfrom typing import TypeVar, Generic, Sequencefrom fastapi import Queryfrom fastapi_pagination.bases import AbstractPage, AbstractParams, RawParamsfrom pydantic import BaseModelT = TypeVar(\"T\")class Params(BaseModel, AbstractParams): page: int = Query(1, ge=1, description=\"Page number\") size: int = Query(17, gt=0, le=100, description=\"Page size\") def to_raw_params(self) -&gt; RawParams: return RawParams( limit=self.size, offset=self.size * (self.page - 1), )class Page(AbstractPage[T], Generic[T]): results: Sequence[T] total: int page: int size: int next: str previous: str total_pages: int __params_type__ = Params @classmethod def create( cls, results: results, total: int, params: Params, ) -&gt; Page[T]: page = params.page size = params.size total_pages = math.ceil(total / params.size) next = f\"?page=&#123;page + 1&#125;&amp;size=&#123;size&#125;\" if (page + 1) &lt;= total_pages else \"null\" previous = f\"?page=&#123;page - 1&#125;&amp;size=&#123;size&#125;\" if (page - 1) &gt;= 1 else \"null\" return cls(results=results, total=total, page=params.page, size=params.size, next=next, previous=previous, total_pages=total_pages)app = FastAPI()class User(BaseModel): sample_id: str sample_name: str time: strsample_data = [ &#123; \"sample_id\": \"000001\", \"sample_name\": \"test1\", \"time\": \"2022-08-11 21:15:33\" &#125;, &#123; \"sample_id\": \"000002\", \"sample_name\": \"test2\", \"time\": \"2022-08-12 13:45:56\" &#125;, &#123; \"sample_id\": \"000003\", \"sample_name\": \"test3\", \"time\": \"2022-08-12 13:45:59\" &#125;,]@app.get('/sample', response_model=Page[User])async def get_users(): return paginate(sample_data)add_pagination(app)if __name__ == \"__main__\": import uvicorn uvicorn.run(app=\"1:app\", reload=True, host='127.0.0.1', port=9999) é¡¹ç›®çº§æ–‡ä»¶ç›®å½•ç»“æ„â”‚ api_class.pyâ”‚ main.pyâ”‚â”œâ”€apiâ”‚ â”‚ nebuladb.pyâ”‚ â”‚ proj_1.pyâ”‚ â”‚ proj_2.pyâ”‚ â”‚ __init__.pyâ”‚ â”‚â”‚ â””â”€__pycache__â”‚ nebuladb.cpython-39.pycâ”‚ proj_1cpython-39.pycâ”‚ proj_2.cpython-39.pycâ”‚ __init__.cpython-39.pycâ”‚â”œâ”€dataâ”‚ nebula_data.txtâ”‚â”œâ”€logsâ”‚ 2022-xx-01.txtâ”‚ 2022-xx-02.txtâ”‚ 2022-xx-03.txtâ”‚ 2022-xx-04.txtâ”‚â”œâ”€scriptsâ”‚ post_1.pyâ”‚ test_1.pyâ”‚â”œâ”€utilsâ”‚ â”‚ client.pyâ”‚ â”‚ creat_data.pyâ”‚ â”‚ log.pyâ”‚ â”‚ snapshot_day_by_day.pyâ”‚ â”‚ __init__.pyâ”‚ â”‚â”‚ â””â”€__pycache__â”‚ log.cpython-39.pycâ”‚ __init__.cpython-39.pycâ”‚â””â”€__pycache__ api_class.cpython-39.pyc main.cpython-39.pyc ä¸»å‡½æ•°main.py12345678from api import mainfrom fastapi_pagination import add_paginationapp_router = main()add_pagination(app_router)if __name__ == \"__main__\": import uvicorn uvicorn.run(app=\"main:app_router\", reload=True, debug=True, host='0.0.0.0', port=8888) æ—¥å¿—utils/log.py123456789101112131415161718192021222324252627282930313233import osimport loggingimport logging.handlersimport timeclass LogInit(object): __instance = None def __init__(self): _log_dir = os.path.join(os.path.dirname(__file__), '../logs') _log_name = time.strftime('%Y-%m-%d', time.localtime(time.time())) + '.txt' self.logger = logging.getLogger(_log_name) self.logger.setLevel(logging.DEBUG) formatter = logging.Formatter( '%(asctime)s - %(levelname)s - %(filename)s - %(funcName)s - %(lineno)s - %(message)s') if not self.logger.handlers: file_log_handler = logging.handlers.RotatingFileHandler(os.path.join(_log_dir, _log_name), maxBytes=10 * 1024 * 1024, backupCount=3, encoding=\"utf-8\") file_log_handler.setLevel(logging.INFO) file_log_handler.setFormatter(formatter) self.logger.addHandler(file_log_handler) @staticmethod def set_logger(): if not LogInit.__instance: LogInit.__instance = LogInit() return LogInit.__instancelogger = LogInit.set_logger().logger ä½¿ç”¨æ–¹å¼ï¼š 12345from utils.log import loggerlogger.info(\"ä¿¡æ¯\")logger.warning(\"è­¦å‘Š\")logger.error(\"é”™è¯¯\") æ•°æ®åº“é…ç½®api/nebuladb.py1234567891011from nebula2.Config import Configfrom nebula2.gclient.net import ConnectionPool# NEBULAconfig = Config()config.max_connection_pool_size = 10config.timeout = 60000config.idle_time = 0config.interval_check = -1connection_pool = ConnectionPool()ok = connection_pool.init([('192.168.80.128', 9669)], config) å›¾è°±å¿«ç…§ä¿å­˜è„šæœ¬utils/snapshot_day_by_day.py123456789101112131415161718192021222324252627282930313233343536373839404142434445import scheduleimport timefrom nebula2.gclient.net import ConnectionPoolfrom nebula2.Config import Configconfig = Config()config.max_connection_pool_size = 10config.timeout = 60000config.idle_time = 0config.interval_check = -1connection_pool = ConnectionPool()ok = connection_pool.init([('192.168.80.128', 9669)], config)def add_snapshot(): session = connection_pool.get_session('root', 'nebula') session.execute('USE ai_project') session.execute(str('CREATE SNAPSHOT'))def del_snapshot(): session = connection_pool.get_session('root', 'nebula') session.execute('USE ai_project') data = session.execute(str('SHOW SNAPSHOTS')) datas = [] if not data.is_empty(): size = data.row_size() for index in range(size): data1 = data.row_values(index)[0].as_string() datas.append(data1) if len(datas) &gt; 3: data_final = datas[:-3] for i in data_final: session.execute(str(f'DROP SNAPSHOT &#123;i&#125;'))schedule.every().day.at(\"22:00\").do(add_snapshot)schedule.every().day.at(\"22:00\").do(del_snapshot)while True: schedule.run_pending() time.sleep(1) apiåŒ…api/__init__.pyé…ç½®1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950from fastapi import FastAPIfrom fastapi.middleware.cors import CORSMiddlewarefrom api.stdlib import stdlib_routerfrom api.quota import quota_routerdef main(): app = FastAPI(docs_url=None, redoc_url=None) app_cors(app) app_stdlib(app) app_quota(app) app_ocr(app) return appdef app_cors(app: FastAPI): \"\"\" CORS :param app: :return: \"\"\" origins = [ \"*\" ] app.add_middleware( CORSMiddleware, allow_origins=origins, allow_credentials=True, allow_methods=[\"*\"], allow_headers=[\"*\"] )def app_proj_1(app: FastAPI): \"\"\" é¡¹ç›®1 :param app: :return: \"\"\" app.include_router(proj_1_router) def app_proj_2(app: FastAPI): \"\"\" é¡¹ç›®2 :param app: :return: \"\"\" app.include_router(proj_2_router) é¡¹ç›®æ¥å£api/proj_1(2).py123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657from fastapi import APIRouterfrom utils.log import loggerfrom api_class import *from .nebuladb import *proj_1_router = APIRouter( prefix=\"/api\",)@stdlib_router.api_route(\"/project/standard\", methods=['GET'])async def get_project_standard(): \"\"\" è·å–å·¥ç¨‹è§„èŒƒ :return: \"\"\" # ä»è¿æ¥æ± ä¸­è·å–ä¼šè¯ session = connection_pool.get_session('root', 'nebula') session.execute('USE ai_project') data_final = [] errorcode = 0 result = &#123; \"data\": data_final, \"errorcode\": errorcode &#125; # ä¸¾ä¾‹ï¼ŒæŸ¥è¯¢æ ‡ç­¾example data_select = session.execute( str(f'match (v:example) return id(v),v.name;') ) # æŸ¥è¯¢å‡ºé”™ï¼Œé”™è¯¯ä»£ç 1 if not data_select.is_succeeded(): session.release() result[\"errorcode\"] = 1 return result # æŸ¥è¯¢ç»“æœä¸ä¸ºç©ºï¼Œæ˜¾ç¤ºæ•°æ® if not data_select.is_empty(): size = data_select.row_size() for index in range(size): data1 = data_select.row_values(index)[0].as_string() data2 = data_select.row_values(index)[1].as_string() data_dict = &#123; \"entity_id\": data1, \"name\": data2, &#125; data_final.append(data_dict) session.release() return result # æŸ¥è¯¢ç±»å‹ä¸‹å®ä½“ä¸ºç©ºï¼Œé”™è¯¯ä»£ç 2 session.release() result[\"errorcode\"] = 2 return result","categories":[{"name":"Web","slug":"Web","permalink":"http://yoursite.com/categories/Web/"}],"tags":[{"name":"nebula","slug":"nebula","permalink":"http://yoursite.com/tags/nebula/"},{"name":"fastapi","slug":"fastapi","permalink":"http://yoursite.com/tags/fastapi/"}]},{"title":"PaddleOCRè¡¨æ ¼è¯†åˆ«","slug":"PaddleOCRè¡¨æ ¼è¯†åˆ«","date":"2022-07-21T06:15:22.000Z","updated":"2022-09-22T03:43:56.275Z","comments":true,"path":"2022/07/21/PaddleOCRè¡¨æ ¼è¯†åˆ«/","link":"","permalink":"http://yoursite.com/2022/07/21/PaddleOCRè¡¨æ ¼è¯†åˆ«/","excerpt":"PaddleOCR2.5æ ¹ç›®å½•ä¸‹çš„ppstructureæ–‡ä»¶æ¨¡å—æ˜¯PaddleOCRæä¾›çš„ä¸€ä¸ªå¯ç”¨äºå¤æ‚æ–‡æ¡£ç»“æ„åˆ†æå¤„ç†çš„OCRå·¥å…·åŒ…githubæ–‡æ¡£é¡µé¢ï¼šhttps://github.com/PaddlePaddle/PaddleOCR/blob/release/2.5/ppstructure/README_ch.md å®‰è£…ä¾èµ–Â· å®‰è£…paddleocr version&gt;=2.51pip install &quot;paddleocr&gt;=2.5&quot; Â· å®‰è£…ç‰ˆé¢åˆ†æä¾èµ–åŒ…layoutparser1pip install -U https://paddleocr.bj.bcebos.com/whl/layoutparser-0.0.0-py3-none-any.whl Â· å®‰è£…DocVQAä¾èµ–åŒ…paddlenlpï¼ˆDocVQAåŠŸèƒ½ï¼Œé€‰è£…ï¼‰1pip install paddlenlp å¿«é€Ÿå¼€å§‹åœ¨PaddleOCR/ppstructureç›®å½•ä¸‹è¿›å…¥CMDå‘½ä»¤è¡Œï¼Œæˆ–è€…åˆ›å»ºpythonè„šæœ¬å¯åŠ¨Â· è¡¨æ ¼è¯†åˆ« 1paddleocr --image_dir=docs/table/table.jpg --type=structure --layout=false pythonè„šæœ¬ï¼š 123456789101112131415import osimport cv2from paddleocr import PPStructure,save_structure_restable_engine = PPStructure(layout=False, show_log=True)save_folder = './output'img_path = 'PaddleOCR/ppstructure/docs/table/table.jpg'img = cv2.imread(img_path)result = table_engine(img)save_structure_res(result, save_folder, os.path.basename(img_path).split('.')[0])for line in result: line.pop('img') print(line) Â· ç‰ˆé¢åˆ†æ 1paddleocr --image_dir=docs/table/1.png --type=structure --table=false --ocr=false pythonè„šæœ¬ï¼š 123456789101112131415import osimport cv2from paddleocr import PPStructure,save_structure_restable_engine = PPStructure(table=False, ocr=False, show_log=True)save_folder = './output'img_path = 'PaddleOCR/ppstructure/docs/table/1.png'img = cv2.imread(img_path)result = table_engine(img)save_structure_res(result, save_folder, os.path.basename(img_path).split('.')[0])for line in result: line.pop('img') print(line) Â· ç‰ˆé¢åˆ†æ+è¡¨æ ¼è¯†åˆ« 1paddleocr --image_dir=docs/table/1.png --type=structure pythonè„šæœ¬ï¼š1234567891011121314151617181920212223import osimport cv2from paddleocr import PPStructure, draw_structure_result, save_structure_resfrom PIL import Imagetable_engine = PPStructure(show_log=True)save_folder = './output'img_path = './ppstructure/docs/table/table.jpg'img = cv2.imread(img_path)result = table_engine(img)save_structure_res(result, save_folder, os.path.basename(img_path).split('.')[0])for line in result: line.pop('img') print(line)font_path = './doc/fonts/simfang.ttf'image = Image.open(img_path).convert('RGB')im_show = draw_structure_result(image, result, font_path=font_path)im_show = Image.fromarray(im_show)im_show.save('result.jpg')","text":"PaddleOCR2.5æ ¹ç›®å½•ä¸‹çš„ppstructureæ–‡ä»¶æ¨¡å—æ˜¯PaddleOCRæä¾›çš„ä¸€ä¸ªå¯ç”¨äºå¤æ‚æ–‡æ¡£ç»“æ„åˆ†æå¤„ç†çš„OCRå·¥å…·åŒ…githubæ–‡æ¡£é¡µé¢ï¼šhttps://github.com/PaddlePaddle/PaddleOCR/blob/release/2.5/ppstructure/README_ch.md å®‰è£…ä¾èµ–Â· å®‰è£…paddleocr version&gt;=2.51pip install &quot;paddleocr&gt;=2.5&quot; Â· å®‰è£…ç‰ˆé¢åˆ†æä¾èµ–åŒ…layoutparser1pip install -U https://paddleocr.bj.bcebos.com/whl/layoutparser-0.0.0-py3-none-any.whl Â· å®‰è£…DocVQAä¾èµ–åŒ…paddlenlpï¼ˆDocVQAåŠŸèƒ½ï¼Œé€‰è£…ï¼‰1pip install paddlenlp å¿«é€Ÿå¼€å§‹åœ¨PaddleOCR/ppstructureç›®å½•ä¸‹è¿›å…¥CMDå‘½ä»¤è¡Œï¼Œæˆ–è€…åˆ›å»ºpythonè„šæœ¬å¯åŠ¨Â· è¡¨æ ¼è¯†åˆ« 1paddleocr --image_dir=docs/table/table.jpg --type=structure --layout=false pythonè„šæœ¬ï¼š 123456789101112131415import osimport cv2from paddleocr import PPStructure,save_structure_restable_engine = PPStructure(layout=False, show_log=True)save_folder = './output'img_path = 'PaddleOCR/ppstructure/docs/table/table.jpg'img = cv2.imread(img_path)result = table_engine(img)save_structure_res(result, save_folder, os.path.basename(img_path).split('.')[0])for line in result: line.pop('img') print(line) Â· ç‰ˆé¢åˆ†æ 1paddleocr --image_dir=docs/table/1.png --type=structure --table=false --ocr=false pythonè„šæœ¬ï¼š 123456789101112131415import osimport cv2from paddleocr import PPStructure,save_structure_restable_engine = PPStructure(table=False, ocr=False, show_log=True)save_folder = './output'img_path = 'PaddleOCR/ppstructure/docs/table/1.png'img = cv2.imread(img_path)result = table_engine(img)save_structure_res(result, save_folder, os.path.basename(img_path).split('.')[0])for line in result: line.pop('img') print(line) Â· ç‰ˆé¢åˆ†æ+è¡¨æ ¼è¯†åˆ« 1paddleocr --image_dir=docs/table/1.png --type=structure pythonè„šæœ¬ï¼š1234567891011121314151617181920212223import osimport cv2from paddleocr import PPStructure, draw_structure_result, save_structure_resfrom PIL import Imagetable_engine = PPStructure(show_log=True)save_folder = './output'img_path = './ppstructure/docs/table/table.jpg'img = cv2.imread(img_path)result = table_engine(img)save_structure_res(result, save_folder, os.path.basename(img_path).split('.')[0])for line in result: line.pop('img') print(line)font_path = './doc/fonts/simfang.ttf'image = Image.open(img_path).convert('RGB')im_show = draw_structure_result(image, result, font_path=font_path)im_show = Image.fromarray(im_show)im_show.save('result.jpg') å‚æ•°è¯´æ˜ å­—æ®µ è¯´æ˜ é»˜è®¤å€¼ output excelå’Œè¯†åˆ«ç»“æœä¿å­˜çš„åœ°å€ ./output/table table_max_len è¡¨æ ¼ç»“æ„æ¨¡å‹é¢„æµ‹æ—¶ï¼Œå›¾åƒçš„é•¿è¾¹resizeå°ºåº¦ 488 table_model_dir è¡¨æ ¼ç»“æ„æ¨¡å‹ inference æ¨¡å‹åœ°å€ None table_char_dict_path è¡¨æ ¼ç»“æ„æ¨¡å‹æ‰€ç”¨å­—å…¸åœ°å€ ../ppocr/utils/dict/table_structure_dict.txt layout_path_model ç‰ˆé¢åˆ†ææ¨¡å‹æ¨¡å‹åœ°å€ï¼Œå¯ä»¥ä¸ºåœ¨çº¿åœ°å€æˆ–è€…æœ¬åœ°åœ°å€ï¼Œå½“ä¸ºæœ¬åœ°åœ°å€æ—¶ï¼Œéœ€è¦æŒ‡å®š layout_label_map, å‘½ä»¤è¡Œæ¨¡å¼ä¸‹å¯é€šè¿‡â€“layout_label_map=â€™{0: â€œTextâ€, 1: â€œTitleâ€, 2: â€œListâ€, 3:â€Tableâ€, 4:â€Figureâ€}â€™ æŒ‡å®š lp://PubLayNet/ppyolov2_r50vd_dcn_365e_publaynet/config layout_label_map ç‰ˆé¢åˆ†ææ¨¡å‹æ¨¡å‹labelæ˜ å°„å­—å…¸ None model_name_or_path VQA SERæ¨¡å‹åœ°å€ None max_seq_length VQA SERæ¨¡å‹æœ€å¤§æ”¯æŒtokené•¿åº¦ 512 label_map_path VQA SER æ ‡ç­¾æ–‡ä»¶åœ°å€ ./vqa/labels/labels_ser.txt layout å‰å‘ä¸­æ˜¯å¦æ‰§è¡Œç‰ˆé¢åˆ†æ True table å‰å‘ä¸­æ˜¯å¦æ‰§è¡Œè¡¨æ ¼è¯†åˆ« True ocr å¯¹äºç‰ˆé¢åˆ†æä¸­çš„éè¡¨æ ¼åŒºåŸŸï¼Œæ˜¯å¦æ‰§è¡Œocrã€‚å½“layoutä¸ºFalseæ—¶ä¼šè¢«è‡ªåŠ¨è®¾ç½®ä¸ºFalse True structure_version è¡¨æ ¼ç»“æ„åŒ–æ¨¡å‹ç‰ˆæœ¬ï¼Œå¯é€‰ PP-STRUCTUREã€‚PP-STRUCTUREæ”¯æŒè¡¨æ ¼ç»“æ„åŒ–æ¨¡å‹ pp-structure æ¨¡å‹ä¸‹è½½ æ¨¡å‹ç±»å‹ æ¨¡å‹åç§° æ¨¡å‹ç®€ä»‹ ä¸‹è½½åœ°å€ ç‰ˆé¢åˆ†ææ¨¡å‹ ppyolov2_r50vd_dcn_365e_publaynet PubLayNet æ•°æ®é›†è®­ç»ƒçš„ç‰ˆé¢åˆ†ææ¨¡å‹ï¼Œå¯ä»¥åˆ’åˆ†æ–‡å­—ã€æ ‡é¢˜ã€è¡¨æ ¼ã€å›¾ç‰‡ä»¥åŠåˆ—è¡¨5ç±»åŒºåŸŸ æ¨ç†æ¨¡å‹/è®­ç»ƒæ¨¡å‹ OCRæ¨¡å‹ ch_PP-OCRv3_det_infer PubLayNetæ•°æ®é›†è®­ç»ƒçš„ä¸­è‹±æ–‡è¶…è½»é‡PP-OCRv3æ¨¡å‹ æ¨ç†æ¨¡å‹/è®­ç»ƒæ¨¡å‹ OCRæ¨¡å‹ en_ppocr_mobile_v2.0_table_rec PubLayNetæ•°æ®é›†è®­ç»ƒçš„ä¸­è‹±æ–‡è¶…è½»é‡PP-OCRv3æ¨¡å‹ æ¨ç†æ¨¡å‹/è®­ç»ƒæ¨¡å‹ è¡¨æ ¼è¯†åˆ«æ¨¡å‹ en_ppocr_mobile_v2.0_table_structure PubLayNetæ•°æ®é›†è®­ç»ƒçš„è‹±æ–‡è¡¨æ ¼åœºæ™¯çš„è¡¨æ ¼ç»“æ„é¢„æµ‹ æ¨ç†æ¨¡å‹/è®­ç»ƒæ¨¡å‹ é¢„æµ‹ç¤ºä¾‹ï¼ˆä»¥ç‰ˆé¢åˆ†æ+è¡¨æ ¼ä¸ºä¾‹ï¼‰å‘½ä»¤è¡Œ1paddleocr --image_dir=docs/table/table.jpg --type=structure --layout=false Pythonè„šæœ¬1234567891011121314151617181920212223import osimport cv2from paddleocr import PPStructure, draw_structure_result, save_structure_resfrom PIL import Imagetable_engine = PPStructure(show_log=True)save_folder = './output'img_path = './ppstructure/docs/table/table.jpg'img = cv2.imread(img_path)result = table_engine(img)save_structure_res(result, save_folder, os.path.basename(img_path).split('.')[0])for line in result: line.pop('img') print(line)font_path = './doc/fonts/simfang.ttf'image = Image.open(img_path).convert('RGB')im_show = draw_structure_result(image, result, font_path=font_path)im_show = Image.fromarray(im_show)im_show.save('result.jpg') æœåŠ¡éƒ¨ç½²å®‰è£…structure_system 1hub install deploy\\hubserving\\structure_system\\ ä¿®æ”¹config.jsonï¼Œä¸ä½¿ç”¨GPU 123456789101112131415&#123; \"modules_info\": &#123; \"structure_system\": &#123; \"init_args\": &#123; \"version\": \"1.0.0\", \"use_gpu\": false &#125;, \"predict_args\": &#123; &#125; &#125; &#125;, \"port\": 8870, \"use_multiprocess\": false, \"workers\": 2&#125; å¯åŠ¨æœåŠ¡ 1hub serving start -c ./deploy/hubserving/structure_system/config.json ç‰ˆé¢åˆ†æ+è¡¨æ ¼è¯†åˆ« 1python tools/test_hubserving.py --server_url http://127.0.0.1:8870/predict/structure_system --image_dir ppstructure/docs/table/table.jpg å°†è¯†åˆ«å¾—åˆ°çš„htmlæ ‡ç­¾å†…å®¹å¤åˆ¶å¦å­˜ä¸º.htmlæ–‡ä»¶è¿›è¡Œå¯¹æ¯”å¾—åˆ°å¦‚ä¸‹ç»“æœï¼š åœ¨Pycharmä¸­éƒ¨ç½²æœåŠ¡å¹¶è¯†åˆ«è¿›å…¥deploy/hubserving/structure_system/params.pyï¼Œä¿®æ”¹é»˜è®¤æ¨¡å‹ä½ç½® 1234567891011121314...from deploy.hubserving.structure_table.params import read_params as table_read_paramsdef read_params(): cfg = table_read_params() # params for layout parser model cfg.layout_path_model = 'lp://PubLayNet/ppyolov2_r50vd_dcn_365e_publaynet/config' cfg.layout_label_map = None cfg.mode = 'structure' cfg.output = './output' return cfg å¯ä»¥çœ‹åˆ°ï¼Œstructure_system/params.pyå¼•ç”¨äº†structure_table/params.pyä¸‹çš„read_paramså‚æ•°ï¼Œå†è¿›å…¥åˆ°structure_table/params.pyæ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶åˆ™æ˜¯å¼•ç”¨äº†ocr_system/params.pyä¸‹çš„read_paramså‚æ•°ï¼Œè¿™äº›å‚æ•°ä¸»è¦ç”¨ä½œOCRè¯†åˆ«ï¼Œæ‰€ä»¥ï¼Œå¦‚æœåœ¨ä¸åŒåœºæ™¯ä¸‹è¦ä½¿ç”¨ä¸åŒæ¨¡å‹æ—¶ï¼Œæœ€å¥½å°†å„ä¸ªparams.pyé‡å†™ã€‚ä¿®æ”¹åçš„æ–‡ä»¶å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869# structure_system/params.pyfrom __future__ import absolute_importfrom __future__ import divisionfrom __future__ import print_functionclass Config(object): passdef read_params(): cfg = Config() #params for text detector cfg.det_algorithm = \"DB\" cfg.det_model_dir = \"C:/Users/9.9/.paddleocr/whl/det/ch/ch_PP-OCRv3_det_infer\" cfg.det_limit_side_len = 960 cfg.det_limit_type = 'max' #DB parmas cfg.det_db_thresh = 0.3 cfg.det_db_box_thresh = 0.5 cfg.det_db_unclip_ratio = 1.6 cfg.use_dilation = False cfg.det_db_score_mode = \"fast\" #EAST parmas cfg.det_east_score_thresh = 0.8 cfg.det_east_cover_thresh = 0.1 cfg.det_east_nms_thresh = 0.2 #params for text recognizer cfg.rec_algorithm = \"CRNN\" cfg.rec_model_dir = r\"C:/Users/9.9/.paddleocr/whl/rec/ch/ch_PP-OCRv3_rec_infer/\" cfg.rec_image_shape = \"3, 48, 320\" cfg.rec_batch_num = 6 cfg.max_text_length = 25 cfg.rec_char_dict_path = r\"C:/Users/9.9/software/PaddleOCR-release-2.5/ppocr/utils/ppocr_keys_v1.txt\" cfg.use_space_char = True #params for text classifier cfg.use_angle_cls = True cfg.cls_model_dir = r\"C:/Users/9.9/software/PaddleOCR-release-2.5/inference/ch_ppocr_mobile_v2.0_cls_infer/\" cfg.cls_image_shape = \"3, 48, 192\" cfg.label_list = ['0', '180'] cfg.cls_batch_num = 30 cfg.cls_thresh = 0.9 cfg.use_pdserving = False cfg.use_tensorrt = False cfg.drop_score = 0.5 # params for table structure model cfg.table_max_len = 488 cfg.table_model_dir = r'C:\\Users\\9.9\\.paddleocr\\whl\\table\\en_ppocr_mobile_v2.0_table_structure_infer/' cfg.table_char_dict_path = 'C:/Users/9.9/software/PaddleOCR-release-2.5/ppocr/utils/dict/table_structure_dict.txt' cfg.show_log = False # params for layout parser model cfg.layout_path_model = 'lp://PubLayNet/ppyolov2_r50vd_dcn_365e_publaynet/config' # cfg.layout_path_model = './inference/ppyolov2_r50vd_dcn_365e_publaynet' cfg.layout_label_map = None cfg.mode = 'structure' cfg.output = './output' return cfg å†æ–°å»ºpythonæ–‡ä»¶ç”¨äºæå–å…·ä½“å†…å®¹ï¼Œé€šè¿‡pandasåˆ†æå¾—åˆ°ç»“æ„ 1234567891011121314151617181920212223242526272829import osimport reimport pandas as pddef exec_ocr(cmd: str): pip = os.popen(cmd) return pip.buffer.read().decode(encoding='utf8')img_dir = r\"C:\\Users\\9.9\\software\\PaddleOCR-release-2.5\\ppstructure\\docs\\table\\table.jpg\"ocr_dir = r\"python C:\\Users\\9.9\\software\\PaddleOCR-release-2.5\\tools\\test_hubserving.py\"res = exec_ocr(fr\"&#123;ocr_dir&#125; --server_url http://127.0.0.1:8870/predict/structure_system --image_dir &#123;img_dir&#125;\")with open(\"system_res.txt\", \"w\", encoding=\"utf-8\") as f: f.write(res)ocr_file = open(\"system_res.txt\", \"r\", encoding='utf-8')alldata_res = ocr_file.read()system_res = re.search(r\"'html': '(.*)'&#125;, 'type': 'Table'&#125;\", alldata_res)print(system_res.group(1))with open(\"system_res.html\", \"w\", encoding='utf-8') as f: f.write(system_res.group(1))with open(\"system_res.html\", encoding='utf-8') as f: df = pd.read_html(f.read(), encoding='utf-8', index_col=0)[0] df = df.loc[:, ~df.columns.str.contains(\"^Unnamed\")]print(df)df.to_csv('system_res.csv') PP-Structureè¡¨æ ¼æ¨¡å‹è®­ç»ƒå®‰è£…å‰å¾€Paddleçš„githubä¸»é¡µä¸‹è½½å®‰è£…PaddleDetectionï¼šhttps://github.com/PaddlePaddle/PaddleDetectionï¼Œå¹¶æ‰§è¡Œpip install -r requirements.txtå®‰è£…å…¶ä»–ä¾èµ– å‡†å¤‡æ•°æ®ä¸‹è½½PubLayNetæ•°æ®é›†ï¼Œå¯é€šè¿‡é“¾æ¥ï¼ˆhttps://dax-cdn.cdn.appdomain.cloud/dax-publaynet/1.0.0/publaynet.tar.gz?_ga=2.104193024.1076900768.1622560733-649911202.1622560733ï¼‰ç›´æ¥ä¸‹è½½ï¼ˆçº¦95GBï¼‰ é…ç½®æ–‡ä»¶ä¿®æ”¹configs/ppyolo/ppyolov2_r50vd_dcn_365e_coco.ymlæ–‡ä»¶çš„é…ç½®è¿›è¡Œè®­ç»ƒï¼š 12345678910_BASE_: [ '../datasets/coco_detection.yml', # ä¸»è¦è¯´æ˜äº†è®­ç»ƒæ•°æ®å’ŒéªŒè¯æ•°æ®çš„è·¯å¾„ '../runtime.yml', # ä¸»è¦è¯´æ˜äº†å…¬å…±çš„è¿è¡Œå‚æ•°ï¼Œæ¯”å¦‚æ˜¯å¦ä½¿ç”¨GPUã€æ¯å¤šå°‘ä¸ªepochå­˜å‚¨checkpointç­‰ './_base_/ppyolov2_r50vd_dcn.yml', # ä¸»è¦è¯´æ˜äº†å­¦ä¹ ç‡å’Œä¼˜åŒ–å™¨çš„é…ç½® './_base_/optimizer_365e.yml', # ä¸»è¦è¯´æ˜æ¨¡å‹å’Œä¸»å¹²ç½‘ç»œçš„æƒ…å†µ './_base_/ppyolov2_reader.yml', # ä¸»è¦è¯´æ˜æ•°æ®è¯»å–å™¨é…ç½®ï¼Œå¦‚batch sizeï¼Œå¹¶å‘åŠ è½½å­è¿›ç¨‹æ•°ç­‰ï¼ŒåŒæ—¶åŒ…å«è¯»å–åé¢„å¤„ç†æ“ä½œï¼Œå¦‚resizeã€æ•°æ®å¢å¼ºç­‰ç­‰]snapshot_epoch: 8weights: output/ppyolov2_r50vd_dcn_365e_coco/model_final æ¥åˆ°datasets/coco_detection.ymlæ–‡ä»¶ä¸­ï¼Œä¿®æ”¹ä¸‹è½½å¥½çš„è®­ç»ƒé›†çš„ä½ç½® 1234567891011121314151617181920metric: COCOnum_classes: 80TrainDataset: !COCODataSet image_dir: C:/Users/9.9/software/publaynet/train anno_path: C:/Users/9.9/software/publaynet/train.json dataset_dir: dataset/coco data_fields: ['image', 'gt_bbox', 'gt_class', 'is_crowd']EvalDataset: !COCODataSet image_dir: C:/Users/9.9/software/publaynet/val anno_path: C:/Users/9.9/software/publaynet/val.json dataset_dir: dataset/cocoTestDataset: !ImageFolder anno_path: C:/Users/9.9/software/publaynet/val.json # also support txt (like VOC's label_list.txt) dataset_dir: dataset/coco # if set, anno_path will be 'dataset_dir/anno_path' è®­ç»ƒ1python tools/train.py -c configs/ppyolo/ppyolov2_r50vd_dcn_365e_coco.yml","categories":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://yoursite.com/categories/æœºå™¨å­¦ä¹ /"}],"tags":[{"name":"OCR","slug":"OCR","permalink":"http://yoursite.com/tags/OCR/"}]},{"title":"PaddleOCR","slug":"PaddleOCR","date":"2022-07-12T06:20:14.000Z","updated":"2022-09-22T03:43:08.898Z","comments":true,"path":"2022/07/12/PaddleOCR/","link":"","permalink":"http://yoursite.com/2022/07/12/PaddleOCR/","excerpt":"å®‰è£…è¿›å…¥PaddleOCRçš„githubé¡µé¢ï¼ˆhttps://github.com/PaddlePaddle/PaddleOCRï¼‰ï¼Œè¿›è¡Œä¸‹è½½å’Œè§£å‹ ä½¿ç”¨pipè¿›è¡Œå®‰è£…ï¼Œè¿™é‡Œå› ä¸ºé€Ÿåº¦å¾ˆæ…¢æ¨èä½¿ç”¨ç™¾åº¦æº1pip install paddlepaddle -i https://mirror.baidu.com/pypi/simple å®‰è£…shapelyï¼ˆhttps://www.lfd.uci.edu/~gohlke/pythonlibs/ï¼‰ï¼Œä¸‹è½½shapelyå¯¹åº”pythonå’Œç³»ç»Ÿç‰ˆæœ¬çš„å®‰è£…åŒ…ï¼ˆæˆ‘ä½¿ç”¨çš„æ˜¯py39ï¼Œwindows_64ï¼‰ï¼Œpythonç‰ˆæœ¬ç›®å‰ä¸èƒ½è¶…è¿‡3.9 å°†ä¸‹è½½å¥½çš„Shapely-1.8.2-cp39-cp39-win_amd64.whlæ”¾è¿›pythonæ ¹ç›®å½•ä¸‹çš„libsæ–‡ä»¶å¤¹å†…ï¼Œé€šè¿‡cmdæˆ–pycharmç»ˆç«¯ä½¿ç”¨pipæ‰§è¡Œå®‰è£…1pip install Shapely-1.8.2-cp39-cp39-win_amd64.whl å®Œæˆä»¥åæ¥ç€æ¥åˆ°PaddleOCRç›®å½•ä¸‹ï¼Œé€šè¿‡ç»ˆç«¯å®‰è£…ä¾èµ–ï¼Œè¿™é‡ŒåŒæ ·æ¨èä½¿ç”¨ç™¾åº¦æº1pip install -r requirements.txt -i https://mirror.baidu.com/pypi/simple åˆ°è¿™é‡Œï¼ŒPaddleOCRçš„å®‰è£…å®Œæˆäº† å¦‚æœå†æ‰§è¡Œpip install -r requirements.txt -i https://mirror.baidu.com/pypi/simpleåˆ°å®‰è£…opencv4.4.0.46åŒ…æ—¶æŠ¥é”™ï¼š error: subprocess-exited-with-error è¯´æ˜pythonçš„ç‰ˆæœ¬å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œéœ€è¦åˆ‡æ¢è™šæ‹Ÿç¯å¢ƒæˆ–å›é€€pythonç‰ˆæœ¬ï¼Œå› ä¸ºopencv-pythonç›®å‰ä»…æ”¯æŒpy3.6-3.9ç‰ˆæœ¬ opencv-pythoné•œåƒï¼šhttps://mirrors.tuna.tsinghua.edu.cn/pypi/web/simple/opencv-python/","text":"å®‰è£…è¿›å…¥PaddleOCRçš„githubé¡µé¢ï¼ˆhttps://github.com/PaddlePaddle/PaddleOCRï¼‰ï¼Œè¿›è¡Œä¸‹è½½å’Œè§£å‹ ä½¿ç”¨pipè¿›è¡Œå®‰è£…ï¼Œè¿™é‡Œå› ä¸ºé€Ÿåº¦å¾ˆæ…¢æ¨èä½¿ç”¨ç™¾åº¦æº1pip install paddlepaddle -i https://mirror.baidu.com/pypi/simple å®‰è£…shapelyï¼ˆhttps://www.lfd.uci.edu/~gohlke/pythonlibs/ï¼‰ï¼Œä¸‹è½½shapelyå¯¹åº”pythonå’Œç³»ç»Ÿç‰ˆæœ¬çš„å®‰è£…åŒ…ï¼ˆæˆ‘ä½¿ç”¨çš„æ˜¯py39ï¼Œwindows_64ï¼‰ï¼Œpythonç‰ˆæœ¬ç›®å‰ä¸èƒ½è¶…è¿‡3.9 å°†ä¸‹è½½å¥½çš„Shapely-1.8.2-cp39-cp39-win_amd64.whlæ”¾è¿›pythonæ ¹ç›®å½•ä¸‹çš„libsæ–‡ä»¶å¤¹å†…ï¼Œé€šè¿‡cmdæˆ–pycharmç»ˆç«¯ä½¿ç”¨pipæ‰§è¡Œå®‰è£…1pip install Shapely-1.8.2-cp39-cp39-win_amd64.whl å®Œæˆä»¥åæ¥ç€æ¥åˆ°PaddleOCRç›®å½•ä¸‹ï¼Œé€šè¿‡ç»ˆç«¯å®‰è£…ä¾èµ–ï¼Œè¿™é‡ŒåŒæ ·æ¨èä½¿ç”¨ç™¾åº¦æº1pip install -r requirements.txt -i https://mirror.baidu.com/pypi/simple åˆ°è¿™é‡Œï¼ŒPaddleOCRçš„å®‰è£…å®Œæˆäº† å¦‚æœå†æ‰§è¡Œpip install -r requirements.txt -i https://mirror.baidu.com/pypi/simpleåˆ°å®‰è£…opencv4.4.0.46åŒ…æ—¶æŠ¥é”™ï¼š error: subprocess-exited-with-error è¯´æ˜pythonçš„ç‰ˆæœ¬å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œéœ€è¦åˆ‡æ¢è™šæ‹Ÿç¯å¢ƒæˆ–å›é€€pythonç‰ˆæœ¬ï¼Œå› ä¸ºopencv-pythonç›®å‰ä»…æ”¯æŒpy3.6-3.9ç‰ˆæœ¬ opencv-pythoné•œåƒï¼šhttps://mirrors.tuna.tsinghua.edu.cn/pypi/web/simple/opencv-python/ ä½¿ç”¨å®˜æ–¹æ¨¡å‹å…ˆä½¿ç”¨å®˜æ–¹æ¨¡å‹å¯¹æ•°æ®è¿›è¡Œæµ‹è¯•ï¼ˆv2.0ï¼‰ï¼šhttps://github.com/PaddlePaddle/PaddleOCR/blob/release/2.0/README_ch.md å…¶ä¸­æ¨ç†æ¨¡å‹ï¼ˆinference modelï¼‰ç›¸å½“äºå·²è®­ç»ƒå®Œæˆçš„æ¨¡å‹ï¼Œå¯ä»¥ç›´æ¥æ‹¿æ¥é¢„æµ‹ï¼Œè€Œé¢„è®­ç»ƒæ¨¡å‹ï¼ˆtrained model)å±äºåŠæˆå“ï¼Œåœ¨ä½¿ç”¨æœ¬åœ°çš„æ•°æ®è®­ç»ƒæ¨¡å‹æ—¶éœ€è¦ç”¨åˆ° å°†æ¨ç†æ¨¡å‹ä¸‹è½½åï¼Œæ¥åˆ°PaddleOCRç›®å½•ä¸‹æ–°å»ºinferenceæ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾æ¨¡å‹ æ£€æŸ¥æ¯ä¸ªæ–‡ä»¶å¤¹ä¸‹æ˜¯å¦å­˜åœ¨inference.pdiparamsã€inference.pdiparams.infoã€inference.pdmodelä¸‰ä¸ªæ–‡ä»¶ï¼Œå¦‚æœå‡ºç°ä¸å’Œè°çš„æ–‡ä»¶å¤¹æ˜¯å®˜æ–¹æ‰“åŒ…æ—¶å‡ºé”™ï¼Œå°†æ–‡ä»¶å¤¹å†…çš„å†…å®¹æå–å‡ºæ¥å³å¯ å¦‚æœç›´æ¥ä½¿ç”¨å¯èƒ½ä¼šæŠ¥é”™ï¼š raise Exception(â€œnot found any img file in {}â€.format(img_file))Exception: not found any img file in ./doc/imgs/test.jpg é¢„æµ‹å®˜æ–¹çš„å¿«é€Ÿå¼€å§‹æ•™ç¨‹ï¼šhttps://github.com/PaddlePaddle/PaddleOCR/blob/develop/doc/doc_ch/quickstart.md é¦–å…ˆå°†æµ‹è¯•ç›®æ ‡test.jpgå­˜æ”¾è¿›PaddleOCR/doc/imgs/ç›®å½•ä¸‹ï¼Œåˆ°cmdæˆ–pycharmç»ˆç«¯é‡Œæ‰§è¡Œï¼š123456python tools/infer/predict_system.py --image_dir=\"./doc/imgs/test.jpg\" \\ --det_model_dir=\"./inference/ch_ppocr_server_v2.0_det_infer/\" \\ --rec_model_dir=\"./inference/ch_ppocr_server_v2.0_rec_infer/\" \\ --cls_model_dir=\"./inference/ch_ppocr_mobile_v2.0_cls_infer/\" \\ --use_angle_cls=True \\ --use_space_char=True ï¼ˆwindowsä¸‹ä½¿ç”¨å®˜æ–¹æ–‡æ¡£é‡Œä¸­çš„â€python3 tools/â€¦â€ä¼šå‡ºä¸æ¥ç»“æœï¼Œlinuxä¸‹æ²¡æœ‰é—®é¢˜ï¼‰ ä½¿ç”¨pycharmé¢„æµ‹éœ€è¦ä¿®æ”¹çš„ä»£ç ä½äºæ ¹ç›®å½•ä¸‹/tools/inferæ–‡ä»¶å¤¹ä¸‹ï¼Œå…¶ä¸­predict_det.pyç”¨äºæ£€æµ‹æ–‡æœ¬ï¼Œpredict_rec.pyç”¨äºè¯†åˆ«æ–‡æœ¬ï¼Œpredict_system.pyå¯ç”¨äºæ£€æµ‹å’Œè¯†åˆ«ï¼Œè¿™3ä¸ª.pyæ–‡ä»¶å…±ç”¨åŒä¸€ä¸ªé…ç½®æ–‡ä»¶utility.pyï¼Œéœ€è¦åˆ°å…¶ä¸­å®šä½å¹¶ä¿®æ”¹ï¼š1234567891011121314151617181920212223242526272829303132333435# æ˜¯å¦ä½¿ç”¨gpuparser.add_argument(\"--use_gpu\", type=str2bool, default=True)# å›¾ç‰‡æ–‡ä»¶ä½ç½®parser.add_argument(\"--image_dir\", type=str, default=\"../../demo/test.jpg\")# æ£€æµ‹æ¨¡å‹è·¯å¾„parser.add_argument(\"--det_model_dir\", type=str, default=\"../../inference/ch_ppocr_server_v2.0_det_infer/\")# è¯†åˆ«æ¨¡å‹è·¯å¾„parser.add_argument(\"--rec_model_dir\", type=str, default=\"../../inference/ch_ppocr_server_v2.0_rec_infer\")# åˆ†ç±»æ¨¡å‹è·¯å¾„parser.add_argument(\"--cls_model_dir\", type=str, default=\"../../inference/ch_ppocr_mobile_v2.0_cls_infer\")# å­—å…¸è·¯å¾„ï¼ˆic15_dict.txtæ˜¯è‹±æ–‡å­—å…¸ï¼Œppocr_keys_v1.txtæ˜¯ä¸­æ–‡å­—å…¸ï¼Œæ£€æµ‹ä¸€èˆ¬ä¸åŒºåˆ†ä¸­è‹±æ–‡ï¼Œä½†æ˜¯è¯†åˆ«éœ€è¦åŒºåˆ†ä¸­è‹±æ–‡ï¼‰parser.add_argument( \"--rec_char_dict_path\", type=str, default=\"../../ppocr/utils/ic15_dict.txt\")# å­—ä½“è·¯å¾„ï¼Œ2å¤„def draw_ocr_box_txt(image, boxes, txts, scores=None, drop_score=0.5, font_path=\"./doc/simfang.ttf\"):def text_visual(texts, scores, img_h=400, img_w=600, threshold=0., font_path=\"./doc/simfang.ttf\"):# ç¨‹åºè¾“å‡ºè·¯å¾„parser.add_argument( \"--draw_img_save_dir\", type=str, default=\"./inference_results\") æ¥ç€è¿è¡Œpredict_system.py æœåŠ¡éƒ¨ç½²ï¼ˆåŸºäºPaddleHub Servingï¼‰deploy/hubservingæœåŠ¡éƒ¨ç½²ç›®å½•ä¸‹åŒ…æ‹¬æ£€æµ‹ï¼ˆocr_detï¼‰ã€è¯†åˆ«ï¼ˆocr_recï¼‰ã€2é˜¶æ®µä¸²è”ï¼ˆocr_systemï¼‰ä¸‰ç§æœåŠ¡åŒ…å’Œåˆ†ç±»æ¨¡å—æœåŠ¡åŒ…ï¼ˆocr_clsï¼‰ï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚é€‰æ‹©ç›¸åº”çš„æœåŠ¡åŒ…è¿›è¡Œå®‰è£…å’Œå¯åŠ¨ã€‚æ¯ä¸ªæœåŠ¡åŒ…ä¸‹åŒ…æ‹¬3ä¸ª.pyæ–‡ä»¶å’Œä¸€ä¸ªconfig.jsoné…ç½®æ–‡ä»¶ï¼š- __init__.py- config.jsonï¼šé…ç½®æ–‡ä»¶- module.pyï¼šä¸»æ¨¡å—ï¼Œå¿…é€‰ï¼ŒåŒ…å«æœåŠ¡çš„å®Œæ•´é€»è¾‘- params.pyï¼šå‚æ•°æ–‡ä»¶ï¼Œå¿…é€‰ï¼ŒåŒ…å«æ¨¡å‹è·¯å¾„ã€å‰åå¤„ç†å‚æ•°ç­‰å‚æ•° å‡†å¤‡ç¯å¢ƒ1.ä½¿ç”¨pipå®‰è£…paddlehubï¼Œpythonç‰ˆæœ¬éœ€è¦é«˜äº3.6.21pip3 install paddlehub==2.1.0 --upgrade -i https://pypi.tuna.tsinghua.edu.cn/simple 2.é…ç½®æ¨¡å‹æ–‡ä»¶ï¼Œå°†ä¹‹å‰ä¸‹è½½çš„æ¨¡å‹è·¯å¾„ä¿®æ”¹åˆ°params.pyå½“ä¸­123cfg.det_model_dir = \"./inference/ch_ppocr_server_v2.0_det_infer/\"cfg.rec_model_dir = \"./inference/ch_ppocr_server_v2.0_rec_infer/\"cfg.cls_model_dir = \"./inference/ch_ppocr_mobile_v2.0_cls_infer/\" 3.å®‰è£…æœåŠ¡æ¨¡å—ï¼Œè¿›å…¥paddleOCRæ ¹ç›®å½•ï¼Œæ‰§è¡Œï¼šLinuxç¯å¢ƒ1234567891011# å®‰è£…æ£€æµ‹æœåŠ¡æ¨¡å—ï¼š $ hub install deploy/hubserving/ocr_det/# æˆ–ï¼Œå®‰è£…åˆ†ç±»æœåŠ¡æ¨¡å—ï¼š $ hub install deploy/hubserving/ocr_cls/# æˆ–ï¼Œå®‰è£…è¯†åˆ«æœåŠ¡æ¨¡å—ï¼š $ hub install deploy/hubserving/ocr_rec/# æˆ–ï¼Œå®‰è£…æ£€æµ‹+è¯†åˆ«ä¸²è”æœåŠ¡æ¨¡å—ï¼š $ hub install deploy/hubserving/ocr_system/ windowsç¯å¢ƒ1234567891011# å®‰è£…æ£€æµ‹æœåŠ¡æ¨¡å—ï¼š hub install deploy\\hubserving\\ocr_det\\# æˆ–ï¼Œå®‰è£…åˆ†ç±»æœåŠ¡æ¨¡å—ï¼š hub install deploy\\hubserving\\ocr_cls\\# æˆ–ï¼Œå®‰è£…è¯†åˆ«æœåŠ¡æ¨¡å—ï¼š hub install deploy\\hubserving\\ocr_rec\\# æˆ–ï¼Œå®‰è£…æ£€æµ‹+è¯†åˆ«ä¸²è”æœåŠ¡æ¨¡å—ï¼šhub install deploy\\hubserving\\ocr_system\\ æ‰§è¡Œhub listå¯ä»¥æŸ¥çœ‹å·²å®‰è£…çš„æ¨¡å—ï¼š å¯åŠ¨æœåŠ¡æ–¹å¼1.å‘½ä»¤è¡Œå¯åŠ¨ï¼ˆä»…æ”¯æŒCPUï¼‰1234$ hub serving start --modules [Module1==Version1, Module2==Version2, ...] \\ --port XXXX \\ --use_multiprocess \\ --workers \\ å‚æ•° ä½œç”¨ â€“modules/-m PaddleHub Servingé¢„å®‰è£…æ¨¡å‹ï¼Œä»¥å¤šä¸ªModule==Versioné”®å€¼å¯¹çš„å½¢å¼åˆ—å‡ºå½“ä¸æŒ‡å®šVersionæ—¶ï¼Œé»˜è®¤é€‰æ‹©æœ€æ–°ç‰ˆæœ¬ â€“port/-p æœåŠ¡ç«¯å£ï¼Œé»˜è®¤ä¸º8866 â€“use_multiprocess æ˜¯å¦å¯ç”¨å¹¶å‘æ–¹å¼ï¼Œé»˜è®¤ä¸ºå•è¿›ç¨‹æ–¹å¼ï¼Œæ¨èå¤šæ ¸CPUæœºå™¨ä½¿ç”¨æ­¤æ–¹å¼Windowsæ“ä½œç³»ç»Ÿåªæ”¯æŒå•è¿›ç¨‹æ–¹å¼ â€“workers åœ¨å¹¶å‘æ–¹å¼ä¸‹æŒ‡å®šçš„å¹¶å‘ä»»åŠ¡æ•°ï¼Œé»˜è®¤ä¸º2*cpu_count-1ï¼Œå…¶ä¸­cpu_countä¸ºCPUæ ¸æ•° ä¾‹ï¼š1hub serving start -m ocr_system æ–¹å¼2.é€šè¿‡é…ç½®æ–‡ä»¶config.jsonå¯åŠ¨ï¼ˆæ”¯æŒCPUã€GPUï¼‰config.jsonå†…å®¹æ ¼å¼å¦‚ä¸‹ï¼š123456789101112131415&#123; \"modules_info\": &#123; \"ocr_system\": &#123; \"init_args\": &#123; \"version\": \"1.0.0\", \"use_gpu\": false &#125;, \"predict_args\": &#123; &#125; &#125; &#125;, \"port\": 8868, \"use_multiprocess\": false, \"workers\": 2&#125; Â· init_argsä¸­çš„å¯é…å‚æ•°ä¸module.pyä¸­çš„_initializeå‡½æ•°æ¥å£ä¿æŒä¸€è‡´ï¼Œå½“use_gpuçš„å€¼ä¸ºtrueæ—¶ï¼Œè¡¨ç¤ºä½¿ç”¨GPUå¯åŠ¨æœåŠ¡ Â· predict_argsä¸­çš„å¯é…å‚æ•°ä¸module.pyä¸­çš„predictå‡½æ•°æ¥å£ä¿æŒä¸€è‡´ Â· ä½¿ç”¨é…ç½®æ–‡ä»¶å¯åŠ¨æœåŠ¡æ—¶ï¼Œå…¶ä»–å‚æ•°ä¼šè¢«å¿½ç•¥ Â· å¦‚æœä½¿ç”¨GPUé¢„æµ‹(å³ï¼Œuse_gpuç½®ä¸ºtrue)ï¼Œåˆ™éœ€è¦åœ¨å¯åŠ¨æœåŠ¡ä¹‹å‰ï¼Œè®¾ç½®CUDA_VISIBLE_DEVICESç¯å¢ƒå˜é‡ï¼Œå¦‚ï¼šexport CUDA_VISIBLE_DEVICES=0ï¼Œå¦åˆ™ä¸ç”¨è®¾ç½® Â· use_gpuä¸å¯ä¸use_multiprocessåŒæ—¶ä¸ºtrue ä¾‹ï¼š1hub serving start -c ./deploy/hubserving/ocr_system/config.json å‘é€é¢„æµ‹è¯·æ±‚éœ€è¦é€šè¿‡POSTæ–¹æ³•ä¼ é€’2ä¸ªå‚æ•°ï¼šserver_url å’Œ image_path1python tools/test_hubserving.py --server_url http://127.0.0.1:8868/predict/ocr_system --image_dir ./demo/ å¦‚æœåœ¨å¯åŠ¨æ—¶é‡åˆ°è­¦å‘Šï¼š C:\\Python39\\lib\\site-packages\\attrdict\\mapping.py:4: DeprecationWarning: Using or importing the ABCs from â€˜collectionsâ€™ instead of from â€˜collections.abcâ€™ is deprecated since Python 3.3, and in 3.10 it will stop working from collections import Mappingéœ€è¦åˆ°å¯¹åº”çš„Python\\lib\\site-packages\\attrdict\\ç›®å½•ä¸‹ä¿®æ”¹default.pyã€mapping.pyã€merge.py å’Œ mixins.pyæ–‡ä»¶ä¸­1from collections import ... ä¿®æ”¹ä¸º1from collections.abc import ... è¿”å›ç»“æ„è¿”å›çš„ç»“æœä¸ºåˆ—è¡¨ï¼Œå…¶ä¸­æ¯ä¸€é¡¹ä¸ºä¸€ä¸ªå­—å…¸ï¼Œå­—å…¸ä¸€å…±å¯èƒ½åŒ…å«ä¸‹åˆ—ä¸‰ç§å­—æ®µï¼š å­—æ®µå æ•°æ®ç±»å‹ å«ä¹‰ text str æ–‡æœ¬å†…å®¹ confidence float æ–‡æœ¬è¯†åˆ«ç½®ä¿¡åº¦ text_region list æ–‡æœ¬ä½ç½®åæ ‡ ä¸åŒæ¨¡å—è¿”å›çš„å­—æ®µä¸åŒï¼Œå¦‚ï¼Œæ–‡æœ¬è¯†åˆ«æœåŠ¡æ¨¡å—è¿”å›ç»“æœä¸å«text_regionå­—æ®µ å­—æ®µå ocr_det ocr_cls ocr_rec ocr_system text âˆš âˆš confidence âˆš âˆš âˆš text_region âˆš âˆš è‡ªå®šä¹‰ä¿®æ”¹æœåŠ¡æ¨¡å—Â· åœæ­¢æœåŠ¡ï¼š1hub serving stop --port/-p XXXX Â· åˆ°ç›¸åº”çš„module.py å’Œ params.pyç­‰æ–‡ä»¶ä¸­æ ¹æ®å®é™…éœ€æ±‚ä¿®æ”¹ä»£ç ä¾‹å¦‚ï¼Œå¦‚æœéœ€è¦æ›¿æ¢éƒ¨ç½²æœåŠ¡æ‰€ç”¨æ¨¡å‹ï¼Œåˆ™éœ€è¦åˆ°params.pyä¸­ä¿®æ”¹æ¨¡å‹è·¯å¾„å‚æ•°det_model_dir å’Œ rec_model_dirï¼Œå¦‚æœéœ€è¦å…³é—­æ–‡æœ¬æ–¹å‘åˆ†ç±»å™¨ï¼Œåˆ™å°†å‚æ•°use_angle_clsç½®ä¸ºFalseï¼Œå½“ç„¶ï¼ŒåŒæ—¶å¯èƒ½è¿˜éœ€è¦ä¿®æ”¹å…¶ä»–ç›¸å…³å‚æ•°ï¼Œå¼ºçƒˆå»ºè®®ä¿®æ”¹åå…ˆç›´æ¥è¿è¡Œmodule.pyè°ƒè¯•ï¼Œèƒ½æ­£ç¡®è¿è¡Œé¢„æµ‹åå†å¯åŠ¨æœåŠ¡æµ‹è¯• Â· å¸è½½æ—§æœåŠ¡åŒ…1hub uninstall ocr_system Â· å®‰è£…ä¿®æ”¹åçš„æ–°æœåŠ¡åŒ…1hub install deploy/hubserving/ocr_system/ Â· é‡æ–°å¯åŠ¨æœåŠ¡1hub serving start -m ocr_system","categories":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://yoursite.com/categories/æœºå™¨å­¦ä¹ /"}],"tags":[{"name":"OCR","slug":"OCR","permalink":"http://yoursite.com/tags/OCR/"}]},{"title":"ClickHouse","slug":"ClickHouse","date":"2022-07-07T08:02:23.000Z","updated":"2022-09-22T03:47:24.441Z","comments":true,"path":"2022/07/07/ClickHouse/","link":"","permalink":"http://yoursite.com/2022/07/07/ClickHouse/","excerpt":"æœ¬æ–‡å‚è€ƒCKä¸­æ–‡å®˜æ–¹æ–‡æ¡£ï¼šhttps://clickhouse.com/docs/zh/ClickHouseæ˜¯ä¸€ä¸ªç”¨äºè”æœºåˆ†æ(OLAP)çš„åˆ—å¼æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ(DBMS) åœ¨ä¼ ç»Ÿçš„è¡Œå¼æ•°æ®åº“ç³»ç»Ÿä¸­ï¼Œæ•°æ®æŒ‰å¦‚ä¸‹é¡ºåºå­˜å‚¨ï¼š ROW Title Code Note Datetime #0 Database 0 æ•°æ®åº“ 2022-07-07 16:03:00 #1 MySQL 1 å…³ç³»å‹æ•°æ®åº“ 2022-07-07 16:03:10 #2 Nebula 1 å›¾æ•°æ®åº“ 2022-07-07 16:03:20 #3 ClickHouse 1 åˆ—å¼æ•°æ®åº“ 2022-07-07 16:03:30 #N â€¦ 1 â€¦ â€¦ å¤„äºåŒä¸€è¡Œä¸­çš„æ•°æ®æ€»æ˜¯è¢«ç‰©ç†çš„å­˜å‚¨åœ¨ä¸€èµ·ã€‚å¸¸è§çš„è¡Œå¼æ•°æ®åº“ç³»ç»Ÿæœ‰ï¼šMySQLã€Postgres å’Œ MS SQL Server ç­‰ è€Œåœ¨åˆ—å¼æ•°æ®åº“ç³»ç»Ÿä¸­ï¼Œæ•°æ®åˆ™æŒ‰å¦‚ä¸‹é¡ºåºå­˜å‚¨ ROW #0 #1 #2 #3 #4 Title Database MySQL Nebula ClickHouse â€¦ Code 0 1 1 1 1 Note æ•°æ®åº“ å…³ç³»å‹æ•°æ®åº“ å›¾æ•°æ®åº“ åˆ—å¼æ•°æ®åº“ â€¦ Datetime 2022-0707 16:03:00 2022-0707 16:03:10 2022-0707 16:03:20 2022-07-07 16:03:30 â€¦ è¿™äº›ç¤ºä¾‹åªæ˜¾ç¤ºäº†æ•°æ®çš„æ’åˆ—é¡ºåºï¼Œæ¥è‡ªä¸åŒåˆ—çš„å€¼è¢«å•ç‹¬å­˜å‚¨ï¼Œæ¥è‡ªåŒä¸€åˆ—çš„æ•°æ®è¢«å­˜å‚¨åœ¨ä¸€èµ·ã€‚å¸¸è§çš„åˆ—å¼æ•°æ®åº“ç³»ç»Ÿæœ‰ï¼šVerticaã€Paraccel(Actian Matrix, Amazon Redshift)ã€Sybase IQã€Exasolã€Infobrightã€InfiniDBã€MonetDB(VectorWise, Actian Vector)ã€LucidDBã€SAP HANAã€Google Dremelã€Google PowerDrillã€Druidã€kdb+ ç­‰ ä¸åŒçš„æ•°æ®å­˜å‚¨æ–¹å¼é€‚ç”¨ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ï¼Œæ•°æ®è®¿é—®çš„åœºæ™¯åŒ…æ‹¬ï¼šè¿›è¡Œäº†ä½•ç§æŸ¥è¯¢ã€å¤šä¹…æŸ¥è¯¢ä¸€æ¬¡ä»¥åŠå„ç±»æŸ¥è¯¢çš„æ¯”ä¾‹ï¼›æ¯ç§ç±»å‹çš„æŸ¥è¯¢(è¡Œã€åˆ—å’Œå­—èŠ‚)è¯»å–å¤šå°‘æ•°æ®ï¼›è¯»å–æ•°æ®å’Œæ›´æ–°ä¹‹é—´çš„å…³ç³»ï¼›ä½¿ç”¨çš„æ•°æ®é›†å¤§å°ä»¥åŠå¦‚ä½•ä½¿ç”¨æœ¬åœ°çš„æ•°æ®é›†ï¼›æ˜¯å¦ä½¿ç”¨äº‹åŠ¡,ä»¥åŠå®ƒä»¬æ˜¯å¦‚ä½•è¿›è¡Œéš”ç¦»çš„ï¼›æ•°æ®çš„å¤åˆ¶æœºåˆ¶ä¸æ•°æ®çš„å®Œæ•´æ€§è¦æ±‚ï¼›æ¯ç§ç±»å‹çš„æŸ¥è¯¢è¦æ±‚çš„å»¶è¿Ÿä¸ååé‡ç­‰ç­‰ ç³»ç»Ÿè´Ÿè½½è¶Šé«˜ï¼Œä¾æ®ä½¿ç”¨åœºæ™¯è¿›è¡Œå®šåˆ¶åŒ–å°±è¶Šé‡è¦ï¼Œå¹¶ä¸”å®šåˆ¶å°†ä¼šå˜çš„è¶Šç²¾ç»†ã€‚æ²¡æœ‰ä¸€ä¸ªç³»ç»Ÿèƒ½å¤ŸåŒæ—¶é€‚ç”¨æ‰€æœ‰ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ã€‚å¦‚æœç³»ç»Ÿé€‚ç”¨äºå¹¿æ³›çš„åœºæ™¯ï¼Œåœ¨è´Ÿè½½é«˜çš„æƒ…å†µä¸‹ï¼Œè¦å…¼é¡¾æ‰€æœ‰çš„åœºæ™¯ï¼Œé‚£ä¹ˆå°†ä¸å¾—ä¸åšå‡ºé€‰æ‹©ï¼šå¹³è¡¡ OR æ•ˆç‡ è”æœºåˆ†æï¼ˆOLAPï¼‰åœºæ™¯çš„å…³é”®ç‰¹å¾Â· ç»å¤§å¤šæ•°æ˜¯è¯»è¯·æ±‚ Â· æ•°æ®ä»¥ç›¸å½“å¤§çš„æ‰¹æ¬¡(&gt; 1000è¡Œ)æ›´æ–°ï¼Œè€Œä¸æ˜¯å•è¡Œæ›´æ–°;æˆ–è€…æ ¹æœ¬æ²¡æœ‰æ›´æ–°ã€‚ Â· å·²æ·»åŠ åˆ°æ•°æ®åº“çš„æ•°æ®ä¸èƒ½ä¿®æ”¹ã€‚ Â· å¯¹äºè¯»å–ï¼Œä»æ•°æ®åº“ä¸­æå–ç›¸å½“å¤šçš„è¡Œï¼Œä½†åªæå–åˆ—çš„ä¸€å°éƒ¨åˆ†ã€‚ Â· å®½è¡¨ï¼Œå³æ¯ä¸ªè¡¨åŒ…å«ç€å¤§é‡çš„åˆ— Â· æŸ¥è¯¢ç›¸å¯¹è¾ƒå°‘(é€šå¸¸æ¯å°æœåŠ¡å™¨æ¯ç§’æŸ¥è¯¢æ•°ç™¾æ¬¡æˆ–æ›´å°‘) Â· å¯¹äºç®€å•æŸ¥è¯¢ï¼Œå…è®¸å»¶è¿Ÿå¤§çº¦50æ¯«ç§’ Â· åˆ—ä¸­çš„æ•°æ®ç›¸å¯¹è¾ƒå°ï¼šæ•°å­—å’ŒçŸ­å­—ç¬¦ä¸²(ä¾‹å¦‚ï¼Œæ¯ä¸ªURL 60ä¸ªå­—èŠ‚) Â· å¤„ç†å•ä¸ªæŸ¥è¯¢æ—¶éœ€è¦é«˜ååé‡(æ¯å°æœåŠ¡å™¨æ¯ç§’å¯è¾¾æ•°åäº¿è¡Œ) Â· äº‹åŠ¡ä¸æ˜¯å¿…é¡»çš„ Â· å¯¹æ•°æ®ä¸€è‡´æ€§è¦æ±‚ä½ Â· æ¯ä¸ªæŸ¥è¯¢æœ‰ä¸€ä¸ªå¤§è¡¨ã€‚é™¤äº†ä»–ä»¥å¤–ï¼Œå…¶ä»–çš„éƒ½å¾ˆå°ã€‚ Â· æŸ¥è¯¢ç»“æœæ˜æ˜¾å°äºæºæ•°æ®ã€‚æ¢å¥è¯è¯´ï¼Œæ•°æ®ç»è¿‡è¿‡æ»¤æˆ–èšåˆï¼Œå› æ­¤ç»“æœé€‚åˆäºå•ä¸ªæœåŠ¡å™¨çš„RAMä¸­ å¾ˆå®¹æ˜“å¯ä»¥çœ‹å‡ºï¼ŒOLAPåœºæ™¯ä¸å…¶ä»–é€šå¸¸ä¸šåŠ¡åœºæ™¯(ä¾‹å¦‚,OLTPæˆ–K/V)æœ‰å¾ˆå¤§çš„ä¸åŒï¼Œ å› æ­¤æƒ³è¦ä½¿ç”¨OLTPæˆ–Key-Valueæ•°æ®åº“å»é«˜æ•ˆçš„å¤„ç†åˆ†ææŸ¥è¯¢åœºæ™¯ï¼Œå¹¶ä¸æ˜¯éå¸¸å®Œç¾çš„é€‚ç”¨æ–¹æ¡ˆã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨OLAPæ•°æ®åº“å»å¤„ç†åˆ†æè¯·æ±‚é€šå¸¸è¦ä¼˜äºä½¿ç”¨MongoDBæˆ–Rediså»å¤„ç†åˆ†æè¯·æ±‚ã€‚","text":"æœ¬æ–‡å‚è€ƒCKä¸­æ–‡å®˜æ–¹æ–‡æ¡£ï¼šhttps://clickhouse.com/docs/zh/ClickHouseæ˜¯ä¸€ä¸ªç”¨äºè”æœºåˆ†æ(OLAP)çš„åˆ—å¼æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ(DBMS) åœ¨ä¼ ç»Ÿçš„è¡Œå¼æ•°æ®åº“ç³»ç»Ÿä¸­ï¼Œæ•°æ®æŒ‰å¦‚ä¸‹é¡ºåºå­˜å‚¨ï¼š ROW Title Code Note Datetime #0 Database 0 æ•°æ®åº“ 2022-07-07 16:03:00 #1 MySQL 1 å…³ç³»å‹æ•°æ®åº“ 2022-07-07 16:03:10 #2 Nebula 1 å›¾æ•°æ®åº“ 2022-07-07 16:03:20 #3 ClickHouse 1 åˆ—å¼æ•°æ®åº“ 2022-07-07 16:03:30 #N â€¦ 1 â€¦ â€¦ å¤„äºåŒä¸€è¡Œä¸­çš„æ•°æ®æ€»æ˜¯è¢«ç‰©ç†çš„å­˜å‚¨åœ¨ä¸€èµ·ã€‚å¸¸è§çš„è¡Œå¼æ•°æ®åº“ç³»ç»Ÿæœ‰ï¼šMySQLã€Postgres å’Œ MS SQL Server ç­‰ è€Œåœ¨åˆ—å¼æ•°æ®åº“ç³»ç»Ÿä¸­ï¼Œæ•°æ®åˆ™æŒ‰å¦‚ä¸‹é¡ºåºå­˜å‚¨ ROW #0 #1 #2 #3 #4 Title Database MySQL Nebula ClickHouse â€¦ Code 0 1 1 1 1 Note æ•°æ®åº“ å…³ç³»å‹æ•°æ®åº“ å›¾æ•°æ®åº“ åˆ—å¼æ•°æ®åº“ â€¦ Datetime 2022-0707 16:03:00 2022-0707 16:03:10 2022-0707 16:03:20 2022-07-07 16:03:30 â€¦ è¿™äº›ç¤ºä¾‹åªæ˜¾ç¤ºäº†æ•°æ®çš„æ’åˆ—é¡ºåºï¼Œæ¥è‡ªä¸åŒåˆ—çš„å€¼è¢«å•ç‹¬å­˜å‚¨ï¼Œæ¥è‡ªåŒä¸€åˆ—çš„æ•°æ®è¢«å­˜å‚¨åœ¨ä¸€èµ·ã€‚å¸¸è§çš„åˆ—å¼æ•°æ®åº“ç³»ç»Ÿæœ‰ï¼šVerticaã€Paraccel(Actian Matrix, Amazon Redshift)ã€Sybase IQã€Exasolã€Infobrightã€InfiniDBã€MonetDB(VectorWise, Actian Vector)ã€LucidDBã€SAP HANAã€Google Dremelã€Google PowerDrillã€Druidã€kdb+ ç­‰ ä¸åŒçš„æ•°æ®å­˜å‚¨æ–¹å¼é€‚ç”¨ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ï¼Œæ•°æ®è®¿é—®çš„åœºæ™¯åŒ…æ‹¬ï¼šè¿›è¡Œäº†ä½•ç§æŸ¥è¯¢ã€å¤šä¹…æŸ¥è¯¢ä¸€æ¬¡ä»¥åŠå„ç±»æŸ¥è¯¢çš„æ¯”ä¾‹ï¼›æ¯ç§ç±»å‹çš„æŸ¥è¯¢(è¡Œã€åˆ—å’Œå­—èŠ‚)è¯»å–å¤šå°‘æ•°æ®ï¼›è¯»å–æ•°æ®å’Œæ›´æ–°ä¹‹é—´çš„å…³ç³»ï¼›ä½¿ç”¨çš„æ•°æ®é›†å¤§å°ä»¥åŠå¦‚ä½•ä½¿ç”¨æœ¬åœ°çš„æ•°æ®é›†ï¼›æ˜¯å¦ä½¿ç”¨äº‹åŠ¡,ä»¥åŠå®ƒä»¬æ˜¯å¦‚ä½•è¿›è¡Œéš”ç¦»çš„ï¼›æ•°æ®çš„å¤åˆ¶æœºåˆ¶ä¸æ•°æ®çš„å®Œæ•´æ€§è¦æ±‚ï¼›æ¯ç§ç±»å‹çš„æŸ¥è¯¢è¦æ±‚çš„å»¶è¿Ÿä¸ååé‡ç­‰ç­‰ ç³»ç»Ÿè´Ÿè½½è¶Šé«˜ï¼Œä¾æ®ä½¿ç”¨åœºæ™¯è¿›è¡Œå®šåˆ¶åŒ–å°±è¶Šé‡è¦ï¼Œå¹¶ä¸”å®šåˆ¶å°†ä¼šå˜çš„è¶Šç²¾ç»†ã€‚æ²¡æœ‰ä¸€ä¸ªç³»ç»Ÿèƒ½å¤ŸåŒæ—¶é€‚ç”¨æ‰€æœ‰ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ã€‚å¦‚æœç³»ç»Ÿé€‚ç”¨äºå¹¿æ³›çš„åœºæ™¯ï¼Œåœ¨è´Ÿè½½é«˜çš„æƒ…å†µä¸‹ï¼Œè¦å…¼é¡¾æ‰€æœ‰çš„åœºæ™¯ï¼Œé‚£ä¹ˆå°†ä¸å¾—ä¸åšå‡ºé€‰æ‹©ï¼šå¹³è¡¡ OR æ•ˆç‡ è”æœºåˆ†æï¼ˆOLAPï¼‰åœºæ™¯çš„å…³é”®ç‰¹å¾Â· ç»å¤§å¤šæ•°æ˜¯è¯»è¯·æ±‚ Â· æ•°æ®ä»¥ç›¸å½“å¤§çš„æ‰¹æ¬¡(&gt; 1000è¡Œ)æ›´æ–°ï¼Œè€Œä¸æ˜¯å•è¡Œæ›´æ–°;æˆ–è€…æ ¹æœ¬æ²¡æœ‰æ›´æ–°ã€‚ Â· å·²æ·»åŠ åˆ°æ•°æ®åº“çš„æ•°æ®ä¸èƒ½ä¿®æ”¹ã€‚ Â· å¯¹äºè¯»å–ï¼Œä»æ•°æ®åº“ä¸­æå–ç›¸å½“å¤šçš„è¡Œï¼Œä½†åªæå–åˆ—çš„ä¸€å°éƒ¨åˆ†ã€‚ Â· å®½è¡¨ï¼Œå³æ¯ä¸ªè¡¨åŒ…å«ç€å¤§é‡çš„åˆ— Â· æŸ¥è¯¢ç›¸å¯¹è¾ƒå°‘(é€šå¸¸æ¯å°æœåŠ¡å™¨æ¯ç§’æŸ¥è¯¢æ•°ç™¾æ¬¡æˆ–æ›´å°‘) Â· å¯¹äºç®€å•æŸ¥è¯¢ï¼Œå…è®¸å»¶è¿Ÿå¤§çº¦50æ¯«ç§’ Â· åˆ—ä¸­çš„æ•°æ®ç›¸å¯¹è¾ƒå°ï¼šæ•°å­—å’ŒçŸ­å­—ç¬¦ä¸²(ä¾‹å¦‚ï¼Œæ¯ä¸ªURL 60ä¸ªå­—èŠ‚) Â· å¤„ç†å•ä¸ªæŸ¥è¯¢æ—¶éœ€è¦é«˜ååé‡(æ¯å°æœåŠ¡å™¨æ¯ç§’å¯è¾¾æ•°åäº¿è¡Œ) Â· äº‹åŠ¡ä¸æ˜¯å¿…é¡»çš„ Â· å¯¹æ•°æ®ä¸€è‡´æ€§è¦æ±‚ä½ Â· æ¯ä¸ªæŸ¥è¯¢æœ‰ä¸€ä¸ªå¤§è¡¨ã€‚é™¤äº†ä»–ä»¥å¤–ï¼Œå…¶ä»–çš„éƒ½å¾ˆå°ã€‚ Â· æŸ¥è¯¢ç»“æœæ˜æ˜¾å°äºæºæ•°æ®ã€‚æ¢å¥è¯è¯´ï¼Œæ•°æ®ç»è¿‡è¿‡æ»¤æˆ–èšåˆï¼Œå› æ­¤ç»“æœé€‚åˆäºå•ä¸ªæœåŠ¡å™¨çš„RAMä¸­ å¾ˆå®¹æ˜“å¯ä»¥çœ‹å‡ºï¼ŒOLAPåœºæ™¯ä¸å…¶ä»–é€šå¸¸ä¸šåŠ¡åœºæ™¯(ä¾‹å¦‚,OLTPæˆ–K/V)æœ‰å¾ˆå¤§çš„ä¸åŒï¼Œ å› æ­¤æƒ³è¦ä½¿ç”¨OLTPæˆ–Key-Valueæ•°æ®åº“å»é«˜æ•ˆçš„å¤„ç†åˆ†ææŸ¥è¯¢åœºæ™¯ï¼Œå¹¶ä¸æ˜¯éå¸¸å®Œç¾çš„é€‚ç”¨æ–¹æ¡ˆã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨OLAPæ•°æ®åº“å»å¤„ç†åˆ†æè¯·æ±‚é€šå¸¸è¦ä¼˜äºä½¿ç”¨MongoDBæˆ–Rediså»å¤„ç†åˆ†æè¯·æ±‚ã€‚ åˆ—å¼æ•°æ®åº“æ›´é€‚åˆOLAPåœºæ™¯çš„åŸå› åˆ—å¼æ•°æ®åº“æ›´é€‚åˆäºOLAPåœºæ™¯(å¯¹äºå¤§å¤šæ•°æŸ¥è¯¢è€Œè¨€ï¼Œå¤„ç†é€Ÿåº¦è‡³å°‘æé«˜äº†100å€) I/O1.é’ˆå¯¹åˆ†æç±»æŸ¥è¯¢ï¼Œé€šå¸¸åªéœ€è¦è¯»å–è¡¨çš„ä¸€å°éƒ¨åˆ†åˆ—ã€‚åœ¨åˆ—å¼æ•°æ®åº“ä¸­ä½ å¯ä»¥åªè¯»å–ä½ éœ€è¦çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåªéœ€è¦è¯»å–100åˆ—ä¸­çš„5åˆ—ï¼Œè¿™å°†å¸®åŠ©ä½ æœ€å°‘å‡å°‘20å€çš„I/Oæ¶ˆè€—ã€‚ 2.ç”±äºæ•°æ®æ€»æ˜¯æ‰“åŒ…æˆæ‰¹é‡è¯»å–çš„ï¼Œæ‰€ä»¥å‹ç¼©æ˜¯éå¸¸å®¹æ˜“çš„ã€‚åŒæ—¶æ•°æ®æŒ‰åˆ—åˆ†åˆ«å­˜å‚¨è¿™ä¹Ÿæ›´å®¹æ˜“å‹ç¼©ã€‚è¿™è¿›ä¸€æ­¥é™ä½äº†I/Oçš„ä½“ç§¯ã€‚ 3.ç”±äºI/Oçš„é™ä½ï¼Œè¿™å°†å¸®åŠ©æ›´å¤šçš„æ•°æ®è¢«ç³»ç»Ÿç¼“å­˜ã€‚ CPUç”±äºæ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢éœ€è¦å¤„ç†å¤§é‡çš„è¡Œï¼Œå› æ­¤åœ¨æ•´ä¸ªå‘é‡ä¸Šæ‰§è¡Œæ‰€æœ‰æ“ä½œå°†æ¯”åœ¨æ¯ä¸€è¡Œä¸Šæ‰§è¡Œæ‰€æœ‰æ“ä½œæ›´åŠ é«˜æ•ˆã€‚åŒæ—¶è¿™å°†æœ‰åŠ©äºå®ç°ä¸€ä¸ªå‡ ä¹æ²¡æœ‰è°ƒç”¨æˆæœ¬çš„æŸ¥è¯¢å¼•æ“ã€‚å¦‚æœä½ ä¸è¿™æ ·åšï¼Œä½¿ç”¨ä»»ä½•ä¸€ä¸ªæœºæ¢°ç¡¬ç›˜ï¼ŒæŸ¥è¯¢å¼•æ“éƒ½ä¸å¯é¿å…çš„åœæ­¢CPUè¿›è¡Œç­‰å¾…ã€‚æ‰€ä»¥ï¼Œåœ¨æ•°æ®æŒ‰åˆ—å­˜å‚¨å¹¶ä¸”æŒ‰åˆ—æ‰§è¡Œæ˜¯å¾ˆæœ‰æ„ä¹‰çš„ã€‚ æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼š 1.å‘é‡å¼•æ“ï¼šæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯ä¸ºå‘é‡è€Œä¸æ˜¯ä¸ºå•ä¸ªå€¼ç¼–å†™çš„ã€‚è¿™æ„å‘³ç€å¤šä¸ªæ“ä½œä¹‹é—´çš„ä¸å†éœ€è¦é¢‘ç¹çš„è°ƒç”¨ï¼Œå¹¶ä¸”è°ƒç”¨çš„æˆæœ¬åŸºæœ¬å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚æ“ä½œä»£ç åŒ…å«ä¸€ä¸ªä¼˜åŒ–çš„å†…éƒ¨å¾ªç¯ã€‚ 2.ä»£ç ç”Ÿæˆï¼šç”Ÿæˆä¸€æ®µä»£ç ï¼ŒåŒ…å«æŸ¥è¯¢ä¸­çš„æ‰€æœ‰æ“ä½œã€‚ è¿™æ˜¯ä¸åº”è¯¥åœ¨ä¸€ä¸ªé€šç”¨æ•°æ®åº“ä¸­å®ç°çš„ï¼Œå› ä¸ºè¿™åœ¨è¿è¡Œç®€å•æŸ¥è¯¢æ—¶æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚ä½†æ˜¯ä¹Ÿæœ‰ä¾‹å¤–ï¼Œä¾‹å¦‚ï¼ŒMemSQLä½¿ç”¨ä»£ç ç”Ÿæˆæ¥å‡å°‘å¤„ç†SQLæŸ¥è¯¢çš„å»¶è¿Ÿ(åªæ˜¯ä¸ºäº†æ¯”è¾ƒï¼Œåˆ†æå‹æ•°æ®åº“é€šå¸¸éœ€è¦ä¼˜åŒ–çš„æ˜¯ååè€Œä¸æ˜¯å»¶è¿Ÿ)ã€‚ ä¸ºäº†æé«˜CPUæ•ˆç‡ï¼ŒæŸ¥è¯¢è¯­è¨€å¿…é¡»æ˜¯å£°æ˜å‹çš„(SQLæˆ–MDX)ï¼Œ æˆ–è€…è‡³å°‘ä¸€ä¸ªå‘é‡(Jï¼ŒK)ã€‚ æŸ¥è¯¢åº”è¯¥åªåŒ…å«éšå¼å¾ªç¯ï¼Œå…è®¸è¿›è¡Œä¼˜åŒ–ã€‚ å®‰è£…ClickHouseä½¿ç”¨CentOSåŸºäºrpmçš„linuxå‘è¡Œç‰ˆå®˜æ–¹é¢„ç¼–è¯‘rpmåŒ…ï¼Œæ·»åŠ å®˜æ–¹å­˜å‚¨åº“ï¼š123$ sudo yum install -y yum-utils$ sudo yum-config-manager --add-repo https://packages.clickhouse.com/rpm/clickhouse.repo$ sudo yum install -y clickhouse-server clickhouse-client å¯åŠ¨CKè¿è¡Œä»¥ä¸‹å‘½ä»¤å°†åœ¨åå°å¯åŠ¨æœåŠ¡ï¼Œæ—¥å¿—æ–‡ä»¶å°†è¾“å‡ºåœ¨/var/log/clickhouse-server/æ–‡ä»¶å¤¹12$ sudo /etc/init.d/clickhouse-server start$ clickhouse-client # æˆ–æ‰§è¡Œ &quot;clickhouse-client --password&quot; æ¥æ·»åŠ å¯†ç  è¦æ‰‹åŠ¨ä»æ§åˆ¶å°å¯åŠ¨æœåŠ¡ï¼Œæ‰§è¡Œï¼š1$ clickhouse-server --config-file=/etc/clickhouse-server/config.xml æ—¥å¿—å°†è¢«æ‰“å°è‡³æ§åˆ¶å° å½“æœåŠ¡æˆåŠŸå¯åŠ¨åï¼Œæ‰§è¡Œ$ clickhouse-clientæ¥è¿æ¥CKæ•°æ®åº“ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨defaultç”¨æˆ·å¹¶ä¸æºå¸¦å¯†ç è¿æ¥åˆ°localhost:9000ï¼Œè¿˜å¯ä»¥ä½¿ç”¨â€“hostå‚æ•°è¿æ¥åˆ°æŒ‡å®šæœåŠ¡å™¨ã€‚ ç»ˆç«¯å¿…é¡»ä½¿ç”¨UTF-8ç¼–ç ã€‚ ClickHouseæ•°æ®åº“å¯è§†åŒ–å·¥å…·Dbeaverç›®å‰navicatå¹¶ä¸æ”¯æŒclickhouseçš„å¯è§†åŒ–æŸ¥è¯¢ï¼Œå¯ä»¥ä½¿ç”¨dbeaveræ•°æ®åº“ç®¡ç†å·¥å…·æ¥ä»£æ›¿navicat Dbeaverå®‰è£…ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„DBeaver RPMå®‰è£…åŒ…å¹¶ä½¿ç”¨rpm/dnfæˆ–yumè½¯ä»¶åŒ…ç®¡ç†å™¨è¿›è¡Œå®‰è£…12$ wget https://dbeaver.io/files/dbeaver-ce-latest-stable.x86_64.rpm$ sudo rpm -Uvh ./dbeaver-ce-latest-stable.x86_64.rpm å®Œæˆåå³å¯åœ¨ç»ˆç«¯æ‰§è¡Œ$ dbeaveræ¥å¯åŠ¨dbeaverï¼Œå†è¿æ¥åˆ°CKï¼ˆéœ€è¦å®‰è£…CKåœ¨çº¿åŒ…ï¼‰ ClickHouseæ•°æ®åº“æ“ä½œåˆ›å»ºæ–°çš„æ•°æ®åº“TESTï¼ˆåˆ é™¤ä¸ºDROPï¼‰1localhost :) CREATE DATABASE TEST æŸ¥çœ‹æ•°æ®åº“ã€æ•°æ®è¡¨12localhost :) SHOW DATABASESlocalhost :) SHOW TABLES IN TEST åˆ›å»ºæ•°æ®è¡¨ClickHouseæœ‰è‡ªå·±çš„æ•°æ®ç±»å‹ï¼Œæ¯ä¸ªè¡¨éƒ½å¿…é¡»æŒ‡å®šä¸€ä¸ªEngineå±æ€§æ¥ç¡®å®šè¦åˆ›å»ºçš„è¡¨çš„ç±»1localhost :) CREATE TABLE TEST.testable (id String,time Date,name String,code FixedString(2))ENGINE=MergeTree() ORDER BY (time) æ‰§è¡Œ1localhost :) DESCRIBE TEST.testable æ¥æè¿°è¡¨ æ·»åŠ æ•°æ®1localhost :) INSERT INTO TEST.testable VALUES (&apos;001&apos;,&apos;2022-07-07&apos;,&apos;MySQL&apos;,&apos;01&apos;) æˆ–æŒ‡å®šæ•°æ®æ‰€åœ¨çš„åˆ—ï¼š1localhost :) INSERT INTO TEST.testable(id,time,name,code) VALUES (&apos;002&apos;,&apos;2022-07-07&apos;,&apos;SQLite&apos;,&apos;01&apos;) æŒ‡å®šåˆ—ä¸æ’å…¥æ•°æ®ï¼š 1localhost :) INSERT INTO TEST.testable(* EXCEPT(code)) VALUES (&apos;0000&apos;,&apos;2022-07-07&apos;,&apos;nosql&apos;) SELECT12localhost :) SELECT * FROM TEST.testablelocalhost :) SELECT * FROM TEST.testable WHERE name=&apos;MySQL&apos;","categories":[{"name":"BigData","slug":"BigData","permalink":"http://yoursite.com/categories/BigData/"}],"tags":[{"name":"database","slug":"database","permalink":"http://yoursite.com/tags/database/"},{"name":"clickhouse","slug":"clickhouse","permalink":"http://yoursite.com/tags/clickhouse/"}]},{"title":"Nebula-CentOSå®‰è£…ä¸éƒ¨ç½²","slug":"Nebula-CentOSå®‰è£…ä¸éƒ¨ç½²","date":"2022-06-21T13:46:14.000Z","updated":"2022-09-22T03:41:08.505Z","comments":true,"path":"2022/06/21/Nebula-CentOSå®‰è£…ä¸éƒ¨ç½²/","link":"","permalink":"http://yoursite.com/2022/06/21/Nebula-CentOSå®‰è£…ä¸éƒ¨ç½²/","excerpt":"æœ¬æ–‡å‚è€ƒã€æå–è‡ªNebula Graph Databaseå®˜æ–¹æ–‡æ¡£(https://docs.nebula-graph.com.cn/2.6.0) 1.å‰æœŸå‡†å¤‡ç¯å¢ƒÂ· nebulaç‰ˆæœ¬ï¼š2.6.0Â· ä¸»æœºï¼šCentOS7 64ä½Â· å†…å­˜ï¼š8GBÂ· å¤„ç†å™¨æ•°é‡ï¼š4Â· å¤„ç†å™¨å†…æ ¸æ•°ï¼š4Â· å¤„ç†å™¨å†…æ ¸æ€»æ•°ï¼š16Â· ç¡¬ç›˜ï¼š30GBï¼ŒSSD ç¡¬ä»¶è¦æ±‚Â· CPUæ¶æ„ï¼šx86_64Â· å†…å­˜ï¼š4GBÂ· ç¡¬ç›˜ï¼š10GBï¼ŒSSD è½¯ä»¶ è½¯ä»¶åç§° ç‰ˆæœ¬ å¤‡æ³¨ glibc 2.17åŠä»¥ä¸Š æ‰§è¡Œldd --versionæ£€æŸ¥ç‰ˆæœ¬ make ä»»æ„ç¨³å®šç‰ˆæœ¬ - m4 ä»»æ„ç¨³å®šç‰ˆæœ¬ - git ä»»æ„ç¨³å®šç‰ˆæœ¬ - wget ä»»æ„ç¨³å®šç‰ˆæœ¬ - unzip ä»»æ„ç¨³å®šç‰ˆæœ¬ - xz ä»»æ„ç¨³å®šç‰ˆæœ¬ - redline-devel ä»»æ„ç¨³å®šç‰ˆæœ¬ - ncurses-devel ä»»æ„ç¨³å®šç‰ˆæœ¬ - zlib-devel ä»»æ„ç¨³å®šç‰ˆæœ¬ - gcc 7.5.0åŠä»¥ä¸Š æ‰§è¡Œå‘½ä»¤gcc -væ£€æŸ¥ç‰ˆæœ¬ gcc-c++ ä»»æ„ç¨³å®šç‰ˆæœ¬ - cmake 3.9.0åŠä»¥ä¸Š æ‰§è¡Œå‘½ä»¤cmake --versionæ£€æŸ¥ç‰ˆæœ¬ gettext ä»»æ„ç¨³å®šç‰ˆæœ¬ - curl ä»»æ„ç¨³å®šç‰ˆæœ¬ - redhat-lsb-core ä»»æ„ç¨³å®šç‰ˆæœ¬ - libstdc++-static ä»»æ„ç¨³å®šç‰ˆæœ¬ ä»…åœ¨CentOS 8+ã€RedHat 8+ã€Fedoraä¸­éœ€è¦ libasan ä»»æ„ç¨³å®šç‰ˆæœ¬ ä»…åœ¨CentOS 8+ã€RedHat 8+ã€Fedoraä¸­éœ€è¦ bzip2 ä»»æ„ç¨³å®šç‰ˆæœ¬ - éœ€è¦ä¿è¯gccå’Œcmakeçš„ç‰ˆæœ¬è¶³å¤Ÿé«˜ï¼Œå…¶ä»–ç¬¬ä¸‰æ–¹è½¯ä»¶å°†åœ¨å®‰è£…ï¼ˆcmakeï¼‰é˜¶æ®µè‡ªåŠ¨ä¸‹è½½å¹¶å®‰è£…åˆ°buildç›®å½•ä¸­","text":"æœ¬æ–‡å‚è€ƒã€æå–è‡ªNebula Graph Databaseå®˜æ–¹æ–‡æ¡£(https://docs.nebula-graph.com.cn/2.6.0) 1.å‰æœŸå‡†å¤‡ç¯å¢ƒÂ· nebulaç‰ˆæœ¬ï¼š2.6.0Â· ä¸»æœºï¼šCentOS7 64ä½Â· å†…å­˜ï¼š8GBÂ· å¤„ç†å™¨æ•°é‡ï¼š4Â· å¤„ç†å™¨å†…æ ¸æ•°ï¼š4Â· å¤„ç†å™¨å†…æ ¸æ€»æ•°ï¼š16Â· ç¡¬ç›˜ï¼š30GBï¼ŒSSD ç¡¬ä»¶è¦æ±‚Â· CPUæ¶æ„ï¼šx86_64Â· å†…å­˜ï¼š4GBÂ· ç¡¬ç›˜ï¼š10GBï¼ŒSSD è½¯ä»¶ è½¯ä»¶åç§° ç‰ˆæœ¬ å¤‡æ³¨ glibc 2.17åŠä»¥ä¸Š æ‰§è¡Œldd --versionæ£€æŸ¥ç‰ˆæœ¬ make ä»»æ„ç¨³å®šç‰ˆæœ¬ - m4 ä»»æ„ç¨³å®šç‰ˆæœ¬ - git ä»»æ„ç¨³å®šç‰ˆæœ¬ - wget ä»»æ„ç¨³å®šç‰ˆæœ¬ - unzip ä»»æ„ç¨³å®šç‰ˆæœ¬ - xz ä»»æ„ç¨³å®šç‰ˆæœ¬ - redline-devel ä»»æ„ç¨³å®šç‰ˆæœ¬ - ncurses-devel ä»»æ„ç¨³å®šç‰ˆæœ¬ - zlib-devel ä»»æ„ç¨³å®šç‰ˆæœ¬ - gcc 7.5.0åŠä»¥ä¸Š æ‰§è¡Œå‘½ä»¤gcc -væ£€æŸ¥ç‰ˆæœ¬ gcc-c++ ä»»æ„ç¨³å®šç‰ˆæœ¬ - cmake 3.9.0åŠä»¥ä¸Š æ‰§è¡Œå‘½ä»¤cmake --versionæ£€æŸ¥ç‰ˆæœ¬ gettext ä»»æ„ç¨³å®šç‰ˆæœ¬ - curl ä»»æ„ç¨³å®šç‰ˆæœ¬ - redhat-lsb-core ä»»æ„ç¨³å®šç‰ˆæœ¬ - libstdc++-static ä»»æ„ç¨³å®šç‰ˆæœ¬ ä»…åœ¨CentOS 8+ã€RedHat 8+ã€Fedoraä¸­éœ€è¦ libasan ä»»æ„ç¨³å®šç‰ˆæœ¬ ä»…åœ¨CentOS 8+ã€RedHat 8+ã€Fedoraä¸­éœ€è¦ bzip2 ä»»æ„ç¨³å®šç‰ˆæœ¬ - éœ€è¦ä¿è¯gccå’Œcmakeçš„ç‰ˆæœ¬è¶³å¤Ÿé«˜ï¼Œå…¶ä»–ç¬¬ä¸‰æ–¹è½¯ä»¶å°†åœ¨å®‰è£…ï¼ˆcmakeï¼‰é˜¶æ®µè‡ªåŠ¨ä¸‹è½½å¹¶å®‰è£…åˆ°buildç›®å½•ä¸­ 2.å®‰è£…ç¼–è¯‘1.å®‰è£…ä¾èµ–åŒ…1$ yum update 12345678910111213141516$ yum install -y make \\ m4 \\ git \\ wget \\ unzip \\ xz \\ readline-devel \\ ncurses-devel \\ zlib-devel \\ gcc \\ gcc-c++ \\ cmake \\ gettext \\ curl \\ redhat-lsb-core \\ bzip2 1$ yum install -y libstdc++-static libasan å®‰è£…å®Œæˆåæ£€æŸ¥ä¸»æœºçš„g++å’Œcmakeç‰ˆæœ¬12$ g++ --version$ cmake --version å¦‚æœcmakeå’Œg++çš„ç‰ˆæœ¬ä¸å¤Ÿï¼Œå¯ä»¥å…ˆåˆ°githubå…‹éš†nebulaä»“åº“12$ git clone --branch v2.6.0 https://github.com/vesoft-inc/nebula.git$ cd nebula æ‰§è¡Œå‘½ä»¤å®‰è£…cmakeå’Œg++123$ ./third-party/install-cmake.sh cmake-install$ source cmake-install/bin/enable-cmake.sh$ sudo mkdir /opt/vesoft &amp;&amp; sudo chmod -R a+w /opt/vesoft 12$ ./third-party/install-gcc.sh --prefix=/opt$ source /opt/vesoft/toolset/gcc/7.5.0/enable æœ€åæ‰§è¡Œè„šæœ¬install-third-party.sh1$ ./third-party/install-third-party.sh ç¼–è¯‘æºç åœ¨githubå…‹éš†nebulaä»“åº“åï¼Œåˆ›å»ºbuildç›®å½•å¹¶è¿›å…¥1$ mkdir build &amp;&amp; cd build ä½¿ç”¨cmakeç”Ÿæˆmakefileæ–‡ä»¶1$ cmake -DCMAKE_INSTALL_PREFIX=/usr/local/nebula -DENABLE_TESTING=OFF -DCMAKE_BUILD_TYPE=Release .. è¿›è¡Œç¼–è¯‘ï¼Œä¸ºäº†æé«˜é€Ÿåº¦ï¼Œ-jå‚æ•°ï¼ˆå¹¶è¡Œæ•°é‡ï¼‰ä¸ºmin(CPUæ ¸æ•°ï¼Œå†…å­˜/2)ï¼Œè¿™é‡Œé€‰æ‹©8/2=41$ make -j4 å®‰è£…nebula graph1$ sudo make install ä¸€åˆ‡å®Œæˆä»¥åï¼Œæ¥åˆ°é»˜è®¤çš„/usr/local/nebula/etcç›®å½•ä¸‹ï¼Œå°†é…ç½®æ–‡ä»¶ï¼ˆnebula-graph.conf.defaultã€nebula-metad.conf.defaultã€nebula-storaged.conf.defaultï¼‰åç¼€çš„.defaultåˆ é™¤ï¼Œå³ä½¿ç”¨é»˜è®¤çš„é…ç½®æ–‡ä»¶ 3.å¯åŠ¨Nebula GraphæœåŠ¡ç«¯å¯åŠ¨Nebula Graphç›´æ¥è¿›è¡Œå¯åŠ¨ã€æŸ¥çœ‹çŠ¶æ€å’Œå…³é—­æœåŠ¡çš„å‘½ä»¤ï¼š123$ sudo /usr/local/nebula/scripts/nebula.service start all$ sudo /usr/local/nebula/scripts/nebula.service status all$ sudo /usr/local/nebula/scripts/nebula.service stop all è¿æ¥Nebula Graphè¿›å…¥nebula consoleä¸‹è½½ç•Œé¢https://github.com/vesoft-inc/nebula-console/releasesï¼Œæ‰¾åˆ°å¯¹åº”çš„2.6.0ç‰ˆæœ¬ï¼Œç‚¹å‡»Assetsæ‰¾åˆ°linuxç‰ˆæœ¬ï¼Œè¿™é‡Œé€‰æ‹©nebula-console-linux-amd64-v2.6.0 1$ wget https://github.com/vesoft-inc/nebula-console/releases/download/v2.6.0/nebula-console-linux-amd64-v2.6.0 å°†ä¸‹è½½å¥½çš„nebula-console-linux-amd64-v2.6.0é‡å‘½åä¸ºnebula-console ä¸ºç”¨æˆ·æˆäºˆnebula-consoleæ–‡ä»¶çš„æ‰§è¡Œæƒé™1$ chmod 111 nebula-console æ¥åˆ°nebula-consoleæ‰€åœ¨ç›®å½•ä¸‹ï¼Œæ‰§è¡Œå‘½ä»¤è¿æ¥nebula graphï¼Œå…¶ä¸­å‚æ•°åˆ†åˆ«å¯¹åº”ipåœ°å€ã€æœåŠ¡ç«¯çš„ç«¯å£å·ï¼ˆ9669ï¼‰ã€nebulaç”¨æˆ·åå’Œå¯†ç 1$ ./nebula-console -addr 192.168.80.128 -port 9669 -u root -p nebula æˆåŠŸåè¿›å…¥åˆ°nebula consoleæ§åˆ¶å°ç•Œé¢ï¼ˆéœ€è¦æå‰å¯åŠ¨nebula graphï¼‰ å¯ä»¥é€šè¿‡consoleæ§åˆ¶å°æ‰§è¡Œå‘½ä»¤ï¼Œè¿›è¡Œæ•°æ®åº“çš„æŸ¥çœ‹ã€ç¼–è¾‘ç­‰ æœ€åé€šè¿‡exitæˆ–è€…quitå‘½ä»¤é€€å‡ºnebula consoleæ§åˆ¶å° 4.Nebula Graph Studioå®¢æˆ·ç«¯nebula graph studioæ˜¯ä¸€æ¬¾å¯ä»¥é€šè¿‡ Web è®¿é—®çš„å›¾æ•°æ®åº“å¼€æºå¯è§†åŒ–å·¥å…·ï¼Œæ­é… nebula graph å†…æ ¸ä½¿ç”¨ï¼Œèƒ½å¤Ÿæä¾›æ„å›¾ã€æ•°æ®å¯¼å…¥ã€ç¼–å†™ nGQL æŸ¥è¯¢ã€å›¾æ¢ç´¢ç­‰ä¸€ç«™å¼æœåŠ¡ nebula graph studio ç‰ˆæœ¬å‘å¸ƒèŠ‚å¥ç‹¬ç«‹äº nebula graph å†…æ ¸ï¼Œå…¶å‘½åæ–¹å¼ä¹Ÿä¸å‚ç…§å†…æ ¸å‘½åçš„è§„åˆ™ï¼Œç›®å‰ä»…æ”¯æŒ x86_64 æ¶æ„ å‰æœŸå‡†å¤‡Â· éœ€è¦å¯åŠ¨nebula graphæœåŠ¡ Â· ä½¿ç”¨çš„Linuxå‘è¡Œç‰ˆä¸ºCentOSï¼Œå®‰è£…æœ‰lsofå’Œç‰ˆæœ¬ä¸ºv10.16.0åŠä»¥ä¸Šçš„Node.js Â· ç¡®ä¿7001å’Œ8080ç«¯å£å¤„äºæœªè¢«å ç”¨çš„çŠ¶æ€ ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„node.jsï¼š è¿›å…¥node.jså®˜ç½‘ï¼Œé€‰æ‹©linuxä¸‹64ä½ç‰ˆæœ¬ 1$ wget https://nodejs.org/dist/v16.15.1/node-v16.15.1-linux-x64.tar.xz ä¸‹è½½åˆ°æœ¬åœ°ä»¥åè§£å‹ç¼©ï¼Œå°†æ–‡ä»¶é‡å‘½åä¸ºnodejs16ï¼Œ12$ tar xf node-v16.15.1-linux-x64.tar.xz$ mv node-v16.15.1-linux-x64 nodejs16 é…ç½®è½¯è¿æ¥ï¼Œå°†nodejs16æ˜ å°„åˆ°usr/binä¸‹ï¼Œä½¿å…¨å±€å¯ä»¥ä½¿ç”¨node.js12$ ln -s /root/nodejs16/bin/node /usr/bin/ $ ln -s /root/nodejs16/bin/npm /usr/bin/ æœ€åå¯ä»¥æŸ¥çœ‹node.jsçš„ç‰ˆæœ¬ï¼Œç¡®è®¤å®‰è£…å®Œæˆ1$ /usr/bin/node -v å®‰è£…å’Œéƒ¨ç½²nebula graph studio12$ https://oss-cdn.nebula-graph.com.cn/nebula-graph-studio/3.1.0/nebula-graph-studio-3.1.0.x86_64.rpm$ sudo rpm -i nebula-graph-studio-3.1.0.x86_64.rpm æˆåŠŸåæ˜¾ç¤º[egg-scripts] egg started on http://0.0.0.0:7001è¯´æ˜å®¢æˆ·ç«¯æ­£å¸¸å¯åŠ¨äº† åˆ·å…¥å‰é¢æ¥å£è¦è°ƒç”¨åˆ°çš„æ•°æ® è¦æ‰‹åŠ¨å…³é—­å’Œå¯åŠ¨æœåŠ¡ï¼Œå¯ä»¥æ‰§è¡Œ 12$ bash /usr/local/nebula-graph-studio/scripts/rpm/start.sh$ bash /usr/local/nebula-graph-studio/scripts/rpm/stop.sh windowsè®¿é—®å®¢æˆ·ç«¯æŸ¥çœ‹è™šæ‹ŸæœºçŠ¶æ€ï¼Œå…³é—­è™šæ‹Ÿæœºé˜²ç«å¢™ï¼Œç¦æ­¢é˜²ç«å¢™çš„å¼€æœºå¯åŠ¨123$ service iptables status$ systemctl stop firewalld.service$ systemctl disable firewalld.service åœ¨æµè§ˆå™¨ä¸­è¿›å…¥è™šæ‹Ÿæœºæœ¬åœ°ipï¼Œè¿›å…¥å›¾åº“ï¼Œå¯ä»¥æ£€ç´¢åˆ°å‰é¢æ’å…¥çš„æ•°æ® è‡ªå¯åŠ¨è¿›å…¥ç³»ç»Ÿç›¸å…³é…ç½®æ–‡ä»¶ï¼Œå†™å…¥è‡ªå¯åŠ¨å‘½ä»¤å’Œè„šæœ¬1$ vim /etc/rc.d/rc.local å†™å…¥å¯åŠ¨å‘½ä»¤123#nebula-graphsudo /usr/local/nebula/scripts/nebula.service start allbash /usr/local/nebula-graph-studio/scripts/rpm/start.sh","categories":[{"name":"BigData","slug":"BigData","permalink":"http://yoursite.com/categories/BigData/"}],"tags":[{"name":"database","slug":"database","permalink":"http://yoursite.com/tags/database/"},{"name":"nebula","slug":"nebula","permalink":"http://yoursite.com/tags/nebula/"}]},{"title":"FastApi","slug":"FastApi","date":"2022-05-23T03:49:29.000Z","updated":"2022-06-27T07:29:21.649Z","comments":true,"path":"2022/05/23/FastApi/","link":"","permalink":"http://yoursite.com/2022/05/23/FastApi/","excerpt":"FastAPI æ˜¯ä¸€ä¸ªåŸºäºPython3.6+ç‰ˆæœ¬ç”¨äºæ„å»ºAPIçš„é«˜æ€§èƒ½webæ¡†æ¶ å®˜æ–¹æ–‡æ¡£é“¾æ¥ï¼šhttps://fastapi.tiangolo.com å®‰è£…æ‰§è¡Œpip install fastapi[all]æ¥å®‰è£…fastapiæ‰€éœ€è¦çš„å…¨éƒ¨pythonåŒ…å’Œæ¨¡å— ä¹Ÿå¯ä»¥åˆ†å¼€æ¥å®‰è£…æ¥å°†åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ°æˆäº§ç¯å¢ƒï¼Œå…¶ä¸­uvicornå¯ä»¥ç”¨ä½œè¿è¡Œä»£ç çš„æœåŠ¡å™¨12pip install fastapipip install uvicorn[standard]","text":"FastAPI æ˜¯ä¸€ä¸ªåŸºäºPython3.6+ç‰ˆæœ¬ç”¨äºæ„å»ºAPIçš„é«˜æ€§èƒ½webæ¡†æ¶ å®˜æ–¹æ–‡æ¡£é“¾æ¥ï¼šhttps://fastapi.tiangolo.com å®‰è£…æ‰§è¡Œpip install fastapi[all]æ¥å®‰è£…fastapiæ‰€éœ€è¦çš„å…¨éƒ¨pythonåŒ…å’Œæ¨¡å— ä¹Ÿå¯ä»¥åˆ†å¼€æ¥å®‰è£…æ¥å°†åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ°æˆäº§ç¯å¢ƒï¼Œå…¶ä¸­uvicornå¯ä»¥ç”¨ä½œè¿è¡Œä»£ç çš„æœåŠ¡å™¨12pip install fastapipip install uvicorn[standard] æ¥å£æœ€ç®€å•çš„Fastapiæ¥å£å¯ä»¥å¦‚ä¸‹æ‰€ç¤ºï¼Œåˆ¶ä½œä¸€ä¸ªæ ¹èŠ‚ç‚¹ä¸‹çš„æ¬¢è¿ç›®å½•Hello World123456789101112from fastapi import FastAPIapp = FastAPI()@app.get(\"/\")async def root(): return &#123;\"message\": \"Hello World\"&#125;if __name__ == \"__main__\": import uvicorn uvicorn.run(app=\"main:app\", reload=True, host='127.0.0.1', port=8888) è¿›å…¥å¯¹åº”çš„æœ¬åœ°åœ°å€åä¼šè·å¾—200çš„å“åº”å¹¶æ”¶åˆ°jsonä¿¡æ¯ï¼š{â€œmessageâ€: â€œHello Worldâ€} ç»§ç»­è·³è½¬åˆ°http://localhost:8888/docsæˆ–è€…http://localhost:8888/redocå°†è¿›å…¥ç”±Swagger UIæä¾›çš„äº¤äº’å¼APIåœ¨çº¿æ–‡æ¡£","categories":[{"name":"Python","slug":"Python","permalink":"http://yoursite.com/categories/Python/"}],"tags":[{"name":"FastApi","slug":"FastApi","permalink":"http://yoursite.com/tags/FastApi/"}]},{"title":"Scrapyï¼šçˆ¬å–steamçƒ­é—¨æ¸¸æˆèµ„æ–™","slug":"Scrapyï¼šçˆ¬å–steamçƒ­é—¨æ¸¸æˆèµ„æ–™","date":"2022-05-01T04:00:35.000Z","updated":"2022-06-27T07:39:57.505Z","comments":true,"path":"2022/05/01/Scrapyï¼šçˆ¬å–steamçƒ­é—¨æ¸¸æˆèµ„æ–™/","link":"","permalink":"http://yoursite.com/2022/05/01/Scrapyï¼šçˆ¬å–steamçƒ­é—¨æ¸¸æˆèµ„æ–™/","excerpt":"æœ‰æ®µæ—¶é—´æ²¡æœ‰åšçˆ¬è™«ç¨‹åºäº†ï¼Œæ­£å¥½æƒ³èµ·æ¥è¿˜æ²¡æœ‰å†™è¿‡scrapyæ¡†æ¶çš„åšå®¢ï¼Œå†™ä¸ªscrapyçˆ¬è™«è¿›è¡Œæ€»ç»“å’Œå›é¡¾ã€‚æœ¬æ–‡ä»£ç å·²ä¸Šä¼ è‡³githubï¼šhttps://github.com/elbadaernU404/steamgames 1.Scrapyç®€ä»‹æœç´¢scrapyï¼Œå¯ä»¥å¾ˆè½»æ¾çš„æ‰¾åˆ°Scrapyçš„å®˜æ–¹ç½‘ç«™ï¼Œæ­£å¦‚å…¶é¦–é¡µæ‰€æè¿°çš„é‚£æ ·ï¼Œscrapyæ˜¯ä¸€æ¬¾å¿«é€Ÿä¸”å¼ºåŠ›çš„å¤šçº¿ç¨‹å¼‚æ­¥çˆ¬è™«æ¡†æ¶ï¼Œé€‚åˆå¯¹é™æ€é¡µé¢ï¼ˆä¸é…ç½®ä¸­é—´ä»¶çš„æƒ…å†µä¸‹ï¼‰çš„ä¿¡æ¯è¿›è¡Œé«˜é€Ÿä¸”å¤§é¢ç§¯ã€é«˜å±‚æ¬¡çš„æŠ“å–ï¼Œé¿å…äº†ä¼ ç»Ÿçˆ¬è™«å¹¶å‘çˆ¬å–ç½‘ç«™æ•°æ®çš„å±€é™æ€§ï¼Œä»…éœ€è¦å°‘é‡çš„ä»£ç å³å¯å®Œæˆçˆ¬è™«å·¥ä½œï¼Œæ˜¯ä¸€é¡¹é«˜æ•ˆç‡çš„ä¸»æµçˆ¬è™«å·¥å…·ã€‚ 2.Scrapyæ¡†æ¶åŸç†è¿›å…¥scrapyå®˜ç½‘ï¼Œå¯ä»¥æ‰¾åˆ°å®˜æ–¹æ–‡æ¡£ä¸­å¯¹æ¡†æ¶æœ€æ–°çš„æè¿°å¦‚ä¸‹ï¼š æ€»ç»“åå°±æ˜¯ï¼šscrapyæ¡†æ¶ä¸­å…±åŒ…æ‹¬äº†å¼•æ“ï¼ˆScrapy Engineï¼‰ã€Item å­—æ®µã€è°ƒåº¦å™¨ï¼ˆSchedulerï¼‰ã€è°ƒåº¦ä¸­é—´ä»¶ï¼ˆScheduler Middewaresï¼‰ã€ä¸‹è½½å™¨ï¼ˆDownloaderï¼‰ã€ä¸‹è½½å™¨ä¸­é—´ä»¶ï¼ˆDownloader Middlewaresï¼‰ã€çˆ¬è™«ç¨‹åºï¼ˆSpidersï¼‰ã€çˆ¬è™«ä¸­é—´ä»¶ï¼ˆSpider Middlewaresï¼‰å’Œç®¡é“ï¼ˆPipelineï¼‰ 1.scrapyå¼•æ“ä¼šä»çˆ¬è™«ç¨‹åºä¸­è·å–åˆå§‹è¯·æ±‚ï¼›2.scrapyå¼•æ“é€šè¿‡è°ƒåº¦å™¨ï¼ˆSchedulerï¼‰è°ƒåº¦Requestså¹¶è¦æ±‚è·å–ä¸‹ä¸€ä¸ªRequestsï¼›3.è°ƒåº¦å™¨å°†ä¸‹ä¸€ä¸ªè¯·æ±‚è¿”å›è‡³scrapyå¼•æ“ï¼›4.scrapyå¼•æ“é€šè¿‡ä¸‹è½½ä¸­é—´ä»¶å°†è¯·æ±‚å‘é€åˆ°ä¸‹è½½å™¨ï¼ˆDownloaderï¼‰å½“ä¸­ï¼Œå®Œæˆä¸€æ¬¡ä¸‹è½½åä¸‹è½½å™¨ä¼šç”ŸæˆResponseå¹¶å‘é€ç»™scrapyå¼•æ“ï¼›5.scrapyå¼•æ“æ¥å—ä¸‹è½½å™¨çš„Responseäº¤ç»™çˆ¬è™«ç¨‹åºã€‚çˆ¬è™«å®Œæˆå¯¹Responseçš„å¤„ç†åï¼Œå°†æŠ“å–çš„æ•°æ®å’Œæ–°çš„Requestsè¿”å›ç»™scrapyå¼•æ“ï¼Œscrapyå¼•æ“å°†æ•°æ®å¤„ç†å®Œæ¯•åäº¤ç»™Itemç®¡é“ï¼Œå†å°†å¤„ç†çš„è¯·æ±‚å‘é€ç»™è°ƒåº¦å™¨ï¼Œæ‰§è¡Œä¸‹ä¸€è½®å·¥ä½œï¼›6.é‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œç›´åˆ°ä¸å†æœ‰æ¥è‡ªè°ƒåº¦å™¨çš„è¯·æ±‚ï¼Œçˆ¬è™«ç¨‹åºç»“æŸã€‚","text":"æœ‰æ®µæ—¶é—´æ²¡æœ‰åšçˆ¬è™«ç¨‹åºäº†ï¼Œæ­£å¥½æƒ³èµ·æ¥è¿˜æ²¡æœ‰å†™è¿‡scrapyæ¡†æ¶çš„åšå®¢ï¼Œå†™ä¸ªscrapyçˆ¬è™«è¿›è¡Œæ€»ç»“å’Œå›é¡¾ã€‚æœ¬æ–‡ä»£ç å·²ä¸Šä¼ è‡³githubï¼šhttps://github.com/elbadaernU404/steamgames 1.Scrapyç®€ä»‹æœç´¢scrapyï¼Œå¯ä»¥å¾ˆè½»æ¾çš„æ‰¾åˆ°Scrapyçš„å®˜æ–¹ç½‘ç«™ï¼Œæ­£å¦‚å…¶é¦–é¡µæ‰€æè¿°çš„é‚£æ ·ï¼Œscrapyæ˜¯ä¸€æ¬¾å¿«é€Ÿä¸”å¼ºåŠ›çš„å¤šçº¿ç¨‹å¼‚æ­¥çˆ¬è™«æ¡†æ¶ï¼Œé€‚åˆå¯¹é™æ€é¡µé¢ï¼ˆä¸é…ç½®ä¸­é—´ä»¶çš„æƒ…å†µä¸‹ï¼‰çš„ä¿¡æ¯è¿›è¡Œé«˜é€Ÿä¸”å¤§é¢ç§¯ã€é«˜å±‚æ¬¡çš„æŠ“å–ï¼Œé¿å…äº†ä¼ ç»Ÿçˆ¬è™«å¹¶å‘çˆ¬å–ç½‘ç«™æ•°æ®çš„å±€é™æ€§ï¼Œä»…éœ€è¦å°‘é‡çš„ä»£ç å³å¯å®Œæˆçˆ¬è™«å·¥ä½œï¼Œæ˜¯ä¸€é¡¹é«˜æ•ˆç‡çš„ä¸»æµçˆ¬è™«å·¥å…·ã€‚ 2.Scrapyæ¡†æ¶åŸç†è¿›å…¥scrapyå®˜ç½‘ï¼Œå¯ä»¥æ‰¾åˆ°å®˜æ–¹æ–‡æ¡£ä¸­å¯¹æ¡†æ¶æœ€æ–°çš„æè¿°å¦‚ä¸‹ï¼š æ€»ç»“åå°±æ˜¯ï¼šscrapyæ¡†æ¶ä¸­å…±åŒ…æ‹¬äº†å¼•æ“ï¼ˆScrapy Engineï¼‰ã€Item å­—æ®µã€è°ƒåº¦å™¨ï¼ˆSchedulerï¼‰ã€è°ƒåº¦ä¸­é—´ä»¶ï¼ˆScheduler Middewaresï¼‰ã€ä¸‹è½½å™¨ï¼ˆDownloaderï¼‰ã€ä¸‹è½½å™¨ä¸­é—´ä»¶ï¼ˆDownloader Middlewaresï¼‰ã€çˆ¬è™«ç¨‹åºï¼ˆSpidersï¼‰ã€çˆ¬è™«ä¸­é—´ä»¶ï¼ˆSpider Middlewaresï¼‰å’Œç®¡é“ï¼ˆPipelineï¼‰ 1.scrapyå¼•æ“ä¼šä»çˆ¬è™«ç¨‹åºä¸­è·å–åˆå§‹è¯·æ±‚ï¼›2.scrapyå¼•æ“é€šè¿‡è°ƒåº¦å™¨ï¼ˆSchedulerï¼‰è°ƒåº¦Requestså¹¶è¦æ±‚è·å–ä¸‹ä¸€ä¸ªRequestsï¼›3.è°ƒåº¦å™¨å°†ä¸‹ä¸€ä¸ªè¯·æ±‚è¿”å›è‡³scrapyå¼•æ“ï¼›4.scrapyå¼•æ“é€šè¿‡ä¸‹è½½ä¸­é—´ä»¶å°†è¯·æ±‚å‘é€åˆ°ä¸‹è½½å™¨ï¼ˆDownloaderï¼‰å½“ä¸­ï¼Œå®Œæˆä¸€æ¬¡ä¸‹è½½åä¸‹è½½å™¨ä¼šç”ŸæˆResponseå¹¶å‘é€ç»™scrapyå¼•æ“ï¼›5.scrapyå¼•æ“æ¥å—ä¸‹è½½å™¨çš„Responseäº¤ç»™çˆ¬è™«ç¨‹åºã€‚çˆ¬è™«å®Œæˆå¯¹Responseçš„å¤„ç†åï¼Œå°†æŠ“å–çš„æ•°æ®å’Œæ–°çš„Requestsè¿”å›ç»™scrapyå¼•æ“ï¼Œscrapyå¼•æ“å°†æ•°æ®å¤„ç†å®Œæ¯•åäº¤ç»™Itemç®¡é“ï¼Œå†å°†å¤„ç†çš„è¯·æ±‚å‘é€ç»™è°ƒåº¦å™¨ï¼Œæ‰§è¡Œä¸‹ä¸€è½®å·¥ä½œï¼›6.é‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œç›´åˆ°ä¸å†æœ‰æ¥è‡ªè°ƒåº¦å™¨çš„è¯·æ±‚ï¼Œçˆ¬è™«ç¨‹åºç»“æŸã€‚ 3.åˆ¶ä½œScrapyçˆ¬è™«ç¨‹åº3.1 ç›®æ ‡ç½‘ç«™ï¼šSteamå•†åº—&lt;s.team&gt;å®Œæ•´åŸŸåï¼šhttps://store.steampowered.com/ 3.2 ç›®æ ‡æ•°æ®çˆ¬è™«è¦æå–çš„æ•°æ®ä¸ºSteamå•†åº—ä¸­å…¨çƒçƒ­é”€æ¦œä¸­çš„æ¸¸æˆä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼šÂ· æ¸¸æˆåç§°Â· é“¾æ¥Â· å‘å”®æ—¥æœŸÂ· å¥½è¯„ç‡Â· æŠ˜æ‰£Â· ä»·æ ¼ï¼ˆåŸä»·ã€æŠ˜æ‰£ä»·ï¼Œå› ä¸ºæŒ‚äº†æ¢¯å­æ‰€ä»¥è´§å¸æ˜¾ç¤ºçš„æ˜¯æ–°å°å¸ï¼‰ æ£€æŸ¥å…ƒç´ ï¼Œæ‰¾åˆ°å„æ•°æ®çš„xpath å¯ä»¥åœ¨chromeæµè§ˆå™¨æ’ä»¶xpath helperä¸­éªŒè¯xpathæ˜¯å¦èƒ½è·å–ç›®æ ‡æ•°æ® 3.3 åˆ›å»ºScrapyé¡¹ç›®å¯åŠ¨pycharmï¼Œåœ¨pycharmçš„ç»ˆç«¯ä¸­è¿›å…¥å­˜æ”¾pycharmç¨‹åºçš„ç›®å½•ï¼Œæ–°å»ºä¸€ä¸ªé¡¹ç›®steamgamesã€‚åœ¨ç»ˆç«¯ä¸­è¾“å…¥ï¼š scrapy startproject steamgames æˆåŠŸåˆ›å»ºé¡¹ç›®åï¼Œä¼šå¾—åˆ°çˆ¬è™«é¡¹ç›®çš„æ ¹ç›®å½•steamgamesæ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…å«æœ‰æ¡†æ¶å·²ç»åˆ›å»ºå·çš„pythonç¨‹åºï¼š 3.4 åˆ›å»ºçˆ¬è™«ç¨‹åºè¿›å…¥é¡¹ç›®ç›®å½•åï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥ï¼šscrapy genspider test store.steampowered.com å®Œæˆå¯¹çˆ¬è™«ç¨‹åºçš„åˆ›å»ºï¼Œå‘½åä¸ºtest 3.5 ç¨‹åºåˆ¶ä½œ3.5.1 ç¼–å†™items.pyé¦–å…ˆåœ¨ç›®å½•çš„items.pyæ–‡ä»¶ä¸­æ·»åŠ è¦çˆ¬å–æ•°æ®çš„itemå­—æ®µ,å¯¹åº”çš„ä¿¡æ¯åˆ†åˆ«ä¸ºä¸Šè¿°çš„Â· æ¸¸æˆåç§°Â· é“¾æ¥Â· å‘å”®æ—¥æœŸÂ· å¥½è¯„ç‡Â· æŠ˜æ‰£Â· ä»·æ ¼ï¼ˆåŸä»·ã€æŠ˜æ‰£ä»·ï¼‰123456789101112131415161718192021222324# -*- coding: utf-8 -*-# Define here the models for your scraped items## See documentation in:# https://doc.scrapy.org/en/latest/topics/items.htmlimport scrapyclass SteamgamesItem(scrapy.Item): # define the fields for your item here like: # name = scrapy.Field() name = scrapy.Field() link = scrapy.Field() time = scrapy.Field() evaluate = scrapy.Field() discount = scrapy.Field() price = scrapy.Field() #pass 3.5.2 ä¿®æ”¹settings.pyé¦–å…ˆå› ä¸ºæ˜¯å­¦ä¹ ç”¨é€”ï¼Œå…³é—­éµå®ˆrobotsåè®® robotsåè®®å…¨ç§°â€œç½‘ç»œçˆ¬è™«æ’é™¤æ ‡å‡†â€ï¼Œåˆç§°çˆ¬è™«åè®®ã€æœºå™¨äººåè®®ç­‰ï¼Œå®ƒè§„å®šç€æœç´¢å¼•æ“æŠ“å–ç½‘ç«™æ—¶æ‰€èƒ½æŠ“å–çš„å†…å®¹ï¼Œæ˜¯ç½‘ç»œçˆ¬è™«çˆ¬è¡Œç½‘ç«™æ—¶ç¬¬ä¸€ä¸ªéœ€è¦è®¿é—®çš„æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä½äºç½‘ç«™çš„æ ¹ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åæ˜¯robots.txtï¼Œä¸»è¦ç”¨äºä¿æŠ¤ç½‘ç«™çš„éšç§ï¼Œæ¥é˜²æ­¢ç½‘ç«™é‡è¦çš„ä¿¡æ¯è¢«æ³„éœ²ï¼Œå¯¹ç½‘ç«™å®‰å…¨èµ·åˆ°ä¸€å®šçš„ä½œç”¨ã€‚1ROBOTSTXT_OBEY = False æ¥ä¸‹æ¥å¯ç”¨ç®¡é“ç¨‹åºï¼Œç”¨äºåç»­çš„æ•°æ®å­˜å‚¨ã€‚å…¶ä¸­æ•°å­—â€œ300â€è¡¨ç¤ºæ¯ä¸ªç®¡é“æ‰§è¡Œçš„ä¼˜å…ˆçº§ï¼Œæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼Œä¸€èˆ¬ä¸è¶…è¿‡1000123ITEM_PIPELINES = &#123; 'steamgames.pipelines.SteamgamesPipeline': 300,&#125; 3.5.3 scrapy shellå¯ä»¥é€šè¿‡scrapy shell + â€œlinkurlâ€çš„æ–¹å¼è¿›å…¥scrapy shellï¼Œå¯¹é¡¹ç›®è¿›è¡Œæµ‹è¯•ï¼Œå¦‚æµ‹è¯•ä½¿ç”¨çš„xpathæ˜¯å¦æ­£å¸¸è·å¾—äº†å€¼ï¼ˆæœªå—åˆ°åçˆ¬æ‰‹æ®µå½±å“ï¼‰ è¿™é‡Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥scrapy shell â€œhttps://store.steampowered.com/search/?filter=globaltopsellers&amp;os=win&quot; æˆåŠŸè¿›å…¥scrapy shellï¼š è¿›è¡Œxpathæµ‹è¯•ï¼Œè¾“å…¥ï¼š response.xpath(â€œ//*[@id=â€™search_resultsRowsâ€™]/a/div[2]/div[4]/div[1]/span/text()â€).extract()response.xpath(â€œ//*[@id=â€™search_resultsRowsâ€™]/a/div[2]/div[1]/span/text()â€).extract() å¾—åˆ°ç»“æœï¼Œæµ‹è¯•æˆåŠŸï¼š 3.5.4 åˆ¶ä½œçˆ¬è™«ç¨‹åºtest.pyè¿›å…¥å·²ç»ç”Ÿæˆå¥½çš„test.pyç¨‹åºå½“ä¸­ï¼Œç¨‹åºä¸­å·²å­˜åœ¨çš„ä»£ç 123name = 'test'allowed_domains = ['store.steampowered.com']start_urls = ['https://store.steampowered.com/search/?filter=globaltopsellers&amp;os=win'] åˆ†åˆ«è¡¨ç¤ºçˆ¬è™«çš„åç§°ã€çˆ¬å–çš„åŸŸåç•Œé™ï¼ˆç½‘ç«™å†…ï¼‰ã€çˆ¬è™«çš„èµ·å§‹ç½‘å€ çˆ¬è™«ç¨‹åºå¯ä»¥æœ‰å¤šä¸ªï¼Œçˆ¬å–çš„ç½‘å€å­è·¯ç”±ä¹Ÿå¯ä»¥æœ‰å¤šä¸ªï¼Œä½†æ˜¯ä¸èƒ½è¶…å‡ºä¸€å¼€å§‹è®¾å®šçš„èŒƒå›´ä¹‹å¤– åœ¨ç±»TestSpiderä¸­ï¼Œå‡½æ•°parseåç§°ä¸å¯å˜ï¼Œå› ä¸ºå…¶ç±»æœ¬èº«ç»§æ‰¿è‡ªscrapyçš„Spiderï¼Œæˆ‘ä»¬åªæ˜¯æ”¹å†™å…¶ä¸­çš„æ–¹æ³•ï¼Œå®ç°çˆ¬è™«åŠŸèƒ½ã€‚ ä¸ºäº†é˜²æ­¢åœ¨å‡½æ•°ç»“å°¾return itemå¯¼è‡´æ•´ä¸ªå‡½æ•°ç»ˆæ­¢è¿è¡Œï¼Œè€Œä¸èƒ½ç»§ç»­å®Œæˆä¹‹åçš„æ•°æ®ä¼ è¾“è¿›ç®¡é“ç¨‹åºä¸­ï¼Œæ•…è¿™é‡Œä½¿ç”¨çš„æ˜¯yieldå…³é”®å­—å®ç°ä¸€ä¸ªè¿­ä»£å™¨1234567891011121314151617181920def parse(self, response): node_list = response.xpath(\"//*[@id='search_resultsRows']/a\") print(node_list) for node in node_list: item = SteamgamesItem() name = node.xpath(\"./div[2]/div[1]/span/text()\").extract() link = node.xpath(\"./@href\").extract() time = node.xpath(\"./div[2]/div[2]/text()\").extract() evaluate = node.xpath(\"./div[2]/div[3]/span/@data-tooltip-html\").extract() discount = node.xpath(\"./div[2]/div[4]/div[1]/span/text()\").extract() price = node.xpath('normalize-space(./div[2]/div[4]/div[2])').extract() item['name'] = name[0] item['link'] = link[0] tem['time'] = time[0] item['evaluate'] = evaluate[0] item['discount'] = discount[0] item['price'] = price[0] yield item åˆ°è¿™é‡Œå¯ä»¥ä½¿ç”¨å‘½ä»¤scrapy crawl test -o steamgames.jsonæ¥å°†ç»“æœç›´æ¥è¾“å‡ºä¸ºjsonæ ¼å¼çš„æ–‡ä»¶ ä½†æ˜¯æµ‹è¯•åå¦‚æœæŠ¥é”™ï¼š Â· KeyError: Spider not foundå¯èƒ½æ˜¯ç”±äºè¿è¡Œçš„çˆ¬è™«æ–‡ä»¶ä¸test.pyä¸­çš„çˆ¬è™«åç§°ä¸ç¬¦ï¼Œæˆ–è€…åˆ›å»ºçš„çˆ¬è™«æ–‡ä»¶æœªèƒ½æ”¾å…¥spidersæ–‡ä»¶å¤¹å½“ä¸­ï¼Œæ£€æŸ¥å³å¯ Â· IndexError: list index out of rangeå› ä¸ºå¹¶ä¸æ˜¯æ‰€æœ‰æ¸¸æˆåˆ—å‡ºäº†æŠ˜æ‰£ã€æŠ˜æ‰£ä»·æ ¼ç­‰æƒ…å†µï¼Œæ‰€ä»¥åœ¨å¾—åˆ°ç©ºåˆ—è¡¨æ—¶ä¼šå‡ºç°å¼‚å¸¸ï¼Œå¢åŠ å¼‚å¸¸å¤„ç†ï¼Œå¦‚æœå‘ç”Ÿå¼‚å¸¸åˆ™è¾“å‡ºä¸ºâ€œæš‚æ—¶æ²¡æœ‰æŠ˜æ‰£â€ï¼Œæˆ–â€œè¯¦æƒ…è¯·æŸ¥é˜…æ¸¸æˆé“¾æ¥â€å³å¯ ä¿®æ”¹å‡½æ•°ä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526def parse(self, response): node_list = response.xpath(\"//*[@id='search_resultsRows']/a\") print(node_list) for node in node_list: item = SteamgamesItem() name = node.xpath(\"./div[2]/div[1]/span/text()\").extract() link = node.xpath(\"./@href\").extract() time = node.xpath(\"./div[2]/div[2]/text()\").extract() evaluate = node.xpath(\"./div[2]/div[3]/span/@data-tooltip-html\").extract() discount = node.xpath(\"./div[2]/div[4]/div[1]/span/text()\").extract() price = node.xpath('normalize-space(./div[2]/div[4]/div[2])').extract() item['name'] = name[0] item['link'] = link[0] try: item['time'] = time[0] except: item['time'] = 'See link for details' item['evaluate'] = evaluate[0] try: item['discount'] = discount[0] except: item['discount'] = 'No discount for now' item['price'] = price[0].strip() yield item 3.5.5 åˆ¶ä½œç®¡é“ç¨‹åºpipelines.pyçˆ¬è™«ä¸»ä½“å®Œæˆä¹‹åï¼Œéœ€è¦ç¼–å†™æ•°æ®å­˜å‚¨çš„ç®¡é“ç¨‹åºã€‚è¿™é‡Œä½¿ç”¨openæ–¹æ³•ï¼Œåˆ›å»ºä¸€ä¸ªä»¥jsonæ ¼å¼ä¿å­˜çš„steamgames.csvæ–‡ä»¶,æ²¡å®Œæˆä¸€ç»„æ•°æ®ä¸‹è½½ï¼Œè¿›è¡Œæ¢è¡Œ12345678910111213import jsonclass SteamgamesPipeline(object): def __init__(self): self.f=open('steamgames.csv','wb+') def process_item(self, item, spider): content=json.dumps(dict(item),ensure_ascii=False)+',\\n' self.f.write(content.encode(encoding='utf-8')) return item def close_spider(self,spider): self.f.close() è¾“å‡ºåå¾—åˆ°ç»“æœï¼Œä»”ç»†æŸ¥çœ‹æœ‰ä½ç½®é”™ä½ã€é•¿ç©ºæ ¼ç­‰æƒ…å†µï¼š å‘ç°é—®é¢˜çš„åŸå› ï¼šå› ä¸ºjsonæ•°æ®æ˜¯ä»¥â€œï¼Œâ€è¿›è¡Œåˆ†éš”çš„ï¼Œè€Œsteamå•†åŸä¸­çš„å¹´ä»½ã€ä»·æ ¼ã€äººæ•°ç­‰ä¿¡æ¯éƒ½æ˜¯ä»¥â€œï¼Œâ€åˆ†éš”åƒåˆ†ä½ï¼Œä»¥åŠæŠ˜æ‰£ä»·æ ¼çš„æ ‡ç­¾ä¸­å¸¦æœ‰æ¢è¡Œç¬¦ï¼Œæ‰€ä»¥ä¼šé€ æˆè¯¯å·®ã€‚ ä¸ºäº†å®ç°æ­£å¸¸çš„å­˜å‚¨å’Œæ ¼å¼çš„ç¾è§‚ï¼Œç»§ç»­å®Œå–„test.pyçˆ¬è™«ç¨‹åº å¯ä»¥é€šè¿‡xpath(â€˜normalize-space(./â€¦)â€™)æˆ–ä½¿ç”¨å­—ç¬¦ä¸²æ–¹æ³•strip()çš„æ–¹å¼å»é™¤æ–‡å­—ä¸­å¤šä½™çš„ç©ºæ ¼ ä½¿ç”¨åˆ—è¡¨æ¨å¯¼å¼å’Œå­—ç¬¦ä¸²æ–¹æ³•replace()ç»“åˆï¼Œå°†æ•°æ®ä¸­çš„â€œï¼Œâ€æ›¿æ¢æˆç©ºæ ¼æˆ–å…¶ä»–å­—ç¬¦ï¼š[i.replace(â€œ,â€,â€œâ€) for i in node.xpath(â€˜â€¦â€™).extract()] å®Œæ•´çš„test.pyæ–‡ä»¶å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536import scrapyfrom steamgames.items import SteamgamesItemclass TestSpider(scrapy.Spider): name = 'test' allowed_domains = ['store.steampowered.com'] start_urls = ['https://store.steampowered.com/search/?filter=globaltopsellers&amp;os=win'] def parse(self, response): node_list = response.xpath(\"//*[@id='search_resultsRows']/a\") print(node_list) for node in node_list: item = SteamgamesItem() name = node.xpath(\"./div[2]/div[1]/span/text()\").extract() link = node.xpath(\"./@href\").extract() time = [i.replace(\",\",\" \") for i in node.xpath(\"./div[2]/div[2]/text()\").extract()] evaluate = [j.replace(\",\",\" \") for j in [i.replace(\"&lt;br&gt;\",\",\") for i in node.xpath(\"./div[2]/div[3]/span/@data-tooltip-html\").extract()]] discount = node.xpath(\"./div[2]/div[4]/div[1]/span/text()\").extract() price = [i.replace(\",\",\"\") for i in node.xpath('normalize-space(./div[2]/div[4]/div[2])').extract()] item['name'] = name[0] item['link'] = link[0] try: item['time'] = time[0] except: item['time'] = 'See link for details' item['evaluate'] = evaluate[0] try: item['discount'] = discount[0] except: item['discount'] = 'No discount for now' item['price'] = price[0].strip() yield item 4.ç»“æœå®Œæˆscrapyçˆ¬è™«åï¼Œæ‰§è¡Œscrapy crawl testæœ€ç»ˆå¾—åˆ°ä¸€ä¸ª.csvæ ¼å¼çš„è¾“å‡ºç»“æœï¼š è‡³æ­¤ï¼Œscrapyæ¡†æ¶ä¸‹çš„çˆ¬è™«ç¨‹åºå®Œæˆï¼Œå·²è·å–åˆ°åˆæ­¥çš„æ¸¸æˆèµ„è®¯ï¼Œå¯ä»¥æ®æ­¤å¯¹å…¶è¿›è¡Œè¿›ä¸€æ­¥çš„æ•°æ®æ¸…æ´—å’Œåˆ†æ 4.1 pandasæ•°æ®æ¸…æ´—å°†æ–‡ä»¶é‡æ–°è¾“å‡ºä¸€ä»½jsonæ ¼å¼çš„steamgames.jsonæ–‡ä»¶ï¼Œåœ¨steamgameså½“å‰ç›®å½•ä¸‹æ–°å»ºpd_steamgames.pyæ–‡ä»¶å‡†å¤‡ç”¨äºæ•°æ®çš„å¤„ç†1234import pandas as pddf = pd.read_json('steamgames.json',encoding='utf-8')print(df.to_string()) è¾“å‡ºåå¾—åˆ°ä¸€ä¸ªpandas DataFrameç±»å‹çš„ç»“æœ: è¿™é‡Œåˆ¶å®šä¸€ä¸ªæ¸…æ´—ç›®æ ‡ï¼šä»…ç­›é€‰å‡ºæ‰“æŠ˜çš„çƒ­é”€æ¸¸æˆ12345import pandas as pddf = pd.read_json('steamgames.json',encoding='utf-8')df = df[df['discount']!='No discount for now']print(df.to_string()) è¿›è€Œå¯¹æ•°æ®è¿›è¡Œåˆ†æï¼Œæ‹Ÿæ‰¾åˆ°æŠ˜æ‰£ä¸å¥½è¯„ç‡å¯¹åº”å…³ç³»ï¼Œç ”ç©¶æŠ˜æ‰£æ˜¯å¦ä¼šå¯¹è¯„ä»·é€ æˆå½±å“ã€‚è¿™é‡Œä¸¢å¼ƒæ‰é™¤è¯„ä»·å’ŒæŠ˜æ‰£å¤–çš„å…¶ä»–æ•°æ®è¡Œ1df = df[df['discount']!='No discount for now'].drop(['name','link','time','price'],axis=1) åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¸…æ´—æ‰è¯„ä»·æ•°æ®ä¸­çš„äººæ•°å’Œå­—ç¬¦ä¸²ç­‰ä¿¡æ¯ï¼ŒåŒæ—¶ç»™æ•°æ®æ¸…é™¤åŸå§‹çš„ç´¢å¼•ï¼š123for i in df.columns: df[i] = df[i].str.extract('(\\d+%?)')print(df.to_string(index=False)) 4.2 æ•°æ®åˆ†æå¯è§†åŒ–å®Œæˆæ•°æ®çš„æ¸…æ´—åï¼Œå¯¼å…¥matpoltlibåº“ï¼Œå¯¹æ•°æ®è¿›è¡Œå¯è§†åŒ–å±•ç¤ºï¼Œå®Œæ•´çš„pd_steamgames.pyæ–‡ä»¶ä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617import pandas as pdimport matplotlib.pyplot as pltdf = pd.read_json('steamgames.json',encoding='utf-8')df = df[df['discount']!='No discount for now'].drop(['name','link','time','price'],axis=1)for i in df.columns: df[i] = df[i].str.extract('(\\d+)')df=df.astype(float)df.plot()my_y_ticks = [20,40,60,80,100]plt.yticks(my_y_ticks)plt.xlabel('Number of games')plt.ylabel('favorable rate(%)')plt.title('evaluate &amp; discount')plt.show() è‡³æ­¤ï¼Œä¸éš¾å¾—å‡ºä¸¤è€…ä¹‹é—´å¹¶æ²¡æœ‰ä¸¥é‡çš„çº¿æ€§ä¾èµ–å…³ç³»ã€‚æœ‰çš„æ¸¸æˆæŠ˜æ‰£å¾ˆé«˜ï¼Œå¥½è¯„ç‡ä¹Ÿä¸€ç›´å¾ˆé«˜ï¼Œæœ‰çš„æ¸¸æˆç»™å‡ºå¾ˆå°‘æŠ˜æ‰£ï¼Œå¥½è¯„ç‡å´ä¾ç„¶å¤„äºä¸­é«˜æ°´å¹³ã€‚å½“ç„¶è¿™å’Œæœ¬æ¬¡ä½¿ç”¨çš„æ•°æ®ä¸ºå…¨çƒçƒ­é”€æ¸¸æˆä¹Ÿæœ‰ä¸€å®šå…³ç³»ï¼Œæ•°æ®é‡ä¹Ÿè¾ƒä¸ºæœ‰é™ã€‚æ—¶é—´å…³ç³»è¿™äº›éƒ½æ˜¯ä¹‹åå°†è§£å†³çš„é—®é¢˜ï¼Œç»§ç»­å°è¯•å¤šæŒ–æ˜æ•°æ®ï¼Œå†å¤šå¤šå»åšæ•°æ®åˆ†æ","categories":[{"name":"Python","slug":"Python","permalink":"http://yoursite.com/categories/Python/"}],"tags":[{"name":"scrapy","slug":"scrapy","permalink":"http://yoursite.com/tags/scrapy/"}]},{"title":"Pythonçˆ¬è™«ï¼šè¯†åˆ«ç½‘é¡µçš„éªŒè¯ç ï¼ˆtesseract-OCRï¼‰","slug":"Pythonçˆ¬è™«ï¼šè¯†åˆ«ç½‘é¡µçš„éªŒè¯ç ï¼ˆtesseract-OCRï¼‰","date":"2022-04-29T07:00:29.000Z","updated":"2022-06-27T07:39:04.522Z","comments":true,"path":"2022/04/29/Pythonçˆ¬è™«ï¼šè¯†åˆ«ç½‘é¡µçš„éªŒè¯ç ï¼ˆtesseract-OCRï¼‰/","link":"","permalink":"http://yoursite.com/2022/04/29/Pythonçˆ¬è™«ï¼šè¯†åˆ«ç½‘é¡µçš„éªŒè¯ç ï¼ˆtesseract-OCRï¼‰/","excerpt":"åœ¨å®é™…çš„çˆ¬è™«æ“ä½œä¸­ï¼Œå¤„äºå®‰å…¨ç­‰åŸå› ç½‘ç«™ä¼šè®¾ç½®éå¸¸å¤šçš„åçˆ¬è™«æ‰‹æ®µæ¥é™åˆ¶ç½‘ç»œçˆ¬è™«ï¼Œæœ€å¸¸è§çš„æ¯”å¦‚è®¾ç½®å›¾å½¢éªŒè¯ç ï¼Œæ¥è¯†åˆ«è®¿å®¢æ˜¯å¦ä¸ºæœºå™¨äºº ä½†æ˜¯ç”±äºpythonæ‹¥æœ‰è®¸å¤šå¼ºå¤§çš„å›¾åƒè¯†åˆ«åº“ï¼Œæ‰€ä»¥æœ€ç®€å•ä¹Ÿæ˜¯æœ€åŸå§‹çš„å›¾å½¢éªŒè¯ç ç›®å‰å·²ç»æ…¢æ…¢æ²¡è½äº†ï¼Œæˆ‘æ‰¾äº†å¾ˆä¹…å‘ç°ä¸­å›½çŸ¥ç½‘çš„æ³¨å†Œç•Œé¢ç›®å‰å±…ç„¶è¿˜åœ¨ä½¿ç”¨ä¸­~ ^ ^ è·å–ç½‘é¡µéªŒè¯ç é¦–å…ˆæ˜¯è·å–éªŒè¯ç å›¾ç‰‡çš„ç›®æ ‡é“¾æ¥ï¼Œæˆ‘ä½¿ç”¨xpathæ‰¾åˆ°htmlæ ‡ç­¾ä¸­éªŒè¯ç çš„srcé“¾æ¥ï¼Œè¯»å–å†…å®¹åå‘ç°å¹¶ä¸èƒ½å¾—åˆ°ç”ŸæˆéªŒè¯ç çš„å¯¹åº”idï¼Œä»¥ä¸ºæ˜¯çŸ¥ç½‘åšäº†å¯¹çˆ¬è™«å¤´çš„é™åˆ¶ï¼Œäºæ˜¯åœ¨headersé‡Œæ·»åŠ äº†â€œRefererâ€å’Œâ€œAccept-Encodingâ€ç­‰ä¿¡æ¯ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ•ˆæœã€‚æŠ“åŒ…åœ¨Docä¸­å‘ç°ç½‘é¡µHTTPè¯·æ±‚çš„æ–¹æ³•ä¸ºâ€GETâ€œæ–¹æ³•ï¼Œå°è¯•ä¸åŠ idä¹Ÿå¾—åˆ°äº†éªŒè¯ç å›¾ç‰‡ 12345678910111213141516171819202122232425262728import requestsfrom lxml import etreeheaders = &#123; \"method\": \"GET\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\", \"Accept-Encoding\": \"gzip, deflate, br\", \"Cache-Control\": \"max-age=0\", \"scheme\": \"https\", \"accept-language\": \"zh-CN,zh;q=0.9\", \"Cookie\": \"U:M_distinctid=1809edfcf6e8ff-088ab0a6edb385-17333273-1fa400-1809edfcf6f9fe; _pk_ref=[\"\",\"\",1651932918,'https://www.baidu.com/link?url=PnlS4wubLFxXVNXrTBRCZMAhA0P5TZLlCBAhBvXfLke&amp;wd=&amp;eqid=e52482a8001102070000000562767ee2']; Ecp_ClientId=1220507221503170167; Ecp_IpLoginFail=22050736.161.51.128; Ecp_ClientIp=36.161.51.128; language=chs; _pk_id=2ce0e7fb-229f-4440-a78b-57771deac2fe.1651932918.1.1651933578.1651932918.; ASP.NET_SessionId=he1no3kmgo3bwuktv1xa1lhs; SID_mycnki=020101\", \"user-agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36\", \"Referer\": \"https://www.cnki.net/\" \"Sec-Fetch-Dest:\" 'document', \"Sec-Fetch-Mode\": 'navigate', \"Sec-Fetch-Site\": 'same-origin', \"Sec-Fetch-User\": '?1', \"Upgrade-Insecure-Requests\": '1'&#125;url = \"https://my.cnki.net/Register/CommonRegister.aspx?returnUrl=https://www.cnki.net#\"r = requests.get(url, headers=headers).content.decode('utf-8')html = etree.HTML(r)link=html.xpath('//*[@id=\"commonRe\"]/div[10]/div[3]/a/img/@src')[0]img_url = \"https://my.cnki.net/Register/\" + linkimg = requests.get(img_url, headers=headers,stream=True)with open('checkcode.jpg','wb')as file: file.write(img.raw.read())","text":"åœ¨å®é™…çš„çˆ¬è™«æ“ä½œä¸­ï¼Œå¤„äºå®‰å…¨ç­‰åŸå› ç½‘ç«™ä¼šè®¾ç½®éå¸¸å¤šçš„åçˆ¬è™«æ‰‹æ®µæ¥é™åˆ¶ç½‘ç»œçˆ¬è™«ï¼Œæœ€å¸¸è§çš„æ¯”å¦‚è®¾ç½®å›¾å½¢éªŒè¯ç ï¼Œæ¥è¯†åˆ«è®¿å®¢æ˜¯å¦ä¸ºæœºå™¨äºº ä½†æ˜¯ç”±äºpythonæ‹¥æœ‰è®¸å¤šå¼ºå¤§çš„å›¾åƒè¯†åˆ«åº“ï¼Œæ‰€ä»¥æœ€ç®€å•ä¹Ÿæ˜¯æœ€åŸå§‹çš„å›¾å½¢éªŒè¯ç ç›®å‰å·²ç»æ…¢æ…¢æ²¡è½äº†ï¼Œæˆ‘æ‰¾äº†å¾ˆä¹…å‘ç°ä¸­å›½çŸ¥ç½‘çš„æ³¨å†Œç•Œé¢ç›®å‰å±…ç„¶è¿˜åœ¨ä½¿ç”¨ä¸­~ ^ ^ è·å–ç½‘é¡µéªŒè¯ç é¦–å…ˆæ˜¯è·å–éªŒè¯ç å›¾ç‰‡çš„ç›®æ ‡é“¾æ¥ï¼Œæˆ‘ä½¿ç”¨xpathæ‰¾åˆ°htmlæ ‡ç­¾ä¸­éªŒè¯ç çš„srcé“¾æ¥ï¼Œè¯»å–å†…å®¹åå‘ç°å¹¶ä¸èƒ½å¾—åˆ°ç”ŸæˆéªŒè¯ç çš„å¯¹åº”idï¼Œä»¥ä¸ºæ˜¯çŸ¥ç½‘åšäº†å¯¹çˆ¬è™«å¤´çš„é™åˆ¶ï¼Œäºæ˜¯åœ¨headersé‡Œæ·»åŠ äº†â€œRefererâ€å’Œâ€œAccept-Encodingâ€ç­‰ä¿¡æ¯ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ•ˆæœã€‚æŠ“åŒ…åœ¨Docä¸­å‘ç°ç½‘é¡µHTTPè¯·æ±‚çš„æ–¹æ³•ä¸ºâ€GETâ€œæ–¹æ³•ï¼Œå°è¯•ä¸åŠ idä¹Ÿå¾—åˆ°äº†éªŒè¯ç å›¾ç‰‡ 12345678910111213141516171819202122232425262728import requestsfrom lxml import etreeheaders = &#123; \"method\": \"GET\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\", \"Accept-Encoding\": \"gzip, deflate, br\", \"Cache-Control\": \"max-age=0\", \"scheme\": \"https\", \"accept-language\": \"zh-CN,zh;q=0.9\", \"Cookie\": \"U:M_distinctid=1809edfcf6e8ff-088ab0a6edb385-17333273-1fa400-1809edfcf6f9fe; _pk_ref=[\"\",\"\",1651932918,'https://www.baidu.com/link?url=PnlS4wubLFxXVNXrTBRCZMAhA0P5TZLlCBAhBvXfLke&amp;wd=&amp;eqid=e52482a8001102070000000562767ee2']; Ecp_ClientId=1220507221503170167; Ecp_IpLoginFail=22050736.161.51.128; Ecp_ClientIp=36.161.51.128; language=chs; _pk_id=2ce0e7fb-229f-4440-a78b-57771deac2fe.1651932918.1.1651933578.1651932918.; ASP.NET_SessionId=he1no3kmgo3bwuktv1xa1lhs; SID_mycnki=020101\", \"user-agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36\", \"Referer\": \"https://www.cnki.net/\" \"Sec-Fetch-Dest:\" 'document', \"Sec-Fetch-Mode\": 'navigate', \"Sec-Fetch-Site\": 'same-origin', \"Sec-Fetch-User\": '?1', \"Upgrade-Insecure-Requests\": '1'&#125;url = \"https://my.cnki.net/Register/CommonRegister.aspx?returnUrl=https://www.cnki.net#\"r = requests.get(url, headers=headers).content.decode('utf-8')html = etree.HTML(r)link=html.xpath('//*[@id=\"commonRe\"]/div[10]/div[3]/a/img/@src')[0]img_url = \"https://my.cnki.net/Register/\" + linkimg = requests.get(img_url, headers=headers,stream=True)with open('checkcode.jpg','wb')as file: file.write(img.raw.read()) Tesserocråº“Tesserocræ˜¯pythonçš„ä¸€ä¸ªOCRè¯†åˆ«åº“ï¼Œæ˜¯é€šè¿‡å¯¹tesseractåº“åšAPIå°è£…æ¥å®ç°åŠŸèƒ½ï¼Œæ ¸å¿ƒä»æ˜¯tesseractã€‚æ‰€ä»¥éœ€æå‰å®‰è£…tesseractåº“æ¥è¿›è¡Œæ”¯æŒ å®‰è£…Tesseractè¿›å…¥å®˜ç½‘é“¾æ¥https://digi.bib.uni-mannheim.de/tesseract/ï¼Œæ‰¾åˆ°å½“å‰åˆé€‚çš„ç‰ˆæœ¬ï¼Œä¸‹è½½å®‰è£…ç¨‹åº å®‰è£…è¿‡ç¨‹ä¸­å¯ä»¥å‹¾é€‰å®‰è£…é¢å¤–çš„è¯­è¨€æ–‡ä»¶ï¼Œæ·»åŠ å¯¹åŒ…æ‹¬ä¸­æ–‡ç­‰å¤šè¯­ç§çš„æ”¯æŒ å®‰è£…å®Œæˆåå»ç³»ç»Ÿè®¾ç½®ä¸­æ·»åŠ ç¯å¢ƒå˜é‡ æ–°å¢ä¸€ä¸ªå˜é‡TESSDATA_PREFIX æ‰“å¼€CMDï¼Œè¾“å…¥tesseract -vï¼Œæ­¤æ—¶å‡ºç°ç‰ˆæœ¬ä¿¡æ¯ï¼Œtesseractå·²ç»å®‰è£…å®Œæˆäº† å¦‚æœæ·»åŠ åæ§åˆ¶å°ä»æç¤ºâ€tesseractä¸æ˜¯å†…éƒ¨æˆ–è€…å¤–éƒ¨å‘½ä»¤â€ï¼Œç»§ç»­åˆ°ç³»ç»Ÿå˜é‡çš„pathä¸­æ·»åŠ â€œ%SystemRoot%\\system32;%SystemRoot%;%SystemRoot%\\System32\\Wbemâ€œå³å¯ å®‰è£…Tesserocrå®‰è£…å®ŒTesseractåï¼Œç»§ç»­å®‰è£…pythonçš„OCRè¯†åˆ«åº“,æ‰“å¼€CMDæˆ–Pycharm12pip install Pillowpip install pytesseract å®Œæˆåæ‰¾åˆ°pytesseractæ–‡ä»¶ï¼Œå°†tesseract.exeç¨‹åºçš„è·¯å¾„æ·»åŠ è¿›å»ï¼ˆæ³¨ï¼šä¸åŒç‰ˆæœ¬è·¯å¾„ä»£ç åœ¨ç¨‹åºä¸­çš„ä½ç½®ä¸ä¸€å®šç›¸åŒï¼‰ æœ€åå†æ‰§è¡Œå®‰è£…tesserocr 1pip install tesserocr å¦‚æœæŠ¥é”™ï¼Œè¿›å…¥tesserocråœ¨githubçš„å®˜ç½‘https://github.com/simonflueckiger/tesserocr-windows_build/releasesï¼Œä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„whlæ–‡ä»¶è¿›è¡Œæ‰‹åŠ¨å®‰è£… è¿›å…¥å¯¹åº”è·¯å¾„ï¼Œæ¥åˆ°æ§åˆ¶å°æ‰§è¡Œpip install tesserocr-2.5.2-cp37-cp37m-win_amd64.whl æœ€åæ˜¾ç¤ºtesserocrå®‰è£…æˆåŠŸ å›¾åƒå¤„ç†ç°åº¦å›¾ä½¿ç”¨Imageçš„openæ–¹æ³•å°†ä¸‹è½½çš„checkcode.jpgæ‰“å¼€ï¼Œå¾—åˆ°ä¸€ä¸ªPIL.Image.Imageå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡convertæ–¹æ³•æ¥å°†RGBå½©è‰²å›¾ç‰‡è½¬æ¢ä¸ºç°åº¦å›¾1234567from PIL import Imageimport tesserocrimg = Image.open(\"checkcode.jpg\")img.show()img_grey = img.convert(\"L\")img_grey.show() å¾—åˆ°åŸå§‹å›¾ç‰‡å’Œç°åº¦å›¾åƒï¼Œä½¿ç”¨tesserocråº“è¿›è¡Œè¯†åˆ«ï¼Œç”±äºå›¾åƒçš„å¹²ç»•å› ç´ å’Œå™ªç‚¹è¿˜æ¯”è¾ƒå¤šï¼Œç›®å‰è¿˜ä¸èƒ½è¯†åˆ«å‡ºå‡†ç¡®ç»“æœ123456789101112from PIL import Imageimport tesserocrimg = Image.open(\"checkcode.jpg\")img.show()img_grey = img.convert(\"L\")img_grey.show()img_grey.save('checkcode_grey.jpg')checkcode = tesserocr.image_to_text(img)checkcode_grey = tesserocr.image_to_text(img_grey)print(f\"checkcode:&#123;checkcode&#125;\")print(f\"checkcode_grey:&#123;checkcode_grey&#125;\") äºŒå€¼åŒ–ç°åº¦ä»å¾—åˆ°çš„ç°åº¦å›¾ç»“æœæ¥çœ‹ï¼Œéœ€è¦è¯†åˆ«çš„æ•°å­—å’Œå­—æ¯ï¼ˆä¸»ä½“éƒ¨åˆ†ï¼‰æ˜æ˜¾è¦æ¯”å¹²ç»•éƒ¨åˆ†æ¸…æ™°çš„ï¼Œç°åº¦ä¹Ÿæ›´é‡ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥å¯å¯¹ç°åº¦å›¾è¿›è¡ŒäºŒå€¼åŒ–ï¼Œå³è®¾å®šä¸€ä¸ªé˜ˆå€¼ï¼Œæ¯ä¸ªåƒç´ çš„ç°åº¦å°†ä¾ç…§å’Œé˜ˆå€¼çš„å…³ç³»ä¿®æ”¹ä¸ºé»‘è‰²æˆ–ç™½è‰²ï¼Œè¿™æ ·å°±å¯ä»¥å¾ˆå¥½çš„å‡¸æ˜¾å‡ºä¸»ä½“éƒ¨åˆ†123456789101112131415from PIL import Imagedef bin_table(threshold=125): table = [] for i in range(256): if i &lt; threshold: table.append(0) else: table.append(1) return tableimg = Image.open('checkcode_grey.jpg')table = bin_table()bin = img.point(table, '1')bin.save('checkcode_bin.jpg') æ­¤æ—¶å†å¯¹å›¾åƒè¿›è¡Œè¯†åˆ«ï¼Œå¾—åˆ°çš„ç»“æœä¸ºâ€g4YSâ€,å·²ç»å¾ˆæ¥è¿‘äº†ï¼Œä½†æ˜¯é—®é¢˜å‡ºåœ¨å“ªé‡Œå‘¢ï¼Ÿ å°†å›¾åƒæ”¾å¤§ï¼š å¯ä»¥å‘ç°å›¾åƒä¸­è¿˜è¦å¾ˆå¤šå™ªç‚¹ å›¾åƒé™å™ªpyä¸­é™å™ªçš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œåƒæ¤’ç›é™å™ªã€é«˜æ–¯é™å™ªã€å‡å€¼æ»¤æ³¢é™å™ªç­‰ï¼Œéœ€è¦æ‰¾åˆ°åˆé€‚çš„é™å™ªæ–¹æ³•ã€‚è¿™é‡Œæ ¹æ®å›¾ç‰‡ï¼Œä½¿ç”¨8é‚»åŸŸé™å™ªçš„æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253from PIL import Imagedef sum_9_region_new(img, x, y): '''ç¡®å®šå™ªç‚¹ ''' cur_pixel = img.getpixel((x, y)) # å½“å‰åƒç´ ç‚¹çš„å€¼ width = img.width height = img.height if cur_pixel == 1: # å¦‚æœå½“å‰ç‚¹ä¸ºç™½è‰²åŒºåŸŸ,åˆ™ä¸ç»Ÿè®¡é‚»åŸŸå€¼ return 0 # å› å½“å‰å›¾ç‰‡çš„å››å‘¨éƒ½æœ‰é»‘ç‚¹ï¼Œæ‰€ä»¥å‘¨å›´çš„é»‘ç‚¹å¯ä»¥å»é™¤ if y &lt; 3: # æœ¬ä¾‹ä¸­ï¼Œå‰ä¸¤è¡Œçš„é»‘ç‚¹éƒ½å¯ä»¥å»é™¤ return 1 elif y &gt; height - 3: # æœ€ä¸‹é¢ä¸¤è¡Œ return 1 else: # yä¸åœ¨è¾¹ç•Œ if x &lt; 3: # å‰ä¸¤åˆ— return 1 elif x == width - 1: # å³è¾¹éé¡¶ç‚¹ return 1 else: # å…·å¤‡9é¢†åŸŸæ¡ä»¶çš„ sum = img.getpixel((x - 1, y - 1)) \\ + img.getpixel((x - 1, y)) \\ + img.getpixel((x - 1, y + 1)) \\ + img.getpixel((x, y - 1)) \\ + cur_pixel \\ + img.getpixel((x, y + 1)) \\ + img.getpixel((x + 1, y - 1)) \\ + img.getpixel((x + 1, y)) \\ + img.getpixel((x + 1, y + 1)) return 9 - sumdef collect_noise_point(img): '''æ”¶é›†æ‰€æœ‰çš„å™ªç‚¹''' noise_point_list = [] for x in range(img.width): for y in range(img.height): res_9 = sum_9_region_new(img, x, y) if (0 &lt; res_9 &lt; 3) and img.getpixel((x, y)) == 0: # æ‰¾åˆ°å­¤ç«‹ç‚¹ pos = (x, y) noise_point_list.append(pos) return noise_point_listdef remove_noise_pixel(img, noise_point_list): '''æ ¹æ®å™ªç‚¹çš„ä½ç½®ä¿¡æ¯ï¼Œæ¶ˆé™¤äºŒå€¼å›¾ç‰‡çš„é»‘ç‚¹å™ªå£°''' for item in noise_point_list: img.putpixel((item[0], item[1]), 1)bin = Image.open('checkcode_bin.jpg')noise_point_list = collect_noise_point(bin)remove_noise_pixel(bin, noise_point_list)bin.save('checkcode_fin.jpg') ä¸è¿‡è¿è¡Œå®Œæˆåä»»ç„¶å¸¦å™ªç‚¹ï¼Œæˆ‘æ‰ååº”è¿‡æ¥æ˜¯ä¿å­˜çš„.jpgæ ¼å¼å¯¹å›¾åƒè¿›è¡Œäº†å‹ç¼©é€ æˆçš„ï¼Œä¸è¿‡æ•´ä½“æ€è·¯æ²¡æœ‰é—®é¢˜ã€‚å°†ä»£ç æ•´åˆåˆ°ä¸€èµ·ï¼Œå†ä¿å­˜ä¸º.pngæ ¼å¼ï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970from PIL import Imagedef sum_9_region_new(img, x, y): '''ç¡®å®šå™ªç‚¹ ''' cur_pixel = img.getpixel((x, y)) # å½“å‰åƒç´ ç‚¹çš„å€¼ width = img.width height = img.height if cur_pixel == 1: # å¦‚æœå½“å‰ç‚¹ä¸ºç™½è‰²åŒºåŸŸ,åˆ™ä¸ç»Ÿè®¡é‚»åŸŸå€¼ return 0 # å› å½“å‰å›¾ç‰‡çš„å››å‘¨éƒ½æœ‰é»‘ç‚¹ï¼Œæ‰€ä»¥å‘¨å›´çš„é»‘ç‚¹å¯ä»¥å»é™¤ if y &lt; 3: # æœ¬ä¾‹ä¸­ï¼Œå‰ä¸¤è¡Œçš„é»‘ç‚¹éƒ½å¯ä»¥å»é™¤ return 1 elif y &gt; height - 3: # æœ€ä¸‹é¢ä¸¤è¡Œ return 1 else: # yä¸åœ¨è¾¹ç•Œ if x &lt; 3: # å‰ä¸¤åˆ— return 1 elif x == width - 1: # å³è¾¹éé¡¶ç‚¹ return 1 else: # å…·å¤‡9é¢†åŸŸæ¡ä»¶çš„ sum = img.getpixel((x - 1, y - 1)) \\ + img.getpixel((x - 1, y)) \\ + img.getpixel((x - 1, y + 1)) \\ + img.getpixel((x, y - 1)) \\ + cur_pixel \\ + img.getpixel((x, y + 1)) \\ + img.getpixel((x + 1, y - 1)) \\ + img.getpixel((x + 1, y)) \\ + img.getpixel((x + 1, y + 1)) return 9 - sumdef collect_noise_point(img): '''æ”¶é›†æ‰€æœ‰çš„å™ªç‚¹''' noise_point_list = [] for x in range(img.width): for y in range(img.height): res_9 = sum_9_region_new(img, x, y) if (0 &lt; res_9 &lt; 3) and img.getpixel((x, y)) == 0: # æ‰¾åˆ°å­¤ç«‹ç‚¹ pos = (x, y) noise_point_list.append(pos) return noise_point_listdef remove_noise_pixel(img, noise_point_list): '''æ ¹æ®å™ªç‚¹çš„ä½ç½®ä¿¡æ¯ï¼Œæ¶ˆé™¤äºŒå€¼å›¾ç‰‡çš„é»‘ç‚¹å™ªå£°''' for item in noise_point_list: img.putpixel((item[0], item[1]), 1)def bin_table(threshold=125): '''è·å–ç°åº¦è½¬äºŒå€¼çš„æ˜ å°„table,0è¡¨ç¤ºé»‘è‰²,1è¡¨ç¤ºç™½è‰²''' table = [] for i in range(256): if i &lt; threshold: table.append(0) else: table.append(1) return tabledef main(): img = Image.open('checkcode.jpg') img_grey = img.convert('L') table = bin_table() bin = img_grey.point(table, '1') noise_point_list = collect_noise_point(bin) remove_noise_pixel(bin, noise_point_list) bin.save('checkcode_fin.png')if __name__ == '__main__': main() æ”¾å¤§ä»¥åæ²¡æœ‰å¹²æ‰°ï¼š ç»“æœ1234567import pytesseractfrom PIL import Imageim = Image.open('checkcode_bin.png')string = pytesseract.image_to_string(im)print(string)","categories":[{"name":"Python","slug":"Python","permalink":"http://yoursite.com/categories/Python/"}],"tags":[{"name":"OCR","slug":"OCR","permalink":"http://yoursite.com/tags/OCR/"}]},{"title":"Numpy & Pandas","slug":"Numpy-Pandas","date":"2022-03-01T05:13:22.000Z","updated":"2022-06-27T07:35:40.856Z","comments":true,"path":"2022/03/01/Numpy-Pandas/","link":"","permalink":"http://yoursite.com/2022/03/01/Numpy-Pandas/","excerpt":"æœ¬æ–‡ä¸»è¦è®°å½•ä¸€äº›Numpyå’ŒPandasçš„æ–¹æ³• Numpy1.æƒ¯ç”¨å†™æ³•ï¼š1import numpy as np 2.ä»åˆ—è¡¨ç”Ÿæˆä¸€ä¸ªçŸ©é˜µï¼š123import numpy as npprint(np.array([[0,1,2,3,4,5],[6,7,8,9,10,11]])) 3.åˆ›å»ºå…¨0æˆ–å…¨1çŸ©é˜µï¼š1234import numpy as npprint(np.zeros((3,4)))print(np.ones((5,5))) 4.é€šè¿‡.shapeå¾—åˆ°å½“å‰çŸ©é˜µçš„å°ºå¯¸ï¼Œé€šè¿‡.reshape()å°†å½“å‰çŸ©é˜µè½¬ç½®12345import numpy as npprint(np.zeros((3,4)))print(np.zeros((3,4)).shape)print(np.zeros((3,4)).reshape(4,3)) 5.ä½¿ç”¨arange()åˆ›å»ºé€’å¢/é€’å‡çš„æ•°åˆ—123import numpy as npprint(np.arange(1,10)) 6.ä½¿ç”¨linspace()è·å–ä¸€ä¸ªç­‰åˆ†çš„åŒºé—´åºåˆ—ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¾“å‡ºæ ·æœ¬çš„æ€»æ•°123import numpy as npprint(np.linspace(1,100,10)) 7.é€šè¿‡random.rand()ç”Ÿæˆéšæœºæ•°ç»„123import numpy as npprint(np.random.rand(3,4)) 8.Numpyä¸­é»˜è®¤çš„æ•°æ®ç±»å‹ä¸º64ä½æµ®ç‚¹æ•°ï¼Œå¯ä»¥åœ¨åˆ›å»ºæ•°ç»„æ—¶ä½¿ç”¨dtypeå‚æ•°æŒ‡å®šå…¶ä»–çš„æ•°æ®ç±»å‹123import numpy as npprint(np.ones((3,4),dtype=np.float32)) 9.å¯¹å…ˆæœ‰çš„æ•°ç»„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨astype()æ¥æ›´æ”¹æ•°æ®ç±»å‹123456import numpy as nparray0=np.ones((3,4),dtype=np.float32)array1=array0.astype(int)print(array0,array1) 10.Numpyæ•°ç»„å¯ä»¥ç›´æ¥ä¸ä¸€ä¸ªæ•°è¿›è¡Œè¿ç®—ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¹‹ä¸ºå¹¿æ’­ï¼›ä¸¤ä¸ªä¸åŒå°ºå¯¸çš„æ•°ç»„ä¹Ÿå¯ä»¥ç›´æ¥è¿›è¡Œè¿ç®—ï¼Œè¿™æœŸé—´numpyä¼šè‡ªåŠ¨å°†ä¸¤ä¸ªæ•°ç»„æ‰©å±•åˆ°ç›¸åŒçš„å°ºå¯¸12345678910import numpy as nparray0=np.array([1,2,3])array1=np.array([4,5,6])array2=np.array([[7], [8], [9]])print(array0*10)print(array1+array2)","text":"æœ¬æ–‡ä¸»è¦è®°å½•ä¸€äº›Numpyå’ŒPandasçš„æ–¹æ³• Numpy1.æƒ¯ç”¨å†™æ³•ï¼š1import numpy as np 2.ä»åˆ—è¡¨ç”Ÿæˆä¸€ä¸ªçŸ©é˜µï¼š123import numpy as npprint(np.array([[0,1,2,3,4,5],[6,7,8,9,10,11]])) 3.åˆ›å»ºå…¨0æˆ–å…¨1çŸ©é˜µï¼š1234import numpy as npprint(np.zeros((3,4)))print(np.ones((5,5))) 4.é€šè¿‡.shapeå¾—åˆ°å½“å‰çŸ©é˜µçš„å°ºå¯¸ï¼Œé€šè¿‡.reshape()å°†å½“å‰çŸ©é˜µè½¬ç½®12345import numpy as npprint(np.zeros((3,4)))print(np.zeros((3,4)).shape)print(np.zeros((3,4)).reshape(4,3)) 5.ä½¿ç”¨arange()åˆ›å»ºé€’å¢/é€’å‡çš„æ•°åˆ—123import numpy as npprint(np.arange(1,10)) 6.ä½¿ç”¨linspace()è·å–ä¸€ä¸ªç­‰åˆ†çš„åŒºé—´åºåˆ—ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¾“å‡ºæ ·æœ¬çš„æ€»æ•°123import numpy as npprint(np.linspace(1,100,10)) 7.é€šè¿‡random.rand()ç”Ÿæˆéšæœºæ•°ç»„123import numpy as npprint(np.random.rand(3,4)) 8.Numpyä¸­é»˜è®¤çš„æ•°æ®ç±»å‹ä¸º64ä½æµ®ç‚¹æ•°ï¼Œå¯ä»¥åœ¨åˆ›å»ºæ•°ç»„æ—¶ä½¿ç”¨dtypeå‚æ•°æŒ‡å®šå…¶ä»–çš„æ•°æ®ç±»å‹123import numpy as npprint(np.ones((3,4),dtype=np.float32)) 9.å¯¹å…ˆæœ‰çš„æ•°ç»„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨astype()æ¥æ›´æ”¹æ•°æ®ç±»å‹123456import numpy as nparray0=np.ones((3,4),dtype=np.float32)array1=array0.astype(int)print(array0,array1) 10.Numpyæ•°ç»„å¯ä»¥ç›´æ¥ä¸ä¸€ä¸ªæ•°è¿›è¡Œè¿ç®—ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¹‹ä¸ºå¹¿æ’­ï¼›ä¸¤ä¸ªä¸åŒå°ºå¯¸çš„æ•°ç»„ä¹Ÿå¯ä»¥ç›´æ¥è¿›è¡Œè¿ç®—ï¼Œè¿™æœŸé—´numpyä¼šè‡ªåŠ¨å°†ä¸¤ä¸ªæ•°ç»„æ‰©å±•åˆ°ç›¸åŒçš„å°ºå¯¸12345678910import numpy as nparray0=np.array([1,2,3])array1=np.array([4,5,6])array2=np.array([[7], [8], [9]])print(array0*10)print(array1+array2) 11.Numpyä¸­ä¸¤ä¸ªç›¸åŒå°ºå¯¸çš„æ•°ç»„å¯ä»¥ç›´æ¥è¿›è¡Œå››åˆ™è¿ç®—123456789import numpy as nparray0=np.array([1,2,3])array1=np.array([4,5,6])array2=np.array([7,8,9])print(array0+array1)print(array0*array2)print(array2/array0) 12.ä½¿ç”¨np.dot()å‡½æ•°æ¥å°†ä¸¤ä¸ªæ•°ç»„å…ƒç´ è¿›è¡Œå‘é‡çš„ç‚¹ä¹˜è¿ç®—ï¼Œæˆ–ä½¿ç”¨ @ ç¬¦å·å°†ä¸¤ä¸ªçŸ©é˜µè¿›è¡ŒçŸ©é˜µçš„ä¹˜æ³•1234567891011import numpy as nparray0=np.array([1,2,3])array1=np.array([4,5,6])array2=np.array([[7,8], [9,10]])array3=np.array([[11,12], [13,14]])print(array0.dot(array1))print(array2 @ array3) 13.åŸºæœ¬åˆç­‰è¿ç®—è¿˜å¯ä»¥ä½¿ç”¨ï¼š Â· np.sin()/np.cos()/np.tan()è¿›è¡Œä¸‰è§’å‡½æ•°è¿ç®— Â· np.sqrt()è¿›è¡Œå¼€æ–¹è¿ç®— Â· np.log()è¿›è¡Œå¯¹æ•°è¿ç®— Â· np.power()è¿›è¡ŒæŒ‡æ•°è¿ç®—12345678import numpy as nparray0=np.array([1,2,3])print(np.sin(array0),np.cos(array0),np.tan(array0))print(np.sqrt(array0))print(np.log(array0))print(np.power(array0,2)) 14.argmin()å’Œargmax()å¯ä»¥è¿”å›æ•°ç»„ä¸­æœ€å°/æœ€å¤§å…ƒç´ çš„ç´¢å¼•123456import numpy as nparray0=np.array([1,2,3])print(array0.argmin())print(array0.argmax()) 15.ç»Ÿè®¡è¿ç®—ä½¿ç”¨ï¼š Â· sum()è·å–æ‰€æœ‰å…ƒç´ å’Œ Â· mean()è·å–æ•°æ®å¹³å‡æ•° Â· np.median()è·å–æ•°æ®ä¸­ä½æ•° Â· var()è·å–æ•°æ®æ–¹å·® Â· std()è·å–æ•°æ®æ ‡å‡†å·® å…¶ä¸­å¯ä»¥é€šè¿‡ä¿®æ”¹å‚æ•°axisçš„å€¼æ¥è·å–å¯¹åº”çŸ©é˜µçš„è¡Œæˆ–åˆ—ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼Pythonæ•°ç»„çš„è¡¨ç¤ºæˆ–åˆ—è¡¨çš„åˆ‡ç‰‡æ¥è·å–å¯¹åº”çš„å…ƒç´ /çŸ©é˜µå¯¹åº”çš„è¡Œåˆ—1234567891011import numpy as nparray0=np.array([[1,2,3,4,5,6,7,8,9,10], [11,12,13,14,15,16,17,18,19,20], [21,22,23,24,25,26,27,28,29,30]])print(array0[1:2,0:5].sum(axis=0),array0.sum(axis=1))print(array0[1,:].mean(),array0.mean(axis=0))print(np.median(array0[2,:]),np.median(array0,axis=1))print(array0[:,5:-1].var(),array0.var(axis=0))print(array0.std(axis=0),array0.std(axis=1)) 16.ç­›é€‰æ•°æ®å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è¿›è¡Œæ•°æ®ç­›é€‰ï¼Œå¦‚åœ¨æ–¹æ‹¬å·ä¸­è¾“å…¥array0&gt;6åˆ™è¿”å›æ‰€æœ‰&gt;6çš„æ•°æ®ã€‚ä¹Ÿå¯ä»¥é…åˆé€»è¾‘è¿ç®—ç¬¦ä¸€èµ·ä½¿ç”¨1234567import numpy as nparray0=np.array([[1,2,3,4,5,6,7,8,9,10], [11,12,13,14,15,16,17,18,19,20], [21,22,23,24,25,26,27,28,29,30]])print(array0[array0&gt;6]) 17.Numpyå›¾ç‰‡å¤„ç†é€šå¸¸å¯¹äºç°åº¦å›¾ç‰‡ï¼Œå¯ä»¥å°†å…¶å½“ä½œäºŒç»´æ•°ç»„å¤„ç†ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ä»£è¡¨å¯¹åº”åƒç´ çš„äº®åº¦ã€‚å¯¹äºRGBå½©è‰²å›¾ç‰‡ï¼Œå¯ä»¥ç”¨ä¸‰ç»´æ•°ç»„å¤„ç†ï¼Œç¬¬ä¸‰ç»´åˆ†åˆ«å­˜å‚¨åƒç´ ç‚¹å¯¹åº”çš„R/G/Bå€¼ ä½¿ç”¨pillowåº“æ‰“å¼€ä¸€å¼ å›¾ç‰‡1234from PIL import Imageimg=Image.open('kite.png')img.show() 1234from PIL import Imageimg=Image.open('kite.png')img.show() å°†å›¾åƒè½¬åŒ–ä¸ºnumpyæ•°ç»„å½¢å¼ï¼Œä¸‹é¢ä»¥flower.pngä¸ºä¾‹1234567import numpy as npfrom PIL import Imageimg=Image.open('flower.png')img=np.array(img)print(img.shape) å¯ä»¥çœ‹åˆ°è¿™ä¸ªå›¾åƒå…±æœ‰3456è¡Œï¼Œ5184åˆ—åƒç´ ï¼Œæ¯ä¸ªåƒç´ åŒ…æ‹¬RGBä¸‰ä¸ªé¢œè‰²çš„åˆ†é‡ é€šè¿‡ç±»ä¼¼åˆ—è¡¨åˆ‡ç‰‡çš„æ–¹å¼æå–å‡ºå›¾åƒçš„æ‰€æœ‰ç»¿è‰²åˆ†é‡12345678import numpy as npfrom PIL import Imageimg=Image.open('flower.png')img=np.array(img)img_red=img[:,:,1]Image.fromarray(img_red).show() ä¹Ÿå¯ä»¥å¯¹å›¾åƒè¿›è¡Œè£å‰ª12345678import numpy as npfrom PIL import Imageimg=Image.open('flower.png')img=np.array(img)img_cut=img[1000:2500,900:3200,:]Image.fromarray(img_cut).show() é€šè¿‡å¹¿æ’­çš„æ–¹å¼åšå›¾åƒå¢å¼ºï¼Œå¸¸ç”¨ä½œæœºå™¨å­¦ä¹ é¢†åŸŸ1234567import numpy as npfrom PIL import Imageimg=Image.open('flower.png')img=np.array(img)*15Image.fromarray(img).show() Pandas1.æƒ¯ç”¨å†™æ³•ï¼š1import pandas as pd 2.åˆ›å»ºpandasåºåˆ—1234import numpy as npimport pandas as pdprint(pd.Series([1,2,3,np.nan,5,6])) 3.åˆ›å»ºpandasæ•°æ®ç»“æ„DataFrameå¯ä»¥é€šè¿‡ä¸€èˆ¬å½¢å¼åˆ›å»ºæˆ–ä»¥ä¸€ä¸ªç±»ä¼¼äºå­—å…¸çš„å½¢å¼åˆ›å»ºpandas DataFrame1234567891011121314import numpy as npimport pandas as pddates=pd.date_range('20220301',periods=5)df0=pd.DataFrame(np.random.randn(5,10),index=dates,columns=['A','B','C','D','E','F','G','H','I','I'])df1=pd.DataFrame(&#123;'A':1., 'B':pd.Timestamp('20220301'), 'C':pd.Series(1,index=list(range(4)),dtype='float32'), 'D':np.array([3]*4,dtype='int32'), 'E':pd.Categorical([\"test\",\"train\",\"test\",\"train\"]), 'F':'foo'&#125;)print(df0)print(df1) ä¹Ÿå¯ä»¥ç›´æ¥å¾—å‡ºDataFrameçš„ä¸€äº›å±æ€§123456789101112131415import numpy as npimport pandas as pddates=pd.date_range('20220301',periods=5)df0=pd.DataFrame(np.random.randn(5,10),index=dates,columns=['A','B','C','D','E','F','G','H','I','I'])df1=pd.DataFrame(&#123;'A':1., 'B':pd.Timestamp('20220301'), 'C':pd.Series(1,index=list(range(4)),dtype='float32'), 'D':np.array([3]*4,dtype='int32'), 'E':pd.Categorical([\"test\",\"train\",\"test\",\"train\"]), 'F':'foo'&#125;)print(df0.columns)print(df1.values)print(df1.describe) 4.è·å–DataFrameå…ƒç´ ä¸‹åˆ—print()ä¸­çš„ä¸¤ç§æ–¹å¼å‡å¯ï¼š1234567891011import numpy as npimport pandas as pddf1=pd.DataFrame(&#123;'A':1., 'B':pd.Timestamp('20220301'), 'C':pd.Series(1,index=list(range(4)),dtype='float32'), 'D':np.array([3]*4,dtype='int32'), 'E':pd.Categorical([\"test\",\"train\",\"test\",\"train\"]), 'F':'foo'&#125;)print(df1.A,df1['A']) ä¹Ÿå¯ä»¥é€šè¿‡åˆ‡ç‰‡ç´¢å¼•çš„æ–¹å¼æ¥è·å–1234567891011import numpy as npimport pandas as pddf1=pd.DataFrame(&#123;'A':1., 'B':pd.Timestamp('20220301'), 'C':pd.Series(1,index=list(range(4)),dtype='float32'), 'D':np.array([3]*4,dtype='int32'), 'E':pd.Categorical([\"test\",\"train\",\"test\",\"train\"]), 'F':'foo'&#125;)print(df1[1:4]) è¿˜å¯ä»¥é€šè¿‡æ ‡ç­¾æ¥è·å–1234567import numpy as npimport pandas as pddates=pd.date_range('20220301',periods=6)df0=pd.DataFrame(np.arange(24).reshape((6,4)),index=dates,columns=['A','B','C','D'])print(df0.loc['20220302'],['A','B']) é€šè¿‡ä½ç½®æ¥è·å–12345678import numpy as npimport pandas as pddates=pd.date_range('20220301',periods=6)df0=pd.DataFrame(np.arange(24).reshape((6,4)),index=dates,columns=['A','B','C','D'])print(df0.iloc[[1,3,5],[1,3]])![è·å–DataFrameå…ƒç´ 4](/7.png) 4.ä¿®æ”¹DataFrameä¸­çš„å€¼å¯ä»¥é€šè¿‡ä¹‹å‰æŸ¥æ‰¾æ ‡ç­¾å’Œä½ç½®çš„æ–¹å¼å¯¹å€¼è¿›è¡Œä¿®æ”¹ï¼š12345678910import numpy as npimport pandas as pddates=pd.date_range('20220301',periods=6)df0=pd.DataFrame(np.arange(24).reshape((6,4)),index=dates,columns=['A','B','C','D'])df0.loc['20220304','B']=9999df0.iloc[2,3]=1000print(df0) ä¹Ÿå¯ä»¥é€šè¿‡é€»è¾‘è¡¨è¾¾å¼ä¿®æ”¹æ•°æ®ï¼š123456789import numpy as npimport pandas as pddates=pd.date_range('20220301',periods=6)df0=pd.DataFrame(np.arange(24).reshape((6,4)),index=dates,columns=['A','B','C','D'])df0[df0.B&gt;10]=100print(df0) 5.åˆ é™¤ç¼ºå¤±æ•°æ®å¯ä»¥é€šè¿‡dropna()æ¥æ¸…é™¤ç¼ºå¤±æ•°æ®ï¼Œå…¶ä¸­å‚æ•°howçš„å€¼ä¸ºâ€˜anyâ€™è¡¨ç¤ºæœ‰ç¼ºå¤±å³ä¸¢å¼ƒï¼Œå€¼ä¸ºâ€˜allâ€™åˆ™è¡¨ç¤ºå…¨éƒ¨ç¼ºå¤±åæ‰ä¸¢å¼ƒ123456789import numpy as npimport pandas as pddates=pd.date_range('20220301',periods=6)df0=pd.DataFrame(np.arange(24).reshape((6,4)),index=dates,columns=['A','B','C','D'])df0.iloc[0,1]=np.nandf0.iloc[2,3]=np.nanprint(df0.dropna(axis=0,how='any')) 6.å¡«è¡¥ç¼ºå¤±æ•°æ®å¯ä»¥é€šè¿‡fillna()æ¥å¡«è¡¥ç¼ºå¤±æ•°æ®123456789import numpy as npimport pandas as pddates=pd.date_range('20220301',periods=6)df0=pd.DataFrame(np.arange(24).reshape((6,4)),index=dates,columns=['A','B','C','D'])df0.iloc[0,1]=np.nandf0.iloc[2,3]=np.nanprint(df0.fillna(value=0)) 7.å®¡æŸ¥ç¼ºå¤±æ•°æ®é€šè¿‡isnull()æ¥æ£€æŸ¥æ•°æ®æ˜¯å¦ä¸ºç©ºï¼Œæ£€æŸ¥ç»“æœä¼šè¿”å›å¸ƒå°”å€¼123456789import numpy as npimport pandas as pddates=pd.date_range('20220301',periods=6)df0=pd.DataFrame(np.arange(24).reshape((6,4)),index=dates,columns=['A','B','C','D'])df0.iloc[0,1]=np.nandf0.iloc[2,3]=np.nanprint(df0.isnull()) å¦‚æœè¦æ£€æŸ¥æ•°æ®ä¸­æ˜¯å¦å­˜åœ¨ä¸¢å¤±æ•°æ®ï¼Œå¯ä»¥è¿™æ ·123456789import numpy as npimport pandas as pddates=pd.date_range('20220301',periods=6)df0=pd.DataFrame(np.arange(24).reshape((6,4)),index=dates,columns=['A','B','C','D'])df0.iloc[0,1]=np.nandf0.iloc[2,3]=np.nanprint(np.any(df0.isnull()==True)) ä¸€æ—¦è¿”å›ç»“æœä¸ºTrueï¼Œåˆ™æ„å‘³ç€æ•°æ®ä¸­æœ‰ç¼ºå¤± 8.Pandasçš„æ•°æ®å¯¼å…¥å¯¼å‡ºé€šå¸¸ä½¿ç”¨å†…ç½®å‡½æ•°å¦‚ï¼š Â· read_csv()ï¼šæ‰“å¼€csvæ–‡ä»¶ Â· read_excel()ï¼šæ‰“å¼€excelæ–‡ä»¶ Â· read_json()ï¼šæ‰“å¼€jsonæ–‡ä»¶ Â· read_html()ï¼šæ‰“å¼€htmlæ–‡ä»¶ Â· read_pickle()ï¼šæ‰“å¼€pickleæ–‡ä»¶ Â· read_sql()ï¼šæ‰“å¼€æ•°æ®åº“æ–‡ä»¶ â€¦ ç±»ä¼¼çš„ï¼Œè¦å­˜å‚¨ä¸ºå¯¹åº”çš„æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ï¼š Â· to_csv()ï¼šå­˜å‚¨ä¸ºcsvæ–‡ä»¶ Â· to_excel()ï¼šå­˜å‚¨ä¸ºexcelæ–‡ä»¶ Â· to_json()ï¼šå­˜å‚¨ä¸ºjsonæ–‡ä»¶ Â· to_html()ï¼šå­˜å‚¨ä¸ºhtmlæ–‡ä»¶ Â· to_pickle()ï¼šå­˜å‚¨ä¸ºpickleæ–‡ä»¶ Â· to_sql()ï¼šå­˜å‚¨ä¸ºæ•°æ®åº“æ–‡ä»¶ â€¦ 9.Pandasæ•°æ®åˆå¹¶å¯ä»¥ä½¿ç”¨pd.concat()æ¥åˆå¹¶pandasçš„DataFrame12345678910import numpy as npimport pandas as pddf0=pd.DataFrame(np.ones((3,4))*0,columns=['A','B','C','D'])df1=pd.DataFrame(np.ones((3,4))*1,columns=['A','B','C','D'])df2=pd.DataFrame(np.ones((3,4))*2,columns=['A','B','C','D'])print(df1,'\\n',df1,'\\n',df2)print(pd.concat([df0,df1,df2],axis=0)) å¦‚æœä¸¤ç»„æ•°æ®çš„ç´¢å¼•ã€ç±»å‹ä¸åŒï¼Œä¹Ÿå¯ä»¥è¿›ä¸€æ­¥å°†å®ƒä»¬åˆå¹¶ å…¶ä¸­joinä¸­â€˜innerâ€™ä¸ºè£å‰ªæ¨¡å¼ï¼Œé»˜è®¤â€˜outâ€™ä¸ºåˆå¹¶æ¨¡å¼ï¼Œä¼šä¸ºä¸¤è€…é—´ç¼ºå¤±çš„éƒ¨åˆ†èµ‹ç©ºå€¼ å°†ignore_indexçš„å€¼èµ‹ä¸ºTrueå¯ä»¥é‡ç½®ç´¢å¼•123456789import numpy as npimport pandas as pddf0=pd.DataFrame(np.ones((3,4))*0,columns=['A','B','C','D'],index=[1,2,3])df1=pd.DataFrame(np.ones((3,4))*1,columns=['B','C','D','E'],index=[2,3,5])print(df1,'\\n',df1)print(pd.concat([df0,df1],join='inner',ignore_index=True))","categories":[{"name":"Python","slug":"Python","permalink":"http://yoursite.com/categories/Python/"}],"tags":[{"name":"numpyã€pandas","slug":"numpyã€pandas","permalink":"http://yoursite.com/tags/numpyã€pandas/"}]},{"title":"Djangoé¡¹ç›®ï¼šè®¢å•ç®¡ç†ç³»ç»Ÿ","slug":"Djangoé¡¹ç›®ï¼šè®¢å•ç®¡ç†ç³»ç»Ÿ","date":"2022-02-26T18:21:08.000Z","updated":"2022-06-27T07:28:27.634Z","comments":true,"path":"2022/02/27/Djangoé¡¹ç›®ï¼šè®¢å•ç®¡ç†ç³»ç»Ÿ/","link":"","permalink":"http://yoursite.com/2022/02/27/Djangoé¡¹ç›®ï¼šè®¢å•ç®¡ç†ç³»ç»Ÿ/","excerpt":"1.Djangoç®€ä»‹Djangoæ˜¯ä¸€æ¬¾å¼€æºçš„python webåº”ç”¨æ¡†æ¶ï¼Œé‡‡ç”¨MTV(Model-Template-View)æ¨¡å¼ï¼Œå…¶ä¸­Modelè´Ÿè´£å¯¹è±¡ä¸æ•°æ®åº“çš„æ˜ å°„(ORM)ï¼ŒTemplateé€šè¿‡æ¥å£ç­‰æ–¹å¼å°†å‰ç«¯é¡µé¢ä¼ é€’ç»™ç”¨æˆ·ï¼ŒViewè§†å›¾å‡½æ•°å¯¹åº”ä¸šåŠ¡é€»è¾‘ï¼Œåœ¨åˆé€‚çš„æ—¶å€™è°ƒç”¨Modelæˆ–Template é™¤å»MTVæ¨¡å‹ä»¥å¤–ï¼ŒDjangoè¿˜æœ‰ä¸€ä¸ªURLæ§åˆ¶å™¨ï¼Œåˆ†åˆ«å°†ä¸åŒçš„URLè¯·æ±‚ä¼ é€’ç»™ä¸åŒçš„Viewè§†å›¾å‡½æ•°å¤„ç†ï¼Œå†é€šè¿‡å„è‡ªçš„Viewå‡½æ•°æ¥è°ƒç”¨å¯¹åº”çš„Modelå’ŒTemplate 2.Djangoé¡¹ç›®ï¼šè®¢å•ç®¡ç†ç³»ç»Ÿ1.Djangoé¡¹ç›®çš„åˆ›å»ºåœ¨python 3ä¸­å®‰è£…å®ŒæˆDjangoåº“åï¼Œå¯ä»¥åœ¨CMDæˆ–Pycharmç»ˆç«¯é‡Œæ‰§è¡Œï¼šdjango-admin startproject itemprojæ¥åˆ›å»ºDjangoé¡¹ç›® ä¹Ÿå¯ä»¥åœ¨Pycharmä¸“ä¸šç‰ˆæœ¬ç›´æ¥åˆ›å»ºä¸€ä¸ªDjangoé¡¹ç›®ï¼Œè¿™æ ·ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç©ºçš„Templateæ–‡ä»¶å¤¹ï¼Œä»¥åŠåœ¨settings.pyä¸­ç”ŸæˆTemplateå¯¹åº”çš„è·¯å¾„ã€‚è¿˜å¯ä»¥ç›´æ¥åˆ›å»ºåˆå§‹APPï¼Œè¿™é‡Œæ²¡æœ‰åš (æœ¬æ–‡ä½¿ç”¨çš„Djangoç‰ˆæœ¬ä¸º3.2.4) æ‰§è¡Œåˆ›å»ºå®Œæˆåï¼Œç³»ç»Ÿä¼šä¸ºæˆ‘ä»¬ç”Ÿæˆè¿™æ ·ä¸€ä¸ªåˆå§‹ç›®å½•ï¼š å…¶ä¸­ï¼š Â· manage.pyæ˜¯Djangoé¡¹ç›®ç®¡ç†çš„å·¥å…·è„šæœ¬ï¼Œæ‰§è¡ŒDjangoå‘½ä»¤æ—¶é€šè¿‡è¿™ä¸ªæ–‡ä»¶è¿›è¡Œç®¡ç†æ“ä½œ Â· itemproj/settings.pyæ˜¯Djangoé¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…æ‹¬äº†Appé…ç½®ã€Djangoä¸­é—´ä»¶ã€æ•°æ®åº“ç­‰é‡è¦è®¾ç½®ï¼Œåœ¨å®é™…å¼€å‘ä¸­è¦ç»å¸¸ä¿®æ”¹å…¶ä¸­å†…å®¹ Â· itemproj/urls.pyæ˜¯URLè·¯ç”±æ˜ å°„æ–‡ä»¶ï¼Œå…¶ä¸­å£°æ˜äº†å‰ç«¯å‘é€çš„å„ç§httpè¯·æ±‚ï¼Œå†é€šè¿‡å„çº§è·¯ç”±æ–‡ä»¶æ¥å¯»æ‰¾åˆ°å¯¹åº”çš„Viewè§†å›¾å‡½æ•°æ¥è¿›è¡Œå¤„ç† Â· itemproj/wsgi.pyï¼ŒWSGIæ˜¯Python webæœåŠ¡ç½‘å…³æ¥å£è§„èŒƒ(Web Server Gateway Interface)çš„ç®€ç§°ï¼Œç”±wsgi web serverå’Œwsgi web applicationä¸¤éƒ¨åˆ†ç»„æˆï¼Œæ˜¯è¿è¡Œåœ¨åŒä¸€ä¸ªpythonè¿›ç¨‹ä¸­çš„ä¸¤ä¸ªæ¨¡å— wsgi web severæ¥æ”¶äº†httpè¯·æ±‚ä»¥åè°ƒç”¨wsgi web applicationæ¥å£ï¼Œå¤„ç†è¯·æ±‚çš„å…·ä½“å†…å®¹ï¼Œå¤„ç†å®Œæˆåå†å°†ç»“æœè¿”å›ç»™wsgi web serverï¼Œé€šè¿‡wsgi web serverå°†è¯·æ±‚ä¼ é€’ç»™å‰ç«¯ï¼Œå¦‚å›¾æ‰€ç¤º(Djangoå®˜æ–¹æ–‡æ¡£)ï¼š Â· itemproj/asgi.pyï¼ŒASGIå³å¼‚æ­¥ç½‘å…³åè®®æ¥å£(Asynchronous Server Gateway Interface)ï¼Œæ˜¯ä¸€ä¸ªä»‹äºç½‘ç»œåè®®æœåŠ¡å’Œpythonåº”ç”¨ä¹‹é—´çš„æ ‡å‡†æ¥å£ï¼Œç”¨äºå¤„ç†é€šç”¨ç±»å‹çš„åè®®ã€‚å‚è€ƒè‡ªDjangoå®˜æ–¹æ–‡æ¡£çš„èµ„æ–™ï¼ŒASGIæ˜¯ä¸ºäº†æ”¯æŒå¼‚æ­¥ç½‘ç»œæœåŠ¡å™¨å’Œåº”ç”¨è€Œå‡ºç°çš„æ–°çš„pythonæ ‡å‡†ï¼Œå¯ä»¥å°†ASGIç†è§£ä¸ºWSGIåè®®çš„æ‰©å±• 2.Djangoç”Ÿå‘½å‘¨æœŸäº†è§£äº†Djangoé¡¹ç›®åŸºæœ¬ç»„æˆåï¼ŒDjangoçš„ç”Ÿå‘½å‘¨æœŸä¹ŸåŸºæœ¬æ˜æœ—ï¼šå‰ç«¯å‘èµ·URLè¯·æ±‚ â WSGI â Djangoä¸­é—´ä»¶ â URLè·¯ç”± â Viewè§†å›¾å‡½æ•° â Modelæ•°æ®åº“äº¤äº’ â Templateæ¨¡æ¿è¿›è¡Œhtmlæ¸²æŸ“ â Djangoä¸­é—´ä»¶ â WSGI â å‰ç«¯é¡µé¢ 3.Djangoé¡¹ç›®å¯åŠ¨é€šè¿‡åœ¨Pycharmç»ˆç«¯ä¸­æ‰§è¡Œpython manage.py runserveræ¥å¯åŠ¨DjangoæœåŠ¡ï¼Œç³»ç»Ÿé»˜è®¤åœ¨:8000ç«¯å£ä¸Šæ‰§è¡Œ å¯ä»¥åœ¨settings.pyä¸­å¢åŠ ALLOWED_HOSTSçš„å‚æ•°ï¼Œæ¥å¢åŠ æ”¯æŒçš„hostsï¼Œè¿™é‡Œæ–°å¢ä¸€ä¸ªlocalhostã€‚ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ç«¯å£å·ç­‰1ALLOWED_HOSTS = ['localhost']","text":"1.Djangoç®€ä»‹Djangoæ˜¯ä¸€æ¬¾å¼€æºçš„python webåº”ç”¨æ¡†æ¶ï¼Œé‡‡ç”¨MTV(Model-Template-View)æ¨¡å¼ï¼Œå…¶ä¸­Modelè´Ÿè´£å¯¹è±¡ä¸æ•°æ®åº“çš„æ˜ å°„(ORM)ï¼ŒTemplateé€šè¿‡æ¥å£ç­‰æ–¹å¼å°†å‰ç«¯é¡µé¢ä¼ é€’ç»™ç”¨æˆ·ï¼ŒViewè§†å›¾å‡½æ•°å¯¹åº”ä¸šåŠ¡é€»è¾‘ï¼Œåœ¨åˆé€‚çš„æ—¶å€™è°ƒç”¨Modelæˆ–Template é™¤å»MTVæ¨¡å‹ä»¥å¤–ï¼ŒDjangoè¿˜æœ‰ä¸€ä¸ªURLæ§åˆ¶å™¨ï¼Œåˆ†åˆ«å°†ä¸åŒçš„URLè¯·æ±‚ä¼ é€’ç»™ä¸åŒçš„Viewè§†å›¾å‡½æ•°å¤„ç†ï¼Œå†é€šè¿‡å„è‡ªçš„Viewå‡½æ•°æ¥è°ƒç”¨å¯¹åº”çš„Modelå’ŒTemplate 2.Djangoé¡¹ç›®ï¼šè®¢å•ç®¡ç†ç³»ç»Ÿ1.Djangoé¡¹ç›®çš„åˆ›å»ºåœ¨python 3ä¸­å®‰è£…å®ŒæˆDjangoåº“åï¼Œå¯ä»¥åœ¨CMDæˆ–Pycharmç»ˆç«¯é‡Œæ‰§è¡Œï¼šdjango-admin startproject itemprojæ¥åˆ›å»ºDjangoé¡¹ç›® ä¹Ÿå¯ä»¥åœ¨Pycharmä¸“ä¸šç‰ˆæœ¬ç›´æ¥åˆ›å»ºä¸€ä¸ªDjangoé¡¹ç›®ï¼Œè¿™æ ·ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç©ºçš„Templateæ–‡ä»¶å¤¹ï¼Œä»¥åŠåœ¨settings.pyä¸­ç”ŸæˆTemplateå¯¹åº”çš„è·¯å¾„ã€‚è¿˜å¯ä»¥ç›´æ¥åˆ›å»ºåˆå§‹APPï¼Œè¿™é‡Œæ²¡æœ‰åš (æœ¬æ–‡ä½¿ç”¨çš„Djangoç‰ˆæœ¬ä¸º3.2.4) æ‰§è¡Œåˆ›å»ºå®Œæˆåï¼Œç³»ç»Ÿä¼šä¸ºæˆ‘ä»¬ç”Ÿæˆè¿™æ ·ä¸€ä¸ªåˆå§‹ç›®å½•ï¼š å…¶ä¸­ï¼š Â· manage.pyæ˜¯Djangoé¡¹ç›®ç®¡ç†çš„å·¥å…·è„šæœ¬ï¼Œæ‰§è¡ŒDjangoå‘½ä»¤æ—¶é€šè¿‡è¿™ä¸ªæ–‡ä»¶è¿›è¡Œç®¡ç†æ“ä½œ Â· itemproj/settings.pyæ˜¯Djangoé¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…æ‹¬äº†Appé…ç½®ã€Djangoä¸­é—´ä»¶ã€æ•°æ®åº“ç­‰é‡è¦è®¾ç½®ï¼Œåœ¨å®é™…å¼€å‘ä¸­è¦ç»å¸¸ä¿®æ”¹å…¶ä¸­å†…å®¹ Â· itemproj/urls.pyæ˜¯URLè·¯ç”±æ˜ å°„æ–‡ä»¶ï¼Œå…¶ä¸­å£°æ˜äº†å‰ç«¯å‘é€çš„å„ç§httpè¯·æ±‚ï¼Œå†é€šè¿‡å„çº§è·¯ç”±æ–‡ä»¶æ¥å¯»æ‰¾åˆ°å¯¹åº”çš„Viewè§†å›¾å‡½æ•°æ¥è¿›è¡Œå¤„ç† Â· itemproj/wsgi.pyï¼ŒWSGIæ˜¯Python webæœåŠ¡ç½‘å…³æ¥å£è§„èŒƒ(Web Server Gateway Interface)çš„ç®€ç§°ï¼Œç”±wsgi web serverå’Œwsgi web applicationä¸¤éƒ¨åˆ†ç»„æˆï¼Œæ˜¯è¿è¡Œåœ¨åŒä¸€ä¸ªpythonè¿›ç¨‹ä¸­çš„ä¸¤ä¸ªæ¨¡å— wsgi web severæ¥æ”¶äº†httpè¯·æ±‚ä»¥åè°ƒç”¨wsgi web applicationæ¥å£ï¼Œå¤„ç†è¯·æ±‚çš„å…·ä½“å†…å®¹ï¼Œå¤„ç†å®Œæˆåå†å°†ç»“æœè¿”å›ç»™wsgi web serverï¼Œé€šè¿‡wsgi web serverå°†è¯·æ±‚ä¼ é€’ç»™å‰ç«¯ï¼Œå¦‚å›¾æ‰€ç¤º(Djangoå®˜æ–¹æ–‡æ¡£)ï¼š Â· itemproj/asgi.pyï¼ŒASGIå³å¼‚æ­¥ç½‘å…³åè®®æ¥å£(Asynchronous Server Gateway Interface)ï¼Œæ˜¯ä¸€ä¸ªä»‹äºç½‘ç»œåè®®æœåŠ¡å’Œpythonåº”ç”¨ä¹‹é—´çš„æ ‡å‡†æ¥å£ï¼Œç”¨äºå¤„ç†é€šç”¨ç±»å‹çš„åè®®ã€‚å‚è€ƒè‡ªDjangoå®˜æ–¹æ–‡æ¡£çš„èµ„æ–™ï¼ŒASGIæ˜¯ä¸ºäº†æ”¯æŒå¼‚æ­¥ç½‘ç»œæœåŠ¡å™¨å’Œåº”ç”¨è€Œå‡ºç°çš„æ–°çš„pythonæ ‡å‡†ï¼Œå¯ä»¥å°†ASGIç†è§£ä¸ºWSGIåè®®çš„æ‰©å±• 2.Djangoç”Ÿå‘½å‘¨æœŸäº†è§£äº†Djangoé¡¹ç›®åŸºæœ¬ç»„æˆåï¼ŒDjangoçš„ç”Ÿå‘½å‘¨æœŸä¹ŸåŸºæœ¬æ˜æœ—ï¼šå‰ç«¯å‘èµ·URLè¯·æ±‚ â WSGI â Djangoä¸­é—´ä»¶ â URLè·¯ç”± â Viewè§†å›¾å‡½æ•° â Modelæ•°æ®åº“äº¤äº’ â Templateæ¨¡æ¿è¿›è¡Œhtmlæ¸²æŸ“ â Djangoä¸­é—´ä»¶ â WSGI â å‰ç«¯é¡µé¢ 3.Djangoé¡¹ç›®å¯åŠ¨é€šè¿‡åœ¨Pycharmç»ˆç«¯ä¸­æ‰§è¡Œpython manage.py runserveræ¥å¯åŠ¨DjangoæœåŠ¡ï¼Œç³»ç»Ÿé»˜è®¤åœ¨:8000ç«¯å£ä¸Šæ‰§è¡Œ å¯ä»¥åœ¨settings.pyä¸­å¢åŠ ALLOWED_HOSTSçš„å‚æ•°ï¼Œæ¥å¢åŠ æ”¯æŒçš„hostsï¼Œè¿™é‡Œæ–°å¢ä¸€ä¸ªlocalhostã€‚ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ç«¯å£å·ç­‰1ALLOWED_HOSTS = ['localhost'] 4.åˆ›å»ºDjango APPé¦–å…ˆåˆ›å»ºä¸€ä¸ªappä¸“é—¨è´Ÿè´£å¤„ç†è®¢å•ç®¡ç†ç³»ç»Ÿä¸­å¯¹è®¢å•é”€å”®çš„å¢åˆ æ”¹æŸ¥è¯·æ±‚ åœ¨Pycharmç»ˆç«¯ä¸­æ‰§è¡Œpython manage.py startapp salesï¼Œä¼šåˆ›å»ºä¸€ä¸ªåä¸ºsalesçš„appç›®å½•ï¼Œå…¶ä¸­åŒ…å«æ–°çš„ä¸‹åˆ—æ–‡ä»¶ï¼š è¯¥æ–‡ä»¶ç›®å½•å…¶å®å°±æ˜¯ä¸€ä¸ªpythonåŒ… 5.ç¼–è¾‘Viewè§†å›¾å‡½æ•°å’ŒURLè·¯ç”±æ‰“å¼€sales/views.pyæ–‡ä»¶ï¼Œå‡†å¤‡æ–°å¢ä¸€æ¡è§†å›¾åŠŸèƒ½ï¼š1234from django.http import HttpResponsedef listorders(request): return HttpResponse(\"ä¸‹é¢æ˜¯ç³»ç»Ÿä¸­æ‰€æœ‰çš„è®¢å•ä¿¡æ¯......\") è¿™é‡Œå°†è¿”å›HttpResponseå¯¹è±¡çš„å­—ç¬¦ä¸²å‚æ•° æ¥ç€æ‰“å¼€itemproj/urls.pyæ–‡ä»¶ï¼Œå¯¼å…¥è§†å›¾å‡½æ•°listordesï¼Œåœ¨åˆ—è¡¨å˜é‡urlpatternsä¸­æ–°å¢æŒ‡å‘Viewçš„è·¯ç”±ä¿¡æ¯ã€‚urlpatternså°±æ˜¯Django URLè·¯ç”±çš„ä¸»å…¥å£123456789from django.contrib import adminfrom django.urls import pathfrom sales.views import listordersurlpatterns = [ path('admin/', admin.site.urls), path('sales/orders/', listorders),] å¯åŠ¨Django åœ¨å®é™…å·¥ç¨‹é¡¹ç›®ä¸­ï¼Œç³»ç»Ÿçš„urlsæ¡ç›®å¤æ‚å¤šå˜ï¼Œæ”¾åœ¨åŒä¸€ä»½ç›®å½•ä¸‹ä¼šæ˜¾å¾—è‡ƒè‚¿ä¸”éš¾ä»¥ç»´æŠ¤ï¼ŒæŸ¥è¯¢èµ·æ¥éå¸¸å›°éš¾ï¼Œä¸ç¬¦åˆåç«¯é¡¹ç›®çš„è®¾è®¡ç†å¿µï¼Œè¿™é‡Œå°±éœ€è¦å°†ç³»ç»Ÿçš„urlsåšæˆæ ‘å½¢ç³»ç»Ÿï¼ŒæŒ‰ç…§urlså¯¹åº”çš„è§†å›¾åŠŸèƒ½å°†å…¶æ‹†åˆ†è¿›å¯¹åº”çš„URLè·¯ç”±å­è¡¨å½“ä¸­ æ¯”å¦‚ï¼Œè¿™é‡Œå°†æ‰€æœ‰ä»¥saleså¼€å¤´çš„urlså…¨éƒ¨æ”¾åœ¨sales appç›®å½•ä¸‹æ–°åˆ›å»ºçš„å­è·¯ç”±sales/urls.pyæ–‡ä»¶ä¸­1234567from django.urls import pathfrom . import viewsurlpatterns = [ path('orders/', views.listorders),] å†å¯¹ä¸»è·¯ç”±æ–‡ä»¶itemproj/urls.pyè¿›è¡Œä¿®æ”¹12345678from django.contrib import adminfrom django.urls import path, includeurlpatterns = [ path('admin/', admin.site.urls), path('sales/', include('sales.urls')),] 6.åˆ›å»ºæ•°æ®åº“æ•°æ®åº“è‡ªç„¶æ˜¯Djangoåç«¯å¼€å‘ä¸­çš„é‡è¦å†…å®¹ï¼ŒDjangoå¯¹å…¶çš„è®¾ç½®ä¿å­˜åœ¨itemproj/settings.pyæ–‡ä»¶ä¸­ è¿›å…¥settings.pyï¼Œæ‰¾åˆ°settings.pyDATABASESè®¾ç½®123456DATABASES = &#123; 'default': &#123; 'ENGINE': 'django.db.backends.sqlite3', 'NAME': BASE_DIR / 'db.sqlite3', &#125;&#125; å¯ä»¥çœ‹åˆ°Djangoé»˜è®¤çš„æ•°æ®åº“å¼•æ“ä¸ºsqlite3ï¼Œè¦æ·»åŠ MySqlæ•°æ®åº“ï¼Œå¯ä»¥å°†å…¶è®¾ç½®ä¸ºï¼š12345678910DATABASES = &#123; 'default':&#123; 'ENGINE':'django.db.backends.mysql', 'NAME':'testdemo1', #æ‰€ä½¿ç”¨çš„æ•°æ®åº“çš„åå­— 'USER':'root', #æ•°æ®åº“ç”¨æˆ· 'PASSWORD':'123456', #å¯†ç  'HOST':'127.0.0.1', #ä¸»æœº 'PORT':'3306', #ç«¯å£ &#125;&#125; æ‰§è¡Œåˆ›å»ºæœ¬åœ°æ•°æ®åº“çš„æŒ‡ä»¤python manage.py migrate é»˜è®¤æƒ…å†µä¸‹å°±ä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªdb.sqlite3ï¼Œå¹¶åœ¨å…¶ä¸­è‡ªåŠ¨åˆ›å»ºä¸€äº›Djangoè¡¨ å¯ä»¥åœ¨Navicatä¸­å°†å…¶æ‰“å¼€ 7.åˆ›å»ºè¡¨å•æ–°å»ºä¸€ä»½common appåº”ç”¨ç›®å½•ï¼Œåœ¨å…¶ä¸­å­˜æ”¾ä¸€äº›å…¬å…±ä¿¡æ¯ python manage.py startapp common è¿›å…¥appä¸­common/models.pyï¼Œæ·»åŠ å†…å®¹ï¼š1234567891011from django.db import modelsclass Customer(models.Model): # å®¢æˆ·åç§° name = models.CharField(max_length=200) # è”ç³»ç”µè¯ phonenumber = models.CharField(max_length=200) # é‚®ç®± address = models.CharField(max_length=200) å…¶ä¸­çš„å®¢æˆ·Customerç±»ç»§æ‰¿è‡ªdjango.db.models.Modelï¼Œç”¨æ¥å®šä¹‰æ•°æ®åº“è¡¨æ ¼ï¼Œæ·»åŠ çš„nameã€phonenumberå’Œadressåˆ†åˆ«æ˜¯è¡¨ä¸­çš„3ä¸ªvarcharå­—æ®µï¼Œå‚æ•°max_lengthåˆ™é™åˆ¶äº†3ä¸ªå­—æ®µçš„æœ€å¤§é•¿åº¦ æ¥ç€æ¥åˆ°itemproj/settings.pyä¸­ï¼Œæ·»åŠ common app12345678910INSTALLED_APPS = [ 'django.contrib.admin', 'django.contrib.auth', 'django.contrib.contenttypes', 'django.contrib.sessions', 'django.contrib.messages', 'django.contrib.staticfiles', 'common.apps.CommonConfig',] å®Œæˆåï¼ŒDjangoå·²ç»çœŸæ­£æ·»åŠ äº†appç”¨ï¼Œç»§ç»­æ‰§è¡Œå‘½ä»¤python manage.py makemigrations commonè®°å½•å¯¹æ•°æ®åº“çš„æ“ä½œ æ‰§è¡Œå®Œæˆåï¼Œä¼šåœ¨common/migrations.pyç›®å½•ä¸‹ç”Ÿæˆ0001_inital.pyæ–‡ä»¶ï¼Œè¯¥è„šæœ¬å°±æ˜¯è¿›è¡Œçš„æ•°æ®åº“æ“ä½œä»£ç  1234567891011121314151617181920from django.db import migrations, modelsclass Migration(migrations.Migration): initial = True dependencies = [ ] operations = [ migrations.CreateModel( name='Customer', fields=[ ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')), ('name', models.CharField(max_length=200)), ('phonenumber', models.CharField(max_length=200)), ('address', models.CharField(max_length=200)), ], ), ] æ¥ä¸‹æ¥æ‰§è¡Œpython manage.py migrateå»æ•°æ®åº“ä¸­åˆ›å»ºè¡¨ 8.åˆ›å»ºDjangoç®¡ç†å‘˜Djangoæä¾›äº†ä¸€ä¸ªå†…ç½®çš„ç®¡ç†å‘˜æ“ä½œé¡µé¢ï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œå¯¹æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥å·¥ä½œï¼Œå°†æ•°æ®åº“æ“ä½œå˜å¾—ç®€å•ã€‚ é¦–å…ˆåˆ›å»ºè¶…çº§ç®¡ç†å‘˜è´¦å·ï¼Œæ‰§è¡Œå‘½ä»¤python manage.py createsuperuser å› ä¸ºæ˜¯åšæµ‹è¯•å­¦ä¹ ä½¿ç”¨ï¼Œæ‰€ä»¥å¯†ç è®¾ç½®å¾—ç›¸å¯¹ç®€å•ï¼Œç›´æ¥æ— è§†æ‰è­¦å‘Šï¼ŒåŒæ ·çš„ï¼Œè¿˜å¯ä»¥ä¸´æ—¶å–æ¶ˆDjangoçš„CSRF(è·¨ç«™è¯·æ±‚ä¼ªé€ )æ ¡éªŒï¼Œå¦åˆ™åç»­çš„HTTPè¯·æ±‚éƒ½å¿…é¡»æºå¸¦æ ¡éªŒæ•°æ® 123456789MIDDLEWARE = [ 'django.middleware.security.SecurityMiddleware', 'django.contrib.sessions.middleware.SessionMiddleware', 'django.middleware.common.CommonMiddleware', #'django.middleware.csrf.CsrfViewMiddleware', 'django.contrib.auth.middleware.AuthenticationMiddleware', 'django.contrib.messages.middleware.MessageMiddleware', 'django.middleware.clickjacking.XFrameOptionsMiddleware',] è¦ç‰¢è®°è®¾ç½®çš„å¯†ç ï¼Œå› ä¸ºå¿˜è®°å¯†ç åå¦‚æœæƒ³è¦å»æ•°æ®åº“é‡ŒæŸ¥çœ‹ï¼Œä¸ç»è¿‡å¯†ç å­¦è§£å¯†çš„æƒ…å†µä¸‹ï¼Œå¯†ç åœ¨æ•°æ®è¡¨ä¸­æ˜¯ä»¥pbkdf2_sha256ç®—æ³•åŠ å¯†åçš„å¯†æ–‡å½¢å¼è®°å½•çš„ï¼Œè¿™åœ¨Djangoåå°ç®¡ç†é¡µé¢å½“ä¸­ä¹Ÿä¼šæœ‰æç¤º å¦‚æœæ‹…å¿ƒå¿˜è®°å¯†ç å¯ä»¥å…ˆå°†å¯†ç æ³¨é‡Šåˆ°itemproj/settings.pyä¸­123456'''Username (leave blank to use 'elbadaernu9.9'): 9.9Email address: rtl1312@163.comPassword: 00000000Superuser created successfully.''' ç„¶åä¿®æ”¹commonåº”ç”¨ä¸­ç®¡ç†å‘˜é…ç½®æ–‡ä»¶common/admin.pyï¼Œæ³¨å†Œè‡ªå®šä¹‰çš„modelç±»ï¼Œæäº¤ç»™Django12345from django.contrib import adminfrom .models import Customeradmin.site.register(Customer) å¯åŠ¨Djangoï¼Œè®¿é—®http://localhost:8000/adminï¼Œå‡ºç°ç®¡ç†å‘˜ç™»é™†ç•Œé¢ ç™»é™†åè¿›å…¥åˆ°ç®¡ç†å‘˜åå° å¢åŠ å®¢æˆ·æ•°æ® ä¸Šè¿°æ­¥éª¤å®Œæˆä»¥åï¼Œè¿›å…¥Navicatï¼Œåˆ·æ–°common_customerè¡¨ï¼Œå¯ä»¥çœ‹åˆ°æ–°å¢æ•°æ®å·²ç»å‡ºç°åœ¨æ•°æ®åº“å½“ä¸­ è¦å°†ç®¡ç†å‘˜ç•Œé¢è®¾ç½®ä¸ºä¸­æ–‡ï¼Œå¯ä»¥åˆ°åˆ°itemproj/settings.pyä¸­å¯¹ä¸­é—´ä»¶åŠ å…¥å¦‚ä¸‹è®¾ç½®ï¼š1234567891011MIDDLEWARE = [ 'django.middleware.security.SecurityMiddleware', 'django.contrib.sessions.middleware.SessionMiddleware', 'django.middleware.common.CommonMiddleware', 'django.middleware.csrf.CsrfViewMiddleware', 'django.contrib.auth.middleware.AuthenticationMiddleware', 'django.contrib.messages.middleware.MessageMiddleware', 'django.middleware.clickjacking.XFrameOptionsMiddleware', #ç®¡ç†å‘˜åå°ç•Œé¢è®¾ç½®ä¸ºä¸­æ–‡ 'django.middleware.locale.LocaleMiddleware',] 9.è·å–æ•°æ®å…ˆæ¥å®ç°ç¬¬ä¸€ä¸ªåŠŸèƒ½ï¼Œå½“æµè§ˆå™¨è®¿é—®/sales/customs/æ—¶ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ç³»ç»Ÿä¸­çš„æ‰€æœ‰å®¢æˆ·è®°å½• æ¥åˆ°sales/views.pyä¸­ï¼Œå®šä¹‰listcustomerså‡½æ•°1234567891011121314from common.models import Customerdef listcustomers(request): qs = Customer.objects.values() # å®šä¹‰è¿”å›å­—ç¬¦ä¸² retStr = '' for customer in qs: for name,value in customer.items(): retStr += f'&#123;name&#125; : &#123;value&#125; | ' retStr += '&lt;br&gt;' return HttpResponse(retStr) Customer.objects.values()ä¼šè¿”å›Djangoå®šä¹‰çš„QuerySetå¯¹è±¡ï¼Œå°†è¿”å›åŒ…å«çš„å…¨éƒ¨Customerè¡¨è®°å½•ï¼Œæ¯æ¡è®°å½•éƒ½æ˜¯ä¸€ä¸ªå­—å…¸å¯¹è±¡ æ¥ç€æ·»åŠ å¯¹/sales/customs/è®¿é—®urlè¯·æ±‚çš„è·¯ç”±12345678910from django.urls import pathfrom . import viewsurlpatterns = [ path('orders/', views.listorders), #è¿™é‡Œæ˜¯æ–°æ·»åŠ çš„è·¯ç”±ä¿¡æ¯ path('customers/', views.listcustomers), ] å¯åŠ¨Djangoï¼Œè¿›å…¥å¯¹åº”é¡µé¢åå‡ºç°ï¼š å› ä¸ºåœ¨å®é™…è®¢å•ä¿¡æ¯ä¸­ï¼Œå®¢æˆ·æ•°é‡åºå¤§ï¼Œå¯ä»¥å¯¹ä»£ç æ–°å¢è¿‡æ»¤æ¡ä»¶1234567891011121314151617def listcustomers(request): qs = Customer.objects.values() # æ£€æŸ¥urlä¸­æ˜¯å¦æœ‰å‚æ•°phonenumber ph = request.GET.get('phonenumber',None) if ph: qs = qs.filter(phonenumber=ph) # å®šä¹‰è¿”å›å­—ç¬¦ä¸² retStr = '' for customer in qs: for name,value in customer.items(): retStr += f'&#123;name&#125; : &#123;value&#125; | ' retStr += '&lt;br&gt;' return HttpResponse(retStr) 10.ä½¿ç”¨Htmlå±•ç¤ºæ•°æ®ä½¿ç”¨Djangoå†…ç½®çš„æ¨¡æ¿å¼•æ“ï¼Œå®šä¹‰ä¸€æ®µHtmlä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657html_template = '''&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;meta charset=\"UTF-8\"&gt;&lt;style&gt;table &#123; border-collapse: collapse;&#125;th, td &#123; padding: 8px; text-align: left; border-bottom: 1px solid #ddd;&#125;&lt;/style&gt;&lt;/head&gt; &lt;body&gt; &lt;table&gt; &lt;tr&gt; &lt;th&gt;id&lt;/th&gt; &lt;th&gt;å§“å&lt;/th&gt; &lt;th&gt;ç”µè¯å·ç &lt;/th&gt; &lt;th&gt;é‚®ç®±&lt;/th&gt; &lt;/tr&gt; &#123;% for customer in customers %&#125; &lt;tr&gt; &#123;% for name, value in customer.items %&#125; &lt;td&gt;&#123;&#123; value &#125;&#125;&lt;/td&gt; &#123;% endfor %&#125; &lt;/tr&gt; &#123;% endfor %&#125; &lt;/table&gt; &lt;/body&gt;&lt;/html&gt;'''from django.template import enginesdjango_engine = engines['django']template = django_engine.from_string(html_template)def listcustomers(request): qs = Customer.objects.values() ph = request.GET.get('phonenumber', None) if ph: qs = qs.filter(phonenumber=ph) # ä¼ å…¥æ¸²æŸ“æ¨¡æ¿éœ€è¦çš„å‚æ•° rendered = template.render(&#123;'customers': qs&#125;) return HttpResponse(rendered) åœ¨å®é™…å‰åç«¯åˆ†ç¦»çš„å¼€å‘ä¸­ï¼ŒHtmléƒ¨åˆ†çš„å·¥ä½œé€šå¸¸äº¤ç”±å‰ç«¯å¼€å‘äººå‘˜ï¼Œåç«¯ä¸»è¦æ˜¯å‡†å¤‡å¥½ä¸å‰ç«¯é¡µé¢çš„APIæ¥å£å·¥ä½œ 11.å¯¹æ•°æ®çš„å¢åˆ æ”¹æŸ¥1.åˆ›å»ºç®¡ç†åº”ç”¨é’ˆå¯¹ç®¡ç†å‘˜ç”¨æˆ·çš„å·¥ä½œï¼Œç»§ç»­åˆ›å»ºæ–°åº”ç”¨mgræ¥å¤„ç†ç®¡ç›¸å…³è¯·æ±‚ ä¸ºäº†é¿å…é¢å‘mgrç®¡ç†å‘˜çš„ç³»ç»Ÿé‡Œmgr/views.pyä¸­çš„å‡½æ•°è¿‡äºåºå¤§ï¼Œæ–°åˆ›å»ºä¸€ä»½mgr/customer.pyæ¥ä¸“é—¨å¤„ç†å¯¹customeræ•°æ®çš„æ“ä½œ 2.è®¾ç½®URLè·¯ç”±å®é™…çš„å¢åˆ æ”¹æŸ¥æ“ä½œéƒ½å‘ç”Ÿåœ¨åŒä¸€ä»½è·¯ç”±å½“ä¸­ Â· GETï¼šè·å–è¯·æ±‚ Â· POSTï¼šæ·»åŠ è¯·æ±‚ Â· PUTï¼šä¿®æ”¹è¯·æ±‚ Â· DELETEï¼šåˆ é™¤è¯·æ±‚ è€ŒDjangoä¸æ”¯æŒåœ¨è·¯ç”±å½“ä¸­æ·»åŠ HTTPè¯·æ±‚æ–¹æ³•ï¼Œå¯ä»¥åœ¨mgr/customer.pyæ–‡ä»¶ä¸­æ–°å¢å‡½æ•°dispatcher()æ¥ç®¡ç†è¯·æ±‚123456789101112131415161718192021222324252627from django.http import JsonResponseimport jsondef dispatcher(request): # å°†è¯·æ±‚å‚æ•°ç»Ÿä¸€æ”¾å…¥requestçš„paramså±æ€§ä¸­ï¼Œæ–¹ä¾¿åç»­å¤„ç† # GETè¯·æ±‚ å‚æ•°åœ¨urlä¸­ï¼Œé€šè¿‡requestå¯¹è±¡çš„GETå±æ€§è·å– if request.method == 'GET': request.params = request.GET # POST/PUT/DELETE è¯·æ±‚ å‚æ•°ä»requestå¯¹è±¡çš„bodyå±æ€§ä¸­è·å– elif request.method in ['POST','PUT','DELETE']: # æ¥å£ä¸­POST/PUT/DELETEè¯·æ±‚çš„æ¶ˆæ¯ä½“éƒ½æ˜¯jsonæ ¼å¼ request.params = json.loads(request.body) # æ ¹æ®ä¸åŒçš„actionåˆ†æ´¾ç»™ä¸åŒçš„å‡½æ•°è¿›è¡Œå¤„ç† action = request.params['action'] if action == 'list_customer': return listcustomers(request) elif action == 'add_customer': return addcustomer(request) elif action == 'modify_customer': return modifycustomer(request) elif action == 'del_customer': return deletecustomer(request) else: return JsonResponse(&#123;'ret': 1, 'msg': 'ä¸æ”¯æŒè¯¥ç±»å‹httpè¯·æ±‚'&#125;) è¿›å…¥ä¸»è·¯ç”±itemproj/urls.pyæ–°å¢1path('api/mgr/', include('mgr.urls')), ç„¶ååˆ›å»ºå¹¶è¿›å…¥å­è·¯ç”±mgr/urls.pyæ·»åŠ è·¯å¾„å£°æ˜1234567from django.urls import pathfrom mgr import customerurlpatterns = [ path('customers', customer.dispatcher),] è¿™æ ·ï¼Œå¦‚æœæœ‰æ¥è‡ªAPIè¯·æ±‚/api/mgr/customerså½“ä¸­å†…å®¹ï¼Œéƒ½å°†ç»è¿‡dispatcher()å‡½æ•°å¤„ç† ç»§ç»­å®Œæˆå¢åˆ æ”¹æŸ¥åŠŸèƒ½å¯¹åº”çš„å‡½æ•° 3.å¢åŠ å®¢æˆ·å¯¼å…¥1from common.models import Customer 123456789def addcustomer(request): info = request.params['data'] record = Customer.objects.create(name=info['name'] , phonenumber=info['phonenumber'] , address=info['address']) return JsonResponse(&#123;'ret': 0, 'id':record.id&#125;) 4.åˆ é™¤å®¢æˆ·123456789101112131415def deletecustomer(request): customerid = request.params['id'] try: customer = Customer.objects.get(id=customerid) except Customer.DoesNotExist: return &#123; 'ret': 1, 'msg': f'id ä¸º`&#123;customerid&#125;`çš„å®¢æˆ·ä¸å­˜åœ¨' &#125; customer.delete() return JsonResponse(&#123;'ret': 0&#125;) 5.ä¿®æ”¹å®¢æˆ·1234567891011121314151617181920212223242526def modifycustomer(request): # ä»è¯·æ±‚æ¶ˆæ¯ä¸­ è·å–ä¿®æ”¹å®¢æˆ·çš„ä¿¡æ¯ # æ‰¾åˆ°è¯¥å®¢æˆ·ï¼Œå¹¶ä¸”è¿›è¡Œä¿®æ”¹æ“ä½œ customerid = request.params['id'] newdata = request.params['newdata'] try: customer = Customer.objects.get(id=customerid) except Customer.DoesNotExist: return &#123; 'ret': 1, 'msg': f'id ä¸º`&#123;customerid&#125;`çš„å®¢æˆ·ä¸å­˜åœ¨' &#125; if 'name' in newdata: customer.name = newdata['name'] if 'phonenumber' in newdata: customer.phonenumber = newdata['phonenumber'] if 'address' in newdata: customer.address = newdata['address'] customer.save() return JsonResponse(&#123;'ret': 0&#125;) 6.æŸ¥è¯¢å®¢æˆ·12345678def listcustomers(request): # è¿”å›ä¸€ä¸ªQuerySetå¯¹è±¡ qs = Customer.objects.values() # å°† QuerySetå¯¹è±¡è½¬åŒ–ä¸ºlistç±»å‹ï¼ŒJSONå­—ç¬¦ä¸² retlist = list(qs) return JsonResponse(&#123;'ret': 0, 'retlist': retlist&#125;) 12.æµ‹è¯•å®é™…å¼€å‘è¿‡ç¨‹ä¸­å¯èƒ½ä¸èƒ½åŠæ—¶æ”¶åˆ°å‰ç«¯çš„Htmlæ–‡ä»¶ï¼Œæ­¤æ—¶å°±éœ€è¦å¯¹é¡¹ç›®åŠŸèƒ½è¿›è¡Œä¸€å®šæµ‹è¯• å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿå‰ç«¯çš„å½¢å¼ï¼Œå‘å‡ºHTTPè¯·æ±‚ï¼Œå¯¹åç«¯æ¥å£è¿›è¡Œæµ‹è¯• åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»ºtestæ–‡ä»¶å¤¹ç”¨äºå­˜æ”¾æµ‹è¯•æ–‡ä»¶ï¼Œå¹¶æ–°å»ºä¸€ä»½test01.pyæ–‡ä»¶ç”¨äºæµ‹è¯•customeræ•°æ® å¯¼å…¥pythonçš„requestsåº“ï¼Œåšæ¥å£æµ‹è¯•12345import requests,pprintresponse = requests.get('http://localhost:8000/api/mgr/customers?action=list_customer')pprint.pprint(response.json()) ç»§ç»­åˆ›å»ºtest_add.pyæ–‡ä»¶ç”¨äºæµ‹è¯•æ–°å¢ç”¨æˆ·123456789101112131415161718import requests,pprintpayload = &#123; \"action\":\"add_customer\", \"data\":&#123; \"name\":\"å°æ˜\", \"phonenumber\":\"12345678910\", \"address\":\"xiaoming@163.com\" &#125;&#125;response = requests.post('http://localhost:8000/api/mgr/customers',json=payload)pprint.pprint(response.json())response = requests.get('http://localhost:8000/api/mgr/customers?action=list_customer')pprint.pprint(response.json()) æ­¤æ—¶æ•°æ®åº“ä¸­ä¹Ÿéšä¹‹å‡ºç°äº†â€œå°æ˜â€çš„è®°å½• 13.ä¸å‰ç«¯é›†æˆåˆ¶ä½œå‰ç«¯çš„Htmlæ–‡ä»¶ï¼Œæ‰“åŒ…åå‘½åä¸ºfront_endä½œä¸ºé™æ€æ–‡ä»¶æ”¾è¿›é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œè¿›å…¥itemproj/urls.pyæ–‡ä»¶ä¸­ï¼Œæ·»åŠ é™æ€æ–‡ä»¶å£°æ˜ï¼Œå¹¶åœ¨æœ«å°¾å¢åŠ ä»£ç 12345678910from django.contrib import adminfrom django.urls import path, includefrom django.conf.urls.static import staticurlpatterns = [ path('admin/', admin.site.urls), path('sales/', include('sales.urls')), path('api/mgr/', include('mgr.urls')),] + static(\"/\", document_root=\"./front_end\") æœ€åæ·»åŠ çš„å°±æ˜¯æŸ¥æ‰¾å‰ç«¯é™æ€æ–‡ä»¶çš„URLè·¯ç”±ï¼Œä¸€ä½†HTTPè¯·æ±‚ä¸æ˜¯ä»¥admin/ sales/ api/å¼€å¤´ï¼ŒDjangoä¼šè®¿é—®å‰ç«¯ç›®å½•ä¸‹çš„é™æ€æ–‡ä»¶ å‡è®¾ä¸å‰ç«¯æ–‡ä»¶çš„é›†æˆæ— è¯¯ï¼Œå¯åŠ¨Djangoï¼Œè®¿é—®http://localhost:8000/mgr/index.html,è¿›å…¥ç®¡ç†å‘˜åå°ï¼Œä¼šå¾—åˆ°ç±»ä¼¼è¿™æ ·çš„æˆæœ 14.ç™»é™†åŠŸèƒ½è¦å®ç°è®¢å•ç®¡ç†å‘˜çš„ç™»é™†ç™»å‡ºåŠŸèƒ½ï¼Œç»§ç»­åœ¨mgræ–‡ä»¶å¤¹ä¸­æ–°å»ºä¸€ä»½sign_in_out.pyæ–‡ä»¶ï¼Œç®¡ç†ç™»é™†ç™»å‡º Djangoå†…ç½®çš„app django.contrib.authå·²ç»å®ç°äº†ç™»é™†éªŒè¯åŠŸèƒ½ï¼Œå¹¶ä¸”åœ¨æ•°æ®åº“ä¸­å®šä¹‰è¿‡ä¸€å¼ auth_userè¡¨ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å…¶æ–¹æ³• 1234567891011121314151617181920212223242526272829303132333435from django.http import JsonResponsefrom django.contrib.auth import authenticate, login, logout# ç™»å½•å¤„ç†def signin(request): # ä» HTTP POSTè¯·æ±‚ä¸­è·å–ç”¨æˆ·åã€å¯†ç å‚æ•° userName = request.POST.get('username') passWord = request.POST.get('password') # ä½¿ç”¨Django authåº“é‡Œçš„æ–¹æ³•æ ¡éªŒç”¨æˆ·åã€å¯†ç  user = authenticate(username=userName, password=passWord) # å¦‚æœèƒ½æ‰¾åˆ°ç”¨æˆ·ï¼Œå¹¶ä¸”å¯†ç æ­£ç¡® if user is not None: if user.is_active: if user.is_superuser: login(request, user) # åœ¨sessionä¸­å­˜å…¥ç”¨æˆ·ç±»å‹ request.session['usertype'] = 'mgr' return JsonResponse(&#123;'ret': 0&#125;) else: return JsonResponse(&#123;'ret': 1, 'msg': 'è¯·ä½¿ç”¨ç®¡ç†å‘˜è´¦æˆ·ç™»å½•'&#125;) else: return JsonResponse(&#123;'ret': 0, 'msg': 'ç”¨æˆ·å·²ç»è¢«ç¦ç”¨'&#125;) # å¦åˆ™ç”¨æˆ·åã€å¯†ç æœ‰è¯¯ else: return JsonResponse(&#123;'ret': 1, 'msg': 'ç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯'&#125;)# ç™»å‡ºå¤„ç†def signout(request): # ä½¿ç”¨ç™»å‡ºæ–¹æ³• logout(request) return JsonResponse(&#123;'ret': 0&#125;) å†åˆ°mgr/urls.pyä¸­æ·»åŠ urlè·¯ç”±12345678910from django.urls import pathfrom mgr import customerfrom mgr import sign_in_outurlpatterns = [ path('customers', customer.dispatcher), path('signin', sign_in_out.signin), path('signout', sign_in_out.signout),] åˆ°è¿™é‡Œç™»é™†åŠŸèƒ½å·²ç»å†™å¥½ï¼Œå¯¹å…¶è¿›è¡Œæµ‹è¯•ï¼Œåœ¨testæ–‡ä»¶å¤¹é‡Œæ–°å»ºæµ‹è¯•æ–‡ä»¶test_login.py12345678910import requests,pprintpayload = &#123; 'username': '9.9', 'password': '00000000'&#125;response = requests.post('http://localhost:8000/api/mgr/signin',data=payload)pprint.pprint(response.json()) å¦‚æœè¿”å›{â€˜retâ€™: 0}ï¼Œè¡¨ç¤ºæˆåŠŸç™»é™† å¦‚æœç™»é™†å¤±è´¥ï¼Œåˆ™è¿”å›{â€˜retâ€™: 1}ï¼Œå¹¶æŒ‡æ˜å¤±è´¥åŸå›  ç»§ç»­åœ¨Djangoç®¡ç†å‘˜åå°å¢åŠ æ–°çš„è®¿å®¢ç”¨æˆ· åˆ°testæ–‡ä»¶å¤¹é‡Œå†æ–°å»ºæµ‹è¯•æ–‡ä»¶test_user.pyæµ‹è¯•æ™®é€šè®¿å®¢ç™»å½•12345678910import requests,pprintpayload = &#123; 'username': 'guest', 'password': 'rtl1312693017'&#125;response = requests.post('http://localhost:8000/api/mgr/signin',data=payload)pprint.pprint(response.json()) ç³»ç»Ÿä¼šæç¤ºæ²¡æœ‰æƒé™è®¿é—® æœ€åå†é€šè¿‡ä¸å‰ç«¯æ–‡ä»¶è¿›è¡Œé›†æˆï¼Œå¾—åˆ°ä¼˜åŒ–åçš„ç™»é™†ç•Œé¢ï¼š æˆåŠŸç™»é™†åå°†è·³è½¬åˆ°ä¹‹å‰çš„å®¢æˆ·è®¢å•ç®¡ç†ç³»ç»Ÿ","categories":[{"name":"Python","slug":"Python","permalink":"http://yoursite.com/categories/Python/"}],"tags":[{"name":"Django","slug":"Django","permalink":"http://yoursite.com/tags/Django/"}]},{"title":"åŸºäºå·ç§¯ç¥ç»ç½‘ç»œçš„é¢éƒ¨å¹´é¾„è¯†åˆ«","slug":"åŸºäºå·ç§¯ç¥ç»ç½‘ç»œçš„é¢éƒ¨å¹´é¾„è¯†åˆ«","date":"2021-05-26T15:13:00.000Z","updated":"2022-06-27T07:41:11.298Z","comments":true,"path":"2021/05/26/åŸºäºå·ç§¯ç¥ç»ç½‘ç»œçš„é¢éƒ¨å¹´é¾„è¯†åˆ«/","link":"","permalink":"http://yoursite.com/2021/05/26/åŸºäºå·ç§¯ç¥ç»ç½‘ç»œçš„é¢éƒ¨å¹´é¾„è¯†åˆ«/","excerpt":"1.è®­ç»ƒæ¨¡å‹å’Œæ¡†æ¶1.1 Adienceæ•°æ®é›†Adienceå›¾ç‰‡é›†åŒ…æ‹¬Flickrç­‰ç›¸å†Œï¼Œé€šè¿‡ä»iPhone5ï¼ˆæˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰çš„æ™ºèƒ½æ‰‹æœºç­‰ç§»åŠ¨è®¾å¤‡è‡ªåŠ¨ä¸Šä¼ å¹¶è¿›è¡Œç»„è£…ï¼Œç”±å…¶ä½œè€…æ ¹æ®çŸ¥è¯†å…±äº«ï¼ˆCCï¼‰è®¸å¯å‘å…¬ä¼—å‘å¸ƒã€‚æ•°æ®é›†æä¾›äº†å…±è®¡26580å¼ é¢éƒ¨ç…§ç‰‡çš„æ•°æ®å’ŒåŸºå‡†ï¼Œæ—¨åœ¨å°½å¯èƒ½çœŸå®åœ°åº”å¯¹å®é™…æˆåƒå¹¶åšå‡ºåˆ¤æ–­ã€‚æ•°æ®çš„æ ‡ç­¾æœ‰å¹´é¾„ç»„ã€æ€§åˆ«ã€æˆ·å¤–ç­‰ï¼Œå¯ç”¨äºç›‘ç£å­¦ä¹ çš„äººè„¸è¯†åˆ«å¯¹å¹´é¾„çš„ç ”ç©¶ã€‚Adienceæ”¶å½•çš„æ•°æ®ä¿¡æ¯åŒ…æ‹¬ä¸»ä½“å¤–è§‚ã€åŠ¨ä½œã€å™ªç‚¹ã€å…‰çº¿ç­‰å®é™…æƒ…å†µä¸­è¿›è¡Œå›¾åƒé‡‡é›†æ—¶åŒ…å«çš„åŠ¨æ€å˜åŒ–ï¼Œå…·æœ‰ç¯å¢ƒé€‚åº”æ€§å¼ºã€åº”ç”¨èŒƒå›´å¹¿çš„ç‰¹ç‚¹ã€‚ 1.2 Caffeæ¡†æ¶Caffeï¼ˆConvolutional Architecture for Fast Feature Embeddingï¼‰é‡‡ç”¨CUDAæ¶æ„ï¼Œå¯åœ¨CPUå’ŒGPUä¸Šè¿›è¡Œé«˜é€Ÿè¿ç®—ï¼Œæ˜¯ä¸€ä¸ªå…¼å…·äº†æ•ˆç‡ã€è¡¨è¾¾å’Œæ€ç»´æ¨¡å—åŒ–çš„å·ç§¯ç¥ç»ç½‘ç»œæ¡†æ¶ã€‚ Caffeçš„æ•°æ®ç»“æ„ä»¥Blobs-Layers-Netçš„å½¢å¼å­˜åœ¨ã€‚ Blobsæ˜¯Caffeçš„æ ¸å¿ƒæ•°æ®æ ¼å¼ï¼Œæä¾›äº†ç»Ÿä¸€çš„å†…å­˜æ¥å£ï¼Œå¹¶ä¸”å¯ä»¥åœ¨CPUä¸GPUä¹‹é—´è¿›è¡Œæ•°æ®åŒæ­¥ã€‚ä¸»è¦é€šè¿‡å››ç»´å¼ é‡ï¼ˆNumberChannelweight*highï¼‰çš„å½¢å¼ï¼ŒæŒ‰ç…§C-contiguousæ–¹å¼ï¼ˆæ•°ç»„çš„è¡Œå­˜å‚¨è¿ç»­ä¸”ä¸é—´æ–­ï¼‰æ¥å­˜å‚¨å’Œäº¤æµç½‘ç»œä¸­çš„æƒé‡ã€æ¿€æ´»å€¼ã€æ­£åå‘æ•°æ®ã€‚ Layersæ˜¯Caffeæ¨¡å‹çš„å…³é”®å†…å®¹ï¼Œæ˜¯ç»„æˆç¥ç»ç½‘ç»œå’Œè¿›è¡Œç›¸å…³è®¡ç®—çš„åŸºç¡€ã€‚æ‰€æœ‰çš„Layerå±‚éƒ½å¯ä»¥æ¥æ”¶åº•å±‚è¾“å…¥çš„Blobsï¼Œå¹¶å‘é«˜å±‚è¾“å‡ºBlobsã€‚Layersæ¯ä¸€å±‚éƒ½å®šä¹‰ä¸‰ç§é‡è¦çš„è®¡ç®—ï¼šåˆå§‹åŒ–ï¼ˆSetupï¼‰ã€å‘å‰ä¼ æ’­ï¼ˆForwardï¼‰ã€å‘åä¼ æ’­ï¼ˆBackwardï¼‰ã€‚ å…¶åŒ…å«çš„è¿ç®—æœ‰ï¼š Â· 1.load dataï¼šæ•°æ®è½½å…¥ Â· 2.Convolve filtersï¼šå·ç§¯å±‚ï¼Œè¿›è¡Œå·ç§¯ã€‚ Â· 3.Poolingï¼šæ± åŒ–å±‚ï¼Œè¿›è¡Œæ± åŒ–ã€‚ Â· 4.Nonlinearitiesï¼šéçº¿æ€§æ˜ å°„è¿ç®—ï¼Œå³æ¿€æ´»å‡½æ•°ã€‚ Â· 5.Inner Productsï¼šå†…ç§¯è¿ç®—ã€‚ Â· 6.Normalizeï¼šå½’ä¸€åŒ– Â· 7.Compute lossesï¼šæŸå¤±å‡½æ•°è®¡ç®—ï¼Œå¦‚softmaxã€hingeã€‚ Netæ˜¯ä¸€ä¸ªç”±ä¸€ç³»åˆ—è¿æ¥çš„Layerå±‚ç»„æˆçš„æœ‰å‘æ— ç¯å›¾ï¼ˆDirected Acyclic Graphï¼ŒDAGï¼‰ã€‚caffeä¼šåœ¨å‘å‰ä¼ æ’­æˆ–å‘åä¼ æ’­æ—¶ï¼Œå¯¹DAGä¸­çš„æ‰€æœ‰å±‚è¿›è¡Œè®°å½•ï¼Œç¡®ä¿å…¶å‡†ç¡®æ€§ã€‚ 2.åŸºäºå·ç§¯ç¥ç»ç½‘ç»œçš„äººè„¸è¯†åˆ«2.1 å·ç§¯ç¥ç»ç½‘ç»œæ¶æ„ä½¿ç”¨çš„æ¶æ„åŒ…æ‹¬3ä¸ªå·ç§¯å±‚ã€2ä¸ªå…¨è¿æ¥å±‚å’Œ1ä¸ªæœ€ç»ˆè¾“å‡ºå±‚ã€‚å…·ä½“å®šä¹‰å·ç§¯å±‚å¦‚ä¸‹ï¼š 1.Conv1ï¼šå°†å†…æ ¸å¤§å°ä¸º337çš„å…±è®¡96ä¸ªåƒç´ èŠ‚ç‚¹çš„è¿‡æ»¤åº”ç”¨äºè¾“å…¥ç¬¬ä¸€å·ç§¯å±‚ä¸­ï¼Œç»è¿‡ä¿®æ­£çº¿æ€§å•å…ƒReLUï¼ˆæ¿€æ´»å‡½æ•°ï¼‰å¤„ç†åï¼Œæ± åŒ–å±‚é‡‡ç”¨ä¿ç•™æœ€å¤§å€¼ï¼ˆmax-poolingï¼‰çš„è§„åˆ™ï¼Œé€‰æ‹©ä¸€ä¸ªä¸¤åƒç´ è·¨åº¦çš„3*3åŒºåŸŸä¸­æœ€å¤§å€¼ï¼Œè¿›è¡Œæ± åŒ–ï¼Œå†ç»è¿‡å±€éƒ¨å“åº”å½’ä¸€åŒ–å±‚ï¼ˆLocal Response Normalizationï¼ŒLRNï¼‰ã€‚ 2.Conv2ï¼šä¸Šä¸€å±‚çš„è¾“å‡ºï¼ˆ96Ã—28Ã—28ï¼‰ç”±ç¬¬äºŒä¸ªå·ç§¯å±‚è¿›è¡Œå¤„ç†ï¼ŒåŒ…æ‹¬å¯¹256ä¸ªå¤§å°ä¸º9655çš„åƒç´ è¿‡æ»¤ã€‚åŒæ ·çš„ï¼Œç»è¿‡ä¸€ä¸ªä¿®æ­£çº¿æ€§å•å…ƒReLUï¼Œæœ€å¤§æ± åŒ–å±‚ï¼Œå’Œä¸€ä¸ªä¸ä¹‹å‰å‚æ•°ç›¸åŒçš„å±€éƒ¨å“åº”å½’ä¸€åŒ–å±‚ã€‚ 3.Conv3ï¼šç¬¬ä¸‰å±‚å·ç§¯å±‚é€šè¿‡å¯¹ä¸€ç»„384ä¸ªå¤§å°ä¸º25633çš„åƒç´ è¿‡æ»¤æ¥å¯¹256Ã—14Ã—14çš„ Blobè¿›è¡Œå¤„ç†ï¼Œæ¥ç€ç»è¿‡ä¿®æ­£çº¿æ€§å•å…ƒReLUå’Œä¸€ä¸ªæœ€å¤§æ± åŒ–å±‚ã€‚ å†é€šè¿‡ä¸‹åˆ—æ–¹å¼å®šä¹‰å®Œå…¨è¿æ¥å±‚ï¼š 1.ç¬¬ä¸€ä¸ªå®Œå…¨è¿æ¥å±‚åŒ…å«äº†512ä¸ªäººå·¥ç¥ç»å…ƒï¼Œç”¨äºæ¥æ”¶ç¬¬ä¸‰å·ç§¯å±‚çš„è¾“å‡ºç»“æœã€‚æ¥ç€å†é€šè¿‡ä¿®æ­£çº¿æ€§å•å…ƒReLUå’ŒDropoutå±‚ï¼ˆé˜²æ­¢CNNè¿‡æ‹Ÿåˆï¼‰ã€‚ 2.ç¬¬äºŒä¸ªå®Œå…¨è¿æ¥å±‚æ¥æ”¶ç¬¬ä¸€ä¸ªå®Œå…¨è¿æ¥å±‚çš„512ä¸ªäººå·¥ç¥ç»å…ƒç©ºé—´å¤§å°çš„è¾“å‡ºï¼ˆåŒæ ·åŒ…å«512ä¸ªäººå·¥ç¥ç»å…ƒï¼‰ï¼Œå†é€šè¿‡ä¿®æ­£çº¿æ€§å•å…ƒReLUå’ŒDropoutå±‚ã€‚ 3.ç¬¬ä¸‰å±‚å®Œå…¨è¿æ¥å±‚æ˜ å°„æœ€ç»ˆçš„åˆ†ç±»ç»“æœã€‚ æœ€ç»ˆï¼Œæœ€åä¸€ä¸ªå®Œå…¨è¿æ¥å±‚çš„è¾“å‡ºä¼šè¢«åé¦ˆåˆ°ä¸ºæ¯ä¸ªç±»åˆ«åˆ†é…æ¦‚ç‡çš„Softmaxå±‚ï¼Œé¢„æµ‹å…¶æœ¬èº«é€šè¿‡ç»™å®šçš„æµ‹è¯•å›¾åƒçš„æœ€å¤§æ¦‚ç‡ã€‚ 2.2 å¹´é¾„é¢„æµ‹äººçš„é¢éƒ¨ç‰¹å¾æ— æ—¶ä¸åˆ»å‘ç”Ÿç€å¾®å¦™å˜åŒ–åæ˜ å‡ºå…¶å¹´é¾„çš„ä¸æ–­å¢é•¿ï¼Œåœ¨æœ€ç†æƒ³çš„æƒ…å†µä¹‹ä¸‹ï¼Œäººçš„é¢éƒ¨ç‰¹å¾éšç€äººçš„æˆé•¿åº”è¯¥è¡¨ç°å‡ºæ­£ç›¸å…³çš„å…³ç³»ï¼Œé‚£ä¹ˆå¹´é¾„ä¼°è®¡å°±æ˜¯ä¸€ä¸ªå¹¿ä¹‰ä¸Šçš„å›å½’é—®é¢˜ã€‚ç„¶è€Œå®é™…ä¸Šä»…é€šè¿‡å›å½’çš„æ–¹æ³•æ¥åˆ¤æ–­ä¸€ä¸ªäººçš„å¹´é¾„æ˜¯é ä¸ä½çš„ï¼Œå³ä¾¿ä¸€ä¸ªæ­£å¸¸çš„è‡ªç„¶äººä¹Ÿå¾ˆéš¾æ¨æ–­å‡ºè§‚å¯Ÿå¯¹è±¡çš„å‡†ç¡®å®é™…å¹´é¾„ã€‚ ä½†æ˜¯äººçœ¼å¯ä»¥å¯¹è§‚å¯Ÿå¯¹è±¡åšå‡ºä¸€ä¸ªå¤§è‡´åˆ¤æ–­ï¼Œè¾ƒä¸ºå‡†ç¡®çš„é¢„æµ‹å‡ºå¯¹æ–¹çš„å¹´é¾„æ‰€åœ¨åŒºé—´ã€‚è¿™æ ·ï¼Œå°±å¯¹å¯¹æ–¹çš„å¹´é¾„æœ‰äº†åˆæ­¥ä¼°è®¡ã€‚è¿™æ ·ï¼Œå°±å¯ä»¥å¯¹å¹´é¾„åŒºé—´è¿›è¡Œä¸€ä¸ªåˆ†ç±»ï¼Œä»¥è¿›ä¸€æ­¥ç ”ç©¶äººè„¸å’Œå¹´é¾„çš„å…³ç³»ã€‚ Adienceæ•°æ®é›†å°†äººçš„å¹´é¾„åˆ’åˆ†ä¸ºäº†å…«ä¸ªç±»åˆ«ï¼Œåˆ†åˆ«ä¸ºï¼š[0-2]ã€[4-6]ã€[8-13]ã€[15-20]ã€[25-32]ã€[38-43]ã€[48-53]ã€[60 -]ã€‚å› æ­¤ï¼Œæ·±åº¦ç¥ç»ç½‘ç»œåœ¨æœ€ç»ˆçš„Softmaxå±‚ä¸­æœ‰8ä¸ªèŠ‚ç‚¹ï¼Œåˆ†åˆ«å¯¹å„å¹´é¾„æ®µè¿›è¡Œåˆ†ç±»ã€‚12MODEL_MEAN_VALUES = (78.4263377603, 87.7689143744, 114.895847746)ageList = ['(0-2)', '(4-6)', '(8-12)', '(15-20)', '(25-32)', '(38-43)', '(48-53)', '(60-100)'] Blobè¾“å…¥ç½‘ç»œè¿›è¡Œå¹´é¾„çš„æ£€æµ‹ï¼Œå¹¶ä¸”å¹´é¾„æ£€æµ‹ç¨‹åºå‘å‰ä¼ æ’­ã€‚123ageNet.setInput(blobs)agepredction = ageNet.forward()age = ageList[agepredction[0].argmax()]","text":"1.è®­ç»ƒæ¨¡å‹å’Œæ¡†æ¶1.1 Adienceæ•°æ®é›†Adienceå›¾ç‰‡é›†åŒ…æ‹¬Flickrç­‰ç›¸å†Œï¼Œé€šè¿‡ä»iPhone5ï¼ˆæˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰çš„æ™ºèƒ½æ‰‹æœºç­‰ç§»åŠ¨è®¾å¤‡è‡ªåŠ¨ä¸Šä¼ å¹¶è¿›è¡Œç»„è£…ï¼Œç”±å…¶ä½œè€…æ ¹æ®çŸ¥è¯†å…±äº«ï¼ˆCCï¼‰è®¸å¯å‘å…¬ä¼—å‘å¸ƒã€‚æ•°æ®é›†æä¾›äº†å…±è®¡26580å¼ é¢éƒ¨ç…§ç‰‡çš„æ•°æ®å’ŒåŸºå‡†ï¼Œæ—¨åœ¨å°½å¯èƒ½çœŸå®åœ°åº”å¯¹å®é™…æˆåƒå¹¶åšå‡ºåˆ¤æ–­ã€‚æ•°æ®çš„æ ‡ç­¾æœ‰å¹´é¾„ç»„ã€æ€§åˆ«ã€æˆ·å¤–ç­‰ï¼Œå¯ç”¨äºç›‘ç£å­¦ä¹ çš„äººè„¸è¯†åˆ«å¯¹å¹´é¾„çš„ç ”ç©¶ã€‚Adienceæ”¶å½•çš„æ•°æ®ä¿¡æ¯åŒ…æ‹¬ä¸»ä½“å¤–è§‚ã€åŠ¨ä½œã€å™ªç‚¹ã€å…‰çº¿ç­‰å®é™…æƒ…å†µä¸­è¿›è¡Œå›¾åƒé‡‡é›†æ—¶åŒ…å«çš„åŠ¨æ€å˜åŒ–ï¼Œå…·æœ‰ç¯å¢ƒé€‚åº”æ€§å¼ºã€åº”ç”¨èŒƒå›´å¹¿çš„ç‰¹ç‚¹ã€‚ 1.2 Caffeæ¡†æ¶Caffeï¼ˆConvolutional Architecture for Fast Feature Embeddingï¼‰é‡‡ç”¨CUDAæ¶æ„ï¼Œå¯åœ¨CPUå’ŒGPUä¸Šè¿›è¡Œé«˜é€Ÿè¿ç®—ï¼Œæ˜¯ä¸€ä¸ªå…¼å…·äº†æ•ˆç‡ã€è¡¨è¾¾å’Œæ€ç»´æ¨¡å—åŒ–çš„å·ç§¯ç¥ç»ç½‘ç»œæ¡†æ¶ã€‚ Caffeçš„æ•°æ®ç»“æ„ä»¥Blobs-Layers-Netçš„å½¢å¼å­˜åœ¨ã€‚ Blobsæ˜¯Caffeçš„æ ¸å¿ƒæ•°æ®æ ¼å¼ï¼Œæä¾›äº†ç»Ÿä¸€çš„å†…å­˜æ¥å£ï¼Œå¹¶ä¸”å¯ä»¥åœ¨CPUä¸GPUä¹‹é—´è¿›è¡Œæ•°æ®åŒæ­¥ã€‚ä¸»è¦é€šè¿‡å››ç»´å¼ é‡ï¼ˆNumberChannelweight*highï¼‰çš„å½¢å¼ï¼ŒæŒ‰ç…§C-contiguousæ–¹å¼ï¼ˆæ•°ç»„çš„è¡Œå­˜å‚¨è¿ç»­ä¸”ä¸é—´æ–­ï¼‰æ¥å­˜å‚¨å’Œäº¤æµç½‘ç»œä¸­çš„æƒé‡ã€æ¿€æ´»å€¼ã€æ­£åå‘æ•°æ®ã€‚ Layersæ˜¯Caffeæ¨¡å‹çš„å…³é”®å†…å®¹ï¼Œæ˜¯ç»„æˆç¥ç»ç½‘ç»œå’Œè¿›è¡Œç›¸å…³è®¡ç®—çš„åŸºç¡€ã€‚æ‰€æœ‰çš„Layerå±‚éƒ½å¯ä»¥æ¥æ”¶åº•å±‚è¾“å…¥çš„Blobsï¼Œå¹¶å‘é«˜å±‚è¾“å‡ºBlobsã€‚Layersæ¯ä¸€å±‚éƒ½å®šä¹‰ä¸‰ç§é‡è¦çš„è®¡ç®—ï¼šåˆå§‹åŒ–ï¼ˆSetupï¼‰ã€å‘å‰ä¼ æ’­ï¼ˆForwardï¼‰ã€å‘åä¼ æ’­ï¼ˆBackwardï¼‰ã€‚ å…¶åŒ…å«çš„è¿ç®—æœ‰ï¼š Â· 1.load dataï¼šæ•°æ®è½½å…¥ Â· 2.Convolve filtersï¼šå·ç§¯å±‚ï¼Œè¿›è¡Œå·ç§¯ã€‚ Â· 3.Poolingï¼šæ± åŒ–å±‚ï¼Œè¿›è¡Œæ± åŒ–ã€‚ Â· 4.Nonlinearitiesï¼šéçº¿æ€§æ˜ å°„è¿ç®—ï¼Œå³æ¿€æ´»å‡½æ•°ã€‚ Â· 5.Inner Productsï¼šå†…ç§¯è¿ç®—ã€‚ Â· 6.Normalizeï¼šå½’ä¸€åŒ– Â· 7.Compute lossesï¼šæŸå¤±å‡½æ•°è®¡ç®—ï¼Œå¦‚softmaxã€hingeã€‚ Netæ˜¯ä¸€ä¸ªç”±ä¸€ç³»åˆ—è¿æ¥çš„Layerå±‚ç»„æˆçš„æœ‰å‘æ— ç¯å›¾ï¼ˆDirected Acyclic Graphï¼ŒDAGï¼‰ã€‚caffeä¼šåœ¨å‘å‰ä¼ æ’­æˆ–å‘åä¼ æ’­æ—¶ï¼Œå¯¹DAGä¸­çš„æ‰€æœ‰å±‚è¿›è¡Œè®°å½•ï¼Œç¡®ä¿å…¶å‡†ç¡®æ€§ã€‚ 2.åŸºäºå·ç§¯ç¥ç»ç½‘ç»œçš„äººè„¸è¯†åˆ«2.1 å·ç§¯ç¥ç»ç½‘ç»œæ¶æ„ä½¿ç”¨çš„æ¶æ„åŒ…æ‹¬3ä¸ªå·ç§¯å±‚ã€2ä¸ªå…¨è¿æ¥å±‚å’Œ1ä¸ªæœ€ç»ˆè¾“å‡ºå±‚ã€‚å…·ä½“å®šä¹‰å·ç§¯å±‚å¦‚ä¸‹ï¼š 1.Conv1ï¼šå°†å†…æ ¸å¤§å°ä¸º337çš„å…±è®¡96ä¸ªåƒç´ èŠ‚ç‚¹çš„è¿‡æ»¤åº”ç”¨äºè¾“å…¥ç¬¬ä¸€å·ç§¯å±‚ä¸­ï¼Œç»è¿‡ä¿®æ­£çº¿æ€§å•å…ƒReLUï¼ˆæ¿€æ´»å‡½æ•°ï¼‰å¤„ç†åï¼Œæ± åŒ–å±‚é‡‡ç”¨ä¿ç•™æœ€å¤§å€¼ï¼ˆmax-poolingï¼‰çš„è§„åˆ™ï¼Œé€‰æ‹©ä¸€ä¸ªä¸¤åƒç´ è·¨åº¦çš„3*3åŒºåŸŸä¸­æœ€å¤§å€¼ï¼Œè¿›è¡Œæ± åŒ–ï¼Œå†ç»è¿‡å±€éƒ¨å“åº”å½’ä¸€åŒ–å±‚ï¼ˆLocal Response Normalizationï¼ŒLRNï¼‰ã€‚ 2.Conv2ï¼šä¸Šä¸€å±‚çš„è¾“å‡ºï¼ˆ96Ã—28Ã—28ï¼‰ç”±ç¬¬äºŒä¸ªå·ç§¯å±‚è¿›è¡Œå¤„ç†ï¼ŒåŒ…æ‹¬å¯¹256ä¸ªå¤§å°ä¸º9655çš„åƒç´ è¿‡æ»¤ã€‚åŒæ ·çš„ï¼Œç»è¿‡ä¸€ä¸ªä¿®æ­£çº¿æ€§å•å…ƒReLUï¼Œæœ€å¤§æ± åŒ–å±‚ï¼Œå’Œä¸€ä¸ªä¸ä¹‹å‰å‚æ•°ç›¸åŒçš„å±€éƒ¨å“åº”å½’ä¸€åŒ–å±‚ã€‚ 3.Conv3ï¼šç¬¬ä¸‰å±‚å·ç§¯å±‚é€šè¿‡å¯¹ä¸€ç»„384ä¸ªå¤§å°ä¸º25633çš„åƒç´ è¿‡æ»¤æ¥å¯¹256Ã—14Ã—14çš„ Blobè¿›è¡Œå¤„ç†ï¼Œæ¥ç€ç»è¿‡ä¿®æ­£çº¿æ€§å•å…ƒReLUå’Œä¸€ä¸ªæœ€å¤§æ± åŒ–å±‚ã€‚ å†é€šè¿‡ä¸‹åˆ—æ–¹å¼å®šä¹‰å®Œå…¨è¿æ¥å±‚ï¼š 1.ç¬¬ä¸€ä¸ªå®Œå…¨è¿æ¥å±‚åŒ…å«äº†512ä¸ªäººå·¥ç¥ç»å…ƒï¼Œç”¨äºæ¥æ”¶ç¬¬ä¸‰å·ç§¯å±‚çš„è¾“å‡ºç»“æœã€‚æ¥ç€å†é€šè¿‡ä¿®æ­£çº¿æ€§å•å…ƒReLUå’ŒDropoutå±‚ï¼ˆé˜²æ­¢CNNè¿‡æ‹Ÿåˆï¼‰ã€‚ 2.ç¬¬äºŒä¸ªå®Œå…¨è¿æ¥å±‚æ¥æ”¶ç¬¬ä¸€ä¸ªå®Œå…¨è¿æ¥å±‚çš„512ä¸ªäººå·¥ç¥ç»å…ƒç©ºé—´å¤§å°çš„è¾“å‡ºï¼ˆåŒæ ·åŒ…å«512ä¸ªäººå·¥ç¥ç»å…ƒï¼‰ï¼Œå†é€šè¿‡ä¿®æ­£çº¿æ€§å•å…ƒReLUå’ŒDropoutå±‚ã€‚ 3.ç¬¬ä¸‰å±‚å®Œå…¨è¿æ¥å±‚æ˜ å°„æœ€ç»ˆçš„åˆ†ç±»ç»“æœã€‚ æœ€ç»ˆï¼Œæœ€åä¸€ä¸ªå®Œå…¨è¿æ¥å±‚çš„è¾“å‡ºä¼šè¢«åé¦ˆåˆ°ä¸ºæ¯ä¸ªç±»åˆ«åˆ†é…æ¦‚ç‡çš„Softmaxå±‚ï¼Œé¢„æµ‹å…¶æœ¬èº«é€šè¿‡ç»™å®šçš„æµ‹è¯•å›¾åƒçš„æœ€å¤§æ¦‚ç‡ã€‚ 2.2 å¹´é¾„é¢„æµ‹äººçš„é¢éƒ¨ç‰¹å¾æ— æ—¶ä¸åˆ»å‘ç”Ÿç€å¾®å¦™å˜åŒ–åæ˜ å‡ºå…¶å¹´é¾„çš„ä¸æ–­å¢é•¿ï¼Œåœ¨æœ€ç†æƒ³çš„æƒ…å†µä¹‹ä¸‹ï¼Œäººçš„é¢éƒ¨ç‰¹å¾éšç€äººçš„æˆé•¿åº”è¯¥è¡¨ç°å‡ºæ­£ç›¸å…³çš„å…³ç³»ï¼Œé‚£ä¹ˆå¹´é¾„ä¼°è®¡å°±æ˜¯ä¸€ä¸ªå¹¿ä¹‰ä¸Šçš„å›å½’é—®é¢˜ã€‚ç„¶è€Œå®é™…ä¸Šä»…é€šè¿‡å›å½’çš„æ–¹æ³•æ¥åˆ¤æ–­ä¸€ä¸ªäººçš„å¹´é¾„æ˜¯é ä¸ä½çš„ï¼Œå³ä¾¿ä¸€ä¸ªæ­£å¸¸çš„è‡ªç„¶äººä¹Ÿå¾ˆéš¾æ¨æ–­å‡ºè§‚å¯Ÿå¯¹è±¡çš„å‡†ç¡®å®é™…å¹´é¾„ã€‚ ä½†æ˜¯äººçœ¼å¯ä»¥å¯¹è§‚å¯Ÿå¯¹è±¡åšå‡ºä¸€ä¸ªå¤§è‡´åˆ¤æ–­ï¼Œè¾ƒä¸ºå‡†ç¡®çš„é¢„æµ‹å‡ºå¯¹æ–¹çš„å¹´é¾„æ‰€åœ¨åŒºé—´ã€‚è¿™æ ·ï¼Œå°±å¯¹å¯¹æ–¹çš„å¹´é¾„æœ‰äº†åˆæ­¥ä¼°è®¡ã€‚è¿™æ ·ï¼Œå°±å¯ä»¥å¯¹å¹´é¾„åŒºé—´è¿›è¡Œä¸€ä¸ªåˆ†ç±»ï¼Œä»¥è¿›ä¸€æ­¥ç ”ç©¶äººè„¸å’Œå¹´é¾„çš„å…³ç³»ã€‚ Adienceæ•°æ®é›†å°†äººçš„å¹´é¾„åˆ’åˆ†ä¸ºäº†å…«ä¸ªç±»åˆ«ï¼Œåˆ†åˆ«ä¸ºï¼š[0-2]ã€[4-6]ã€[8-13]ã€[15-20]ã€[25-32]ã€[38-43]ã€[48-53]ã€[60 -]ã€‚å› æ­¤ï¼Œæ·±åº¦ç¥ç»ç½‘ç»œåœ¨æœ€ç»ˆçš„Softmaxå±‚ä¸­æœ‰8ä¸ªèŠ‚ç‚¹ï¼Œåˆ†åˆ«å¯¹å„å¹´é¾„æ®µè¿›è¡Œåˆ†ç±»ã€‚12MODEL_MEAN_VALUES = (78.4263377603, 87.7689143744, 114.895847746)ageList = ['(0-2)', '(4-6)', '(8-12)', '(15-20)', '(25-32)', '(38-43)', '(48-53)', '(60-100)'] Blobè¾“å…¥ç½‘ç»œè¿›è¡Œå¹´é¾„çš„æ£€æµ‹ï¼Œå¹¶ä¸”å¹´é¾„æ£€æµ‹ç¨‹åºå‘å‰ä¼ æ’­ã€‚123ageNet.setInput(blobs)agepredction = ageNet.forward()age = ageList[agepredction[0].argmax()] 3.è®¡ç®—æœºè§†è§‰æŠ€æœ¯ä¸ç³»ç»Ÿçš„è¿è¡Œæµ‹è¯•3.1 OpenCVOpenCVæ˜¯åŸºäºä¼¯å…‹åˆ©è½¯ä»¶å¥—ä»¶ï¼ˆBerkeley Software Distributionï¼ŒBSDï¼‰è®¸å¯å‘è¡Œçš„ä¸€ä¸ªå¼€æºçš„è·¨å¹³å°è®¡ç®—æœºè§†è§‰åº“ï¼Œå…¶æœ¬èº«ç”±C++è¯­è¨€å’ŒCå‡½æ•°ç¼–å†™ï¼ŒåŒæ—¶æä¾›äº†Pythonã€JAVAã€MATLABç­‰è¯­è¨€çš„æ¥å£ï¼Œèƒ½å¤Ÿè¿è¡Œè®¡ç®—æœºè§†è§‰çš„ä¸€ç³»åˆ—ç®—æ³•ï¼Œå¯¹å›¾åƒè¿›è¡Œå¤„ç†ã€‚ è¦åœ¨pythonç¯å¢ƒä¸‹ä½¿ç”¨OpenCVè§†è§‰åº“ï¼Œå¯ä»¥é€šè¿‡pipæ‰§è¡Œå‘½ä»¤â€œpip install opencv-pythonâ€œæ¥å®‰è£…OpenCVæ¨¡å—ã€‚ å®‰è£…å®Œæˆä»¥åï¼Œåœ¨Pythonä¸­å¯¼å…¥æ¨¡å—ã€‚ 3.2 å›¾åƒä¾¦æµ‹ä½¿ç”¨OpenCVä¸­çš„DNNäººè„¸ä¾¦æµ‹æ¨¡å—å¯¹äººè„¸çš„å›¾åƒè¿›è¡Œä¾¦æµ‹å’Œè·å–ï¼ŒOpenCVä¸ºè¯¥æ£€æµ‹å™¨æä¾›äº†Caffeå®æ–½çš„16ä½æµ®ç‚¹æ•°ç‰ˆæœ¬ã€‚å…¶ä¼˜ç‚¹æœ‰ï¼š Â· 1.åœ¨CPUä¸Šå®æ—¶è¿è¡Œã€‚ Â· 2.å³ä½¿åœ¨ä¸¥é‡é®æŒ¡ä¸‹ä¹Ÿå¯ä»¥å·¥ä½œã€‚ Â· 3.èƒ½å¤Ÿæ£€æµ‹å„ç§æ¯”ä¾‹çš„é¢éƒ¨ã€‚ Â· 4.é€‚ç”¨ä¸åŒçš„è„¸éƒ¨æœå‘ï¼Œå¦‚ä¸Šã€ä¸‹ã€å·¦ã€å³å’Œä¾§é¢ç­‰ã€‚ æ•´ä¸ªé¢éƒ¨æ£€æµ‹çš„åŠŸèƒ½ä½¿ç”¨å‡½æ•°â€œgetFaceBoxâ€å®Œæˆï¼ŒåŒ…å«ä¿¡å·é‡å‚æ•°â€œnetâ€œã€å›¾åƒå‚æ•°â€œframeâ€œå’Œé˜ˆå€¼å‚æ•°â€œconf_thresholdâ€ã€‚å°†å›¾åƒè½¬åŒ–ä¸ºblobï¼Œå…¶ä¸­â€œblobFromImageâ€å‡½æ•°ç”¨äºå‡å‡å€¼ã€å›¾åƒç¼©æ”¾å’Œè¿›è¡Œé€šé“äº¤æ¢ï¼ˆç”±äºopencvä¸­çš„å›¾åƒå­˜å‚¨éƒ½æ˜¯åŸºäºBGRé€šé“ï¼Œæ‰€ä»¥éœ€è¦å°†åŸæœ¬çš„RGBé€šé“æ›¿æ¢ä¸ºBGRé€šé“ï¼‰ã€‚1234567import cv2def getFaceBox(net, frame, threshold_conf=0.7): bounding_OpencvDnn = frame.copy() bounding_Height = bounding_OpencvDnn.shape[0] bounding_Width = bounding_OpencvDnn.shape[1] blobs = cv2.dnn.blobFromImage(bounding_OpencvDnn, 1.0, (300, 300), [104, 117, 123], True, False) ä¾¦æµ‹äººè„¸çš„ç½‘ç»œå‘å‰ä¼ é€’ã€‚æ¥ç€è¿›è¡Œäººè„¸è¯†åˆ«æ¡†bounding boxçš„ç»˜åˆ¶ï¼Œè®¾ç½®bounding boxçš„åæ ‡åˆ†åˆ«ä¸ºx1ã€y1ï¼Œx2ã€y2ã€‚è¾“å‡ºæ£€æµ‹æ˜¯ä¸€ä¸ª4-DçŸ©é˜µï¼Œå…¶ä¸­iæ˜¯é¢éƒ¨çš„è¿­ä»£å™¨ï¼Œç¬¬ä¸‰ç»´ç”¨äºéå†æ£€æµ‹åˆ°çš„é¢éƒ¨æ•°æ®ï¼Œç¬¬å››ç»´åŒ…å«äº†æ¯ä¸ªé¢çš„è¾¹ç•Œæ¡†å’Œåˆ†æ•°ä¿¡æ¯ã€‚ç”±äºè¯†åˆ«æ¡†çš„è¾“å‡ºåæ ‡ä¼šåœ¨[0,1]é—´è¿›è¡Œå½’ä¸€åŒ–ï¼Œæ‰€ä»¥ï¼Œä¸ºäº†è·å¾—æ­£ç¡®çš„bounding boxï¼Œéœ€è¦å°†åæ ‡å†ä¹˜ä»¥åŸå§‹å›¾åƒçš„å®½åº¦å’Œé«˜åº¦ã€‚12345678910111213net.setInput(blobs)detections = net.forward()bounding_bboxes = []for i in range(detections.shape[2]): confidence = detections[0, 0, i, 2] if confidence &gt; threshold_conf: x1 = int(detections[0, 0, i, 3] * bounding_Width) y1 = int(detections[0, 0, i, 4] * bounding_Height) x2 = int(detections[0, 0, i, 5] * bounding_Width) y2 = int(detections[0, 0, i, 6] * bounding_Height) bounding_bboxes.append([x1, y1, x2, y2]) cv2.rectangle(bounding_OpencvDnn, (x1, y1), (x2, y2), (0, 255, 0), int(round(bounding_Height/150)), 8)return bounding_OpencvDnn, bounding_bboxes 3.3 è¾“å…¥å°†è¯†åˆ«çš„æºå›¾ç‰‡ä½ç½®å­˜æ”¾åœ¨å­—ç¬¦ä¸²strå½“ä¸­ï¼Œè°ƒç”¨OpenCVä¸­çš„å‡½æ•°imread()æ¥è¯»å–å›¾ç‰‡ï¼Œå®Œæˆå›¾åƒçš„è¾“å…¥ã€‚å¹¶æˆªå–æ–‡ä»¶çš„è·¯å¾„åªä¿ç•™æ–‡ä»¶åï¼Œæ–¹ä¾¿åç»­è¾“å‡ºã€‚123str = \"C:\\\\Users\\\\elbadaernU9.9\\\\Desktop\\\\test.png\"frame = cv2.imread(str)name = str[31:] ä½¿ç”¨OpenCVåº“ï¼Œå¯¼å…¥ç½‘ç»œæ¨¡å‹å’Œé¢„è®­ç»ƒæ¨¡å‹ï¼Œåœ¨Caffeæ¡†æ¶ä¸‹å¯¹Adienceæ•°æ®é›†è¿›è¡Œæ¨¡å‹çš„è®­ç»ƒã€‚12345faceProto = \"opencv_face_detector.pbtxt\"faceModel = \"opencv_face_detector_uint8.pb\"ageProto = \"age_deploy.prototxt\"ageModel = \"age_net.caffemodel\" 5.4 æµ‹è¯•è¾“å‡ºæœ€åä½¿ç”¨imshow()å‡½æ•°åœ¨è¾“å…¥çš„å›¾åƒä¸Šæ˜¾ç¤ºç½‘ç»œçš„è¾“å‡ºï¼ŒåŒ…æ‹¬è¯†åˆ«æ¡†bounding boxã€åˆ†ç±»ï¼ˆé¢„æµ‹ï¼‰çš„æœ€ç»ˆç»“æœã€‚ä¸ºäº†ä½¿å›¾åƒæ­£å¸¸æ˜¾ç¤ºï¼Œéœ€è¦æ·»åŠ ä¸€è¡Œä»£ç â€œcv2.waitKey(1)â€ï¼Œå¹¶è®¾ç½®æ˜¾ç¤ºçš„æ—¶é—´ä¸º5ç§’ã€‚é€šè¿‡imwrite()å‡½æ•°ä¿å­˜è¾“å‡ºçš„ç»“æœã€‚è‡³æ­¤ï¼Œä¸»è¦çš„å¹´é¾„è¯†åˆ«ç³»ç»Ÿç¼–å†™å®Œæˆã€‚12345label = \"&#123;&#125;,&#123;&#125;\".format(gender, age)cv2.putText(frameFace, label, (bounding_bbox[0], bounding_bbox[1]-10), cv2.FONT_HERSHEY_SIMPLEX, 0.8, (0, 255, 255), 2, cv2.LINE_AA)cv2.imshow(\"Age &amp; Gender Prediction Demo\", frameFace)cv2.imwrite(\"age-gender-out-&#123;&#125;\".format(args.input),frameFace)time.sleep(5) 5.5 æ‹“å±•ç³»ç»Ÿåˆæ­¥çš„å¹´é¾„ä¼°è®¡åŠŸèƒ½å®ç°ä»¥åï¼Œå¼€å§‹å¯¹ç³»ç»Ÿè¿›è¡Œè¿›ä¸€æ­¥çš„ä¼˜åŒ–å’ŒåŠŸèƒ½æ‹“å±•ã€‚ ç”±äºåŸç³»ç»Ÿçš„å›¾åƒè¾“å…¥æ˜¯ä»¥ä¿å­˜çš„å›¾ç‰‡å½¢å¼å¯¼å…¥çš„ï¼Œåœ¨å®é™…åº”ç”¨å½“ä¸­æ²¡æœ‰äº‹å…ˆä¿å­˜æºå›¾åƒæ–‡ä»¶çš„æƒ…å†µä¸‹å°±ä¼šæœ‰è¯¸å¤šä¸ä¾¿ã€‚æ‰€ä»¥å°è¯•å°†å›¾åƒçš„è¾“å…¥å½¢å¼åšä¸€ä¸ªåŠ¨æ€çš„æ‹“å±•ï¼Œç”±é™æ€çš„å›¾ç‰‡å½¢å¼è¡¥å……ä¸ºæ‘„åƒå¤´åŠ¨æ€æ•æ‰äººåƒã€‚ é€šè¿‡è°ƒç”¨OpenCVå¯åŠ¨æ‘„åƒå¤´çš„å‡½æ•°ï¼Œä½¿ç³»ç»Ÿè‡ªåŠ¨æ•è·äººè„¸ï¼ŒåŒæ—¶ä¿ç•™å›¾ç‰‡è¾“å…¥çš„åŠŸèƒ½ï¼ˆä½¿ç”¨Doså‘½ä»¤å®ç°ï¼‰ã€‚12345678cap = cv2.VideoCapture(args.input if args.input else 0)padding = 20while cv2.waitKey(1) &lt; 0: t = time.time() hasFrame, frame = cap.read() if not hasFrame: cv2.waitKey() break ç”±äºAdienceæ•°æ®é›†åŒæ ·åŒ…å«äº†æ€§åˆ«çš„æ ‡ç­¾ï¼Œå¯ä»¥åœ¨å¹´é¾„ä¼°è®¡çš„åŒæ—¶ä¸ºç³»ç»Ÿæ·»åŠ æ€§åˆ«é¢„æµ‹åŠŸèƒ½çš„ä»£ç ã€‚12345678910genderProto = \"gender_deploy.prototxt\"genderModel = \"gender_net.caffemodel\"genderList = ['Male', 'Female']genderNet = cv2.dnn.readNet(genderModel, genderProto)genderNet.setInput(blobs)genderPredction = genderNet.forward()label = \"&#123;&#125;,&#123;&#125;\".format(gender, age) å®Œæˆååœ¨Pycharmä¸­å°†é¡¹ç›®å°è£…ä¸º.exeå¯æ‰§è¡Œæ–‡ä»¶ã€‚ å¾—åˆ°æœ€ç»ˆçš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š å®Œæ•´çš„äººè„¸è¯†åˆ«ç¨‹åºä»£ç ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192import timeimport argparseimport cv2def getFaceBox(net, frame, threshold_conf=0.7): bounding_OpencvDnn = frame.copy() bounding_Height = bounding_OpencvDnn.shape[0] bounding_Width = bounding_OpencvDnn.shape[1] blobs = cv2.dnn.blobFromImage(bounding_OpencvDnn, 1.0, (300, 300), [104, 117, 123], True, False) net.setInput(blobs) detections = net.forward() bounding_bboxes = [] for i in range(detections.shape[2]): confidence = detections[0, 0, i, 2] if confidence &gt; threshold_conf: x1 = int(detections[0, 0, i, 3] * bounding_Width) y1 = int(detections[0, 0, i, 4] * bounding_Height) x2 = int(detections[0, 0, i, 5] * bounding_Width) y2 = int(detections[0, 0, i, 6] * bounding_Height) bounding_bboxes.append([x1, y1, x2, y2]) cv2.rectangle(bounding_OpencvDnn, (x1, y1), (x2, y2), (0, 255, 0), int(round(bounding_Height/150)), 8) return bounding_OpencvDnn, bounding_bboxesparser = argparse.ArgumentParser(description='Use this script to run age and gender recognition using OpenCV.')parser.add_argument('--input', help='Path to input image or video file. Skip this argument to capture frames from a camera.')args = parser.parse_args()faceProto = \"opencv_face_detector.pbtxt\"faceModel = \"opencv_face_detector_uint8.pb\"ageProto = \"age_deploy.prototxt\"ageModel = \"age_net.caffemodel\"genderProto = \"gender_deploy.prototxt\"genderModel = \"gender_net.caffemodel\"MODEL_MEAN_VALUES = (78.4263377603, 87.7689143744, 114.895847746)ageList = ['(0-2)', '(4-6)', '(8-12)', '(15-20)', '(25-32)', '(38-43)', '(48-53)', '(60-100)']genderList = ['Male', 'Female']#genderList.decode(\"utf-8\")# Load networkageNet = cv2.dnn.readNet(ageModel, ageProto)genderNet = cv2.dnn.readNet(genderModel, genderProto)faceNet = cv2.dnn.readNet(faceModel, faceProto)# Open a video file or an image file or a camera streamcap = cv2.VideoCapture(args.input if args.input else 0)padding = 20while cv2.waitKey(1) &lt; 0: # Read frame t = time.time() hasFrame, frame = cap.read() if not hasFrame: cv2.waitKey() break frameFace, bounding_bboxes = getFaceBox(faceNet, frame) if not bounding_bboxes: print(\"No face Detected, Checking next frame\") continue for bounding_bbox in bounding_bboxes: print(\"=====================================Face Found=====================================\") # print(bounding_bbox) face = frame[max(0,bounding_bbox[1]-padding):min(bounding_bbox[3]+padding,frame.shape[0]-1),max(0,bounding_bbox[0]-padding):min(bounding_bbox[2]+padding, frame.shape[1]-1)] blobs = cv2.dnn.blobFromImage(face, 1.0, (227, 227), MODEL_MEAN_VALUES, swapRB=False) genderNet.setInput(blobs) genderPredction = genderNet.forward() gender = genderList[genderPredction[0].argmax()] # print(\"Gender Output : &#123;&#125;\".format(genderPredction)) print(\"Gender : &#123;&#125;, conf = &#123;:.3f&#125;\".format(gender, genderPredction[0].max())) ageNet.setInput(blobs) agepredction = ageNet.forward() age = ageList[agepredction[0].argmax()] print(\"Age Output : &#123;&#125;\".format(agepredction)) print(\"Age : &#123;&#125;, conf = &#123;:.3f&#125;\".format(age, agepredction[0].max())) label = \"&#123;&#125;,&#123;&#125;\".format(gender, age) cv2.putText(frameFace, label, (bounding_bbox[0], bounding_bbox[1]-10), cv2.FONT_HERSHEY_SIMPLEX, 0.8, (0, 255, 255), 2, cv2.LINE_AA) cv2.imshow(\"Age &amp; Gender Prediction Demo\", frameFace) # cv2.imwrite(\"age-gender-out-&#123;&#125;\".format(args.input),frameFace) print(\"time : &#123;:.3f&#125;\".format(time.time() - t)) print(\"=====================================Round Over=====================================\") (æœ¬æ–‡èŠ‚é€‰è‡ªæˆ‘çš„æ¯•ä¸šè®ºæ–‡ï¼Œæœ‰åˆ æ”¹)ç›¸å…³ä»£ç å’Œè®­ç»ƒé›†å·²æ‰“åŒ…è‡³githubï¼šhttps://github.com/elbadaernU404/AgeGenderPredictionDemo","categories":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://yoursite.com/categories/æœºå™¨å­¦ä¹ /"}],"tags":[{"name":"CNN","slug":"CNN","permalink":"http://yoursite.com/tags/CNN/"}]},{"title":"å·ç§¯ç¥ç»ç½‘ç»œç®—æ³•","slug":"å·ç§¯ç¥ç»ç½‘ç»œç®—æ³•","date":"2021-05-25T05:01:35.000Z","updated":"2023-08-09T08:32:52.615Z","comments":true,"path":"2021/05/25/å·ç§¯ç¥ç»ç½‘ç»œç®—æ³•/","link":"","permalink":"http://yoursite.com/2021/05/25/å·ç§¯ç¥ç»ç½‘ç»œç®—æ³•/","excerpt":"ç¥ç»ç½‘ç»œ(Neural Networksï¼ŒNN)æ˜¯äººå·¥æ™ºèƒ½ç ”ç©¶é¢†åŸŸçš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œæ˜¯å¤§æ•°æ®ä¸äººå·¥æ™ºèƒ½æŠ€æœ¯å‘å±•çš„é‡è¦åŠ¨åŠ›ã€‚ 1.å·ç§¯ç¥ç»ç½‘ç»œå·ç§¯ç¥ç»ç½‘ç»œå±äºæœºå™¨å­¦ä¹ é¢†åŸŸå½“ä¸­çš„æ·±åº¦å­¦ä¹ æŠ€æœ¯ï¼Œæ˜¯ä¸€ç±»åŒ…å«äº†å·ç§¯è®¡ç®—å¹¶ä¸”å…·æœ‰æ·±åº¦ç»“æ„çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆFeedforward Neural Networksï¼‰ã€‚ç”±çº½çº¦å¤§å­¦æ•™æˆYann LeCunåœ¨1998å¹´æå‡ºï¼Œä¸»è¦åº”ç”¨äºè¯­éŸ³è¯†åˆ«ã€è®¡ç®—æœºè§†è§‰ã€è‡ªç„¶è¯­è¨€å¤„ç†ç­‰é¢†åŸŸã€‚ å…¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªé‡‡ç”¨äº†å±€éƒ¨è¿æ¥å’Œæƒå€¼å…±äº«æ–¹å¼çš„å¤šå±‚æ„ŸçŸ¥æœºï¼ŒåŒ…æ‹¬ä¸€èˆ¬çš„å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰å’Œæ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œï¼ˆDeep Convolutional Neural Networks, DCNNï¼‰ï¼Œé€šå¸¸ä¸åšç‰¹æ„åŒºåˆ†ã€‚ä¸€èˆ¬çš„å·ç§¯ç¥ç»ç½‘ç»œå­˜åœ¨æµ…å±‚ç»“æ„ï¼Œä½†å‡†ç¡®æ€§å’Œè¡¨ç°åŠ›ç›¸å¯¹ä¸è¶³ï¼Œæ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œå¯ä»¥è‡ªåŠ¨ä»å¤§è§„æ¨¡çš„æ•°æ®ä¸­è¿›è¡Œç‰¹å¾å­¦ä¹ ï¼Œä¸”å…·å¤‡å°†ç»“æœå‘åŒç±»å‹çš„æœªçŸ¥æ•°æ®æ³›åŒ–çš„èƒ½åŠ›ï¼Œæ˜¯ç›®å‰æœ€å¸¸ç”¨çš„ç¥ç»ç½‘ç»œæŠ€æœ¯ã€‚ 2.å·ç§¯ç¥ç»ç½‘ç»œåŸç†2.1 å·ç§¯åŸç†ä»æ•°å­¦çš„è§’åº¦å‡ºå‘ï¼Œåˆ†ææ•°å­¦ä¸­å®šä¹‰ä¸€ç§è¿ç®—ï¼Œç§°(f*g)(n)ä¸º(fï¼Œg)çš„å·ç§¯ï¼ˆConvolutionï¼‰ã€‚å…¶è¿ç»­çš„å®šä¹‰ä¸ºï¼š å…¶ç¦»æ•£çš„å®šä¹‰ä¸ºï¼š å…¶è¿ç»­å’Œç¦»æ•£å…·æœ‰å…±åŒçš„ç‰¹å¾ï¼šn=Ï„+(n-Ï„)ï¼Œå½“ä»¤x=Ï„ï¼Œy=n-Ï„æ—¶ï¼Œæœ‰ç›´çº¿ï¼šx+y=nï¼Œå…¶å›¾åƒä¸ºå¦‚ä¸‹å›¾ï¼š å¦‚æœéå†è¿™äº›ç›´çº¿ï¼Œå°±ç±»ä¼¼äºæ²¿ç›´çº¿å·èµ·æ¯›å·¾çš„è¿‡ç¨‹ã€‚ ä¸‹é¢å°†å·ç§¯æ‰©å±•åˆ°äºŒç»´ï¼Œæœ‰ä¸¤ä¸ªR2â†’Rçš„äºŒå…ƒå‡½æ•°f(xï¼Œy)å’Œg(xï¼Œy)ï¼Œé‚£ä¹ˆä»¤få’Œgçš„å·ç§¯å°±æ˜¯ä¸€ä¸ªæ–°çš„R2â†’Rçš„äºŒå…ƒå‡½æ•°c(xï¼Œy)ï¼š å…¶å«ä¹‰ä¸ºå°†fåœ¨(sï¼Œt)ä¸Šçš„å€¼ä¹˜ä»¥gåœ¨(x-sï¼Œy-t)ä¸Šçš„å€¼ï¼Œå†éå†ä»-âˆåˆ°+âˆå…¨éƒ¨så’Œtçš„å€¼ï¼Œè¿›è¡Œfå’Œgç§¯åˆ†æ„ä¹‰ä¸Šçš„åŠ å’Œï¼Œæœ€ç»ˆå¾—åˆ°cåœ¨(xï¼Œy)ä¸Šçš„å€¼ï¼ˆäºŒé‡ç§¯åˆ†ï¼‰ã€‚ å¯ä»¥çœ‹å‡ºè¿™ç§åŠ å’Œæ˜¯ä¸€ç§åŠ æƒæ±‚å’Œï¼Œå³ä»¥fä¸ºæƒï¼Œ(xï¼Œy)ä¸ºä¸­å¿ƒï¼Œå°†fåœ¨(sï¼Œt)ä¸Šçš„å€¼ä¹˜ä»¥gè·ç¦»ä¸­å¿ƒ(-sï¼Œ-t)ä¸Šçš„å€¼å†ç›¸åŠ ã€‚ å…¶ç¦»æ•£çš„è¡¨ç¤ºå½¢å¼ä¸ºï¼š 2.2 ç¥ç»å…ƒç¥ç»ç»†èƒæœ‰ä¼—å¤šçš„æ ‘çªå’Œä¸€ä¸ªä¼¸é•¿çš„è½´çªï¼Œä¸åŒç¥ç»å…ƒä¹‹é—´é€šè¿‡æ ‘çªè¿æ¥è½´çªçš„æ–¹å¼ï¼Œå¹¶é€šè¿‡ç¥ç»è„‰å†²çš„ä¼ å¯¼è¿›è¡Œç»†èƒé—´äº¤æµã€‚å…·ä½“è¿‡ç¨‹ä¸ºç¥ç»ç»†èƒAçš„è½´çªè¿æ¥åˆ°ç¥ç»ç»†èƒBçš„æ ‘çªï¼Œä¼ å¯¼ç¥ç»è„‰å†²ï¼Œç¥ç»ç»†èƒAæ ¹æ®å…¶æ ‘çªä¼ é€’æ¥çš„ä¿¡å·å†³å®šæ˜¯å¦é€šè¿‡è½´çªæ¥å‘ä¸‹ä¸€ä¸ªç¥ç»ç»†èƒCä¼ é€’ä¿¡æ¯ã€‚ 1943å¹´ï¼Œç¾å›½å¿ƒç†å­¦å®¶W.McCullochå’Œæ•°å­¦å®¶W.Pittsæ ¹æ®ç”Ÿç‰©ç¥ç»å…ƒã€ç”Ÿç‰©ç”µå’Œç”Ÿç‰©åŒ–å­¦çš„è¿è¡Œæœºç†æå‡ºäº†äºŒå€¼ç¥ç»å…ƒçš„æ•°å­¦æ¨¡å‹ï¼Œå³ç¥ç»ç»†èƒæœºèƒ½çš„ç®€å•åŒ–çš„æ•°ç†æ¨¡å‹ï¼Œè¢«ç§°ä½œè«å…‹ç½—-å½¼ç‰¹æ°ç¥ç»æ¨¡å‹ï¼ˆMcCullochï¼Pittsâ€²Neuron Modelï¼‰ï¼Œä¹Ÿå«äººå·¥ç¥ç»å…ƒæ¨¡å‹ã€‚ ä¸€ä¸ªäººå·¥ç¥ç»å…ƒæ¨¡å‹å°±æ˜¯å¯¹ç”Ÿç‰©ç¥ç»å…ƒçš„æ•°å­¦å»ºæ¨¡ï¼š å…¶ä¸­X1ã€X2ã€X3ã€â€¦ã€Xnåˆ†åˆ«æ˜¯ä»å…¶ä»–ç¥ç»å…ƒä¼ å…¥çš„è¾“å…¥ä¿¡å·ï¼ŒWi1ã€Wi2ã€Wi3ã€â€¦ã€Winåˆ†åˆ«æ˜¯å¯¹åº”X1ã€X2ã€X3ã€â€¦ã€Xnçš„æƒé‡ã€‚Î¸è¡¨ç¤ºä¸€ä¸ªé˜ˆå€¼ï¼Œæˆ–ç§°ä¸ºåç½®ï¼ˆBiasï¼‰ï¼Œå…¶è®¾ç½®ç›®çš„æ˜¯æ­£ç¡®å°†æ ·æœ¬åˆ†ç±»ã€‚ç¥ç»å…ƒå½“å‰çš„è¾“å…¥ä¿¡å·å’Œåç½®ç›¸åŠ åäº§ç”Ÿå½“å‰ç¥ç»å…ƒçš„æœ€ç»ˆå¤„ç†ä¿¡å·Netï¼Œç§°ä¸ºå‡€æ¿€æ´»æˆ–å‡€æ¿€åŠ±ï¼ˆNet Activationï¼‰ï¼Œå¹¶ä½œä¸ºæ¿€æ´»å‡½æ•°æˆ–æ¿€åŠ±å‡½æ•°ï¼ˆActivation Functionï¼‰fçš„è¾“å…¥ï¼Œå³fï¼ˆnetï¼‰ï¼Œæœ€ç»ˆå¾—åˆ°å¯¹åº”çš„è¾“å‡ºyiã€‚å½¢å¦‚ï¼š æ¿€æ´»å‡½æ•°fï¼ˆnetï¼‰çš„ä½œç”¨æ˜¯é€šè¿‡åŠ å…¥éçº¿æ€§å› ç´ æ¥è§£å†³çº¿æ€§æ¨¡å‹çš„è¡¨è¾¾å’Œåˆ†ç±»èƒ½åŠ›ä¸è¶³çš„é—®é¢˜ã€‚å¸¸è§çš„æ¿€æ´»å‡½æ•°æœ‰ï¼š 1.LinearLinearæ˜¯ä¸€ä¸ªçº¿æ€§æ¿€æ´»å‡½æ•°ï¼šf(x)=âˆ‘i xiwi+bã€‚æœ¬è´¨ä¸Šå°±æ˜¯å¯¹è¾“å…¥çš„åŠ æƒæ±‚å’Œå†åŠ ä¸Šåç½®ï¼Œæ‰€ä»¥ç›¸å¯¹ç®€å•ï¼ŒåŠŸèƒ½è¾ƒä¸ºå•ä¸€ã€‚ ç”±äºå¤šä¸ªçŸ©é˜µè¿›è¡Œè¿ä¹˜çš„ç»“æœä»æ˜¯çŸ©é˜µï¼Œç±»ä¼¼çš„ï¼Œå¦‚æœä¸€ä¸ªç¥ç»ç½‘ç»œä¸­ä»…ä½¿ç”¨çº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œé‚£ä¹ˆå°±åªèƒ½å­¦ä¹ åˆ°çº¿æ€§å‡½æ•°ã€‚ 2.SigmoidSigmoidæ˜¯åœ¨ç¥ç»ç½‘ç»œç ”ç©¶çš„åˆå§‹é˜¶æ®µå°±è¢«æŠ•å…¥äº†å¹¿æ³›ä½¿ç”¨çš„ä¸€ä¸ªç»å…¸çš„éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œå…¶è¡¨è¾¾å¼æ˜¯ä¸€ç§é€»è¾‘æ–¯è’‚å‡½æ•°ï¼ˆLogistic Functionï¼‰ï¼š å…¶ä¸­x=âˆ‘i xiwi+b è¿™ä¸ªå‡½æ•°åœ¨å‡½æ•°çš„åŒºåŸŸå†…æ˜¯å®Œå…¨å¯å¯¼çš„ï¼Œè¾“å‡ºä¸º0åˆ°1èŒƒå›´å†…çš„æ­£å€¼ï¼ˆè¢«è¯å®ä¸æ˜“äºç¥ç»ç½‘ç»œå¯¹æ”¶æ•›çš„å­¦ä¹ ï¼‰ï¼Œå¹¶ä¸”å¯¹äºæ¥è¿‘0å’Œ1çš„å‡½æ•°éƒ¨åˆ†ï¼Œå¯¼æ•°æ— é™è¶‹è¿‘äº0ï¼Œå­˜åœ¨æ˜æ˜¾çš„æ¢¯åº¦è¡°å‡é—®é¢˜ã€‚æ‰€ä»¥ç°é˜¶æ®µå¯¹Sigmodå‡½æ•°çš„åº”ç”¨å·²ç»è¶Šæ¥è¶Šå°‘ã€‚ 3.Tanhé€šè¿‡å…¶å›¾åƒå¯ä»¥çœ‹å‡ºTanhå‡½æ•°æ—¨åœ¨å…‹æœSigmoidå‡½æ•°åªèƒ½å–æ­£å€¼çš„ç¼ºé™·ï¼Œå°†å…¶è®¾è®¡ä¸ºå…³äºåŸç‚¹å¯¹ç§°çš„åŒæ›²æ­£åˆ‡ï¼ˆhyperbolic tangentï¼‰å½¢å¼ï¼š å…¶ä¸­x=âˆ‘i xiwi+bã€‚å‡½æ•°çš„å¯¼æ•°å–å€¼èŒƒå›´åœ¨0åˆ°1ä¹‹é—´ï¼Œä¼˜äºsigmoidçš„0è‡³1/4ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡è½»äº†æ¢¯åº¦çš„æ¶ˆå¤±ã€‚ä½†å‡½æ•°çš„ä¸¤ç«¯ä»ç„¶å­˜åœ¨æ¢¯åº¦é¥±å’Œé—®é¢˜ï¼Œä¸”è®¡ç®—å˜å¾—æ›´ä¸ºå¤æ‚ã€‚ Tanhçš„è¾“å…¥å’Œè¾“å‡ºèƒ½å¤Ÿä¿æŒéçº¿æ€§å•è°ƒä¸Šå‡å’Œä¸‹é™çš„å…³ç³»ï¼Œç¬¦åˆBPç®—æ³•ç½‘ç»œçš„æ¢¯åº¦æ±‚è§£ï¼Œå®¹é”™æ€§å¥½ã€‚ 4.ReLU ï¼ˆThe Rectified Linear Unitï¼‰å…¶å…¬å¼çš„è¡¨è¾¾å½¢å¼ä¸ºï¼š ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸ºf(x)=max(0,x)ã€‚å³å½“è¾“å…¥ä¿¡å·å°äº0æ—¶ï¼Œå‡½æ•°çš„è¾“å‡ºä¸º0ï¼›å½“è¾“å…¥ä¿¡å·å¤§äº0æ—¶ï¼Œå‡½æ•°çš„è¾“å‡ºç­‰äºè¾“å…¥å€¼ã€‚ ReLUæ‹¥æœ‰æ“ä½œç®€ä¾¿ï¼Œè€—æ—¶å°‘çš„ä¼˜ç‚¹ï¼Œåˆå…·æœ‰éƒ¨åˆ†çº¿æ€§çš„ç‰¹æ€§ï¼Œä¸ä¼šå‡ºç°è¿‡é¥±å’Œç°è±¡ã€å‡å…äº†æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ï¼ˆå‡½æ•°å¾—åˆ°çš„éšæœºæ¢¯åº¦ä¸‹é™æ³•çš„æ”¶æ•›é€Ÿåº¦æ¯”Sigmoidå’ŒTanhéƒ½å¿«ï¼‰ã€‚å¹¶ä¸”ReLUåªéœ€è¦ä¸€ä¸ªé˜ˆå€¼å°±å¯ä»¥å¾—åˆ°æ¿€æ´»å€¼ï¼Œä¸ç”¨å’ŒSigmoidä¸€æ ·è¿›è¡Œå¤æ‚çš„æŒ‡æ•°è¿ç®—ã€‚ä½†å…¶ç¥ç»å…ƒæ¯”ä»·è„†å¼±å®¹æ˜“å¤±å»ä½œç”¨ï¼šå½“ç¥ç»å…ƒæ¥æ”¶åˆ°éå¸¸å¤§çš„æ¢¯åº¦æ•°æ®æµä»¥åï¼Œè¯¥ç¥ç»å…ƒå¯èƒ½å°±ä¸å†å¯¹è¾“å…¥æ•°æ®è¿›è¡Œåé¦ˆäº†ï¼Œæ‰€ä»¥åœ¨è¿›è¡Œè®­ç»ƒæ—¶è¦è®¾ç½®ä¸€ä¸ªè¾ƒå°çš„å­¦ä¹ ç‡å‚æ•°ã€‚ReLUæ˜¯ç›®å‰ç”¨äºç¥ç»ç½‘ç»œé¢†åŸŸæœ€å¸¸è§çš„æ¿€æ´»å‡½æ•°ä¹‹ä¸€ã€‚ è¿™å°±æ˜¯å•ä¸ªäººå·¥ç¥ç»å…ƒçš„å®šä¹‰ã€‚ä½†æ˜¯æ—©æœŸçš„å•ä¸ªäººå·¥ç¥ç»å…ƒæ¨¡å‹ç”šè‡³æ— æ³•å¤„ç†å¼‚æˆ–ç­‰è¿ç®—ï¼Œåœ¨å¤šä¸ªäººå·¥ç¥ç»å…ƒå‘å±•ä¸ºç¥ç»ç½‘ç»œä¹‹åé€æ¸å…‹æœäº†è¿™äº›é—®é¢˜å’Œç§ç§å›°éš¾ï¼Œæˆä¸ºç°ä»£äººå·¥æ™ºèƒ½çš„é‡è¦æ¨¡å‹ã€‚","text":"ç¥ç»ç½‘ç»œ(Neural Networksï¼ŒNN)æ˜¯äººå·¥æ™ºèƒ½ç ”ç©¶é¢†åŸŸçš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œæ˜¯å¤§æ•°æ®ä¸äººå·¥æ™ºèƒ½æŠ€æœ¯å‘å±•çš„é‡è¦åŠ¨åŠ›ã€‚ 1.å·ç§¯ç¥ç»ç½‘ç»œå·ç§¯ç¥ç»ç½‘ç»œå±äºæœºå™¨å­¦ä¹ é¢†åŸŸå½“ä¸­çš„æ·±åº¦å­¦ä¹ æŠ€æœ¯ï¼Œæ˜¯ä¸€ç±»åŒ…å«äº†å·ç§¯è®¡ç®—å¹¶ä¸”å…·æœ‰æ·±åº¦ç»“æ„çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆFeedforward Neural Networksï¼‰ã€‚ç”±çº½çº¦å¤§å­¦æ•™æˆYann LeCunåœ¨1998å¹´æå‡ºï¼Œä¸»è¦åº”ç”¨äºè¯­éŸ³è¯†åˆ«ã€è®¡ç®—æœºè§†è§‰ã€è‡ªç„¶è¯­è¨€å¤„ç†ç­‰é¢†åŸŸã€‚ å…¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªé‡‡ç”¨äº†å±€éƒ¨è¿æ¥å’Œæƒå€¼å…±äº«æ–¹å¼çš„å¤šå±‚æ„ŸçŸ¥æœºï¼ŒåŒ…æ‹¬ä¸€èˆ¬çš„å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰å’Œæ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œï¼ˆDeep Convolutional Neural Networks, DCNNï¼‰ï¼Œé€šå¸¸ä¸åšç‰¹æ„åŒºåˆ†ã€‚ä¸€èˆ¬çš„å·ç§¯ç¥ç»ç½‘ç»œå­˜åœ¨æµ…å±‚ç»“æ„ï¼Œä½†å‡†ç¡®æ€§å’Œè¡¨ç°åŠ›ç›¸å¯¹ä¸è¶³ï¼Œæ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œå¯ä»¥è‡ªåŠ¨ä»å¤§è§„æ¨¡çš„æ•°æ®ä¸­è¿›è¡Œç‰¹å¾å­¦ä¹ ï¼Œä¸”å…·å¤‡å°†ç»“æœå‘åŒç±»å‹çš„æœªçŸ¥æ•°æ®æ³›åŒ–çš„èƒ½åŠ›ï¼Œæ˜¯ç›®å‰æœ€å¸¸ç”¨çš„ç¥ç»ç½‘ç»œæŠ€æœ¯ã€‚ 2.å·ç§¯ç¥ç»ç½‘ç»œåŸç†2.1 å·ç§¯åŸç†ä»æ•°å­¦çš„è§’åº¦å‡ºå‘ï¼Œåˆ†ææ•°å­¦ä¸­å®šä¹‰ä¸€ç§è¿ç®—ï¼Œç§°(f*g)(n)ä¸º(fï¼Œg)çš„å·ç§¯ï¼ˆConvolutionï¼‰ã€‚å…¶è¿ç»­çš„å®šä¹‰ä¸ºï¼š å…¶ç¦»æ•£çš„å®šä¹‰ä¸ºï¼š å…¶è¿ç»­å’Œç¦»æ•£å…·æœ‰å…±åŒçš„ç‰¹å¾ï¼šn=Ï„+(n-Ï„)ï¼Œå½“ä»¤x=Ï„ï¼Œy=n-Ï„æ—¶ï¼Œæœ‰ç›´çº¿ï¼šx+y=nï¼Œå…¶å›¾åƒä¸ºå¦‚ä¸‹å›¾ï¼š å¦‚æœéå†è¿™äº›ç›´çº¿ï¼Œå°±ç±»ä¼¼äºæ²¿ç›´çº¿å·èµ·æ¯›å·¾çš„è¿‡ç¨‹ã€‚ ä¸‹é¢å°†å·ç§¯æ‰©å±•åˆ°äºŒç»´ï¼Œæœ‰ä¸¤ä¸ªR2â†’Rçš„äºŒå…ƒå‡½æ•°f(xï¼Œy)å’Œg(xï¼Œy)ï¼Œé‚£ä¹ˆä»¤få’Œgçš„å·ç§¯å°±æ˜¯ä¸€ä¸ªæ–°çš„R2â†’Rçš„äºŒå…ƒå‡½æ•°c(xï¼Œy)ï¼š å…¶å«ä¹‰ä¸ºå°†fåœ¨(sï¼Œt)ä¸Šçš„å€¼ä¹˜ä»¥gåœ¨(x-sï¼Œy-t)ä¸Šçš„å€¼ï¼Œå†éå†ä»-âˆåˆ°+âˆå…¨éƒ¨så’Œtçš„å€¼ï¼Œè¿›è¡Œfå’Œgç§¯åˆ†æ„ä¹‰ä¸Šçš„åŠ å’Œï¼Œæœ€ç»ˆå¾—åˆ°cåœ¨(xï¼Œy)ä¸Šçš„å€¼ï¼ˆäºŒé‡ç§¯åˆ†ï¼‰ã€‚ å¯ä»¥çœ‹å‡ºè¿™ç§åŠ å’Œæ˜¯ä¸€ç§åŠ æƒæ±‚å’Œï¼Œå³ä»¥fä¸ºæƒï¼Œ(xï¼Œy)ä¸ºä¸­å¿ƒï¼Œå°†fåœ¨(sï¼Œt)ä¸Šçš„å€¼ä¹˜ä»¥gè·ç¦»ä¸­å¿ƒ(-sï¼Œ-t)ä¸Šçš„å€¼å†ç›¸åŠ ã€‚ å…¶ç¦»æ•£çš„è¡¨ç¤ºå½¢å¼ä¸ºï¼š 2.2 ç¥ç»å…ƒç¥ç»ç»†èƒæœ‰ä¼—å¤šçš„æ ‘çªå’Œä¸€ä¸ªä¼¸é•¿çš„è½´çªï¼Œä¸åŒç¥ç»å…ƒä¹‹é—´é€šè¿‡æ ‘çªè¿æ¥è½´çªçš„æ–¹å¼ï¼Œå¹¶é€šè¿‡ç¥ç»è„‰å†²çš„ä¼ å¯¼è¿›è¡Œç»†èƒé—´äº¤æµã€‚å…·ä½“è¿‡ç¨‹ä¸ºç¥ç»ç»†èƒAçš„è½´çªè¿æ¥åˆ°ç¥ç»ç»†èƒBçš„æ ‘çªï¼Œä¼ å¯¼ç¥ç»è„‰å†²ï¼Œç¥ç»ç»†èƒAæ ¹æ®å…¶æ ‘çªä¼ é€’æ¥çš„ä¿¡å·å†³å®šæ˜¯å¦é€šè¿‡è½´çªæ¥å‘ä¸‹ä¸€ä¸ªç¥ç»ç»†èƒCä¼ é€’ä¿¡æ¯ã€‚ 1943å¹´ï¼Œç¾å›½å¿ƒç†å­¦å®¶W.McCullochå’Œæ•°å­¦å®¶W.Pittsæ ¹æ®ç”Ÿç‰©ç¥ç»å…ƒã€ç”Ÿç‰©ç”µå’Œç”Ÿç‰©åŒ–å­¦çš„è¿è¡Œæœºç†æå‡ºäº†äºŒå€¼ç¥ç»å…ƒçš„æ•°å­¦æ¨¡å‹ï¼Œå³ç¥ç»ç»†èƒæœºèƒ½çš„ç®€å•åŒ–çš„æ•°ç†æ¨¡å‹ï¼Œè¢«ç§°ä½œè«å…‹ç½—-å½¼ç‰¹æ°ç¥ç»æ¨¡å‹ï¼ˆMcCullochï¼Pittsâ€²Neuron Modelï¼‰ï¼Œä¹Ÿå«äººå·¥ç¥ç»å…ƒæ¨¡å‹ã€‚ ä¸€ä¸ªäººå·¥ç¥ç»å…ƒæ¨¡å‹å°±æ˜¯å¯¹ç”Ÿç‰©ç¥ç»å…ƒçš„æ•°å­¦å»ºæ¨¡ï¼š å…¶ä¸­X1ã€X2ã€X3ã€â€¦ã€Xnåˆ†åˆ«æ˜¯ä»å…¶ä»–ç¥ç»å…ƒä¼ å…¥çš„è¾“å…¥ä¿¡å·ï¼ŒWi1ã€Wi2ã€Wi3ã€â€¦ã€Winåˆ†åˆ«æ˜¯å¯¹åº”X1ã€X2ã€X3ã€â€¦ã€Xnçš„æƒé‡ã€‚Î¸è¡¨ç¤ºä¸€ä¸ªé˜ˆå€¼ï¼Œæˆ–ç§°ä¸ºåç½®ï¼ˆBiasï¼‰ï¼Œå…¶è®¾ç½®ç›®çš„æ˜¯æ­£ç¡®å°†æ ·æœ¬åˆ†ç±»ã€‚ç¥ç»å…ƒå½“å‰çš„è¾“å…¥ä¿¡å·å’Œåç½®ç›¸åŠ åäº§ç”Ÿå½“å‰ç¥ç»å…ƒçš„æœ€ç»ˆå¤„ç†ä¿¡å·Netï¼Œç§°ä¸ºå‡€æ¿€æ´»æˆ–å‡€æ¿€åŠ±ï¼ˆNet Activationï¼‰ï¼Œå¹¶ä½œä¸ºæ¿€æ´»å‡½æ•°æˆ–æ¿€åŠ±å‡½æ•°ï¼ˆActivation Functionï¼‰fçš„è¾“å…¥ï¼Œå³fï¼ˆnetï¼‰ï¼Œæœ€ç»ˆå¾—åˆ°å¯¹åº”çš„è¾“å‡ºyiã€‚å½¢å¦‚ï¼š æ¿€æ´»å‡½æ•°fï¼ˆnetï¼‰çš„ä½œç”¨æ˜¯é€šè¿‡åŠ å…¥éçº¿æ€§å› ç´ æ¥è§£å†³çº¿æ€§æ¨¡å‹çš„è¡¨è¾¾å’Œåˆ†ç±»èƒ½åŠ›ä¸è¶³çš„é—®é¢˜ã€‚å¸¸è§çš„æ¿€æ´»å‡½æ•°æœ‰ï¼š 1.LinearLinearæ˜¯ä¸€ä¸ªçº¿æ€§æ¿€æ´»å‡½æ•°ï¼šf(x)=âˆ‘i xiwi+bã€‚æœ¬è´¨ä¸Šå°±æ˜¯å¯¹è¾“å…¥çš„åŠ æƒæ±‚å’Œå†åŠ ä¸Šåç½®ï¼Œæ‰€ä»¥ç›¸å¯¹ç®€å•ï¼ŒåŠŸèƒ½è¾ƒä¸ºå•ä¸€ã€‚ ç”±äºå¤šä¸ªçŸ©é˜µè¿›è¡Œè¿ä¹˜çš„ç»“æœä»æ˜¯çŸ©é˜µï¼Œç±»ä¼¼çš„ï¼Œå¦‚æœä¸€ä¸ªç¥ç»ç½‘ç»œä¸­ä»…ä½¿ç”¨çº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œé‚£ä¹ˆå°±åªèƒ½å­¦ä¹ åˆ°çº¿æ€§å‡½æ•°ã€‚ 2.SigmoidSigmoidæ˜¯åœ¨ç¥ç»ç½‘ç»œç ”ç©¶çš„åˆå§‹é˜¶æ®µå°±è¢«æŠ•å…¥äº†å¹¿æ³›ä½¿ç”¨çš„ä¸€ä¸ªç»å…¸çš„éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œå…¶è¡¨è¾¾å¼æ˜¯ä¸€ç§é€»è¾‘æ–¯è’‚å‡½æ•°ï¼ˆLogistic Functionï¼‰ï¼š å…¶ä¸­x=âˆ‘i xiwi+b è¿™ä¸ªå‡½æ•°åœ¨å‡½æ•°çš„åŒºåŸŸå†…æ˜¯å®Œå…¨å¯å¯¼çš„ï¼Œè¾“å‡ºä¸º0åˆ°1èŒƒå›´å†…çš„æ­£å€¼ï¼ˆè¢«è¯å®ä¸æ˜“äºç¥ç»ç½‘ç»œå¯¹æ”¶æ•›çš„å­¦ä¹ ï¼‰ï¼Œå¹¶ä¸”å¯¹äºæ¥è¿‘0å’Œ1çš„å‡½æ•°éƒ¨åˆ†ï¼Œå¯¼æ•°æ— é™è¶‹è¿‘äº0ï¼Œå­˜åœ¨æ˜æ˜¾çš„æ¢¯åº¦è¡°å‡é—®é¢˜ã€‚æ‰€ä»¥ç°é˜¶æ®µå¯¹Sigmodå‡½æ•°çš„åº”ç”¨å·²ç»è¶Šæ¥è¶Šå°‘ã€‚ 3.Tanhé€šè¿‡å…¶å›¾åƒå¯ä»¥çœ‹å‡ºTanhå‡½æ•°æ—¨åœ¨å…‹æœSigmoidå‡½æ•°åªèƒ½å–æ­£å€¼çš„ç¼ºé™·ï¼Œå°†å…¶è®¾è®¡ä¸ºå…³äºåŸç‚¹å¯¹ç§°çš„åŒæ›²æ­£åˆ‡ï¼ˆhyperbolic tangentï¼‰å½¢å¼ï¼š å…¶ä¸­x=âˆ‘i xiwi+bã€‚å‡½æ•°çš„å¯¼æ•°å–å€¼èŒƒå›´åœ¨0åˆ°1ä¹‹é—´ï¼Œä¼˜äºsigmoidçš„0è‡³1/4ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡è½»äº†æ¢¯åº¦çš„æ¶ˆå¤±ã€‚ä½†å‡½æ•°çš„ä¸¤ç«¯ä»ç„¶å­˜åœ¨æ¢¯åº¦é¥±å’Œé—®é¢˜ï¼Œä¸”è®¡ç®—å˜å¾—æ›´ä¸ºå¤æ‚ã€‚ Tanhçš„è¾“å…¥å’Œè¾“å‡ºèƒ½å¤Ÿä¿æŒéçº¿æ€§å•è°ƒä¸Šå‡å’Œä¸‹é™çš„å…³ç³»ï¼Œç¬¦åˆBPç®—æ³•ç½‘ç»œçš„æ¢¯åº¦æ±‚è§£ï¼Œå®¹é”™æ€§å¥½ã€‚ 4.ReLU ï¼ˆThe Rectified Linear Unitï¼‰å…¶å…¬å¼çš„è¡¨è¾¾å½¢å¼ä¸ºï¼š ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸ºf(x)=max(0,x)ã€‚å³å½“è¾“å…¥ä¿¡å·å°äº0æ—¶ï¼Œå‡½æ•°çš„è¾“å‡ºä¸º0ï¼›å½“è¾“å…¥ä¿¡å·å¤§äº0æ—¶ï¼Œå‡½æ•°çš„è¾“å‡ºç­‰äºè¾“å…¥å€¼ã€‚ ReLUæ‹¥æœ‰æ“ä½œç®€ä¾¿ï¼Œè€—æ—¶å°‘çš„ä¼˜ç‚¹ï¼Œåˆå…·æœ‰éƒ¨åˆ†çº¿æ€§çš„ç‰¹æ€§ï¼Œä¸ä¼šå‡ºç°è¿‡é¥±å’Œç°è±¡ã€å‡å…äº†æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ï¼ˆå‡½æ•°å¾—åˆ°çš„éšæœºæ¢¯åº¦ä¸‹é™æ³•çš„æ”¶æ•›é€Ÿåº¦æ¯”Sigmoidå’ŒTanhéƒ½å¿«ï¼‰ã€‚å¹¶ä¸”ReLUåªéœ€è¦ä¸€ä¸ªé˜ˆå€¼å°±å¯ä»¥å¾—åˆ°æ¿€æ´»å€¼ï¼Œä¸ç”¨å’ŒSigmoidä¸€æ ·è¿›è¡Œå¤æ‚çš„æŒ‡æ•°è¿ç®—ã€‚ä½†å…¶ç¥ç»å…ƒæ¯”ä»·è„†å¼±å®¹æ˜“å¤±å»ä½œç”¨ï¼šå½“ç¥ç»å…ƒæ¥æ”¶åˆ°éå¸¸å¤§çš„æ¢¯åº¦æ•°æ®æµä»¥åï¼Œè¯¥ç¥ç»å…ƒå¯èƒ½å°±ä¸å†å¯¹è¾“å…¥æ•°æ®è¿›è¡Œåé¦ˆäº†ï¼Œæ‰€ä»¥åœ¨è¿›è¡Œè®­ç»ƒæ—¶è¦è®¾ç½®ä¸€ä¸ªè¾ƒå°çš„å­¦ä¹ ç‡å‚æ•°ã€‚ReLUæ˜¯ç›®å‰ç”¨äºç¥ç»ç½‘ç»œé¢†åŸŸæœ€å¸¸è§çš„æ¿€æ´»å‡½æ•°ä¹‹ä¸€ã€‚ è¿™å°±æ˜¯å•ä¸ªäººå·¥ç¥ç»å…ƒçš„å®šä¹‰ã€‚ä½†æ˜¯æ—©æœŸçš„å•ä¸ªäººå·¥ç¥ç»å…ƒæ¨¡å‹ç”šè‡³æ— æ³•å¤„ç†å¼‚æˆ–ç­‰è¿ç®—ï¼Œåœ¨å¤šä¸ªäººå·¥ç¥ç»å…ƒå‘å±•ä¸ºç¥ç»ç½‘ç»œä¹‹åé€æ¸å…‹æœäº†è¿™äº›é—®é¢˜å’Œç§ç§å›°éš¾ï¼Œæˆä¸ºç°ä»£äººå·¥æ™ºèƒ½çš„é‡è¦æ¨¡å‹ã€‚ 2.3 ç¥ç»ç½‘ç»œç¥ç»ç½‘ç»œï¼ˆNNï¼‰ï¼Œåˆå«äººå·¥ç¥ç»ç½‘ç»œï¼ˆArtificial Neural Networksï¼Œ ANNï¼‰ï¼Œæ˜¯ä¸€ä¸ªå†å²æ‚ ä¹…çš„è®¡ç®—æ¨¡å‹ã€‚ è¿›è¡Œä¸Šè¿°è¿‡ç¨‹çš„æ¨æ¼”ï¼Œå°†ä¸€ä¸ªäººå·¥ç¥ç»å…ƒçš„è¾“å‡ºä½œä¸ºå¦ä¸€ä¸ªäººå·¥ç¥ç»å…ƒçš„è¾“å…¥ï¼Œä¸€å®šæ•°é‡çš„è¿™æ ·çš„äººå·¥ç¥ç»å…ƒå°±è¿æ¥æˆäººå·¥ç¥ç»ç½‘ç»œã€‚äººå·¥ç¥ç»ç½‘ç»œå…·æœ‰å¤šç§æ‹“æ‰‘ç»“æ„ï¼Œå…¶ä¸­â€œå¤šå±‚å…¨è¿æ¥å‰å‘ç¥ç»ç½‘ç»œâ€ç»“æ„ç›¸å¯¹ç®€ä¾¿ï¼šå°†è¾“å…¥è¿æ¥åˆ°ç½‘ç»œç¬¬ä¸€å±‚çš„æ¯ä¸ªç¥ç»å…ƒä¸Šï¼Œå‰ä¸€å±‚çš„æ¯ä¸ªç¥ç»å…ƒçš„è¾“å‡ºå†è¿æ¥åˆ°ä¸‹ä¸€å±‚çš„æ¯ä¸ªç¥ç»å…ƒçš„è¾“å…¥ä¸Šï¼Œè¿™æ ·æœ€åä¸€å±‚ç¥ç»å…ƒçš„è¾“å‡ºå°±å¯ä»¥ä½œä¸ºæ•´ä¸ªç¥ç»ç½‘ç»œçš„è¾“å‡ºæ¥ä½¿ç”¨ã€‚ å›¾ä¾‹ä¸ºä¸€ä¸ª3å±‚çš„ç¥ç»ç½‘ç»œç»“æ„ï¼Œç¬¬1å±‚ç§°ä¸ºè¾“å…¥å±‚ï¼Œç¬¬2å±‚ç§°ä¸ºéšè—å±‚ï¼Œç¬¬ä¸‰å±‚ç§°ä¸ºè¾“å‡ºå±‚ã€‚å…¶åŒ…å«äº†10ä¸ªè¾“å…¥ç«¯ï¼ˆ10å…ƒå‘é‡ï¼‰ï¼Œç¬¬1ã€2å±‚å„æœ‰12ä¸ªç¥ç»å…ƒï¼Œæœ€åä¸€å±‚æœ‰6ä¸ªç¥ç»å…ƒï¼Œé‚£ä¹ˆè¯¥ç»“æ„çš„ç¥ç»ç½‘ç»œæœ€ç»ˆè¾“å‡ºçš„å°±æ˜¯ä¸€ä¸ª6å…ƒå‘é‡ã€‚ å…³äºæ•´ä¸ªç¥ç»ç½‘ç»œçš„è®¡ç®—å¯ä»¥é€šè¿‡çŸ©é˜µå¼è¡¨å‡ºï¼ˆå•å±‚ç¥ç»ç½‘ç»œçš„è¡¨è¾¾å¼ï¼‰ã€‚å‡è®¾ç¥ç»ç½‘ç»œæ‹¥æœ‰nä¸ªç¥ç»å…ƒçš„ç¬¬iå±‚æ”¶åˆ°mä¸ªè¾“å…¥ï¼Œå¯ä»¥è¡¨ç¤ºä¸ºä¸‹åˆ—å½¢å¼ï¼š å¦‚æœæ¯å±‚ç¥ç»å…ƒçš„ä¸ªæ•°ä¸åŒï¼Œé‚£ä¹ˆï¼Œè¾“å…¥/è¾“å‡ºçš„ç»´åº¦ä¹Ÿä¸ç›¸åŒï¼Œä½†æ•´ä½“å½¢å¼ä¿æŒä¸€è‡´ã€‚O^iæ˜¯nå…ƒçš„è¾“å‡ºå‘é‡ï¼Œç”±äºç¥ç»ç½‘ç»œçš„ç¬¬iå±‚å…±æœ‰nä¸ªç¥ç»å…ƒï¼Œé‚£ä¹ˆç¬¬iå±‚çš„è¾“å…¥ï¼ˆå³ç¬¬i-1å±‚çš„è¾“å‡ºï¼‰æ˜¯ä¸€ä¸ªmå…ƒå‘é‡ã€‚æƒå€¼çŸ©é˜µwæ˜¯n x mçš„çŸ©é˜µï¼šnä¸ªç¥ç»å…ƒä¸­æ¯ä¸ªç¥ç»å…ƒåŒ…å«mä¸ªæƒå€¼ã€‚wä¹˜ä»¥ç¬¬i - 1å±‚è¾“å‡ºçš„må‘é‡ï¼Œå¯ä»¥å¾—åˆ°nå‘é‡ï¼Œå†åŠ ä¸Šnå…ƒåç½®å‘é‡bï¼Œå¯¹ç»“æœçš„æ¯ä¸€ä¸ªå…ƒç´ æ–½ä»¥æ¿€æ´»å‡½æ•°fï¼Œæœ€åå°±å¾—åˆ°ç¬¬iå±‚çš„nå…ƒè¾“å‡ºå‘é‡ã€‚ 3.å·ç§¯ç¥ç»ç½‘ç»œç»“æ„3.1 å›¾åƒçš„è¾“å…¥å’Œç‰¹å¾æå–å¯¹äºä¸€å¹…å›¾åƒï¼Œå…¨è¿æ¥ç¥ç»ç½‘ç»œï¼ˆFully Connected Neural Networkï¼‰å¯ä»¥é€šè¿‡å°†å…¶å¹³æ•´åŒ–ä¸ºæ•°ç»„ï¼Œå¹¶æŠŠåƒç´ å€¼ä½œä¸ºé¢„æµ‹å›¾åƒä¸­æ•°å€¼çš„ç‰¹å¾ã€‚ ç»å…¸çš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œéœ€è¦å¯¹æ•´å¹…ç›®æ ‡å›¾åƒè¿›è¡Œè¯»å–æ¥å°†å…¶ä½œä¸ºç¥ç»ç½‘ç»œçš„è¾“å…¥ï¼Œå³å…¨è¿æ¥æ¨¡å¼ã€‚å¦‚æœç›®æ ‡å›¾åƒçš„å°ºå¯¸éå¸¸å¤§ï¼Œé‚£ä¹ˆåœ¨è¿æ¥è¿‡ç¨‹ä¸­çš„å‚æ•°è¿‡å¤šï¼Œä¼šå¯¼è‡´æ•°æ®è®¡ç®—é‡éå¸¸å¤§ï¼Œä½¿å¾—ç½‘ç»œç†è§£å›¾åƒä¿¡æ¯å˜å¾—æ›´åŠ å›°éš¾ã€‚ ç±»æ¯”äººç±»å¯¹å¤–éƒ¨ç¯å¢ƒçš„æ„ŸçŸ¥è¿‡ç¨‹ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªä»å±€éƒ¨åˆ°å…¨éƒ¨çš„è¿‡ç¨‹ï¼Œå›¾åƒä¸­çš„ç©ºé—´å…³ç³»ä¹Ÿç±»ä¼¼è¿™æ ·ï¼Œå±€éƒ¨èŒƒå›´å†…åƒç´ ä¹‹é—´çš„è”ç³»è¾ƒä¸ºç´§å¯†ï¼Œè€Œè·ç¦»è¾ƒè¿œçš„åƒç´ ä¹‹é—´ç›¸å…³æ€§è¾ƒå¼±ã€‚æ‰€ä»¥ï¼Œå„ä¸ªç¥ç»å…ƒä¸éœ€è¦å¯¹æ•´å¹…å›¾åƒè¿›è¡Œæ„ŸçŸ¥ï¼Œåªéœ€å¯¹å›¾åƒçš„å„éƒ¨åˆ†è¿›è¡Œæ„ŸçŸ¥ï¼Œç„¶ååœ¨æ›´é«˜å±‚å°†å±€éƒ¨ä¿¡æ¯æ‹¼æ¥å®Œæ•´ï¼Œè¿™æ ·ç»¼åˆèµ·æ¥åŒæ ·èƒ½å¤Ÿè·å–å…¨å±€ä¿¡æ¯ã€‚è¿™æ ·çš„æ„ŸçŸ¥æ¨¡å¼å°±æ˜¯å·ç§¯ç¥ç»ç½‘ç»œæ¨¡å‹ä¸­é™ä½å‚æ•°æ•°ç›®çš„é‡è¦æ–¹æ³•ï¼šå±€éƒ¨æ„Ÿå—é‡ï¼ˆLocal Receptive Fieldsï¼‰ã€‚ å‡è®¾è¾“å…¥å›¾åƒä¸ºå­—æ¯Xå’ŒOçš„å›¾ç‰‡ï¼Œé€šè¿‡å±€éƒ¨æ„Ÿå—é‡æ¥æå–å›¾åƒçš„ç‰¹å¾ã€‚å¯¹äºCNNçš„å¯¹æ¯”æ¨¡å¼ï¼ŒCNNæ˜¯é€šè¿‡ä¸€å°å—ä¸€å°å—çš„å¯¹æ¯”åœ¨å›¾åƒä¸­å¤§è‡´ç›¸åŒçš„ä½ç½®æ‰¾åˆ°ä¸€äº›ç²—ç•¥çš„ç‰¹å¾è¿›è¡ŒåŒ¹é…ã€‚ç›¸æ¯”è¾ƒä¼ ç»Ÿçš„æ•´å›¾é€ä¸€å¯¹æ¯”æ–¹å¼ï¼ŒCNNçš„å°å—åŒ¹é…æ¨¡å¼èƒ½æ›´å¥½çš„æ¯”è¾ƒå‡ºå›¾åƒä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚ ä»¥å­—æ¯xä¸ºä¾‹ï¼Œç”¨åƒç´ å€¼â€œ1â€è¡¨ç¤ºç™½è‰²ï¼Œç”¨åƒç´ å€¼â€œ-1â€è¡¨ç¤ºç°è‰²ï¼Œå¯ä»¥æå–å‡ºä¸‰ä¸ªé‡è¦çš„ç‰¹å¾ï¼š1ä¸ªä¸­å¿ƒäº¤å‰çº¿ï¼Œä¸¤ä¸ªæ–œè¾¹å¯¹è§’çº¿ï¼š 3.2 å·ç§¯å±‚å·ç§¯ç¥ç»ç½‘ç»œä¸­çš„ç¬¬ä¸€å±‚å§‹ç»ˆæ˜¯å·ç§¯å±‚ï¼ˆé™¤å»è¾“å…¥å±‚ï¼‰ã€‚å½“å¼€å§‹å¯¹ä¸€å¼ å›¾ç‰‡è¿›è¡Œè¯†åˆ«æ—¶ï¼ŒCNNå¹¶ä¸èƒ½ç«‹å³å¯¹éœ€è¦è¯†åˆ«çš„éƒ¨åˆ†è¿›è¡Œå‡†ç¡®åŒ¹é…ï¼Œè€Œæ˜¯é¦–å…ˆå¯¹æºæ–‡ä»¶çš„æ¯ä¸ªä½ç½®è¿›è¡Œå°è¯•æ€§åŒ¹é…ï¼Œå°†åŒ¹é…çš„ç›®æ ‡ç‰¹å¾ä½œä¸ºä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œä»è€Œå¤„ç†æ‰åŒ¹é…åº¦ä½çš„éƒ¨åˆ†ã€‚è¿™ä¸ªæ“ä½œå°±æ˜¯å·ç§¯æ“ä½œã€‚ åœ¨è¿™ä¸ªå­—æ¯è¯†åˆ«æ¡ˆä¾‹å½“ä¸­ï¼Œè¦è®¡ç®—ä¸€ä¸ªç‰¹å¾å’Œå…¶åœ¨å­—æ¯â€œXâ€çš„åŸå›¾ä¸Šå¯¹åº”çš„æŸä¸€å°å—çš„ç»“æœï¼Œå¯ä»¥å°†ä¸¤ä¸ªå°å—å†…å¯¹åº”ä½ç½®çš„åƒç´ å€¼è¿›è¡Œä¹˜æ³•è¿ç®—ï¼Œå†å°†æ•´ä¸ªå°å—å†…ä¹˜æ³•è¿ç®—çš„ç»“æœç´¯åŠ èµ·æ¥ï¼Œé™¤ä»¥å°å—å†…åƒç´ ç‚¹æ€»ä¸ªæ•°ã€‚ è¿™æ ·ï¼Œä¸è®ºåŒ¹é…çš„ä¸¤ä¸ªåƒç´ ç‚¹çš„é¢œè‰²å‡ä¸ºç™½è‰²æˆ–è€…ç°è‰²ï¼Œå®ƒä»¬çš„ä¹˜ç§¯ç»“æœ1Ã—1å’Œ(-1)Ã—(1)éƒ½ä¸º1ï¼Œè¯´æ˜æ¯ä¸€å¯¹èƒ½å¤ŸåŒ¹é…æˆåŠŸçš„åƒç´ ï¼Œå…¶ç»“æœæ’ä¸º1ã€‚ç±»ä¼¼çš„ï¼Œä¸èƒ½å®Œå…¨åŒ¹é…çš„ç»“æœä¹˜ç§¯åˆ™ä¸º1Ã—(-1)=-1ã€‚ç›¸å…³æ­¥éª¤å¦‚ä¸‹ï¼š é€šè¿‡å·ç§¯çš„è®¡ç®—ï¼Œç¬¬ä¸€å—ç‰¹å¾å®ŒæˆåŒ¹é…åç»“æœä¸º1ã€‚ ç±»ä¼¼çš„ï¼Œå°†ç¬¬ä¸€å—ç‰¹å¾ä¸å…¶ä»–éƒ¨åˆ†è¿›è¡ŒåŒ¹é…ï¼Œå¾—åˆ°åŒ¹é…åçš„ç»“æœã€‚ ä»¥æ­¤ç±»æ¨ï¼Œå¯¹ä¸‰ä¸ªç‰¹å¾ä¸æ–­é‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œé€šè¿‡å¯¹æ¯ä¸ªç‰¹å¾çš„å·ç§¯æ“ä½œï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªç§°ä¸ºfeature mapçš„æ–°äºŒç»´æ•°ç»„ã€‚å…¶ä¸­å€¼çš„å«ä¹‰æ˜¯è¶Šæ¥è¿‘1çš„å€¼è¡¨ç¤ºè¯¥å¯¹åº”ä½ç½®å’Œç‰¹å¾çš„åŒ¹é…è¶Šå®Œæ•´ï¼Œè¶Šæ¥è¿‘-1çš„å€¼è¡¨ç¤ºè¯¥å¯¹åº”ä½ç½®å’Œç‰¹å¾çš„åå‘åŒ¹é…è¶Šå®Œæ•´ï¼Œè€Œæ¥è¿‘0çš„å€¼è¡¨ç¤ºå¯¹åº”ä½ç½®æ²¡æœ‰æ˜æ˜¾åŒ¹é…æˆ–ä¸ç›¸å…³ã€‚ å¯ä»¥é¢„è§ï¼Œå½“å›¾åƒçš„å°ºå¯¸å¢å¤§æ—¶ï¼Œæ¯ä¸€ä¸ªå·ç§¯å±‚çš„å¤§å°å’Œå·ç§¯å±‚çš„æ•°ç›®å‘ˆçº¿æ€§å¢é•¿çš„å…³ç³»ï¼Œå…¶å†…éƒ¨çš„åŠ æ³•ã€ä¹˜æ³•å’Œé™¤æ³•æ“ä½œçš„æ¬¡æ•°ä¹Ÿä¼šéšä¹‹å¢åŠ ï¼Œè®¡ç®—é‡ä¹Ÿä¼šè¶Šåºå¤§ã€‚ 3.3 æ± åŒ–å±‚ï¼ˆPoolingï¼‰ç”±äºç¬¬ä¸€å±‚å·ç§¯æ“ä½œçš„åŒ¹é…ç¨‹åºè®¡ç®—é‡è¾ƒå¤§ï¼Œå¦‚æœé‡åˆ°æ•°æ®é‡å¤§çš„æƒ…å†µä¼šä¸¥é‡å½±å“å·ç§¯çš„æ•ˆç‡ã€‚ä¸ºäº†æœ‰æ•ˆçš„å‡å°‘è¿™ä¸€æ­¥éª¤çš„è®¡ç®—ï¼ŒCNNä¼šé€šè¿‡æ± åŒ–å±‚çš„ç»“æ„å°†è¾“å…¥çš„æºå›¾åƒæ–‡ä»¶è¿›è¡Œå¿…è¦çš„ç®€åŒ–å’Œç¼©æ”¾ï¼Œå°½å¯èƒ½çš„å‡å°‘æ–‡ä»¶çš„åƒç´ ä¿¡æ¯ï¼Œåªä¿ç•™å¿…è¦çš„æ•°æ®ä¿¡æ¯ï¼Œå‡å°‘å†…å­˜æ¶ˆè€—ã€‚ æ± åŒ–å±‚é€šå¸¸é‡‡ç”¨2*2åƒç´ çš„æ± åŒ–åŒºåŸŸï¼ŒæŒ‰ç…§ä¸€å®šçš„ç®—æ³•è§„åˆ™ä¿ç•™æ± åŒ–åŒºåŸŸä¸­çš„æœ€å¤§å€¼ï¼ˆmax-poolingï¼‰ã€å‡å€¼ï¼ˆmean-poolingï¼‰ç­‰ï¼Œå¹¶å°†ç»“æœä½œä¸ºåŒºåŸŸçš„åƒç´ ã€‚ ä¸‹å›¾æ˜¾ç¤ºäº†å·¦ä¸Šè§’2Ã—2æ± åŒ–åŒºåŸŸçš„max-poolingç»“æœï¼Œå–è¯¥åŒºåŸŸçš„æœ€å¤§å€¼max(0.77,-0.11,-0.11,1.00)ï¼Œä½œä¸ºæ± åŒ–åçš„ç»“æœã€‚ ç±»ä¼¼çš„ï¼Œæ± åŒ–åŒºåŸŸå‘å·¦ç§»åŠ¨ï¼Œå–ç¬¬äºŒå—åŒºåŸŸçš„å–å¤§å€¼max(0.11,0.33,-0.11,0.33)ï¼Œä½œä¸ºæ± åŒ–åçš„ç»“æœã€‚ ä»¥æ­¤ç±»æ¨ï¼Œå¾—åˆ°æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š ä»¥åŒæ ·çš„æ–¹å¼å¯¹æ‰€æœ‰feature mapæ‰§è¡Œç›¸åŒæ“ä½œã€‚ æœ€å¤§æ± åŒ–ï¼ˆmax-poolingï¼‰ä¿ç•™äº†æ¯ä¸€åŒºåŸŸå†…çš„æœ€å¤§å€¼ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºä¿ç•™äº†è¿™ä¸€å—åŒºåŸŸçš„æœ€ä½³åŒ¹é…ç»“æœï¼ˆå€¼è¶Šæ¥è¿‘1è¡¨ç¤ºåŒ¹é…ç¨‹åº¦è¶Šé«˜ï¼‰ã€‚æ± åŒ–æ“ä½œä¸ä¼šåˆ†æåŒºåŸŸå†…å…·ä½“å®ŒæˆåŒ¹é…çš„éƒ¨åˆ†ï¼Œè€Œæ˜¯å…³æ³¨æ˜¯å¦æœ‰æŸä¸€éƒ¨åˆ†èƒ½å¤ŸåŒ¹é…ä¸Šã€‚ é€šè¿‡æ± åŒ–æ“ä½œï¼Œå›¾åƒè¢«ç®€åŒ–ï¼Œåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå‡å°‘äº†è®¡ç®—é‡ï¼Œé™ä½è®¡ç®—æœºè´Ÿè½½ã€‚ 3.4 æ¿€æ´»å‡½æ•°æ¿€æ´»å‡½æ•°é€šè¿‡åŠ å…¥éçº¿æ€§å› ç´ å°†å·ç§¯å±‚çš„è¾“å‡ºç»“æœåšéçº¿æ€§çš„æ˜ å°„ã€‚å·ç§¯å±‚å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°æœ‰ä¿®æ­£çº¿æ€§å•å…ƒReLUå‡½æ•°ï¼Œå…¶æ”¶æ•›é€Ÿåº¦è¾ƒå¿«ï¼Œä¸”æ¢¯åº¦è®¡ç®—ç®€å•ã€‚ReLUå‡½æ•°çš„ä¸€èˆ¬è¡¨è¾¾å¼è¿‘ä¼¼äºmax(0ï¼Œx)ï¼Œå³å½“x&lt;0æ—¶ï¼Œè¾“å‡ºç»“æœæ’ä¸º0ï¼Œå½“xâ‰¥0æ—¶ï¼Œè¾“å‡ºç»“æœä¸ºå‚æ•°æœ¬èº«ã€‚ ä¸‹å›¾ä¸ºé€šè¿‡ReLUå¯¹feature mapçš„å¤„ç†ï¼Œé¦–å…ˆå–max(0,0.77)ï¼Œç»“æœä¸º0.77ã€‚ ç±»ä¼¼çš„ï¼Œç¬¬äºŒä¸ªå€¼å–max(0,-0.11)ï¼Œç»“æœä¸º0ã€‚ ä»¥æ­¤ç±»æ¨ï¼Œæœ€ç»ˆå¾—åˆ°ç»“æœå¦‚ä¸‹ï¼š 3.5 æ·±åº¦ç¥ç»ç½‘ç»œé€šè¿‡å°†å·ç§¯ã€æ¿€æ´»å‡½æ•°ã€æ± åŒ–è¿›è¡Œç»„åˆï¼Œå¾—åˆ°ä¸€å±‚ç®€å•çš„ç¥ç»ç½‘ç»œè§£æ„ã€‚ å°†å·ç§¯ã€æ± åŒ–ã€æ¿€æ´»å‡½æ•°ç»è¿‡ç»„åˆå’Œæ‹“å±•ä»¥åï¼Œå±‚æ•°å¢åŠ ï¼Œå¾—åˆ°æ·±åº¦ç¥ç»ç½‘ç»œçš„ç»“æ„ã€‚ 3.6 å…¨è¿æ¥å±‚ï¼ˆFully connected layersï¼‰å…¨è¿æ¥å±‚ç›¸å½“äºæ•´ä¸ªç¥ç»ç½‘ç»œå½“ä¸­çš„â€œåˆ†ç±»å™¨â€ï¼Œæ•°æ®ç»è¿‡å·ç§¯ã€æ± åŒ–ã€æ¿€æ´»å‡½æ•°ç­‰æ·±åº¦ç½‘ç»œä»¥åï¼Œå†é€šè¿‡å…¨è¿æ¥å±‚å¯¹ç»“æœè¿›è¡Œåˆ†ç±»ï¼Œè·å–è¯†åˆ«çš„ç»“æœã€‚ç”±äºç¥ç»ç½‘ç»œæŠ€æœ¯æ˜¯å¯¹æœ‰æ ‡ç­¾æ•°æ®çš„ä¸€ç§ç›‘ç£å­¦ä¹ ï¼Œåœ¨æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå¾—åˆ°å…¨è¿æ¥å±‚çš„æƒé‡ï¼Œè¿™æ ·å†é€šè¿‡æ¨¡å‹å¯¹ç›®æ ‡è¿›è¡Œè¯†åˆ«æ—¶ï¼Œæ ¹æ®å·ç§¯ã€æ± åŒ–ã€æ¿€æ´»å‡½æ•°ç­‰æ·±åº¦ç½‘ç»œæ“ä½œçš„ç»“æœå’Œå¾—åˆ°çš„æƒé‡è¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œè·å–å¯¹å„åˆ†ç±»ç»“æœçš„é¢„æµ‹å€¼ï¼Œé€‰æ‹©æœ€ä¼˜ç»“æœå³å®Œæˆé¢„æµ‹åˆ†ç±»çš„ä»»åŠ¡ã€‚å…¨è¿æ¥å±‚å¯ä»¥æœ‰å¤šä¸ªã€‚ å°†ç»è¿‡å·ç§¯ã€æ¿€æ´»å‡½æ•°ã€æ± åŒ–åçš„æ·±åº¦ç½‘ç»œçš„ç»“æœä¸²è”èµ·æ¥ï¼Œå¯¹å­—æ¯è¿›è¡Œè¯†åˆ«åˆ¤æ–­ã€‚ 3.7 å·ç§¯ç¥ç»ç½‘ç»œå†å®Œæˆäº†å·ç§¯å±‚ã€æ± åŒ–å±‚ã€æ¿€æ´»å‡½æ•°ã€æ·±åº¦ç¥ç»ç½‘ç»œã€å…¨è¿æ¥å±‚ä¸€ç³»åˆ—çš„æ“ä½œåï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ªå®Œæ•´çš„å·ç§¯ç¥ç»ç½‘ç»œçš„ç»“æ„ã€‚æ•´ä½“å¯åˆ’åˆ†ä¸ºä¸¤å¤§æ­¥éª¤ï¼Œæ­¥éª¤ä¸€æ˜¯ç»è¿‡å·ç§¯ã€æ± åŒ–å’Œæ¿€æ´»å‡½æ•°çš„ç‰¹å¾æå–ï¼Œæ­¥éª¤äºŒæ˜¯é€šè¿‡ç»„æˆæ·±åº¦ç¥ç»ç½‘ç»œå’Œå…¨è¿æ¥å±‚çš„ç‰¹å¾è¯†åˆ«å’Œé¢„æµ‹åˆ†ç±»ã€‚ å·ç§¯ç¥ç»ç½‘ç»œåœ¨æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å¯¹è¾“å…¥è¾“å‡ºæ˜ å°„å…³ç³»çš„å­¦ä¹ ï¼Œç‰¹ç‚¹æ˜¯ä¸éœ€è¦æŒæ¡è¾“å…¥è¾“å‡ºä¹‹é—´çš„æ˜ç¡®å…³ç³»æˆ–å…·ä½“çš„å‡½æ•°è¡¨è¾¾å¼ï¼Œè€Œæ˜¯åˆ©ç”¨å…¶ç‰¹å¾æå–çš„æ¨¡å¼å¯¹å·ç§¯ç½‘ç»œåŠ ä»¥è®­ç»ƒï¼Œæœ€ç»ˆç½‘ç»œä¼šå…·å¤‡è¾“å…¥è¾“å‡ºä¹‹é—´æ˜ å°„çš„èƒ½åŠ›ã€‚ ï¼ˆæœ¬æ–‡èŠ‚é€‰è‡ªæˆ‘çš„æ¯•ä¸šè®ºæ–‡ï¼‰","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://yoursite.com/categories/æ·±åº¦å­¦ä¹ /"}],"tags":[{"name":"CNN","slug":"CNN","permalink":"http://yoursite.com/tags/CNN/"}]},{"title":"Hadoopé›†ç¾¤ç»„ä»¶é…ç½®","slug":"Hadoopé›†ç¾¤ç»„ä»¶é…ç½®","date":"2019-09-08T18:35:33.000Z","updated":"2022-06-27T07:30:06.571Z","comments":true,"path":"2019/09/09/Hadoopé›†ç¾¤ç»„ä»¶é…ç½®/","link":"","permalink":"http://yoursite.com/2019/09/09/Hadoopé›†ç¾¤ç»„ä»¶é…ç½®/","excerpt":"Sparké›†ç¾¤æ­å»ºé¦–å…ˆåœ¨scalaå®˜ç½‘ï¼ˆhttp://www.scala-lang.org/files/archive/scala-2.10.4.tgzï¼‰ä¸‹è½½scalaè¯­è¨€å¹¶è§£å‹ç¼©ï¼Œé…ç½®/etc/profileä¸‹scalaçš„ç¯å¢ƒå˜é‡12export SCALA_HOME=/usr/local/scalaexport PATH=$PATH:$&#123;SCALA_HOME&#125;/bin ç¯å¢ƒå˜é‡æˆåŠŸç”Ÿæ•ˆåè¿›è¡Œæµ‹è¯•ï¼Œè¾“å…¥15*15,è¿”å›225ï¼ŒæˆåŠŸ æ¥ä¸‹æ¥åˆ°sparkå®˜ç½‘ï¼ˆhttp://archive.cloudera.com/cdh5/cdh/5/spark-1.5.0-cdh5.6.0.tar.gzï¼‰ä¸‹è½½SparkåŒ…ï¼Œç»§ç»­é…ç½®ç¯å¢ƒå˜é‡12export SPARK_HOME=/usr/local/soft/spark-1.6.0-bin-hadoop2.6export PATH=$PATH:$&#123;SPARK_HOME&#125;/bin å®Œæˆåç»§ç»­é…ç½®${SPARK_HOME}/conf/spark-env.sh é…ç½®{SPARK_HOME}/conf/ slavesï¼Œåœ¨viç¼–è¾‘å™¨ä¸­æ·»åŠ nodeèŠ‚ç‚¹,åœ¨å°†ç¨‹åºåˆ†å‘ç»™nodeèŠ‚ç‚¹12scp -r spark-1.6.0-bin-hadoop2.6. root@node1:/usr/local/soft/scp -r spark-1.6.0-bin-hadoop2.6. root@node2:/usr/local/soft/ å¯ä»¥é€šè¿‡./start-all.shå‘½ä»¤æ¥å¯åŠ¨sparké›†ç¾¤ å¯ä¹Ÿæœ‰é€šè¿‡èŠ‚ç‚¹æ¥å¯åŠ¨ï¼š Â· é€šè¿‡sbin/start-master.shå¯åŠ¨ä¸»èŠ‚ç‚¹Â· é€šè¿‡sbin/start-slave.sh 192.168.218.141:8070ç­‰å¯åŠ¨nodeèŠ‚ç‚¹ å¯ä»¥æ‰§è¡Œ/bin/run-example SparkPi 10 &gt; Sparkpilog.txtè¿è¡Œsparkç¤ºä¾‹ç¨‹åº é€šè¿‡jpså‘½ä»¤æŸ¥çœ‹å¯åŠ¨çš„javaæœåŠ¡ï¼Œè¿›è¡ŒéªŒè¯","text":"Sparké›†ç¾¤æ­å»ºé¦–å…ˆåœ¨scalaå®˜ç½‘ï¼ˆhttp://www.scala-lang.org/files/archive/scala-2.10.4.tgzï¼‰ä¸‹è½½scalaè¯­è¨€å¹¶è§£å‹ç¼©ï¼Œé…ç½®/etc/profileä¸‹scalaçš„ç¯å¢ƒå˜é‡12export SCALA_HOME=/usr/local/scalaexport PATH=$PATH:$&#123;SCALA_HOME&#125;/bin ç¯å¢ƒå˜é‡æˆåŠŸç”Ÿæ•ˆåè¿›è¡Œæµ‹è¯•ï¼Œè¾“å…¥15*15,è¿”å›225ï¼ŒæˆåŠŸ æ¥ä¸‹æ¥åˆ°sparkå®˜ç½‘ï¼ˆhttp://archive.cloudera.com/cdh5/cdh/5/spark-1.5.0-cdh5.6.0.tar.gzï¼‰ä¸‹è½½SparkåŒ…ï¼Œç»§ç»­é…ç½®ç¯å¢ƒå˜é‡12export SPARK_HOME=/usr/local/soft/spark-1.6.0-bin-hadoop2.6export PATH=$PATH:$&#123;SPARK_HOME&#125;/bin å®Œæˆåç»§ç»­é…ç½®${SPARK_HOME}/conf/spark-env.sh é…ç½®{SPARK_HOME}/conf/ slavesï¼Œåœ¨viç¼–è¾‘å™¨ä¸­æ·»åŠ nodeèŠ‚ç‚¹,åœ¨å°†ç¨‹åºåˆ†å‘ç»™nodeèŠ‚ç‚¹12scp -r spark-1.6.0-bin-hadoop2.6. root@node1:/usr/local/soft/scp -r spark-1.6.0-bin-hadoop2.6. root@node2:/usr/local/soft/ å¯ä»¥é€šè¿‡./start-all.shå‘½ä»¤æ¥å¯åŠ¨sparké›†ç¾¤ å¯ä¹Ÿæœ‰é€šè¿‡èŠ‚ç‚¹æ¥å¯åŠ¨ï¼š Â· é€šè¿‡sbin/start-master.shå¯åŠ¨ä¸»èŠ‚ç‚¹Â· é€šè¿‡sbin/start-slave.sh 192.168.218.141:8070ç­‰å¯åŠ¨nodeèŠ‚ç‚¹ å¯ä»¥æ‰§è¡Œ/bin/run-example SparkPi 10 &gt; Sparkpilog.txtè¿è¡Œsparkç¤ºä¾‹ç¨‹åº é€šè¿‡jpså‘½ä»¤æŸ¥çœ‹å¯åŠ¨çš„javaæœåŠ¡ï¼Œè¿›è¡ŒéªŒè¯ éƒ½é€šè¿‡åï¼Œå¯ä»¥åœ¨æœ¬åœ°æµè§ˆå™¨è¾“å…¥http://192.168.218.141:8090/ï¼Œè¿›å…¥åˆ°sparkæœåŠ¡ç•Œé¢ å¦‚æœè¦å¯åŠ¨spark shellï¼Œå¯ä»¥æ‰§è¡Œï¼šspark shellï¼šbin/spark-shell æœ€åé€šè¿‡./stop-all.shæ¥å…³é—­sparké›†ç¾¤ HiveHbaseKafukaSqoopFlinkStromï¼ˆæœªå®Œï¼‰","categories":[{"name":"BigData","slug":"BigData","permalink":"http://yoursite.com/categories/BigData/"}],"tags":[{"name":"Hadoop","slug":"Hadoop","permalink":"http://yoursite.com/tags/Hadoop/"}]},{"title":"Hadoopå…¥é—¨","slug":"Hadoopå…¥é—¨","date":"2019-09-07T09:17:17.000Z","updated":"2022-06-27T07:29:58.866Z","comments":true,"path":"2019/09/07/Hadoopå…¥é—¨/","link":"","permalink":"http://yoursite.com/2019/09/07/Hadoopå…¥é—¨/","excerpt":"Hadoopæ˜¯ä¸€ä¸ªç”¨Javaç¼–å†™çš„Apacheå¼€æºæ¡†æ¶ï¼Œå…è®¸ä½¿ç”¨ç®€å•çš„ç¼–ç¨‹æ¨¡å‹è·¨è®¡ç®—æœºé›†ç¾¤åˆ†å¸ƒå¼å¤„ç†å¤§å‹æ•°æ®é›†ã€‚Hadoopæ¡†æ¶å·¥ä½œçš„åº”ç”¨ç¨‹åºåœ¨è·¨è®¡ç®—æœºé›†ç¾¤æä¾›åˆ†å¸ƒå¼å­˜å‚¨å’Œè®¡ç®—çš„ç¯å¢ƒä¸­å·¥ä½œã€‚Hadoopæ—¨åœ¨ä»å•ä¸ªæœåŠ¡å™¨æ‰©å±•åˆ°æ•°åƒä¸ªæœºå™¨ï¼Œæ¯ä¸ªéƒ½æä¾›æœ¬åœ°è®¡ç®—å’Œå­˜å‚¨ã€‚ Hadoopä¼ªåˆ†å¸ƒå¼æ­å»ºé¦–å…ˆåˆ›å»ºä¸€å°masterè™šæ‹Ÿæœºï¼Œå¹¶å…‹éš†node1ã€node2ä¸¤å°èŠ‚ç‚¹æœºï¼Œæˆ‘çš„è™šæ‹Ÿæœºé›†ç¾¤ipåœ°å€åˆ†åˆ«è®¾ç½®ä¸ºï¼š Â· 192.168.218.141 master Â· 192.168.218.142 node1 Â· 192.168.218.143 node2 åˆ°masterä¸­è®¾ç½®å¥½sshï¼Œåšå¥½ä¸»æœºåä¸ipåœ°å€çš„æ˜ å°„ï¼Œä¿®æ”¹/etc/hostsä¸‹çš„é…ç½®æ–‡ä»¶ï¼Œå¹¶å°†å®Œæˆçš„hostsæ–‡ä»¶å¤åˆ¶è¿›èŠ‚ç‚¹æœºä¸­ æ­¤æ—¶å¯ä»¥æ‰“å¼€xshellï¼Œä¹Ÿå¯ä»¥ç»§ç»­åœ¨è™šæ‹Ÿæœºä¸­è¿›è¡Œæ“ä½œ å°†hadoopçš„jaråŒ…ä¸Šä¼ åˆ°è™šæ‹Ÿæœºä¸­ï¼Œé…ç½®ç¯å¢ƒå˜é‡ï¼Œå¹¶å¯¹hadoopä¸‹çš„core-site.xmlã€hdfs-site.xmlã€yarn-site.xmlå’Œmapred-site.xmlæ–‡ä»¶è¿›è¡Œç›¸å…³é…ç½® å®Œæˆä»¥åå†å°†hadoopçš„å®‰è£…ç›®å½•åˆ†åˆ«æ‹·è´åˆ°å­èŠ‚ç‚¹ä¸­ï¼Œæ£€æŸ¥æ˜¯å¦å®Œæˆé›†ç¾¤æ–‡ä»¶çš„é…ç½®å’Œéƒ¨ç½² å¯åŠ¨å›åˆ°ä¸»æœºä¸­æ‰“å¼€hadoopå®‰è£…ç›®å½•ï¼Œæ‰§è¡Œ 12start-dfs.shstart-yarn.sh ï¼ˆè€ç‰ˆæœ¬çš„â€start-all.shâ€ä¼šæç¤ºå·²è¿‡æœŸï¼‰ å®Œæˆhadoopçš„å¯åŠ¨åï¼Œåœ¨ä¸»æœºå’ŒèŠ‚ç‚¹æœºè¾“å…¥jpsæŸ¥çœ‹å½“å‰è¿è¡Œçš„javaè¿›ç¨‹ æˆåŠŸåæ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥localhost:50700å¯ä»¥è¿›å…¥hadoopåˆå§‹ç•Œé¢ã€‚","text":"Hadoopæ˜¯ä¸€ä¸ªç”¨Javaç¼–å†™çš„Apacheå¼€æºæ¡†æ¶ï¼Œå…è®¸ä½¿ç”¨ç®€å•çš„ç¼–ç¨‹æ¨¡å‹è·¨è®¡ç®—æœºé›†ç¾¤åˆ†å¸ƒå¼å¤„ç†å¤§å‹æ•°æ®é›†ã€‚Hadoopæ¡†æ¶å·¥ä½œçš„åº”ç”¨ç¨‹åºåœ¨è·¨è®¡ç®—æœºé›†ç¾¤æä¾›åˆ†å¸ƒå¼å­˜å‚¨å’Œè®¡ç®—çš„ç¯å¢ƒä¸­å·¥ä½œã€‚Hadoopæ—¨åœ¨ä»å•ä¸ªæœåŠ¡å™¨æ‰©å±•åˆ°æ•°åƒä¸ªæœºå™¨ï¼Œæ¯ä¸ªéƒ½æä¾›æœ¬åœ°è®¡ç®—å’Œå­˜å‚¨ã€‚ Hadoopä¼ªåˆ†å¸ƒå¼æ­å»ºé¦–å…ˆåˆ›å»ºä¸€å°masterè™šæ‹Ÿæœºï¼Œå¹¶å…‹éš†node1ã€node2ä¸¤å°èŠ‚ç‚¹æœºï¼Œæˆ‘çš„è™šæ‹Ÿæœºé›†ç¾¤ipåœ°å€åˆ†åˆ«è®¾ç½®ä¸ºï¼š Â· 192.168.218.141 master Â· 192.168.218.142 node1 Â· 192.168.218.143 node2 åˆ°masterä¸­è®¾ç½®å¥½sshï¼Œåšå¥½ä¸»æœºåä¸ipåœ°å€çš„æ˜ å°„ï¼Œä¿®æ”¹/etc/hostsä¸‹çš„é…ç½®æ–‡ä»¶ï¼Œå¹¶å°†å®Œæˆçš„hostsæ–‡ä»¶å¤åˆ¶è¿›èŠ‚ç‚¹æœºä¸­ æ­¤æ—¶å¯ä»¥æ‰“å¼€xshellï¼Œä¹Ÿå¯ä»¥ç»§ç»­åœ¨è™šæ‹Ÿæœºä¸­è¿›è¡Œæ“ä½œ å°†hadoopçš„jaråŒ…ä¸Šä¼ åˆ°è™šæ‹Ÿæœºä¸­ï¼Œé…ç½®ç¯å¢ƒå˜é‡ï¼Œå¹¶å¯¹hadoopä¸‹çš„core-site.xmlã€hdfs-site.xmlã€yarn-site.xmlå’Œmapred-site.xmlæ–‡ä»¶è¿›è¡Œç›¸å…³é…ç½® å®Œæˆä»¥åå†å°†hadoopçš„å®‰è£…ç›®å½•åˆ†åˆ«æ‹·è´åˆ°å­èŠ‚ç‚¹ä¸­ï¼Œæ£€æŸ¥æ˜¯å¦å®Œæˆé›†ç¾¤æ–‡ä»¶çš„é…ç½®å’Œéƒ¨ç½² å¯åŠ¨å›åˆ°ä¸»æœºä¸­æ‰“å¼€hadoopå®‰è£…ç›®å½•ï¼Œæ‰§è¡Œ 12start-dfs.shstart-yarn.sh ï¼ˆè€ç‰ˆæœ¬çš„â€start-all.shâ€ä¼šæç¤ºå·²è¿‡æœŸï¼‰ å®Œæˆhadoopçš„å¯åŠ¨åï¼Œåœ¨ä¸»æœºå’ŒèŠ‚ç‚¹æœºè¾“å…¥jpsæŸ¥çœ‹å½“å‰è¿è¡Œçš„javaè¿›ç¨‹ æˆåŠŸåæ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥localhost:50700å¯ä»¥è¿›å…¥hadoopåˆå§‹ç•Œé¢ã€‚ å› ä¸ºæˆ‘ä¹‹å‰å·²ç»å®Œæˆäº†å¹³å°çš„æ­å»ºï¼Œdfsä¸­å·²ç»å­˜æ”¾æœ‰ä¸€äº›æµ‹è¯•æ–‡ä»¶ï¼Œå¯ä»¥è¿›è¡ŒæŸ¥çœ‹(è±†ç“£ç”µå½±æ•°æ®) MapreduceMapReduceæ˜¯Hadoopä¸­ä¸€å¥—åˆ†å¸ƒå¼çš„è®¡ç®—æ¡†æ¶,åˆ†ä¸ºMapå’ŒReduceä¸¤ä¸ªéƒ¨åˆ†,Mapç”¨äºæ•°æ®çš„æ•´ç†,Reduceè´Ÿè´£æ•°æ®çš„æ±‡æ€»ï¼Œå½“hadoopå¹³å°æ­å»ºå®Œæˆåï¼Œå°±å¯ä»¥ä½¿ç”¨å†…ç½®çš„mapreduceç¨‹åºâ€wordcountâ€è¿›è¡Œæµ‹è¯•ï¼Œå…¶ä½œç”¨æ˜¯å¯¹è¾“å…¥æ–‡ä»¶çš„è¯é¢‘è¿›è¡Œç»Ÿè®¡ è¿›å…¥hadoopç›®å½•æ–°å»ºä¸€ä¸ªæµ‹è¯•æ–‡ä»¶å¤¹testfilesï¼Œå¹¶åˆ›å»ºå‡ ä¸ªtxtæ–‡æœ¬æ–‡ä»¶12345cd $HADOOP_HOMEmkdir testfilesecho Hello World &gt;&gt; testfiles/test1.txtecho Hello Hadoop &gt;&gt; testfiles/test2.txtecho Hello spark &gt;&gt; testfiles/test3.txt æ‰§è¡Œåå†åˆ°dfsä¸­åˆ›å»ºä¸€ä¸ªinputtestfilesæ–‡ä»¶å¤¹,å¹¶å°†ç”¨äºæµ‹è¯•çš„æ–‡æœ¬æ–‡ä»¶å‘é€è¿›å»12hadoop fs -mkdir /inputfiletestshadoop fs -put testfiles/* /inputfiletests æ‰¾åˆ°mapreduceæ‰€åœ¨çš„ä½ç½®ï¼Œæ‰§è¡Œ12cd $HADOOP_HOME/share/hadoop/mapreducehadoop jar hadoop-mapreduce-examples-2.6.0.jar wordcount /inputfiletests /outputfiletests æ‰§è¡Œå®ŒæˆåæŸ¥çœ‹è¾“å‡ºè·¯å¾„/outputfiletestsï¼ŒåŒ…å«äº†è¿è¡ŒæˆåŠŸæ–‡ä»¶å’Œæœ€ç»ˆè¾“å‡ºæ–‡ä»¶ï¼Œæ‰“å¼€è¾“å‡ºçš„æ–‡ä»¶è¿›è¡ŒæŸ¥çœ‹12hadoop fs -ls /outputhadoop fs -cat /outputfiletests/part-r-00000 åŒæ—¶åœ¨hadoopåå°é‡Œä¹Ÿä¼šæœ‰wordcountçš„è¿è¡Œç»“æœ æœ€åï¼Œå…³é—­hadoopé›†ç¾¤12stop-dfs.shstop-yarn.sh","categories":[{"name":"BigData","slug":"BigData","permalink":"http://yoursite.com/categories/BigData/"}],"tags":[{"name":"Hadoop","slug":"Hadoop","permalink":"http://yoursite.com/tags/Hadoop/"}]},{"title":"å®ä¹ é¡¹ç›®ï¼šCRMç®¡ç†ç³»ç»Ÿ","slug":"å®ä¹ é¡¹ç›®ï¼šCRMç®¡ç†ç³»ç»Ÿ","date":"2019-06-06T05:59:01.000Z","updated":"2022-06-27T07:41:43.666Z","comments":true,"path":"2019/06/06/å®ä¹ é¡¹ç›®ï¼šCRMç®¡ç†ç³»ç»Ÿ/","link":"","permalink":"http://yoursite.com/2019/06/06/å®ä¹ é¡¹ç›®ï¼šCRMç®¡ç†ç³»ç»Ÿ/","excerpt":"é¡¹ç›®æ–‡ä»¶ä»£ç å·²å­˜å‚¨äºgithubï¼šhttps://github.com/elbadaernU404/projcode 1.å‰æœŸå‡†å¤‡é¦–å…ˆå®Œæˆäº†MySqlã€JspStudyçš„å®‰è£…ï¼Œæµ‹è¯•äº†æ•°æ®åº“çš„è¿æ¥ï¼ŒtomcatæœåŠ¡å™¨çš„éƒ¨ç½²ï¼Œä»¥åŠé…ç½®tomcatçš„åŠ¨æ€æ›´æ–°ç­‰æ“ä½œã€‚æ¥ä¸‹æ¥ä¸»è¦æ˜¯åšäº†å¯¹Htmlè¯­æ³•çš„å¤ä¹ ï¼Œå¹¶å°è¯•å¯¹åå°ç™»é™†ç•Œé¢çš„ç¼–ç¨‹ã€‚åœ¨é¡¹ç›®æ–‡ä»¶çš„æ ¹ç›®å½•ä¸‹/webä¸­åˆ›å»ºregister.htmlæ–‡ä»¶è¿›è¡Œæµ‹è¯•ï¼Œé€šè¿‡do getçš„æ–¹æ³•å‘é€ç½‘é¡µè¯·æ±‚ï¼Œä»¥åŠæ·»åŠ å„ç±»å¯è§†åŒ–å…ƒç´ ï¼Œå®Œæˆæ³¨å†Œç•Œé¢ã€‚åŒæ ·åœ¨/webä¸­åˆ›å»ºlogin.htmlæ–‡ä»¶ï¼Œé€šè¿‡do postçš„æ–¹æ³•å‘é€ç½‘é¡µè¯·æ±‚ï¼ˆéšè—æ˜¾ç¤ºçš„ç»†èŠ‚ï¼‰å®Œæˆç™»é™†ç•Œé¢ã€‚","text":"é¡¹ç›®æ–‡ä»¶ä»£ç å·²å­˜å‚¨äºgithubï¼šhttps://github.com/elbadaernU404/projcode 1.å‰æœŸå‡†å¤‡é¦–å…ˆå®Œæˆäº†MySqlã€JspStudyçš„å®‰è£…ï¼Œæµ‹è¯•äº†æ•°æ®åº“çš„è¿æ¥ï¼ŒtomcatæœåŠ¡å™¨çš„éƒ¨ç½²ï¼Œä»¥åŠé…ç½®tomcatçš„åŠ¨æ€æ›´æ–°ç­‰æ“ä½œã€‚æ¥ä¸‹æ¥ä¸»è¦æ˜¯åšäº†å¯¹Htmlè¯­æ³•çš„å¤ä¹ ï¼Œå¹¶å°è¯•å¯¹åå°ç™»é™†ç•Œé¢çš„ç¼–ç¨‹ã€‚åœ¨é¡¹ç›®æ–‡ä»¶çš„æ ¹ç›®å½•ä¸‹/webä¸­åˆ›å»ºregister.htmlæ–‡ä»¶è¿›è¡Œæµ‹è¯•ï¼Œé€šè¿‡do getçš„æ–¹æ³•å‘é€ç½‘é¡µè¯·æ±‚ï¼Œä»¥åŠæ·»åŠ å„ç±»å¯è§†åŒ–å…ƒç´ ï¼Œå®Œæˆæ³¨å†Œç•Œé¢ã€‚åŒæ ·åœ¨/webä¸­åˆ›å»ºlogin.htmlæ–‡ä»¶ï¼Œé€šè¿‡do postçš„æ–¹æ³•å‘é€ç½‘é¡µè¯·æ±‚ï¼ˆéšè—æ˜¾ç¤ºçš„ç»†èŠ‚ï¼‰å®Œæˆç™»é™†ç•Œé¢ã€‚ 2.æ³¨å†ŒåŠŸèƒ½&amp;æœåŠ¡å™¨ä¸æ•°æ®åº“çš„è¿æ¥1.åœ¨é¡¹ç›®ç›®å½•/srcé‡Œåˆ›å»ºmainæ–‡ä»¶å¤¹ï¼Œåœ¨mainæ–‡ä»¶å¤¹ä¸­åˆ†åˆ«åˆ›å»ºcontrollerã€daoã€modelã€serviceã€utiläº”ä¸ªå­æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸€ä¸€åˆ›å»ºç›¸å¯¹åº”çš„java classæ–‡ä»¶ï¼Œåœ¨web.xmlä¸­å®šä¹‰ã€‚ 2.åœ¨mysqlæ•°æ®åº“ä¸­æ‰¾åˆ°userè¡¨ï¼Œå¹¶é€šè¿‡æ–°å»ºæŸ¥è¯¢æµ‹è¯•åˆ›å»ºç”¨æˆ·çš„æŸ¥è¯¢è¯­å¥é€‚åˆå½“å‰æ•°æ®åº“ç‰ˆæœ¬ã€‚ 3.ç¼–å†™UserServlet.javaè·å–è¡¨å•çš„å±æ€§ï¼Œå¹¶å®Œæˆæ³¨å†ŒåŠŸèƒ½ç»“æŸåçš„è·³è½¬æ­¥éª¤ï¼Œå®ç°registeræ³¨å†Œé¡µé¢å‘loginç™»é™†é¡µé¢çš„è·³è½¬ã€‚123456789101112131415161718192021222324252627282930313233343536package main.controller;import main.model.User;import main.service.UserService;import javax.servlet.ServletException;import javax.servlet.http.HttpServlet;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.io.IOException;/** * @author rtl * @site elbadaernu404.github.io * @company suzhou university * @create 2020-06-21 16:40 */public class UserServlet extends HttpServlet&#123; @Override protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;//è·å–è¡¨å•ä¸­çš„å±æ€§å€¼ String username=req.getParameter(\"name\"); String password=req.getParameter(\"password\");//æ–°å»ºä¸€ä¸ªuserå¯¹è±¡ User user=new User(); user.setName(username); user.setPassword(password); //è°ƒç”¨serviceï¼Œå®Œæˆæœ€åçš„æ³¨å†ŒåŠŸèƒ½ UserService userService=new UserService(); userService.addUser(user);//æ³¨å†Œå®Œæˆåï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢ req.getRequestDispatcher(\"/login.jsp\").forward(req,resp); &#125; @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; &#125;&#125; 4.ç¼–å†™UserDao.javaå®Œæˆæ•°æ®åº“å†…å®¹çš„å¯¼å…¥ï¼Œç±»å‹ä¸ºInterfaceæ¥å£ç±»å‹ã€‚12345678910111213package main.dao;import main.model.User;/** * @author rtl * @site elbadaernu404.github.io * @company suzhou university * @create 2020-06-21 16:40 */public interface UserDao &#123; //ç”¨æˆ·æ³¨å†Œçš„åŠŸèƒ½ public void addUser(User user);&#125; 5.ç¼–å†™User.javaï¼Œå®ç°å…·ä½“çš„æ³¨å†ŒåŠŸèƒ½çš„å†™å…¥ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253package main.model;/** * @author rtl * @site elbadaernu404.github.io * @company suzhou university * @create 2020-06-21 16:40 */public class User &#123; private int id; private String name; private String password; public User() &#123; &#125; public User(int id, String name, String password) &#123; this.id = id; this.name = name; this.password = password; &#125; public int getId() &#123; return id; &#125; public void setId(int id) &#123; this.id = id; &#125; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public String getPassword() &#123; return password; &#125; public void setPassword(String password) &#123; this.password = password; &#125; @Override public String toString() &#123; return \"User&#123;\" + \"id=\" + id + \", name='\" + name + '\\'' + \", password='\" + password + '\\'' + '&#125;'; &#125;&#125; 6.ç¼–å†™UserService.javaå°†ç”¨æˆ·æ•°æ®æ“ä½œåˆ°æ•°æ®åº“å½“ä¸­ï¼Œå®Œæˆtomcatåˆ°æ•°æ®åº“çš„æ˜ å°„åŠŸèƒ½ã€‚123456789101112131415161718192021222324252627282930313233package main.service;import main.dao.UserDao;import main.model.User;import main.util.JdbcUtil;import java.sql.Connection;import java.sql.PreparedStatement;import java.sql.SQLException;/** * @author rtl * @site elbadaernu404.github.io * @company suzhou university * @create 2020-06-21 16:40 */public class UserService implements UserDao &#123; PreparedStatement ps=null; @Override public void addUser(User user) &#123; //çœŸæ­£çš„æŠŠç”¨æˆ·æ³¨å†Œçš„æ•°æ®è¿›è¡Œæ“ä½œåˆ°æ•°æ®åº“ä¸­ String sql=\"INSERT into user(name,password) values(?,?)\"; //ï¼Ÿæ˜¯å ä½ç¬¦çš„æ„æ€ Connection conn = null; conn = JdbcUtil.getConn(); try &#123; ps= conn.prepareStatement(sql); ps.setString(1,user.getName()); ps.setString(2,user.getPassword()); ps.executeUpdate(); &#125; catch (SQLException e) &#123; e.printStackTrace(); &#125; &#125;&#125; 7.ç¼–å†™JdbcUtil.javaï¼Œæ·»åŠ æœ¬åœ°æ•°æ®åº“é“¾æ¥åŠJdbcåŠŸèƒ½ï¼Œå®ŒæˆJdbcé©±åŠ¨ã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091package main.util;import java.sql.*;public class JdbcUtil &#123; static&#123; try &#123; Class.forName(\"com.mysql.jdbc.Driver\");//åŠ è½½æ•°æ®åº“é©±åŠ¨ &#125; catch (ClassNotFoundException e) &#123; e.printStackTrace(); &#125; &#125; private JdbcUtil() &#123;&#125; public static Connection getConn()&#123; Connection conn = null; try &#123; conn = DriverManager.getConnection(\"jdbc:mysql://localhost:3306/crmpro?useUnicode=true&amp;characterEncoding=utf-8\", \"root\",\"root\");//è¿æ¥æ•°æ®åº“ &#125; catch(SQLException e)&#123; e.printStackTrace(); &#125; return conn; &#125; public static void closeConn(Connection conn)&#123; try &#123; if(conn != null )&#123; conn.close(); conn = null; &#125; &#125; catch (SQLException e) &#123; e.printStackTrace(); &#125; &#125; public static PreparedStatement getPStmt(Connection conn,String sql)&#123; PreparedStatement pstmt = null; try &#123; pstmt = conn.prepareStatement(sql); &#125; catch (SQLException e) &#123; e.printStackTrace(); &#125; return pstmt; &#125; public static void closeStmt(Statement stmt)&#123; try &#123; if(stmt != null )&#123; stmt.close(); stmt = null; &#125; &#125; catch (SQLException e) &#123; e.printStackTrace(); &#125; &#125; public static ResultSet executeQuery(Statement stmt,String sql)&#123; ResultSet rs = null; try &#123; rs = stmt.executeQuery(sql); &#125; catch (SQLException e) &#123; e.printStackTrace(); &#125; return rs; &#125; public static void closeRs(ResultSet rs)&#123; try &#123; if(rs != null )&#123; rs.close(); rs = null; &#125; &#125; catch (SQLException e) &#123; e.printStackTrace(); &#125; &#125; public static ResultSet executeQuery(Connection conn,String sql)&#123;//é‡è½½ ResultSet rs = null; try &#123; rs = conn.createStatement().executeQuery(sql); &#125; catch (SQLException e) &#123; e.printStackTrace(); &#125; return rs; &#125;&#125; 8.æ·»åŠ tomcat-jdbc.jaråŒ…ï¼Œå®Œæˆé©±åŠ¨çš„åŠŸèƒ½ï¼Œä½¿å¾—æ‰€æœ‰æ–‡ä»¶å¯ä»¥ç›¸äº’è°ƒç”¨ï¼Œå®ç°æ³¨å†Œä¿¡æ¯å½•å…¥æœ¬åœ°æ•°æ®åº“ï¼Œæ³¨å†ŒåŠŸèƒ½åŸºæœ¬å®Œæˆã€‚ 9.è¿è¡Œç¨‹åºï¼Œæ³¨å†ŒåŠŸèƒ½æ­£å¸¸è¿è¡Œã€‚å®ç°äº†è¿›è¡Œé¡¹ç›®ä¸æ•°æ®åº“çš„è¿æ¥ 3.ç™»é™†åŠŸèƒ½1.åœ¨src/main/controllerä¸­åˆ›å»ºLoginServlet.javaï¼Œç¼–å†™ä»£ç å®ç°ä»ç™»é™†ç•Œé¢é€šè¿‡getæ–¹æ³•è·å–è´¦æˆ·å’Œå¯†ç ï¼Œå¹¶ä¸æ•°æ®åº“ç°å­˜æ•°æ®è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœéªŒè¯æˆåŠŸåˆ™ç™»é™†æˆåŠŸï¼ŒéªŒè¯å¤±è´¥åˆ™ç™»é™†æ— æ•ˆï¼Œè½¬è€Œè¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚1234567891011121314151617181920212223242526272829303132package main.controller;import main.model.User;import main.service.LoginService;import javax.servlet.ServletException;import javax.servlet.annotation.WebServlet;import javax.servlet.http.HttpServlet;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.io.IOException;import java.util.List;/** * @author rtl * @site elbadaernu404.github.io * @company suzhou university * @create 2020-06-21 16:40 */public class LoginServlet extends HttpServlet &#123; protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123; &#125; protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123; //ä»ç™»é™†ç•Œé¢è·å¾—äº†ç”¨æˆ·åå’Œå¯†ç  String username = request.getParameter(\"name\"); String password = request.getParameter(\"password\"); //ä¸æ•°æ®åº“çš„æ•°æ®è¿›è¡Œå¯¹æ¯” LoginService loginService=new LoginService(); User user=new User(); user.setName(username); user.setPassword(password); List list= loginService.login(user); &#125;&#125; 2.åœ¨src/main/daoä¸­åˆ›å»ºLoginDao.javaï¼Œéƒ¨ç½²æ¥å£ã€‚12345678910111213package main.dao;import main.model.User;import java.util.List;/** * @author rtl * @site elbadaernu404.github.io * @company suzhou university * @create 2020-06-21 16:40 */public interface LoginDao &#123; //ç™»å½•åŠŸèƒ½ public List login(User user);&#125; 3.åœ¨.åœ¨src/main/serviceä¸­åˆ›å»ºLoginServiceï¼Œç¼–å†™ä»£ç é€šè¿‡jdbcé©±åŠ¨æ¥å®ç°æ•°æ®åº“çš„æŸ¥è¯¢åŠŸèƒ½ï¼Œå¹¶é€šè¿‡æŸ¥è¯¢è¯­å¥è¿›è¡Œå…·ä½“çš„æ•°æ®åº“æ•°æ®çš„æŸ¥è¯¢æ“ä½œï¼Œå…¶æ‰§è¡ŒæŸ¥è¯¢å¹¶éå†ç»“æœé›†ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041424344454647package main.service;import main.dao.LoginDao;import main.model.User;import main.util.JdbcUtil;import java.sql.Connection;import java.sql.PreparedStatement;import java.sql.ResultSet;import java.sql.SQLException;import java.util.ArrayList;import java.util.List;/** * @author rtl * @site elbadaernu404.github.io * @company suzhou university * @create 2020-06-21 16:40 */public class LoginService implements LoginDao &#123; @Override public List login(User user) &#123; //è¿”å›å€¼çš„ç±»å‹æ˜¯ä¸€ä¸ªé›†åˆ List list=new ArrayList(); PreparedStatement ps=null; String sql =\"select * from user where name =? and password=?\" ;//jdbcå»å®ç°æŸ¥è¯¢åŠŸèƒ½ Connection conn = null; conn = JdbcUtil.getConn(); try &#123; ps= conn.prepareStatement(sql); ps.setString(1,user.getName()); ps.setString(2,user.getPassword()); ResultSet resultSet =ps.executeQuery();//æ‰§è¡ŒæŸ¥è¯¢è¯­å¥//éå†è¿™ä¸ªç»“æœé›† while(resultSet.next())&#123; String name=resultSet.getString(2); String password=resultSet.getString(3); list.add(name); list.add(password); &#125; &#125; catch (SQLException e) &#123; e.printStackTrace(); &#125; return list; &#125;&#125; 4.åœ¨LoginServlet.javaä¸­æ·»åŠ ä»£ç ï¼Œå®ç°ç™»é™†æˆåŠŸå‘localhostä¸»é¡µé¢è·³è½¬ï¼Œç™»é™†å¤±è´¥åˆ™å‘register.jspæ³¨å†Œé¡µé¢è·³è½¬ã€‚1234567if (list.size()&gt;0)&#123; //ç”¨æˆ·åå¯†ç å­˜åœ¨ï¼Œç™»é™†æˆåŠŸ request.getRequestDispatcher(\"index.jsp\").forward(request,response);&#125;else&#123; //ç”¨æˆ·åå¯†ç ä¸å­˜åœ¨ï¼Œç™»é™†å¤±è´¥ request.getRequestDispatcher(\"register.jsp\").forward(request,response);&#125; LoginServlet.javaå®Œæ•´ä»£ç å¦‚ä¸‹:12345678910111213141516171819202122232425262728293031323334353637383940package main.controller;import main.model.User;import main.service.LoginService;import javax.servlet.ServletException;import javax.servlet.annotation.WebServlet;import javax.servlet.http.HttpServlet;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.io.IOException;import java.util.List;/** * @author rtl * @site elbadaernu404.github.io * @company suzhou university * @create 2020-06-21 16:40 */public class LoginServlet extends HttpServlet &#123; protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123; &#125; protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123; //ä»ç™»é™†ç•Œé¢è·å¾—äº†ç”¨æˆ·åå’Œå¯†ç  String username = request.getParameter(\"name\"); String password = request.getParameter(\"password\"); //ä¸æ•°æ®åº“çš„æ•°æ®è¿›è¡Œå¯¹æ¯” LoginService loginService=new LoginService(); User user=new User(); user.setName(username); user.setPassword(password); List list= loginService.login(user); if (list.size()&gt;0)&#123; //ç”¨æˆ·åå¯†ç å­˜åœ¨ï¼Œç™»é™†æˆåŠŸ request.getRequestDispatcher(\"index.jsp\").forward(request,response); &#125;else&#123; //ç”¨æˆ·åå¯†ç ä¸å­˜åœ¨ï¼Œç™»é™†å¤±è´¥ request.getRequestDispatcher(\"register.jsp\").forward(request,response); &#125; &#125;&#125; 5.åœ¨UserServlet.javaä¸­æ·»åŠ ä»£ç ï¼Œå®ç°æ³¨å†Œå®Œæˆå‘login.jspç™»é™†é¡µé¢è·³è½¬çš„åŠŸèƒ½ã€‚12//æ³¨å†Œå®Œæˆåï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢req.getRequestDispatcher(\"/login.jsp\").forward(req,resp); 6.åœ¨web.xmlä¸­å®šä¹‰ä»¥æ·»åŠ ä¸Šè¿°åŠŸèƒ½ã€‚123456789101112131415161718192021222324252627&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;web-app xmlns=\"http://xmlns.jcp.org/xml/ns/javaee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd\" version=\"3.1\"&gt; &lt;welcome-file-list&gt; &lt;welcome-file&gt;login.jsp&lt;/welcome-file&gt; &lt;/welcome-file-list&gt; &lt;servlet&gt; &lt;servlet-name&gt;UserServlet&lt;/servlet-name&gt; &lt;servlet-class&gt;main.controller.UserServlet&lt;/servlet-class&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;UserServlet&lt;/servlet-name&gt; &lt;url-pattern&gt;/register&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; &lt;servlet&gt; &lt;servlet-name&gt;LoginServlet&lt;/servlet-name&gt; &lt;servlet-class&gt;main.controller.LoginServlet&lt;/servlet-class&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;LoginServlet&lt;/servlet-name&gt; &lt;url-pattern&gt;/login&lt;/url-pattern&gt; &lt;/servlet-mapping&gt;&lt;/web-app&gt; 7.å¯åŠ¨tomcatæœåŠ¡å™¨ï¼Œè¿è¡Œï¼Œå½»åº•å®Œæˆæ³¨å†ŒåŠç™»é™†åŠŸèƒ½åŠä¸€ç³»åˆ—è·³è½¬æ­¥éª¤ï¼Œæœ€ååœ¨web.xmlä¸­å°†login.jspè®¾ç½®ä¸ºtomcatæœåŠ¡å™¨å¯åŠ¨çš„ä¸»ç•Œé¢ã€‚ 4.EasyUIæ¡†æ¶1.è¿›å…¥jquery easyuiå®˜ç½‘é¦–é¡µhttp://www.jeasyui.netï¼Œè¿›è¡Œæµè§ˆeasyuiçš„ç›¸å…³ä¿¡æ¯ï¼Œäº†è§£easyuiçš„å®ä¾‹demoåŠæ•™ç¨‹ã€‚ 2.è¿›å…¥easyuiçš„ä¸‹è½½ç•Œé¢ï¼Œé€‰æ‹©ä¸‹è½½â€œEasyUI for jQueryâ€ï¼Œè¿™é‡Œé€‰æ‹©å…è´¹ç‰ˆæœ¬ã€‚ 3.å°†ä¸‹è½½å¥½çš„easyuiæ–‡ä»¶è§£å‹ï¼Œé‡å‘½ååæ•´ä½“å¤åˆ¶åˆ°/webç›®å½•ä¸­å»ï¼Œç»è¿‡ä¸€æ®µæ—¶é—´æ–‡ä»¶å¯¼å…¥å®Œæ¯•ã€‚ 4.ä¿®æ”¹æ­£ç¡®çš„æ–‡ä»¶è·¯å¾„ï¼Œå°†easyui.cssã€icon.cssã€jquery.min.jsã€jquery.easyui.min.jså’Œdemo.cssæ–‡ä»¶ä¸€åŒæ·»åŠ åˆ°index.jspæ–‡ä»¶çš„&#60;head&#62;&#60;/head&#62;ä¸­ã€‚123456789101112&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;Insert title here&lt;/title&gt; &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"easyui/themes/bootstrap/easyui.css\"&gt; &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"easyui/themes/icon.css\"&gt; &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"./easyui/demo/demo.css\"&gt; &lt;script type=\"text/javascript\" src=\"easyui/jquery.min.js\"&gt;&lt;/script&gt; &lt;script type=\"text/javascript\" src=\"easyui/jquery.easyui.min.js\"&gt;&lt;/script&gt; ...&lt;/head&gt; 5.é€šè¿‡ä½¿ç”¨åå°çš„åŸºæœ¬æ¡†æ¶ä»£ç ï¼Œè¿›è¡Œä¿®æ”¹index.jspæ–‡ä»¶çš„&#60;body&#62;&#60;/body&#62;éƒ¨åˆ†ï¼Œå®Œæˆä¸€ä¸ªæœ€åŸºæœ¬çš„åŸºäºeasyuiçš„CRMç”¨æˆ·ç®¡ç†ç³»ç»Ÿåå°ä»£ç ã€‚å®Œæ•´çš„index.jspæ–‡ä»¶ä»£ç å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112&lt;%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %&gt;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;Insert title here&lt;/title&gt; &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"easyui/themes/bootstrap/easyui.css\"&gt; &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"easyui/themes/icon.css\"&gt; &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"./easyui/demo/demo.css\"&gt; &lt;script type=\"text/javascript\" src=\"easyui/jquery.min.js\"&gt;&lt;/script&gt; &lt;script type=\"text/javascript\" src=\"easyui/jquery.easyui.min.js\"&gt;&lt;/script&gt; &lt;style&gt; .westname &#123; text-decoration:none; &#125; &lt;/style&gt; &lt;script type=\"text/javascript\"&gt; $(function()&#123; $('.westname').click(function()&#123; var name = this.innerHTML; var url = this.href; //é€šè¿‡è·å–çš„åå­—åˆ›å»ºé€‰é¡¹å¡ crateTabs(name,url); //è®©è¶…é“¾æ¥ä¸è·³è½¬ return false; &#125;); &#125;); //åˆ›å»ºtabsçš„å‡½æ•° function crateTabs(name,url)&#123; if($('#tt').tabs('exists',name))&#123; $('#tt').tabs('select',name); &#125;else&#123; $('#tt').tabs('add',&#123; title:name, content:createUrl(url), closable:true &#125;); &#125; &#125; //ä½¿ç”¨iframeè½¬åŒ–é‡Œé¢çš„æ•°æ®ä½¿ä¹‹è¿”å›çš„æ˜¯urlé‡Œé¢çš„æ•°æ® function createUrl(url)&#123; return \"&lt;iframe src='\"+url+\"' style='border:0px;width:100%;height:95%;'&gt;&lt;/iframe&gt;\"; &#125; &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div id=\"cc\" class=\"easyui-layout\" data-options=\"fit:true\"&gt; &lt;div data-options=\"region:'north',title:'CRMç®¡ç†ç³»ç»Ÿ',split:true\" style=\"height:100px;background-color: #0081c2\"&gt; &lt;font size=\"6\" color=white&gt;&lt;div&gt; &lt;span&gt; &lt;script type=\"text/javascript\"&gt; var date = new Date(); document.write(date.getFullYear() + \"å¹´\" + (date.getMonth() + 1) + \"æœˆ\" + date.getDate() + \"æ—¥\" + \" æ˜ŸæœŸ\" + \"æ—¥ä¸€äºŒä¸‰å››äº”å…­\".charAt(date.getDay())); &lt;/script&gt; &lt;/span&gt; &lt;/div&gt;&lt;/font&gt; &lt;%--&lt;img src=\"img/2.png\" width=\"100% \"height=\"100%\"/&gt;--%&gt; &lt;/div&gt; &lt;div data-options=\"region:'west',title:'ç³»ç»Ÿèœå•',split:true\" style=\"width:240px;\"&gt; &lt;div id=\"aa\" class=\"easyui-accordion\" data-options=\"fit:true\"&gt; &lt;div title=\"å®¢æˆ·ç®¡ç†\" data-options=\"iconCls:'icon-reload',selected:true\" style=\"overflow: auto; padding: 10px;background-color: #DCDCE2\"&gt; &lt;a href=\"customer.jsp\" class=\"westname\" &gt;å®¢æˆ·ç®¡ç†&lt;/a&gt; &lt;br&gt;&lt;a href=\"department.jsp\" class=\"westname\" &gt;éƒ¨é—¨ä¿¡æ¯&lt;/a&gt;&lt;/br&gt; &lt;a href=\"employee.jsp\" class=\"westname\" &gt;å‘˜å·¥ç®¡ç†&lt;/a&gt; &lt;/div&gt; &lt;div title=\"æ•°æ®ç®¡ç†\" data-options=\"iconCls:'icon-reload'\" style=\"padding: 10px;background-color: #DCDCE2\"&gt; &lt;a href=\"linkMen.html\" class=\"westname\"&gt;å­—å…¸ç›®å½•&lt;/a&gt; &lt;br&gt;&lt;a href=\"linkMen.html\" class=\"westname\"&gt;å­—å…¸æ˜ç»†&lt;/a&gt;&lt;/br&gt; &lt;/div&gt; &lt;div title=\"å‘˜å·¥ç®¡ç†\" data-options=\"iconCls:'icon-reload'\" style=\"padding: 10px;background-color: #DCDCE2\"&gt; &lt;a href=\"#\" class=\"westname\"&gt;å‘˜å·¥ç®¡ç†&lt;/a&gt; &lt;/div&gt; &lt;div title=\"è®¢å•ç®¡ç†\" data-options=\"iconCls:'icon-reload'\" style=\"padding: 10px;background-color: #DCDCE2\"&gt; &lt;a href=\"#\" class=\"westname\"&gt;è®¢å•ç®¡ç†&lt;/a&gt; &lt;/div&gt; &lt;div title=\"åœ°å€ç®¡ç†\" data-options=\"iconCls:'icon-reload'\" style=\"padding: 10px;background-color: #DCDCE2\"&gt; &lt;a href=\"#\" class=\"westname\"&gt;åœ°å€ç®¡ç†&lt;/a&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div data-options=\"region:'center',title:''\" style=\"padding:5px;background:#eee;\"&gt; &lt;div id=\"tt\" class=\"easyui-tabs\" data-options=\"fit:true\"&gt; &lt;div align=\"center\" title=\"ä¸»é¡µ\" data-options=\"closable:true\" style=\"overflow: auto; padding: 20px; display: none;background-color: white;\"&gt; &lt;form id=\"bdfm\" target=\"_blank\" name=\"bdfm\" method=\"get\" action=\"http://www.baidu.com/s\"&gt; &lt;table&gt; &lt;tr&gt; &lt;td&gt; &lt;a href=\"http://www.baidu.com\"&gt; &lt;img src=\"img/baidu.png\"/&gt; &lt;/a&gt; &lt;/td&gt; &lt;td&gt;&lt;br/&gt;&lt;input type=\"text\" id=\"search1\" name=\"word\"/&gt;&lt;/td&gt; &lt;td&gt;&lt;br/&gt;&lt;input type=\"submit\" value=\"æœç´¢\" /&gt;&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;/form&gt; &lt;img src=\"img/1.png\" alt=\"some_text\"&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; 6.åœ¨web.xmlä¸­è¿›ä¸€æ­¥æ·»åŠ å¿…è¦ä¿¡æ¯ã€‚ 7.å¯åŠ¨tomcatæœåŠ¡å™¨ï¼Œé€šè¿‡éªŒè¯è´¦å·å¯†ç è¿›å…¥CRMåå°ç³»ç»Ÿï¼Œç•Œé¢åŸºæœ¬æˆå½¢ã€‚ 8.ä¿æŒtomcatæœåŠ¡å™¨çš„å¯åŠ¨ï¼Œåœ¨easyuiçš„easyui.cssæ–‡ä»¶ä¸­ä¿®æ”¹æ¡†æ¶å„æˆåˆ†çš„é¢œè‰²ï¼Œå¯¹åå°åšæœ€åˆçš„ä¼˜åŒ–ã€‚ 5.ä¸æ•°æ®åº“çš„è¿›ä¸€æ­¥äº¤äº’1.åœ¨src/main/controllerä¸­æ–°å»ºGetAllUser.javaæ–‡ä»¶ï¼Œç¼–å†™ä»£ç å®ç°easyuiæ¡†æ¶çš„åå°èƒ½å¤Ÿè·å–æ•°æ®ã€‚ä¸»è¦æ€è·¯ä¸ºé€šè¿‡å°†æ•°æ®åº“listæ•°æ®ç±»å‹è½¬åŒ–ä¸ºjsonæ•°ç»„ï¼Œä½¿å¾—æ•°æ®é›†åˆä»¥jsonçš„é”®å€¼å¯¹æ ¼å¼è¿”å›åˆ°easyuiå‰ç«¯ã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152package main.controller;import main.model.User;import main.service.GetUserService;import main.util.UserOperation;import net.sf.json.JSONArray;import net.sf.json.JSONObject;import javax.servlet.ServletException;import javax.servlet.http.HttpServlet;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import java.io.IOException;import java.io.PrintWriter;import java.util.HashMap;import java.util.List;import java.util.Map;/** * @author rtl * @site elbadaernu404.github.io * @company suzhou university * @create 2020-06-21 16:40 */public class GetAllUser extends HttpServlet &#123; @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123; super.doGet(req, resp); &#125; @Override protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123; PrintWriter out = response.getWriter(); //è¯·æ±‚é¡µç ã€æ¯é¡µæ˜¾ç¤ºè¡Œæ•°ã€åç§»ã€æ€»æ•° int page,rows,offset,total; //è·å– String input_page=request.getParameter(\"page\"); page=(input_page==null)?1:Integer.parseInt(input_page);//é¡µç æ•° String input_rows=request.getParameter(\"rows\"); rows=(input_rows==null)?10:Integer.parseInt(input_rows);//æ¯é¡µå¤šå°‘æ¡æ•°æ® offset=(page-1)*rows; UserOperation operation=new UserOperation(); total=operation.selectCount(); List&lt;User&gt; users=operation.selectPage(offset, rows); Map&lt;String, Object&gt; jsonMap = new HashMap&lt;String, Object&gt;();//å®šä¹‰map jsonMap.put(\"total\", total);//totalé”® å­˜æ”¾æ€»è®°å½•æ•°ï¼Œå¿…é¡»çš„ jsonMap.put(\"rows\", users);//rowsé”® å­˜æ”¾æ¯é¡µè®°å½• list String result = JSONObject.fromObject(jsonMap).toString();//æ ¼å¼åŒ–result ä¸€å®šè¦æ˜¯JSONObject out.print(result); out.flush(); out.close(); &#125;&#125; 2.å°†jsonçš„jaråŒ…å¯¼å…¥ideaã€‚ 3.åœ¨src/main/daoä¸­æ–°å»ºGetUserDao.javaæ¥å£ç±»å‹æ–‡ä»¶ï¼Œåˆ›å»ºæ˜¾ç¤ºç”¨æˆ·æ•°æ®çš„æ•°æ®åº“æ¥å£ã€‚123456789101112package main.dao;import main.model.User;import java.util.List;/** * @author rtl * @site elbadaernu404.github.io * @company suzhou university * @create 2020-06-21 16:40 */public interface GetUserDao &#123; public List&lt;User&gt; GetAllUser();//è¿”å›å€¼ç±»å‹List&lt;User&gt;&#125; 4.åœ¨src/main/serviceä¸­æ–°å»ºGetUserService.javaæ–‡ä»¶ï¼Œæ­¤ç¨‹åºçš„åŠŸèƒ½ä¸ºé€šè¿‡jdbcé©±åŠ¨å»å®ç°æ•°æ®åº“æŸ¥è¯¢çš„åŠŸèƒ½ï¼Œä½¿å¾—åå°å¯ä»¥é€šè¿‡æŸ¥è¯¢è¯­å¥éå†å¹¶è¿”å›å‡ºç»“æœï¼Œæ˜¯æŸ¥è¯¢æ•°æ®çš„å…·ä½“åŠŸèƒ½å®ç°ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142package main.service;import main.dao.GetUserDao;import main.model.User;import main.util.JdbcUtil;import java.sql.Connection;import java.sql.PreparedStatement;import java.sql.ResultSet;import java.sql.SQLException;import java.util.ArrayList;import java.util.List;/** * @author rtl * @site elbadaernu404.github.io * @company suzhou university * @create 2020-06-21 16:40 */public class GetUserService implements GetUserDao &#123; @Override public List&lt;User&gt; GetAllUser() &#123; List&lt;User&gt; list=new ArrayList(); PreparedStatement ps=null; String sql =\"select * from user \" ;//jdbcå»å®ç°æŸ¥è¯¢åŠŸèƒ½ Connection conn = null; conn = JdbcUtil.getConn(); try &#123; ps= conn.prepareStatement(sql); ResultSet resultSet =ps.executeQuery();//æ‰§è¡ŒæŸ¥è¯¢è¯­å¥//éå†è¿™ä¸ªç»“æœé›† while(resultSet.next())&#123; int id=resultSet.getInt(1); String name=resultSet.getString(2); String password=resultSet.getString(3); User user=new User(id,name,password); list.add(user); &#125; &#125; catch (SQLException e) &#123; e.printStackTrace(); &#125; return list; &#125;&#125; 5.åœ¨web.xmlä¸­æ·»åŠ ä¸Šè¿°åŠŸèƒ½æ˜ å°„ã€‚12345678&lt;servlet&gt; &lt;servlet-name&gt;GetAllUser&lt;/servlet-name&gt; &lt;servlet-class&gt;main.controller.GetAllUser&lt;/servlet-class&gt;&lt;/servlet&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;GetAllUser&lt;/servlet-name&gt; &lt;url-pattern&gt;/getAllUser&lt;/url-pattern&gt;&lt;/servlet-mapping&gt; 6.åœ¨/webæ–‡ä»¶å¤¹ä¸‹æ–°å»ºcustom.jspæ–‡ä»¶ï¼Œå‡†å¤‡ç”¨æ¥æ˜¾ç¤ºç”¨æˆ·æ•°æ®ã€‚ 7.åœ¨custom.jspæ–‡ä»¶ä¸­æ·»åŠ å¢æ·»ç”¨æˆ·çš„æŒ‰é’®æ§ä»¶ï¼Œç¼–å†™å…·ä½“åŠŸèƒ½ã€‚custom.jspæ–‡ä»¶ä¸­å…·ä½“ä»£ç å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147&lt;%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %&gt;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;å®¢æˆ·ç®¡ç†&lt;/title&gt; &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"easyui/themes/bootstrap/easyui.css\"&gt; &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"easyui/themes/icon.css\"&gt; &lt;script type=\"text/javascript\" src=\"easyui/jquery.min.js\"&gt;&lt;/script&gt; &lt;script type=\"text/javascript\" src=\"easyui/jquery.easyui.min.js\"&gt;&lt;/script&gt; &lt;script type=\"text/javascript\" src=\"easyui/locale/easyui-lang-zh_CN.js\"&gt;&lt;/script&gt; &lt;script type=\"text/javascript\"&gt; var url; $(function()&#123; $('#dg').datagrid(&#123; url:'getAllUser', columns:[[ &#123;field:'id',title:'id',width:100&#125;, &#123;field:'name',title:'ç”¨æˆ·å',width:100&#125;, &#123;field:'password',title:'å¯†ç ',width:100&#125; ]] , striped:'true', pagination:'true', pagePosition:'bottom', pageNumber:1, pageSize:5, pageList: [3,5,10] &#125;); &#125;); function newUser()&#123;$('#winAdd').window('open');&#125; function save()&#123; //æäº¤è¡¨å•æ•°æ® $('#formAdd').form('submit', &#123; url:\"saveUser\" &#125;); alert('ä¿å­˜æˆåŠŸ'); //å…³é—­çª—å£ $(\"#winAdd\").window(\"close\"); //è¡¨æ ¼é‡æ–°åŠ è½½ $(\"#dg\").datagrid(\"reload\"); &#125; function deleteUser() &#123; var row = $('#dg').datagrid('getSelected'); if (row) &#123; $.messager.confirm(\"ç³»ç»Ÿæç¤º\", \"æ‚¨ç¡®å®šè¦åˆ é™¤è¿™æ¡è®°å½•å—?\", function (r) &#123; if (r) &#123; $.post('userDelete', &#123;id: row.id&#125;, function (result) &#123; if (result.success) &#123; $.messager.alert(\"ç³»ç»Ÿæç¤º\", \"å·²æˆåŠŸåˆ é™¤è¿™æ¡è®°å½•!\"); $(\"#dg\").datagrid(\"reload\"); &#125; else &#123; $.messager.alert(\"ç³»ç»Ÿæç¤º\", result.errorMsg); &#125; &#125;, 'json'); &#125; &#125;); &#125; &#125; function editUser()&#123; var row=$('#dg').datagrid('getSelected'); if(row)&#123; $(\"#dlg\").dialog('open').dialog('setTitle','ç¼–è¾‘ç”¨æˆ·'); $('#formAdd2').form('load',row);//æŠŠè¡¨å•æ•°æ®å¸¦è¿‡æ¥è¿›è¡Œå¡«å…… url='userSave?id='+row.id; &#125; &#125; function saveUser()&#123; $('#formAdd2').form('submit',&#123; url:url, onSubmit:function()&#123; return $(this).form('validate'); &#125;, &#125;); $.messager.alert(\"ç³»ç»Ÿæç¤º\",\"ä¿å­˜æˆåŠŸ\"); $('#dlg').dialog('close'); $(\"#dg\").datagrid(\"reload\"); &#125; &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;table id=\"dg\"&gt; &lt;div id=\"toolbar\"&gt; &lt;a href=\"javascript:void(0)\" class=\"easyui-linkbutton\" iconCls=\"icon-add\" plain=\"true\" onclick=\"newUser()\"&gt;æ·»åŠ ç”¨æˆ·&lt;/a&gt; &lt;a href=\"javascript:void(0)\" class=\"easyui-linkbutton\" iconCls=\"icon-edit\" plain=\"true\" onclick=\"editUser()\"&gt;ç¼–è¾‘ç”¨æˆ·&lt;/a&gt; &lt;a href=\"javascript:void(0)\" class=\"easyui-linkbutton\" iconCls=\"icon-remove\" plain=\"true\" onclick=\"deleteUser()\"&gt;åˆ é™¤ç”¨æˆ·&lt;/a&gt; &lt;a href=\"javascript:void(0)\" class=\"easyui-linkbutton\" iconCls=\"icon-search\" plain=\"true\" onclick=\"doSearch()\"&gt;Search&lt;/a&gt; &lt;/div&gt;&lt;/table&gt;&lt;!-- æ·»åŠ å®¢æˆ·çš„è¡¨å•ï¼Œé»˜è®¤æ˜¯éšè—çš„ --&gt;&lt;div id=\"winAdd\" class=\"easyui-window\" title=\"æ·»åŠ å®¢æˆ·\" style=\"width:600px;height:400px\" data-options=\"iconCls:'icon-save',modal:true,closed:true\"&gt; &lt;form id=\"formAdd\" method=\"post\"&gt; &lt;TABLE cellSpacing=0 cellPadding=5 border=0&gt; &lt;TR&gt; &lt;td&gt;ç”¨æˆ·åï¼š&lt;/td&gt; &lt;td&gt; &lt;INPUT class=textbox style=\"WIDTH: 180px\" maxLength=50 name=\"name\"&gt; &lt;/td&gt; &lt;td&gt;å¯†ç  ï¼š&lt;/td&gt; &lt;td&gt; &lt;INPUT class=textbox dstyle=\"WIDTH: 180px\" maxLength=50 name=\"password\"&gt; &lt;/td&gt; &lt;/TR&gt; &lt;tr&gt; &lt;td rowspan=2&gt; &lt;button id=\"customerBtn\" type=\"button\" onclick=\"save()\"&gt;ä¿å­˜&lt;/button&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/TABLE&gt; &lt;/form&gt;&lt;/div&gt;&lt;!-- ç¼–è¾‘å®¢æˆ·çš„è¡¨å•ï¼Œé»˜è®¤æ˜¯éšè—çš„ --&gt;&lt;div id=\"dlg\" class=\"easyui-window\" title=\"ç¼–è¾‘å®¢æˆ·\" style=\"width:600px;height:400px\" data-options=\"iconCls:'icon-save',modal:true,closed:true\"&gt; &lt;form id=\"formAdd2\" method=\"post\"&gt; &lt;TABLE cellSpacing=0 cellPadding=5 border=0&gt; &lt;TR&gt; &lt;td&gt;ç”¨æˆ·åï¼š&lt;/td&gt; &lt;td&gt; &lt;INPUT class=textbox style=\"WIDTH: 180px\" maxLength=50 name=\"name\"&gt; &lt;/td&gt; &lt;td&gt;å¯†ç  ï¼š&lt;/td&gt; &lt;td&gt; &lt;INPUT class=textbox dstyle=\"WIDTH: 180px\" maxLength=50 name=\"password\"&gt; &lt;/td&gt; &lt;/TR&gt; &lt;tr&gt; &lt;td rowspan=2&gt; &lt;button id=\"customerBtn2\" type=\"button\" onclick=\"saveUser()\"&gt;ä¿å­˜&lt;/button&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/TABLE&gt; &lt;/form&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; 8.åœ¨src/mainä¸­åˆ›å»ºSaveUser.javaæ–‡ä»¶ç”¨äºä¿å­˜æ·»åŠ ç»“æœï¼›åˆ›å»ºSaveUserDaoåˆ›å»ºæ•°æ®åº“æ¥å£ï¼›åˆ›å»ºSaveUserService.javaæ–‡ä»¶ï¼Œé€šè¿‡jdbcé©±åŠ¨å¯¹æ•°æ®åº“è¿›è¡Œå®é™…æ“ä½œï¼Œä»¥æ›´æ–°ç”¨æˆ·çŠ¶æ€å¹¶ä¿å­˜ã€‚ 9.å¯åŠ¨tomcatæœåŠ¡å™¨æµ‹è¯•é¡¹ç›®æ˜¾ç¤ºå’Œæ–°å¢ç”¨æˆ·çš„è¿è¡Œç»“æœã€‚ 6.å¢åˆ æ”¹æŸ¥1.åœ¨/web/custom.jspæ–‡ä»¶ä¸­æ–°å¢æ•°æ®çš„ä¿®æ”¹å’Œæ•°æ®åˆ é™¤ä¸¤ä¸ªæ§ä»¶ï¼Œå¹¶ç¼–å†™æ“ä½œçª—å£ï¼Œç”¨äºä¿®æ”¹å’Œæç¤ºï¼Œå¢åŠ é¡¹ç›®çš„å¯è§†åŒ–ã€‚ 2.åœ¨/src/main/controllerä¸­æ–°å»ºUserSave.javaæ–‡ä»¶ï¼Œç¼–å†™ç¨‹åºç”¨äºå®ç°ä¿å­˜å‰å°ä¼ é€’è¿‡æ¥çš„ç”¨æˆ·åå’Œå¯†ç ã€‚ 3.åœ¨/src/main/controllerä¸­æ–°å»ºUserDelete.javaæ–‡ä»¶ï¼Œç¼–å†™ç¨‹åºç”¨äºå®ç°æ•°æ®çš„é€‰ä¸­çš„åˆ é™¤æ“ä½œã€‚ 4.åœ¨/src/main/daoä¸­æ–°å»ºUserDeleteDao.javaæ–‡ä»¶ï¼Œç¼–å†™javaæ•°æ®åº“çš„æ¥å£ç¨‹åºï¼Œä¸ºé“¾æ¥æ•°æ®åº“åšå‡†å¤‡ã€‚ 5.åœ¨/src/main/serviceä¸­æ–°å»ºUserDeleteService.javaæ–‡ä»¶ï¼Œç¼–å†™ç¨‹åºç”¨äºå®ç°å°†æ•°æ®é€šè¿‡å®é™…çš„æŸ¥è¯¢è¯­å¥ï¼Œæ“ä½œåœ¨æ•°æ®åº“ä¸­ï¼ŒçœŸæ­£çš„å®ç°æ•°æ®çš„åˆ é™¤æ“ä½œï¼Œå¹¶è¿”å›ç»™ç”¨æˆ·æˆåŠŸæç¤ºã€‚ 6.åœ¨web.xmlå½“ä¸­æ–°å¢ä¸Šè¿°æ˜ å°„ã€‚1234567891011121314151617&lt;servlet&gt; &lt;servlet-name&gt;UserDelete&lt;/servlet-name&gt; &lt;servlet-class&gt;main.controller.UserDelete&lt;/servlet-class&gt;&lt;/servlet&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;UserDelete&lt;/servlet-name&gt; &lt;url-pattern&gt;/userDelete&lt;/url-pattern&gt;&lt;/servlet-mapping&gt;&lt;servlet&gt; &lt;servlet-name&gt;UserSave&lt;/servlet-name&gt; &lt;servlet-class&gt;main.controller.UserSave&lt;/servlet-class&gt;&lt;/servlet&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;UserSave&lt;/servlet-name&gt; &lt;url-pattern&gt;/userSave&lt;/url-pattern&gt;&lt;/servlet-mapping&gt; 7.åœ¨/src/main/utilä¸­æ–°å»ºJsonUtil.javaæ–‡ä»¶ï¼Œç¼–å†™å…·ä½“ç¨‹åºç”¨äºä½¿resultç»“æœè½¬åŒ–ä¸ºjsonæ•°ç»„æ ¼å¼ã€‚1234567891011121314151617181920212223242526272829303132package main.util;import net.sf.json.JSONArray;import net.sf.json.JSONObject;import java.sql.ResultSet;import java.sql.ResultSetMetaData;/** * @author rtl * @site elbadaernu404.github.io * @company suzhou university * @create 2020-06-21 16:40 */public class JsonUtil &#123; /** * å°†resultçš„ç»“æœé›†è½¬åŒ–æˆjsonæ•°ç»„æ ¼å¼ * @param rs * @return * @throws Exception */ public static JSONArray formatRsToJsonArray(ResultSet rs)throws Exception&#123; ResultSetMetaData md=rs.getMetaData(); int num=md.getColumnCount(); JSONArray array=new JSONArray(); while(rs.next())&#123; JSONObject mapOfColValues=new JSONObject(); for(int i=1;i&lt;=num;i++)&#123; mapOfColValues.put(md.getColumnName(i), rs.getObject(i)); &#125; array.add(mapOfColValues); &#125; return array; &#125;&#125; 8.ç»§ç»­åœ¨utilæ–‡ä»¶å¤¹ä¸­æ–°å»ºUserOperation.javaæ–‡ä»¶ï¼Œç¼–å†™ç¨‹åºé€šè¿‡è®¡ç®—userç±»åœ¨æ•°æ®åº“ä¸­çš„æ€»æ•°æ®æ¡ç›®ï¼ŒæŠŠæ£€ç´¢ç»“æœçœ‹æˆåªæœ‰ä¸€æ¡è®°å½•ä¸€ä¸ªå­—æ®µçš„è¡¨ï¼Œå®ç°æ•°æ®çš„åˆ†é¡µåŠŸèƒ½ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859package main.util;import main.model.User;import java.sql.Connection;import java.sql.PreparedStatement;import java.sql.ResultSet;import java.sql.SQLException;import java.util.ArrayList;import java.util.List;/** * @author rtl * @site elbadaernu404.github.io * @company suzhou university * @create 2020-06-21 16:40 */public class UserOperation &#123; public List selectPage(int offset, int size) &#123;//æ³¨æ„è¿”å›å€¼nullå’Œlist.size()==0çš„åŒºåˆ« PreparedStatement ps=null; ResultSet rs=null; ArrayList&lt;User&gt; list=new ArrayList&lt;User&gt;();//è¿”å›å€¼ Connection conn = null; conn = JdbcUtil.getConn(); try &#123; ps=conn.prepareStatement(\"select * from user limit \"+offset+\",\"+size); rs= ps.executeQuery(); while(rs.next())&#123; User one=new User();//è¿”å›å€¼ä¸­çš„ä¸€ä¸ª one.setId(rs.getInt(1)); one.setName(rs.getString(2)); one.setPassword(rs.getString(3)); list.add(one);//æ·»åŠ åˆ°åˆ—è¡¨ &#125; return list; &#125; catch (Exception ex) &#123; return null; &#125; &#125;//è®¡ç®—userç±»åœ¨æ•°æ®åº“ä¸­æ€»å…±æœ‰å¤šå°‘æ¡æ•°æ® public int selectCount()&#123; PreparedStatement ps=null; ResultSet rs=null; ArrayList&lt;User&gt; list=new ArrayList&lt;User&gt;();//è¿”å›å€¼ Connection conn = null; conn = JdbcUtil.getConn(); int count=0; try &#123; ps=conn.prepareStatement(\"select count(*) from user \"); rs= ps.executeQuery(); while(rs.next()) &#123;//æ‰“å°çš„å°±æ˜¯æ€»è®°å½•æ•°ã€‚æŠŠæ£€ç´¢ç»“æœçœ‹æˆåªæœ‰ä¸€è·³è®°å½•ä¸€ä¸ªå­—æ®µçš„è¡¨ count=rs.getInt(1); System.out.println(count); &#125; &#125; catch (SQLException e) &#123; e.printStackTrace(); &#125;return count; &#125;&#125; 9.å¯åŠ¨tomcatæœåŠ¡å™¨ï¼Œæµ‹è¯•åŠŸèƒ½çš„å®Œæ•´ã€‚ 7.ç³»ç»Ÿä¿®ç¼®1.å¯¹CRMåå°ç®¡ç†ç³»è¿›è¡Œåˆæ­¥è®¾è®¡ï¼ŒæŒ‰ç…§è®¾è®¡éœ€è¦åœ¨æœ¬åœ°æ•°æ®åº“ä¸­åˆ›å»ºæ›´å¤šçš„è¡¨å•ï¼Œå¡«å†™å±æ€§ï¼Œå‡†å¤‡å½•å…¥CRMç®¡ç†ç³»ç»Ÿã€‚ 2.åœ¨æœ¬åœ°æ•°æ®åº“ç³»ç»Ÿä¸­å®Œæˆåˆ›å»ºéƒ¨é—¨å’Œå‘˜å·¥è¡¨ï¼Œå¹¶ä¸”å®Œæˆåˆ›å»ºå’Œå®æ–½ç›¸å…³çš„æ§ä»¶ã€æ•°æ®åº“æ¥å£ã€æ¨¡å—ã€å…·ä½“åŠŸèƒ½ã€æŸ¥è¯¢è¯­å¥ç­‰ä¸»è¦ç¨‹åºçš„ç¼–ç¨‹ã€‚ 4.åœ¨/webç›®å½•ä¸­æ–°å»ºéƒ¨é—¨å’Œå‘˜å·¥çš„jspæ–‡ä»¶ï¼Œè¡¥å…¨æ“ä½œçš„é¡µé¢ã€çª—å£ä»¥åŠä¸»è¦å‡½æ•°åŠŸèƒ½çš„ä»£ç ï¼Œå®Œæˆå…¶ä»–æ•°æ®åº“è¡¨å•çš„jdbcè°ƒåº¦åŠŸèƒ½ã€‚éƒ¨é—¨ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142&lt;%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %&gt;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;éƒ¨é—¨ä¿¡æ¯&lt;/title&gt; &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"easyui/themes/bootstrap/easyui.css\"&gt; &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"easyui/themes/icon.css\"&gt; &lt;script type=\"text/javascript\" src=\"easyui/jquery.min.js\"&gt;&lt;/script&gt; &lt;script type=\"text/javascript\" src=\"easyui/jquery.easyui.min.js\"&gt;&lt;/script&gt; &lt;script type=\"text/javascript\" src=\"easyui/locale/easyui-lang-zh_CN.js\"&gt;&lt;/script&gt; &lt;script type=\"text/javascript\"&gt; var url; $(function()&#123; $('#dg').datagrid(&#123; url:'getAllDepartment', columns:[[ &#123;field:'number',title:'Number',width:100&#125;, &#123;field:'departmentname',title:'éƒ¨é—¨',width:100&#125;, &#123;field:'departmentfunction',title:'æƒé™',width:100&#125; ]] , striped:'true', pagination:'true', pagePosition:'bottom', pageNumber:1, pageSize:5, pageList: [3,5,10] &#125;); &#125;); &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;table id=\"dg\"&gt; &lt;div id=\"toolbar\"&gt; &lt;a href=\"javascript:void(0)\" &gt;&lt;/a&gt; &lt;a href=\"javascript:void(0)\" &gt;&lt;/a&gt; &lt;a href=\"javascript:void(0)\" &gt;&lt;/a&gt; &lt;/div&gt;&lt;/table&gt;&lt;/body&gt;&lt;/html&gt; å‘˜å·¥ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177&lt;%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %&gt;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;å‘˜å·¥ç®¡ç†&lt;/title&gt; &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"easyui/themes/bootstrap/easyui.css\"&gt; &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"easyui/themes/icon.css\"&gt; &lt;script type=\"text/javascript\" src=\"easyui/jquery.min.js\"&gt;&lt;/script&gt; &lt;script type=\"text/javascript\" src=\"easyui/jquery.easyui.min.js\"&gt;&lt;/script&gt; &lt;script type=\"text/javascript\" src=\"easyui/locale/easyui-lang-zh_CN.js\"&gt;&lt;/script&gt; &lt;script type=\"text/javascript\"&gt; var url; $(function()&#123; $('#dg1').datagrid(&#123; url:'getAllEmployee', columns:[[ &#123;field:'id',title:'å·¥å·',width:100&#125;, &#123;field:'employeename',title:'å§“å',width:100&#125;, &#123;field:'employeedept',title:'éƒ¨é—¨',width:100&#125;, &#123;field:'employeeemail',title:'è”ç³»é‚®ç®±',width:100&#125; ]] , striped:'true', pagination:'true', pagePosition:'bottom', pageNumber:1, pageSize:5, pageList: [3,5,10] &#125;); &#125;); function newEmployee()&#123;$('#winAdda').window('open');&#125; function save()&#123; //æäº¤è¡¨å•æ•°æ® $('#formAdda').form('submit', &#123; url:\"saveEmployee\" &#125;); alert('ä¿å­˜æˆåŠŸ'); //å…³é—­çª—å£ $(\"#winAdda\").window(\"close\"); //è¡¨æ ¼é‡æ–°åŠ è½½ $(\"#dg1\").datagrid(\"reload\"); &#125; function search()&#123; //æäº¤è¡¨å•æ•°æ® $('#formAddaa').form('submit', &#123; url:\"EmployeeSearch\" &#125;); alert('æŸ¥è¯¢æˆåŠŸ'); //å…³é—­çª—å£ $(\"#winAddaa\").window(\"close\"); &#125; function deleteEmployee() &#123; var row = $('#dg1').datagrid('getSelected'); if (row) &#123; $.messager.confirm(\"ç³»ç»Ÿæç¤º\", \"ç¡®å®šå¼€é™¤æ­¤å‘˜å·¥?\", function (r) &#123; if (r) &#123; $.post('employeeDelete', &#123;id: row.id&#125;, function (result) &#123; if (result.success) &#123; $.messager.alert(\"ç³»ç»Ÿæç¤º\", \"æˆåŠŸ!\"); $(\"#dg1\").datagrid(\"reload\"); &#125; else &#123; $.messager.alert(\"ç³»ç»Ÿæç¤º\", result.errorMsg); &#125; &#125;, 'json'); &#125; &#125;); &#125; &#125; function editEmployee()&#123; var row=$('#dg1').datagrid('getSelected'); if(row)&#123; $(\"#dlg1\").dialog('open').dialog('setTitle','ç¼–è¾‘å‘˜å·¥'); $('#formAdda2').form('load',row); url='employeeSave?id='+row.id; &#125; &#125; function searchEmployee()&#123;$('#winAddaa').window('open');&#125; function saveEmployee()&#123; $('#formAdda2').form('submit',&#123; url:url, onSubmit:function()&#123; return $(this).form('validate'); &#125;, &#125;); $.messager.alert(\"ç³»ç»Ÿæç¤º\",\"ä¿å­˜æˆåŠŸ\"); $('#dlg1').dialog('close'); $(\"#dg1\").datagrid(\"reload\"); &#125; &lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;table id=\"dg1\"&gt; &lt;div id=\"toolbar1\"&gt; &lt;a href=\"javascript:void(0)\" class=\"easyui-linkbutton\" plain=\"true\" onclick=\"newEmployee()\"&gt;æ·»åŠ å‘˜å·¥&lt;/a&gt; &lt;a href=\"javascript:void(0)\" class=\"easyui-linkbutton\" plain=\"true\" onclick=\"editEmployee()\"&gt;ç®¡ç†å‘˜å·¥&lt;/a&gt; &lt;a href=\"javascript:void(0)\" class=\"easyui-linkbutton\" plain=\"true\" onclick=\"deleteEmployee()\"&gt;å¼€é™¤å‘˜å·¥&lt;/a&gt; &lt;a href=\"javascript:void(0)\" class=\"easyui-linkbutton\" iconCls=\"icon-search\" plain=\"true\" onclick=\"searchEmployee()\"&gt;Search&lt;/a&gt; &lt;/div&gt;&lt;/table&gt;&lt;!-- æ·»åŠ å®¢æˆ·çš„è¡¨å•ï¼Œé»˜è®¤æ˜¯éšè—çš„ --&gt;&lt;div id=\"winAdda\" class=\"easyui-window\" title=\"æ·»åŠ å‘˜å·¥\" style=\"width:600px;height:400px\" data-options=\"iconCls:'icon-save',modal:true,closed:true\"&gt; &lt;form id=\"formAdda\" method=\"post\"&gt; &lt;TABLE cellSpacing=0 cellPadding=5 border=0&gt; &lt;br&gt; &lt;td&gt;å§“åï¼š&lt;/td&gt; &lt;td&gt; &lt;INPUT class=textbox style=\"WIDTH: 120px\" maxLength=30 name=\"employeename\"&gt; &lt;/td&gt; &lt;td&gt;éƒ¨é—¨ï¼š&lt;/td&gt; &lt;td&gt; &lt;INPUT class=textbox style=\"WIDTH: 120px\" maxLength=30 name=\"employeedept\"&gt; &lt;/td&gt; &lt;td&gt;é‚®ç®±ï¼š&lt;/td&gt; &lt;td&gt; &lt;INPUT class=textbox style=\"WIDTH: 120px\" maxLength=30 name=\"employeeemail\"&gt; &lt;/td&gt; &lt;/TR&gt; &lt;tr&gt; &lt;td rowspan=2&gt; &lt;button id=\"employeeBtn\" type=\"button\" onclick=\"save()\"&gt;ä¿å­˜&lt;/button&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/TABLE&gt; &lt;/form&gt;&lt;/div&gt;&lt;!-- ç¼–è¾‘å®¢æˆ·çš„è¡¨å•ï¼Œé»˜è®¤æ˜¯éšè—çš„ --&gt;&lt;div id=\"dlg1\" class=\"easyui-window\" title=\"ç¼–è¾‘å‘˜å·¥\" style=\"width:600px;height:400px\" data-options=\"iconCls:'icon-save',modal:true,closed:true\"&gt; &lt;form id=\"formAdda2\" method=\"post\"&gt; &lt;TABLE cellSpacing=0 cellPadding=5 border=0&gt; &lt;TR&gt; &lt;td&gt;å§“åï¼š&lt;/td&gt; &lt;td&gt; &lt;INPUT class=textbox style=\"WIDTH: 120px\" maxLength=30 name=\"employeename\"&gt; &lt;/td&gt; &lt;td&gt;éƒ¨é—¨ï¼š&lt;/td&gt; &lt;td&gt; &lt;INPUT class=textbox style=\"WIDTH: 120px\" maxLength=30 name=\"employeedept\"&gt; &lt;/td&gt; &lt;td&gt;é‚®ç®±ï¼š&lt;/td&gt; &lt;td&gt; &lt;INPUT class=textbox style=\"WIDTH: 120px\" maxLength=30 name=\"employeeemail\"&gt; &lt;/td&gt; &lt;/TR&gt; &lt;tr&gt; &lt;td rowspan=2&gt; &lt;button id=\"employeeBtn2\" type=\"button\" onclick=\"saveEmployee()\"&gt;ä¿å­˜&lt;/button&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/TABLE&gt; &lt;/form&gt;&lt;/div&gt;&lt;div id=\"winAddaa\" class=\"easyui-window\" title=\"æœç´¢å‘˜å·¥\" style=\"width:600px;height:400px\" data-options=\"iconCls:'icon-save',modal:true,closed:true\"&gt; &lt;form id=\"formAddaa\" method=\"post\"&gt; &lt;TABLE cellSpacing=0 cellPadding=5 border=0&gt; &lt;br&gt; &lt;td&gt;å§“åï¼š&lt;/td&gt; &lt;td&gt; &lt;INPUT class=textbox style=\"WIDTH: 120px\" maxLength=30 name=\"employeename\"&gt; &lt;/td&gt; &lt;/TR&gt; &lt;tr&gt; &lt;td rowspan=2&gt; &lt;button id=\"employeeBtn3\" type=\"button\" onclick=\"search()\"&gt;æœç´¢&lt;/button&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/TABLE&gt; &lt;/form&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; 5.æ•°æ®å­—å…¸ï¼šåå°webåº”ç”¨ç³»ç»Ÿä¸­ï¼Œåœ¨ä¸€äº›å«æœ‰å­—å…¸å€¼æ•°æ®æƒ…å†µä¸‹ï¼Œè¿™äº›æ•°æ®è¦æ˜¾å¼åœ°å±•ç¤ºç»™ç”¨æˆ·ï¼Œå°±è¦é€šè¿‡è½¬æ¢å­—å…¸å€¼æ•°æ®ï¼Œç„¶åè¿”å›åˆ°é¡µé¢ã€‚å…¶å®ç°æ–¹æ³•å¯ä»¥æ˜¯æ¯æ¬¡é€šè¿‡éå†å­—å…¸æ•°æ®ç„¶ååœ¨å±•ç¤ºæ•°æ®ä¸­å¢åŠ è½¬æ¢åçš„å€¼ï¼Œç„¶åå°†æ•°æ®è¿”å›åˆ°é¡µé¢ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è‡ªå®šä¹‰æ ‡ç­¾ï¼Œé¡µé¢è‡ªåŠ¨è½¬æ¢å­—å…¸å€¼æ˜¾ç¤ºé—®é¢˜ï¼Œç›¸æ¯”ç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œç¬¬äºŒç§æ–¹å¼å¯ä»¥é€šè¿‡ä¸€ä¸ªæ ‡ç­¾å¤„ç†æ‰€æœ‰çš„æ•°æ®å­—å…¸ï¼Œä¸å¿…åƒç¬¬ä¸€ç§æ–¹æ¡ˆé‚£æ ·è¦æ¯æ¬¡åœ¨åå°æ‰‹åŠ¨å¤„ç†ã€‚ 6.åœ¨æœ¬åœ°æ•°æ®åº“ä¸­åˆ›å»ºä¸€ä¸ªæ•°æ®å­—å…¸ï¼Œç¼–ç¨‹å®ç°CRMç®¡ç†ç³»ç»Ÿçš„æ•°æ®å­—å…¸ç›®å½•åŠå­—å…¸æ˜ç»†ï¼Œå¯åŠ¨tomcatæœåŠ¡å™¨å¯¹ç›®å‰å®Œæˆçš„é¡¹ç›®è¿›è¡Œæµ‹è¯•ã€‚ 8.å®¢æˆ·è·Ÿè¸ªçš„ç¨‹åºä»¥åŠç³»ç»Ÿçš„æ·±åº¦ä¼˜åŒ–1.åœ¨æœ¬åœ°æ•°æ®åº“ä¸­æ–°å»ºå®¢æˆ·è¡¨ï¼Œå¹¶ä¸”å®Œæˆåˆ›å»ºå’Œå®æ–½ç›¸å…³çš„æ§ä»¶ã€æ•°æ®åº“æ¥å£ã€æ¨¡å—ã€å…·ä½“åŠŸèƒ½ã€æŸ¥è¯¢è¯­å¥ç­‰ä¸»è¦ç¨‹åºçš„ç¼–ç¨‹ã€‚æˆåŠŸå°†å®¢æˆ·è¡¨æ·»åŠ åˆ°ç³»ç»Ÿã€‚ 2.ä¸ºå®¢æˆ·è¡¨æ·»åŠ å¢åˆ æ”¹æŸ¥åŠŸèƒ½ï¼Œä¾æ¬¡è¡¥å…¨å®¢æˆ·ç³»ç»Ÿçš„èµ„æºæ± ã€æ½œåœ¨å®¢æˆ·ã€å¤±è´¥å®¢æˆ·ã€æ­£å¼å®¢æˆ·ã€æµå¤±å®¢æˆ·ç­‰ä¸€ç³»åˆ—å®¢æˆ·ç®¡ç†ç³»ç»Ÿçš„æ ¸å¿ƒä»£ç ï¼Œå®Œæˆå®¢æˆ·è·Ÿè¿›åŠŸèƒ½ã€‚ 3.åœ¨å®˜ç½‘ä¸‹è½½easyuiä¸»é¢˜ï¼Œå¹¶é€šè¿‡index.jspä¸­é“¾æ¥æ¡†æ¶ä¸»ä½“çš„ä»£ç ä¿®æ”¹easyuiçš„é»˜è®¤ä¸»é¢˜ï¼Œæ›´æ–°uiç•Œé¢ï¼Œä¸ºeasyuiè®¾ç½®ç³»ç»Ÿæ—¶é—´æ¨¡å—ã€‚ 4.æ”¶é›†å›¾ç‰‡ç´ æï¼Œä¸ºindexä¸»é¡µé¢æ·»åŠ å›¾ç‰‡èƒŒæ™¯ï¼Œä¼˜åŒ–åŒºå—ï¼ŒåŒæ—¶è°ƒæ•´æ¡†æ¶å„éƒ¨åˆ†çš„è‡ªé€‚åº”å¤§å°ã€‚ 5.ä¸ºä¸»ç•Œé¢æ·»åŠ æœç´¢æ¡†ï¼ŒåŒæ­¥åˆ°ç™¾åº¦ï¼Œå¹¶å®ç°é€šè¿‡è¶…é“¾æ¥çš„è·³è½¬ã€‚å°†ç™¾åº¦logoçš„ç´ æå›¾ç‰‡å¯¼å…¥æœç´¢æ¡†å·¦ä¾§ï¼Œå®Œæˆå¢å¼ºæœç´¢åŠŸèƒ½çš„å¯è§†åŒ–ã€‚1234567891011&lt;table&gt; &lt;tr&gt; &lt;td&gt; &lt;a href=\"http://www.baidu.com\"&gt; &lt;img src=\"img/baidu.png\"/&gt; &lt;/a&gt; &lt;/td&gt; &lt;td&gt;&lt;br/&gt;&lt;input type=\"text\" id=\"search1\" name=\"word\"/&gt;&lt;/td&gt; &lt;td&gt;&lt;br/&gt;&lt;input type=\"submit\" value=\"æœç´¢\" /&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt; 6.å¯åŠ¨tomcatæœåŠ¡å™¨ï¼Œæµ‹è¯•åŠŸèƒ½åŸºæœ¬é½å…¨ã€uiå®Œå–„çš„åå°ç³»ç»Ÿï¼Œé¡¹ç›®åˆæ­¥å®Œæˆã€‚ 9.å…³äºMavenå’Œssmæ¡†æ¶è‡³æ­¤ï¼ŒCRMç®¡ç†ç³»ç»ŸåŸºæœ¬å®Œæˆã€‚ä¹‹åçš„æ—¶é—´é‡Œæˆ‘å¯¹å…¶ä»–æ¡†æ¶è¿›è¡Œäº†ç®€å•çš„äº†è§£ä¸å­¦ä¹ ï¼š1.Mavené¡¹ç›®å¯¹è±¡æ¨¡å‹(POM)ï¼Œå¯ä»¥é€šè¿‡ä¸€å°æ®µæè¿°ä¿¡æ¯æ¥ç®¡ç†é¡¹ç›®çš„æ„å»ºï¼ŒæŠ¥å‘Šå’Œæ–‡æ¡£çš„é¡¹ç›®ç®¡ç†å·¥å…·è½¯ä»¶ã€‚Maven é™¤äº†ä»¥ç¨‹åºæ„å»ºèƒ½åŠ›ä¸ºç‰¹è‰²ä¹‹å¤–ï¼Œè¿˜æä¾›é«˜çº§é¡¹ç›®ç®¡ç†å·¥å…·ã€‚ç”±äº Maven çš„é¢å‘é¡¹ç›®çš„æ–¹æ³•ï¼Œè®¸å¤š Apache Jakarta é¡¹ç›®å‘æ–‡æ—¶ä½¿ç”¨ Mavenï¼Œè€Œä¸”å…¬å¸é¡¹ç›®é‡‡ç”¨ Maven çš„æ¯”ä¾‹åœ¨æŒç»­å¢é•¿ã€‚ 2.ssmæ¡†æ¶ï¼šSpring + Spring MVC + MyBatisã€‚Springæ˜¯åˆ†å±‚çš„Java SE/EEåº”ç”¨ä¸€ç«™å¼çš„è½»é‡çº§å¼€æºæ¡†æ¶ï¼Œä»¥IoCåè½¬æ§åˆ¶å’ŒAOPé¢å‘åˆ‡é¢ç¼–ç¨‹ä¸ºå†…æ ¸ï¼Œæä¾›äº†å±•ç°å±‚ï¼šSpring MVCå’ŒæŒä¹…å±‚ï¼šSpring JDBCä»¥åŠä¸šåŠ¡å±‚ï¼šäº‹åŠ¡ç®¡ç†ç­‰ä¼—å¤šçš„ä¼ä¸šçº§åº”ç”¨æŠ€æœ¯ã€‚Spring MVC åˆ†ç¦»äº†æ§åˆ¶å™¨ã€æ¨¡å‹å¯¹è±¡ã€åˆ†æ´¾å™¨ä»¥åŠå¤„ç†ç¨‹åºå¯¹è±¡çš„è§’è‰²ï¼Œè¿™ç§åˆ†ç¦»è®©å®ƒä»¬æ›´å®¹æ˜“è¿›è¡Œå®šåˆ¶ã€‚MyBatis ä½¿ç”¨ç®€å•çš„ XMLæˆ–æ³¨è§£ç”¨äºé…ç½®å’ŒåŸå§‹æ˜ å°„ï¼Œå°†æ¥å£å’Œ Java çš„POJOsæ˜ å°„æˆæ•°æ®åº“ä¸­çš„è®°å½•ã€‚ 3.mavenä¸ssmæ¡†æ¶çš„æ•´åˆï¼Œä¸»è¦åŒ…å«çš„ä¾èµ–æœ‰ä¾èµ–SpringMVCã€ä¾èµ–c3p0ã€ä¾èµ–Mybatisï¼Œè¿›è¡Œé…ç½®springå£°æ˜å¼äº‹åŠ¡ç®¡ç†ï¼Œè‡³æ­¤mavenå·²ç»æˆåŠŸæ•´åˆäº†spring+springmvc+mybatisã€‚é€šè¿‡æ–°å»ºç¨‹åºå’Œå®Œæˆæ˜ å°„ï¼Œå®Œæˆè®ºæ–‡å¢åˆ æ”¹æŸ¥ç³»ç»Ÿã€‚","categories":[{"name":"ä¸ªäººç¬”è®°","slug":"ä¸ªäººç¬”è®°","permalink":"http://yoursite.com/categories/ä¸ªäººç¬”è®°/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yoursite.com/tags/java/"}]},{"title":"Pythonçˆ¬è™«ï¼šè±†ç“£ç”µå½±æ•°æ®","slug":"Pythonçˆ¬è™«ï¼šè±†ç“£ç”µå½±æ•°æ®","date":"2019-05-01T16:39:06.000Z","updated":"2022-06-27T07:38:05.697Z","comments":true,"path":"2019/05/02/Pythonçˆ¬è™«ï¼šè±†ç“£ç”µå½±æ•°æ®/","link":"","permalink":"http://yoursite.com/2019/05/02/Pythonçˆ¬è™«ï¼šè±†ç“£ç”µå½±æ•°æ®/","excerpt":"æè¿°Â· ç›®æ ‡ç½‘ç«™ï¼šè±†ç“£ç”µå½±ç½‘https://movie.douban.com/ Â· ç›®æ ‡æ•°æ®1ï¼šçƒ­é—¨é«˜åˆ†ç”µå½±çš„åç§°ã€ç±»å‹ã€è¯„åˆ†ã€æ€»è¯„äººæ•°ç­‰ Â· ç›®æ ‡æ•°æ®2ï¼šçƒ­é—¨ç”µå½±ã€Šå°‘å¹´çš„ä½ ã€‹å½±è¯„ Â· æ•°æ®å­˜å‚¨ï¼šcsvã€txt Â· çˆ¬è™«æ–¹æ³•ï¼šrequestsã€jsonã€xpathã€æ­£åˆ™è¡¨è¾¾å¼ æ‰¾åˆ°ç½‘ç«™jsonï¼Œåˆ©ç”¨xpathã€æ­£åˆ™è¡¨è¾¾å¼ç­‰å¯¹è±†ç“£ç”µå½±æ•°æ®è¿›è¡Œåˆ†é¡µçˆ¬å–ï¼Œä»¥åŠå¯¹çƒ­é—¨ç”µå½±ã€Šå°‘å¹´çš„ä½ ã€‹å…¨éƒ¨å½±è¯„è¿›è¡Œçˆ¬å–","text":"æè¿°Â· ç›®æ ‡ç½‘ç«™ï¼šè±†ç“£ç”µå½±ç½‘https://movie.douban.com/ Â· ç›®æ ‡æ•°æ®1ï¼šçƒ­é—¨é«˜åˆ†ç”µå½±çš„åç§°ã€ç±»å‹ã€è¯„åˆ†ã€æ€»è¯„äººæ•°ç­‰ Â· ç›®æ ‡æ•°æ®2ï¼šçƒ­é—¨ç”µå½±ã€Šå°‘å¹´çš„ä½ ã€‹å½±è¯„ Â· æ•°æ®å­˜å‚¨ï¼šcsvã€txt Â· çˆ¬è™«æ–¹æ³•ï¼šrequestsã€jsonã€xpathã€æ­£åˆ™è¡¨è¾¾å¼ æ‰¾åˆ°ç½‘ç«™jsonï¼Œåˆ©ç”¨xpathã€æ­£åˆ™è¡¨è¾¾å¼ç­‰å¯¹è±†ç“£ç”µå½±æ•°æ®è¿›è¡Œåˆ†é¡µçˆ¬å–ï¼Œä»¥åŠå¯¹çƒ­é—¨ç”µå½±ã€Šå°‘å¹´çš„ä½ ã€‹å…¨éƒ¨å½±è¯„è¿›è¡Œçˆ¬å– æºç main.py123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101import timeimport xlwtfrom lxml import etreeimport requestsimport jsonimport reheaders = &#123; \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36\"&#125;def processing_data(content_list): workbook = xlwt.Workbook(encoding='utf-8') worksheet = workbook.add_sheet('My Worksheet') for i, content in enumerate(content_list): for x, info in enumerate(content): worksheet.write(i, x, label=info) # å°†æ•°æ®å­˜å…¥excel workbook.save('info.csv')def save_info(content): info = content.xpath(\"//div[@id='info']\")[0] try: name = str(content.xpath('//*[@id=\"content\"]/h1/span[1]/text()')[0]).replace(\"'\", \" \") except: name = \"æ— \" try: daoyan = str(info.xpath(\"./span[1]/span[2]/a/text()\")[0] if info.xpath(\"./span[1]/span[2]/a/text()\") else None ).replace(\"'\", \" \") except: daoyan = \"æ— \" try: bianju = str(info.xpath(\"./span[2]/span[2]/a/text()\")[0] if info.xpath(\"./span[2]/span[2]/a/text()\") else None).replace(\"'\", \" \") except: bianju = \"æ— \" try: zhuyan = '/'.join(info.xpath(\"./span[3]/span[2]/a/text()\")).replace(\"'\", \" \") except: zhuyan = \"æ— \" try: leixing = '/'.join(info.xpath(\"./span[@property='v:genre']/text()\")).replace(\"'\", \" \") except: leixing = \"æ— \" try: shangyingshijian= str( '/'.join(info.xpath(\".//span[@property='v:initialReleaseDate']/text()\")).replace(\"'\", \" \"))[0:10] except: shangyingshijian = \"æ— \" try: shichang = str(info.xpath(\".//span[@property='v:runtime']/text()\")[0]).replace(\"'\", \" \") res1 = str(re.match(r'(.*)', shichang))[37:-1] except: shichang = \"æ— \" try: pingfen = str(content.xpath('//*[@id=\"interest_sectl\"]/div[1]/div[2]/strong/text()')[0]).replace(\"'\", \" \") except: pingfen = \"æ— \" try: pingjiarenshu = content.xpath('//*[@id=\"interest_sectl\"]/div[1]/div[2]/div/div[2]/a/span/text()')[0] except: pingjiarenshu = \"æ— \" print(\"ç”µå½±åç§°ï¼š\", name) print(\"ç±»å‹ï¼š\", leixing) print(\"è¯„åˆ†ï¼š\", pingfen) print(\"è¯„ä»·äººæ•°ï¼š\", pingjiarenshu) print(\"å¯¼æ¼”ï¼š\", daoyan) print(\"ç¼–å‰§ï¼š\", bianju) print(\"ä¸»æ¼”ï¼š\", zhuyan) print(\"ä¸Šæ˜ æ—¶é—´ï¼š\", shangyingshijian) print(\"æ—¶é•¿ï¼š\", res1) one_info = [name, leixing, pingfen, pingjiarenshu, daoyan, bianju, zhuyan, shangyingshijian, shichang] all_list.append(one_info) processing_data(all_list)def main(): try: for x in range(0,9999): url = 'https://movie.douban.com/j/new_search_subjects?sort=T&amp;range=0,10&amp;tags=&amp;start='+ str(x) content = requests.get(url, headers=headers) content_json = json.loads(content.text)[\"data\"] for one_info in content_json: one_id = one_info[\"id\"] print(one_id) url2 = \"https://movie.douban.com/subject/%s/\"%one_id # content_html = requests.get(url, headers=headers) html = requests.get(url2, headers=headers) if html.status_code == 200: content = html.content.decode(\"utf-8\") content = etree.HTML(content) save_info(content) time.sleep(1) except: processing_data(all_list)if __name__ == '__main__': all_list = [] main() yping.py1234567891011121314151617181920212223import requestsfrom lxml import etreeheaders=&#123; 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36'&#125;for x in range(0, 480, 20): try: startUrl = 'https://movie.douban.com/subject/30166972/comments?start='+str(x)+'&amp;limit=20&amp;sort=new_score&amp;status=P' r = requests.get(startUrl, headers=headers).content.decode('utf-8') html = etree.HTML(r) for i in range(1, 21): try: comment = str(html.xpath('//*[@id=\"comments\"]/div['+str(i)+']/div[2]/p/span/text()')[0]).replace(\"'\", \" \") print(comment) with open('info.txt', 'a', encoding='utf8') as file: file.write(comment + '\\n') except: continue except: continue è¾“å‡º","categories":[{"name":"Python","slug":"Python","permalink":"http://yoursite.com/categories/Python/"}],"tags":[{"name":"xpath","slug":"xpath","permalink":"http://yoursite.com/tags/xpath/"}]},{"title":"Pythonçˆ¬è™«ï¼šäººæ°‘æ—¥æŠ¥æ–°é—»","slug":"Pythonçˆ¬è™«ï¼šäººæ°‘æ—¥æŠ¥æ–°é—»","date":"2019-05-01T16:20:51.000Z","updated":"2022-06-27T07:37:27.489Z","comments":true,"path":"2019/05/02/Pythonçˆ¬è™«ï¼šäººæ°‘æ—¥æŠ¥æ–°é—»/","link":"","permalink":"http://yoursite.com/2019/05/02/Pythonçˆ¬è™«ï¼šäººæ°‘æ—¥æŠ¥æ–°é—»/","excerpt":"æè¿°Â· ç›®æ ‡ç½‘ç«™ï¼šäººæ°‘æ—¥æŠ¥å®˜ç½‘http://paper.people.com.cn/ Â· ç›®æ ‡æ•°æ®ï¼šæ–°é—»çš„æ ‡é¢˜ã€æ­£æ–‡ç­‰ Â· æ•°æ®å­˜å‚¨ï¼štxt Â· çˆ¬è™«æ–¹æ³•ï¼šrequestsã€beautifulsoup4 ä¸»è¦ä½¿ç”¨äº†requestså’Œbs4è§£æåº“ï¼Œå°†æŒ‡å®šè¾“å…¥çš„æ—¥æœŸè½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œä¸å¯¹åº”æ–°é—»é“¾æ¥è¿›è¡Œè¿æ¥ï¼Œå¯¹åŒºé—´å†…æ–°é—»è¿›è¡Œçˆ¬å–","text":"æè¿°Â· ç›®æ ‡ç½‘ç«™ï¼šäººæ°‘æ—¥æŠ¥å®˜ç½‘http://paper.people.com.cn/ Â· ç›®æ ‡æ•°æ®ï¼šæ–°é—»çš„æ ‡é¢˜ã€æ­£æ–‡ç­‰ Â· æ•°æ®å­˜å‚¨ï¼štxt Â· çˆ¬è™«æ–¹æ³•ï¼šrequestsã€beautifulsoup4 ä¸»è¦ä½¿ç”¨äº†requestså’Œbs4è§£æåº“ï¼Œå°†æŒ‡å®šè¾“å…¥çš„æ—¥æœŸè½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œä¸å¯¹åº”æ–°é—»é“¾æ¥è¿›è¡Œè¿æ¥ï¼Œå¯¹åŒºé—´å†…æ–°é—»è¿›è¡Œçˆ¬å– æºç æ³¨ï¼š2021å¹´1æœˆ1æ—¥èµ·äººæ°‘æ—¥æŠ¥å®˜ç½‘æ”¹åŠ¨ï¼Œä»£ç å·²æ›´æ–°(2021)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137import requestsimport bs4import osimport datetimeimport timedef fetchUrl(url): headers = &#123; 'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36', &#125; r = requests.get(url, headers=headers) r.raise_for_status() r.encoding = r.apparent_encoding return r.textdef getPageList(year, month, day): url = 'http://paper.people.com.cn/rmrb/html/' + year + '-' + month + '/' + day + '/nbs.D110000renmrb_01.htm' html = fetchUrl(url) bsobj = bs4.BeautifulSoup(html, 'html.parser') temp = bsobj.find('div', attrs = &#123;'id': 'pageList'&#125;) if temp: pageList = temp.ul.find_all('div', attrs = &#123;'class': 'right_title-name'&#125;) else: pageList = bsobj.find('div', attrs = &#123;'class': 'swiper-container'&#125;).find_all('div', attrs = &#123;'class': 'swiper-slide'&#125;) linkList = [] for page in pageList: link = page.a[\"href\"] url = 'http://paper.people.com.cn/rmrb/html/' + year + '-' + month + '/' + day + '/' + link linkList.append(url) return linkListdef getTitleList(year, month, day, pageUrl): html = fetchUrl(pageUrl) bsobj = bs4.BeautifulSoup(html, 'html.parser') temp = bsobj.find('div', attrs = &#123;'id': 'titleList'&#125;) if temp: titleList = temp.ul.find_all('li') else: titleList = bsobj.find('ul', attrs = &#123;'class': 'news-list'&#125;).find_all('li') linkList = [] for title in titleList: tempList = title.find_all('a') for temp in tempList: link = temp[\"href\"] if 'nw.D110000renmrb' in link: url = 'http://paper.people.com.cn/rmrb/html/' + year + '-' + month + '/' + day + '/' + link linkList.append(url) return linkListdef getContent(html): bsobj = bs4.BeautifulSoup(html, 'html.parser') title = bsobj.h3.text + '\\n' + bsobj.h1.text + '\\n' + bsobj.h2.text + '\\n' pList = bsobj.find('div', attrs=&#123;'id': 'ozoom'&#125;).find_all('p') content = '' for p in pList: content += p.text + '\\n' resp = title + content return respdef saveFile(content, path, filename): if not os.path.exists(path): os.makedirs(path) with open(path + filename, 'w', encoding='utf-8') as f: f.write(content)def download_rmrb(year, month, day, destdir): pageList = getPageList(year, month, day) for page in pageList: titleList = getTitleList(year, month, day, page) for url in titleList: html = fetchUrl(url) content = getContent(html) temp = url.split('_')[2].split('.')[0].split('-') pageNo = temp[1] titleNo = temp[0] if int(temp[0]) &gt;= 10 else '0' + temp[0] path = destdir + '/' + year + month + day + '/' fileName = year + month + day + '-' + pageNo + '-' + titleNo + '.txt' saveFile(content, path, fileName)def gen_dates(b_date, days): day = datetime.timedelta(days=1) for i in range(days): yield b_date + day * idef get_date_list(beginDate, endDate): start = datetime.datetime.strptime(beginDate, \"%Y%m%d\") end = datetime.datetime.strptime(endDate, \"%Y%m%d\") data = [] for d in gen_dates(start, (end - start).days): data.append(d) return dataif __name__ == '__main__': ''' mainï¼ˆï¼‰ ''' beginDate = input('æ–°é—»å¼€å§‹æ—¥æœŸï¼ˆæ ¼å¼å¦‚20210101ï¼‰:') endDate = input('æ–°é—»ç»“æŸæ—¥æœŸï¼ˆæ ¼å¼å¦‚20210102ï¼‰:') data = get_date_list(beginDate, endDate) for d in data: year = str(d.year) month = str(d.month) if d.month &gt;= 10 else '0' + str(d.month) day = str(d.day) if d.day &gt;= 10 else '0' + str(d.day) download_rmrb(year, month, day, 'data') print(\"å®Œæˆï¼š\" + year + month + day)'''çˆ¬çš„ä¸å¤šä¸åˆ æ³¨é‡Šï¼Œå°å¿ƒå°ip'''# time.Sleep(5) è¾“å‡º","categories":[{"name":"Python","slug":"Python","permalink":"http://yoursite.com/categories/Python/"}],"tags":[{"name":"beautifulsoup","slug":"beautifulsoup","permalink":"http://yoursite.com/tags/beautifulsoup/"}]},{"title":"Pythonçˆ¬è™«ï¼šè·å–yuehui163ç”¨æˆ·èµ„æ–™","slug":"Pythonçˆ¬è™«ï¼šè·å–yuehui163ç”¨æˆ·èµ„æ–™","date":"2019-05-01T14:58:05.000Z","updated":"2022-06-27T07:37:51.457Z","comments":true,"path":"2019/05/01/Pythonçˆ¬è™«ï¼šè·å–yuehui163ç”¨æˆ·èµ„æ–™/","link":"","permalink":"http://yoursite.com/2019/05/01/Pythonçˆ¬è™«ï¼šè·å–yuehui163ç”¨æˆ·èµ„æ–™/","excerpt":"æè¿°Â· ç›®æ ‡ç½‘ç«™ï¼šç½‘æ˜“https://yuehui.163.com/åŒåŸçº¦ä¼šç½‘ç«™ Â· ç›®æ ‡æ•°æ®ï¼šç”¨æˆ·çš„å¤´åƒã€æ€§åˆ«ã€åŸå¸‚ã€åœ°åŒºã€å·¥ä½œã€å­¦å†ç­‰ Â· æ•°æ®å­˜å‚¨ï¼špngã€txtã€csv Â· çˆ¬è™«æ–¹æ³•ï¼šrequestsã€json é€šè¿‡jsonæ ¼å¼ï¼Œå¯¹yuehui163ç½‘ç«™ç”¨æˆ·çš„å¤šé¡µçˆ¬å–ï¼Œä½¿ç”¨å¾ªç¯å’Œå­—ç¬¦ä¸²æ‹¼æ¥ç­‰æ–¹å¼è·å–è¯¦ç»†åˆ†é¡µæ•°æ®","text":"æè¿°Â· ç›®æ ‡ç½‘ç«™ï¼šç½‘æ˜“https://yuehui.163.com/åŒåŸçº¦ä¼šç½‘ç«™ Â· ç›®æ ‡æ•°æ®ï¼šç”¨æˆ·çš„å¤´åƒã€æ€§åˆ«ã€åŸå¸‚ã€åœ°åŒºã€å·¥ä½œã€å­¦å†ç­‰ Â· æ•°æ®å­˜å‚¨ï¼špngã€txtã€csv Â· çˆ¬è™«æ–¹æ³•ï¼šrequestsã€json é€šè¿‡jsonæ ¼å¼ï¼Œå¯¹yuehui163ç½‘ç«™ç”¨æˆ·çš„å¤šé¡µçˆ¬å–ï¼Œä½¿ç”¨å¾ªç¯å’Œå­—ç¬¦ä¸²æ‹¼æ¥ç­‰æ–¹å¼è·å–è¯¦ç»†åˆ†é¡µæ•°æ® æŠ“åŒ…è·å–ç½‘ç«™çš„jsonæ•°æ®(æºjsonå¾ˆé•¿ï¼Œä»¥ä¸‹ä¸ºä¸€æ¡ç”¨æˆ·çš„ä¿¡æ¯)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192&#123; \"hasAuth\": false, \"vippage\": 1, \"mobileRootUrl\": \"/mobile\", \"viptotal\": 0, \"mainDomain\": \"yuehui.163.com\", \"list\": [&#123; \"age\": 19, \"aim\": 4, \"aimName\": \"çŸ¥å·±\", \"albumCount\": 0, \"alg\": \"\", \"auditingTodayMood\": \"\", \"auditingTodayMoodTag\": 0, \"avoirdupois\": 49, \"carNo\": \"\", \"certLevel\": 0, \"city\": 0, \"cityName\": \"åŒ—äº¬\", \"constellation\": 3, \"constellationName\": \"ç™½ç¾Šåº§\", \"contact_popo\": \"\", \"contact_qq\": \"\", \"dateCount\": 0, \"dateTheme\": 0, \"degree\": 3, \"degreeName\": \"æœ¬ç§‘\", \"district\": 0, \"districtName\": \"\", \"eggName\": \"\", \"email\": \"\", \"focusUser\": false, \"fullPhotoUri\": \"https://yuehui2.nosdn.127.net/29/37/10/d6f9fa88660ab618fbd63cc307841eec/704131037/1648550666583\", \"hasCert\": false, \"hasEmail\": false, \"hasMobile\": false, \"hasMobileOrEmail\": false, \"hasPortrait\": 2, \"hasRcmIndex\": -1, \"hasRcmNIndex\": -1, \"house\": 2, \"id\": 704131037, \"income\": 8, \"incomeName\": \"ä¿å¯†\", \"industry\": 40, \"industryName\": \"å­¦ç”Ÿ\", \"intro\": \"\", \"isCloseArgue\": 0, \"isDiamondVIP\": false, \"isInsufficentCity\": -1, \"isVip\": 0, \"isVipName\": \"æ™®é€š\", \"lastLoginTime\": 1651385715089, \"level\": 0, \"marriage\": 0, \"marriageName\": \"æœªå©š\", \"maskPic\": 0, \"memberNo\": \"5665449560\", \"mobileNo\": \"\", \"monthVIP\": false, \"needCrop\": false, \"newVipNames\": \"æ™®é€š\", \"nick\": \"å°å¸Œ\", \"nickShort\": \"å°å¸Œ\", \"nickShort3\": \"å°å¸Œ\", \"nickShort4\": \"å°å¸Œ\", \"nickShort5\": \"å°å¸Œ\", \"nickShort7\": \"å°å¸Œ\", \"offStr\": \"\", \"online\": 0, \"onlineState\": \"\", \"pageStyle\": 0, \"photoUri\": \"https://yuehui2.nosdn.127.net/29/37/10/d6f9fa88660ab618fbd63cc307841eec/704131037/1648550666583_9_10\", \"photoUri180\": \"https://yuehui2.nosdn.127.net/29/37/10/d6f9fa88660ab618fbd63cc307841eec/704131037/1648550666583?imageView&amp;crop=0_45_403_447&amp;thumbnail=180x200\", \"photoUri195\": \"https://yuehui2.nosdn.127.net/29/37/10/d6f9fa88660ab618fbd63cc307841eec/704131037/1648550666583_3_4_m\", \"photoUri250\": \"https://yuehui2.nosdn.127.net/29/37/10/d6f9fa88660ab618fbd63cc307841eec/704131037/1648550666583?imageView&amp;crop=0_45_403_447&amp;thumbnail=250x278\", \"photoUri90\": \"https://yuehui2.nosdn.127.net/29/37/10/d6f9fa88660ab618fbd63cc307841eec/704131037/1648550666583_9_10?imageView&amp;thumbnail=90x100\", \"pos\": 0, \"province\": 0, \"provinceName\": \"\", \"rank\": 0, \"sex\": 0, \"showScore\": 0, \"stature\": 164, \"todayMoodTag\": 4, \"todaymood\": \"\", \"userType\": 0, \"visitLevel\": 0, \"visitLevelName\": \"\", \"visitLevelName3\": false, \"yhstatid\": \"newsearchuser,user\" &#125; æºç ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117import requests#from lxml import etreeimport jsonimport mathheaders=&#123; 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36'&#125;for page in range(0,34): for page2 in range(21): for page3 in range(2): startUrl = 'http://yuehui.163.com/searchusersrcm.do?ajax=1&amp;ageBegin=18&amp;ageEnd=25&amp;aim=-1&amp;marriage=0&amp;mode=4&amp;order=8&amp;province='+str(page)+'&amp;city='+str(page2)+'&amp;district=-1&amp;sex='+str(page3)+'&amp;userTag=0&amp;vippage=-1&amp;searchType=0&amp;page=1&amp;pagesize=81' r = requests.get(startUrl,headers=headers).content.decode('utf-8') r_j=json.loads(r) #print(r_j) aaa=r_j[0] #print(aaa) info=aaa['list'] #print(info) if info==[]: break else: num=1 strttt=\"æœªçŸ¥\" for i in info: full_url = i['photoUri'] r2 = requests.get(full_url,headers=headers,stream=True) ID=str(i['id']) name = str(i['nick']) cityname=str(i['cityName']) cityarea=str(i['districtName']) Age=str(i['age']) studylevel=str(i['degreeName']) sense=str(i['marriageName']) job=str(i['industryName']) star=str(i['constellationName']) weight=str(i['avoirdupois']) high=str(i['stature']) salary=str(i['incomeName']) if page3==0: sex='å¥³' else: sex='ç”·' if (str(i['cityName'])==''): cityname=strttt else: cityname = str(i['cityName']) if (str(i['districtName'])==''): cityarea=strttt else: cityarea = str(i['districtName']) if (str(i['age'])==''): Age='æœªçŸ¥' else: Age = str(i['age']) if (str(i['degreeName'])==''): studylevel='æœªçŸ¥' else: studylevel = str(i['degreeName']) if (str(i['marriageName'])==''): sense='æœªçŸ¥' else: sense = str(i['marriageName']) if (str(i['industryName'])==''): job='æœªçŸ¥' else: job = str(i['industryName']) if (str(i['constellationName'])==''): star='æœªçŸ¥' else: star = str(i['constellationName']) if (str(i['avoirdupois'])==''): weight='æœªçŸ¥' else: weight = str(i['avoirdupois']) if (str(i['stature'])==''): high='æœªçŸ¥' else: high = str(i['stature']) if (str(i['incomeName'])==''): salary='æœªçŸ¥' else: salary = str(i['incomeName']) if (int(i['avoirdupois'])==0|int(i['stature'])==0): bmi='æœªçŸ¥' else: bmi = str((float(i['avoirdupois']) / float(i['stature'] ** 2)) * 10000) with open('D:/PycharmProjects/1/yuehuipro/final/'+ ID+'.png','wb') as file: for j in r2.iter_content(1024): file.write(j) with open('D:/PycharmProjects/1/yuehuipro/final/' + ID + '.txt', 'a',encoding='utf8') as file: file.write('idï¼š'+ID+ '\\n' + '=' * 100 + '\\n' + name + '\\n' + '=' * 100 + '\\n' + 'å¹´é¾„ï¼š'+Age + '\\n' + '=' * 100 + '\\n '+ 'æ€§åˆ«ï¼š' + sex + '\\n' + '=' * 100 + '\\n '+ 'æ‰€åœ¨åŸå¸‚ï¼š'+ cityname +'\\n' + '=' * 100 + '\\n '+ 'æ‰€åœ¨åœ°åŒºï¼š'+ cityarea + '\\n' + '=' * 100 + '\\n '+ 'å·¥ä½œï¼š' + job + '\\n' + '=' * 100 + '\\n' + 'å­¦å†ï¼š' + studylevel + '\\n' + '=' * 100 + '\\n' + 'æ„Ÿæƒ…çŠ¶å†µï¼š' + sense + '\\n' + '=' * 100 + '\\n' + 'èº«é«˜ï¼š' + high + '\\n' + '=' * 100 + '\\n' + 'ä½“é‡ï¼š' + weight + '\\n' + '=' * 100 + '\\n' + 'è–ªèµ„ï¼š' + salary + '\\n' + '=' * 100 + '\\n' + 'æ˜Ÿåº§ï¼š' + star + '\\n' + '=' * 100 + '\\n' + 'BMIï¼š' + bmi + '\\n') with open('info.csv', 'a', encoding='utf8') as file: file.write(' '+ID+' '+name + ' ' + Age + ' ' + cityname + ' ' + cityarea +' ' +sex+' ' + job + ' '+studylevel+' '+sense+' '+star+' '+'èº«é«˜ï¼š'+ high+ ' '+'ä½“é‡ï¼š'+ weight +' '+'è–ªèµ„ï¼š'+ salary + ' '+'BMIï¼š'+' '+bmi+'\\n') if page3==1: print('æ­£åœ¨åŠ è½½ç”·æ€§') else: print('æ­£åœ¨åŠ è½½å¥³æ€§') print('å·²åŠ è½½ç¬¬%dæ¡æ•°æ®'%num) num+=1 ç»“æœä»¥å¹¶å‘æ–¹å¼çˆ¬å–äº†å…±è®¡çº¦10000æ¡æ•°æ®åæ‰‹åŠ¨ä¸­æ­¢äº†ï¼Œæ•ˆç‡è¿˜æ˜¯æ¯”è¾ƒæ…¢çš„ï¼Œå¹¶ä¸”æ²¡æœ‰å¢åŠ å¼‚å¸¸åˆ¤æ–­(æ¯”è¾ƒé¡ºåˆ©ï¼Œæ²¡æœ‰å‘ç”Ÿä¸­æ–­çš„æƒ…å†µ)","categories":[{"name":"Python","slug":"Python","permalink":"http://yoursite.com/categories/Python/"}],"tags":[{"name":"xpath","slug":"xpath","permalink":"http://yoursite.com/tags/xpath/"}]},{"title":"Pythonå¤šçº¿ç¨‹åŸºç¡€","slug":"Pythonå¤šçº¿ç¨‹åŸºç¡€","date":"2019-04-16T13:00:56.000Z","updated":"2022-06-27T07:36:27.778Z","comments":true,"path":"2019/04/16/Pythonå¤šçº¿ç¨‹åŸºç¡€/","link":"","permalink":"http://yoursite.com/2019/04/16/Pythonå¤šçº¿ç¨‹åŸºç¡€/","excerpt":"åŒæ­¥å’Œå¼‚æ­¥åŒæ­¥å…¶å®ç±»ä¼¼äºå°å­¦æ—¶æœŸå¦‚ä½•åœ¨æœ€çŸ­çš„æ—¶é—´å†…å»å®Œæˆæ‰€æœ‰äº‹ä»¶çš„æ•°å­¦é¢˜ã€‚ å‡è®¾å°æ˜æ—©ä¸Š7ï¼š00èµ·åºŠï¼Œåˆ·ç‰™æ´—è„¸éœ€è¦3åˆ†é’Ÿï¼Œçƒ§æ°´éœ€è¦10åˆ†é’Ÿï¼Œç©¿è¡£å è¢«éœ€è¦2åˆ†é’Ÿï¼Œåƒæ—©é¤éœ€è¦15åˆ†é’Ÿï¼Œæ”¶å¬æ—©é—´æ–°é—»éœ€è¦20åˆ†é’Ÿï¼ˆ7ç‚¹å¼€å§‹ï¼‰ï¼Œé—®å°æ˜èµ·åºŠåšå®Œè¿™äº›äº‹æƒ…è‡³å°‘éœ€è¦å¤šé•¿æ—¶é—´ï¼Ÿ åŒæ­¥æ˜¯æŒ‡è°ƒç”¨ä¸€æ—¦å¼€å§‹ï¼Œå¿…é¡»ç­‰å¾…è¿”å›è°ƒç”¨çš„ç»“æœï¼Œæ‰èƒ½ç»§ç»­ä¸‹ä¸€æ­¥æ“ä½œ é‚£ä¹ˆç»“æœå°±æ˜¯ï¼Œå°æ˜ä¸€å…±éœ€è¦å¬æ–°é—»ï¼ˆ20åˆ†é’Ÿï¼‰+ç©¿è¡£å è¢«ï¼ˆ2åˆ†é’Ÿï¼‰+åˆ·ç‰™æ´—è„¸ï¼ˆ3åˆ†é’Ÿï¼‰+çƒ§æ°´ï¼ˆ10åˆ†é’Ÿï¼‰+åƒæ—©é¤ï¼ˆ15åˆ†é’Ÿï¼‰ï¼Œæ€»å…±50åˆ†é’Ÿï¼Œä¸€å®šè¦è¿Ÿåˆ°äº†ï¼Œå¾ˆç¬¨ å¼‚æ­¥å¼‚æ­¥å’ŒåŒæ­¥ç›¸åï¼Œè°ƒç”¨ä¸€æ—¦å¼€å§‹ï¼Œè°ƒç”¨è€…æ— éœ€ç­‰å¾…æ–¹æ³•çš„å®Œæˆï¼Œå°±å¯ä»¥ç»§ç»­æ‰§è¡Œåç»­æ–¹æ³•ï¼Œè¢«è°ƒç”¨è€…é€šè¿‡çŠ¶æ€ä½“é€šçŸ¥è°ƒç”¨è€…ï¼Œæˆ–è€…ä½¿ç”¨å›è°ƒå‡½æ•°å¤„ç†è°ƒç”¨ å¼‚æ­¥æ–¹æ³•ä¸‹ï¼Œå°æ˜éœ€è¦æ‰“å¼€æ–°é—»ï¼Œå¼€å§‹çƒ§æ°´ï¼Œç©¿è¡£å è¢«ï¼Œå†æ´—æ¼±ï¼Œåƒæ—©é¤ï¼Œåªéœ€è¦20åˆ†é’Ÿï¼Œæ–°é—»ç»“æŸï¼Œå°±å¯ä»¥é«˜é«˜å…´å…´å»ä¸Šå­¦äº† å¹¶å‘å’Œå¹¶è¡Œå¹¶å‘å¹¶å‘æ˜¯åŒæ—¶å…·æœ‰å¤šä¸ªæ´»åŠ¨çš„ç³»ç»Ÿï¼Œå®è´¨æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªç‰©ç†CPUåœ¨è‹¥å¹²é“ç¨‹åºï¼ˆæˆ–çº¿ç¨‹ï¼‰ä¹‹é—´å¤šè·¯å¤ç”¨ï¼Œå…¶å®å°±æ˜¯nä¸ªäº‹ä»¶åœ¨åŒä¸€æ—¶é—´çº¿ä¸Šäº¤æ›¿å®Œæˆï¼šå°æ˜åšå®Œæ‰€æœ‰äº‹ä»¶èŠ±äº†50åˆ†é’Ÿ å¹¶è¡Œå¹¶è¡Œæ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ä¸åŒäº‹ä»¶æˆ–çº¿ç¨‹åœ¨åŒä¸€æ—¶åˆ»åŒæ—¶æ‰§è¡Œã€‚å¹¶è¡Œåˆ©ç”¨å¹¶å‘ä½¿ç³»ç»Ÿè¿è¡Œæ›´å¿«ï¼Œåœ¨æ“ä½œç³»ç»Ÿçš„å¤šä¸ªæŠ½è±¡å±‚æ¬¡è¿ç”¨ï¼Œæ˜¯nä¸ªäº‹ä»¶åœ¨åŒä¸€æ—¶åˆ»ä¸ŠåŒæ—¶å‘ç”Ÿï¼šå°æ˜å®¶é‡Œé›‡äº†4ä¸ªæœºå™¨äººä¿å§†ï¼Œ1ä¸ªæ‰“å¼€ç”µè§†åçƒ§æ°´ï¼Œ1ä¸ªå¸®å°æ˜ç©¿è¡£å è¢«ï¼Œ1ä¸ªå¸®å°æ˜æ´—æ¼±ï¼Œæœ€å1ä¸ªå–‚å°æ˜åƒæ—©é¤ï¼Œè¿™æ ·åœ¨æ—©é—´æ–°é—»æ”¾å®Œå‰ï¼Œå°æ˜åªç”¨äº†18åˆ†é’Ÿå°±å®Œæˆäº†æ‰€æœ‰äº‹ä»¶ï¼Œè¿˜å¤šå‡º2åˆ†é’Ÿæ—¶é—´æ£€æŸ¥ä¹¦åŒ… è¿›ç¨‹å’Œçº¿ç¨‹è¿›ç¨‹ç¨‹åºä¸èƒ½è‡ªå·±è¿è¡Œï¼Œåªæœ‰å°†ç¨‹åºè£…è½½è¿›å†…å­˜ï¼Œç”±ç³»ç»Ÿåˆ†é…èµ„æºåæ‰èƒ½è¿è¡Œã€‚ç¨‹åºæ˜¯æŒ‡ä»¤çš„é›†åˆï¼Œå¯ä»¥è§†ä¸ºæŒ‡ä»¤çš„é™æ€æ–‡æœ¬ï¼Œè€Œè¿›ç¨‹æ˜¯æŒ‡ä»¤çš„æ‰§è¡Œæ´»åŠ¨ï¼Œæ˜¯åŠ¨æ€çš„è¡Œä¸º è¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿå¯¹äºä¸€ä¸ªè¿è¡Œä¸­ç¨‹åºçš„æŠ½è±¡ï¼Œæ˜¯CPUã€å†…å­˜ã€IOè®¾å¤‡çš„æŠ½è±¡ã€‚ç³»ç»Ÿå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªè¿›ç¨‹ çº¿ç¨‹çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿè¿›è¡Œè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ï¼Œè¢«åŒ…å«äºè¿›ç¨‹ä¸­ï¼Œæ˜¯è¿›ç¨‹çš„å®é™…è¿ä½œå•ä½ã€‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥ç”±å¤šä¸ªçº¿ç¨‹ç»„æˆï¼Œçº¿ç¨‹ä¹‹é—´å…±äº«ä»£ç å’Œæ•°æ®ã€‚ ç”±äºåœ¨å®é™…ç½‘ç»œæœåŠ¡å™¨ä¸­å¯¹å¹¶è¡Œçš„éœ€æ±‚ï¼Œçº¿ç¨‹æˆä¸ºé‡è¦çš„ç¼–ç¨‹æ¨¡å‹ï¼š 1.å¤šçº¿ç¨‹ä¹‹é—´æ¯”å¤šè¿›ç¨‹ä¹‹é—´æ›´æ˜“å…±äº«æ•°æ®ã€‚2.çº¿ç¨‹ä¸€èˆ¬æ¯”è¿›ç¨‹é«˜æ•ˆã€‚","text":"åŒæ­¥å’Œå¼‚æ­¥åŒæ­¥å…¶å®ç±»ä¼¼äºå°å­¦æ—¶æœŸå¦‚ä½•åœ¨æœ€çŸ­çš„æ—¶é—´å†…å»å®Œæˆæ‰€æœ‰äº‹ä»¶çš„æ•°å­¦é¢˜ã€‚ å‡è®¾å°æ˜æ—©ä¸Š7ï¼š00èµ·åºŠï¼Œåˆ·ç‰™æ´—è„¸éœ€è¦3åˆ†é’Ÿï¼Œçƒ§æ°´éœ€è¦10åˆ†é’Ÿï¼Œç©¿è¡£å è¢«éœ€è¦2åˆ†é’Ÿï¼Œåƒæ—©é¤éœ€è¦15åˆ†é’Ÿï¼Œæ”¶å¬æ—©é—´æ–°é—»éœ€è¦20åˆ†é’Ÿï¼ˆ7ç‚¹å¼€å§‹ï¼‰ï¼Œé—®å°æ˜èµ·åºŠåšå®Œè¿™äº›äº‹æƒ…è‡³å°‘éœ€è¦å¤šé•¿æ—¶é—´ï¼Ÿ åŒæ­¥æ˜¯æŒ‡è°ƒç”¨ä¸€æ—¦å¼€å§‹ï¼Œå¿…é¡»ç­‰å¾…è¿”å›è°ƒç”¨çš„ç»“æœï¼Œæ‰èƒ½ç»§ç»­ä¸‹ä¸€æ­¥æ“ä½œ é‚£ä¹ˆç»“æœå°±æ˜¯ï¼Œå°æ˜ä¸€å…±éœ€è¦å¬æ–°é—»ï¼ˆ20åˆ†é’Ÿï¼‰+ç©¿è¡£å è¢«ï¼ˆ2åˆ†é’Ÿï¼‰+åˆ·ç‰™æ´—è„¸ï¼ˆ3åˆ†é’Ÿï¼‰+çƒ§æ°´ï¼ˆ10åˆ†é’Ÿï¼‰+åƒæ—©é¤ï¼ˆ15åˆ†é’Ÿï¼‰ï¼Œæ€»å…±50åˆ†é’Ÿï¼Œä¸€å®šè¦è¿Ÿåˆ°äº†ï¼Œå¾ˆç¬¨ å¼‚æ­¥å¼‚æ­¥å’ŒåŒæ­¥ç›¸åï¼Œè°ƒç”¨ä¸€æ—¦å¼€å§‹ï¼Œè°ƒç”¨è€…æ— éœ€ç­‰å¾…æ–¹æ³•çš„å®Œæˆï¼Œå°±å¯ä»¥ç»§ç»­æ‰§è¡Œåç»­æ–¹æ³•ï¼Œè¢«è°ƒç”¨è€…é€šè¿‡çŠ¶æ€ä½“é€šçŸ¥è°ƒç”¨è€…ï¼Œæˆ–è€…ä½¿ç”¨å›è°ƒå‡½æ•°å¤„ç†è°ƒç”¨ å¼‚æ­¥æ–¹æ³•ä¸‹ï¼Œå°æ˜éœ€è¦æ‰“å¼€æ–°é—»ï¼Œå¼€å§‹çƒ§æ°´ï¼Œç©¿è¡£å è¢«ï¼Œå†æ´—æ¼±ï¼Œåƒæ—©é¤ï¼Œåªéœ€è¦20åˆ†é’Ÿï¼Œæ–°é—»ç»“æŸï¼Œå°±å¯ä»¥é«˜é«˜å…´å…´å»ä¸Šå­¦äº† å¹¶å‘å’Œå¹¶è¡Œå¹¶å‘å¹¶å‘æ˜¯åŒæ—¶å…·æœ‰å¤šä¸ªæ´»åŠ¨çš„ç³»ç»Ÿï¼Œå®è´¨æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªç‰©ç†CPUåœ¨è‹¥å¹²é“ç¨‹åºï¼ˆæˆ–çº¿ç¨‹ï¼‰ä¹‹é—´å¤šè·¯å¤ç”¨ï¼Œå…¶å®å°±æ˜¯nä¸ªäº‹ä»¶åœ¨åŒä¸€æ—¶é—´çº¿ä¸Šäº¤æ›¿å®Œæˆï¼šå°æ˜åšå®Œæ‰€æœ‰äº‹ä»¶èŠ±äº†50åˆ†é’Ÿ å¹¶è¡Œå¹¶è¡Œæ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ä¸åŒäº‹ä»¶æˆ–çº¿ç¨‹åœ¨åŒä¸€æ—¶åˆ»åŒæ—¶æ‰§è¡Œã€‚å¹¶è¡Œåˆ©ç”¨å¹¶å‘ä½¿ç³»ç»Ÿè¿è¡Œæ›´å¿«ï¼Œåœ¨æ“ä½œç³»ç»Ÿçš„å¤šä¸ªæŠ½è±¡å±‚æ¬¡è¿ç”¨ï¼Œæ˜¯nä¸ªäº‹ä»¶åœ¨åŒä¸€æ—¶åˆ»ä¸ŠåŒæ—¶å‘ç”Ÿï¼šå°æ˜å®¶é‡Œé›‡äº†4ä¸ªæœºå™¨äººä¿å§†ï¼Œ1ä¸ªæ‰“å¼€ç”µè§†åçƒ§æ°´ï¼Œ1ä¸ªå¸®å°æ˜ç©¿è¡£å è¢«ï¼Œ1ä¸ªå¸®å°æ˜æ´—æ¼±ï¼Œæœ€å1ä¸ªå–‚å°æ˜åƒæ—©é¤ï¼Œè¿™æ ·åœ¨æ—©é—´æ–°é—»æ”¾å®Œå‰ï¼Œå°æ˜åªç”¨äº†18åˆ†é’Ÿå°±å®Œæˆäº†æ‰€æœ‰äº‹ä»¶ï¼Œè¿˜å¤šå‡º2åˆ†é’Ÿæ—¶é—´æ£€æŸ¥ä¹¦åŒ… è¿›ç¨‹å’Œçº¿ç¨‹è¿›ç¨‹ç¨‹åºä¸èƒ½è‡ªå·±è¿è¡Œï¼Œåªæœ‰å°†ç¨‹åºè£…è½½è¿›å†…å­˜ï¼Œç”±ç³»ç»Ÿåˆ†é…èµ„æºåæ‰èƒ½è¿è¡Œã€‚ç¨‹åºæ˜¯æŒ‡ä»¤çš„é›†åˆï¼Œå¯ä»¥è§†ä¸ºæŒ‡ä»¤çš„é™æ€æ–‡æœ¬ï¼Œè€Œè¿›ç¨‹æ˜¯æŒ‡ä»¤çš„æ‰§è¡Œæ´»åŠ¨ï¼Œæ˜¯åŠ¨æ€çš„è¡Œä¸º è¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿå¯¹äºä¸€ä¸ªè¿è¡Œä¸­ç¨‹åºçš„æŠ½è±¡ï¼Œæ˜¯CPUã€å†…å­˜ã€IOè®¾å¤‡çš„æŠ½è±¡ã€‚ç³»ç»Ÿå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªè¿›ç¨‹ çº¿ç¨‹çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿè¿›è¡Œè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ï¼Œè¢«åŒ…å«äºè¿›ç¨‹ä¸­ï¼Œæ˜¯è¿›ç¨‹çš„å®é™…è¿ä½œå•ä½ã€‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥ç”±å¤šä¸ªçº¿ç¨‹ç»„æˆï¼Œçº¿ç¨‹ä¹‹é—´å…±äº«ä»£ç å’Œæ•°æ®ã€‚ ç”±äºåœ¨å®é™…ç½‘ç»œæœåŠ¡å™¨ä¸­å¯¹å¹¶è¡Œçš„éœ€æ±‚ï¼Œçº¿ç¨‹æˆä¸ºé‡è¦çš„ç¼–ç¨‹æ¨¡å‹ï¼š 1.å¤šçº¿ç¨‹ä¹‹é—´æ¯”å¤šè¿›ç¨‹ä¹‹é—´æ›´æ˜“å…±äº«æ•°æ®ã€‚2.çº¿ç¨‹ä¸€èˆ¬æ¯”è¿›ç¨‹é«˜æ•ˆã€‚ pythonè¿›ç¨‹åˆ›å»º1234import multiprocessingè¿›ç¨‹å¯¹è±¡ = multiprocessing.Process(target=å‡½æ•°åæˆ–å½“å‰ä»»åŠ¡,*args/**kwargs)è¿›ç¨‹å¯¹è±¡.start() è¿›ç¨‹ç¼–å·1234import osos.getpid() #è·å–å½“å‰è¿›ç¨‹çš„ç¼–å·os.getppid() #è·å–å½“å‰è¿›ç¨‹çˆ¶è¿›ç¨‹çš„ç¼–å· ä¸»è¿›ç¨‹å¾€å¾€ä¼šç­‰å¾…æ‰€æœ‰çš„å­è¿›ç¨‹å®Œæˆä»¥åæ‰ç»“æŸ å¯ä»¥è®¾ç½®å®ˆæŠ¤ä¸»è¿›ç¨‹ï¼Œå½“ä¸»è¿›ç¨‹ç»“æŸä»¥åå­è¿›ç¨‹ä¸­æ­¢1234è¿›ç¨‹å¯¹è±¡ = multiprocessing.Process(target=å‡½æ•°åæˆ–å½“å‰ä»»åŠ¡, daemon=True)#æˆ–è¿›ç¨‹å¯¹è±¡.daemon = True ä¸¾ä¾‹-æ–‡ä»¶æ‹·è´ç¨‹åº12345678910111213141516171819202122232425import osimport multiprocessingdef copy_file(file_name, source_dir, dest_dir): source_path = source_dir + '\\\\' + file_name dest_path = dest_dir + '\\\\' + file_name with open(source_path, 'rb') as source_file: with open(dest_path, 'wb') as dest_file: while True: data = source_file.read(1024) if data: dest_file.write(data) else: breakif __name__ == '__main__': source_dir = r'C:\\Users\\elbadaernU9.9\\Desktop\\æ–°å»ºæ–‡ä»¶å¤¹ (1)' dest_dir= r'F:C:\\Users\\elbadaernU9.9\\Desktop\\æ–°å»ºæ–‡ä»¶å¤¹ (2)' try: os.mkdir(dest_dir) except: print(\"ç›®æ ‡æ–‡ä»¶å¤¹å·²ç»å­˜åœ¨\") file_list = os.listdir(source_dir) for file_name in file_list: sub_process = multiprocessing.Process(target=copy_file, args=(file_name, source_dir, dest_dir)) sub_process.start() pythonçº¿ç¨‹åˆ›å»º1234import threadingçº¿ç¨‹å¯¹è±¡ = threading.Thread(target=å‡½æ•°åæˆ–å½“å‰ä»»åŠ¡,*args/**kwargs)çº¿ç¨‹å¯¹è±¡.start() å¤šçº¿ç¨‹-æ–‡ä»¶æ‹·è´ç¨‹åº12345678910111213141516171819202122232425import osimport threadingdef copy_file(file_name, source_dir, dest_dir): source_path = source_dir + '\\\\' + file_name dest_path = dest_dir + '\\\\' + file_name with open(source_path, 'rb') as source_file: with open(dest_path, 'wb') as dest_file: while True: data = source_file.read(1024) if data: dest_file.write(data) else: breakif __name__ == '__main__': source_dir = r'C:\\Users\\elbadaernU9.9\\Desktop\\æ–°å»ºæ–‡ä»¶å¤¹ (1)' dest_dir= r'F:C:\\Users\\elbadaernU9.9\\Desktop\\æ–°å»ºæ–‡ä»¶å¤¹ (2)' try: os.mkdir(dest_dir) except: print(\"ç›®æ ‡æ–‡ä»¶å¤¹å·²ç»å­˜åœ¨\") file_list = os.listdir(source_dir) for file_name in file_list: sub_thread = threading.Thread(target=copy_file, args=(file_name, source_dir, dest_dir)) sub_thread.start() è¿›ç¨‹ä¸çº¿ç¨‹çš„å…³ç³»å¯¹æ¯”è¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œçº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚çº¿ç¨‹ä¾é™„äºè¿›ç¨‹ï¼Œä¸èƒ½è„±ç¦»è¿›ç¨‹ç‹¬ç«‹å­˜åœ¨ã€‚ä¸€ä¸ªè¿›ç¨‹é»˜è®¤æä¾›äº†ä¸€æ¡çº¿ç¨‹ï¼Œå¯ä»¥åˆ›å»ºå¤šä¸ªçº¿ç¨‹ åˆ›å»ºè¿›ç¨‹çš„èµ„æºå¼€é”€è¾ƒå¤§ï¼Œå¯ä»¥ä½¿ç”¨CPUå¤šæ ¸ï¼Œçº¿ç¨‹çš„èµ„æºå¼€é”€å°ï¼Œåªèƒ½åœ¨å•æ ¸æ¨¡å¼è¿è¡Œ","categories":[{"name":"Python","slug":"Python","permalink":"http://yoursite.com/categories/Python/"}],"tags":[{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"http://yoursite.com/tags/å¤šçº¿ç¨‹/"}]},{"title":"HTTPè¯·æ±‚æ–¹æ³•","slug":"HTTPè¯·æ±‚æ–¹æ³•","date":"2019-04-11T08:07:35.000Z","updated":"2022-06-27T07:31:08.481Z","comments":true,"path":"2019/04/11/HTTPè¯·æ±‚æ–¹æ³•/","link":"","permalink":"http://yoursite.com/2019/04/11/HTTPè¯·æ±‚æ–¹æ³•/","excerpt":"","text":"GETè¯·æ±‚æŒ‡å®šçš„é¡µé¢ä¿¡æ¯ï¼Œå¹¶è¿”å›å®ä½“ä¸»ä½“ POSTå‘æŒ‡å®šçš„èµ„æºæäº¤æ•°æ®ï¼Œè¯·æ±‚å¤„ç†ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“å½“ä¸­ï¼Œé‡æ–°æäº¤é¡µé¢ï¼Œå¯¼è‡´æ–°èµ„æºçš„å»ºç«‹æˆ–å·²æœ‰èµ„æºçš„ä¿®æ”¹ PUTä»å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€æ•°æ®æ¥å–ä»£æŒ‡å®šçš„æ–‡æ¡£å†…å®¹ DELETEè¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šçš„é¡µé¢ HEADç±»ä¼¼GETè¯·æ±‚ï¼Œè¿”å›çš„å“åº”ä¸­æ²¡æœ‰å…·ä½“å†…å®¹ï¼Œä»…è·å–æŠ¥å¤´ OPTIONSå…è®¸å®¢æˆ·ç«¯æŸ¥çœ‹æœåŠ¡å™¨çš„å†…å®¹ TRACEæ˜¾ç¤ºæœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œç”¨äºæµ‹è¯•æˆ–è¯Šæ–­ CONNECTHTTP/1.1åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ GETæ–¹æ³•å’ŒPOSTæ–¹æ³•çš„åŒºåˆ«Â· GETä»…è¯·æ±‚ç›®æ ‡ä¿¡æ¯ï¼Œè¿”å›/åˆ·æ–°æ˜¯æ— å®³çš„ï¼ŒPOSTæ¯æ¬¡è¿”å›/åˆ·æ–°ä¼šé‡æ–°æäº¤æ•°æ® Â· GETå¯è¢«ä¿å­˜åœ¨ä¹¦ç­¾ã€ç¼“å­˜ã€å†å²è®°å½•å½“ä¸­ï¼ŒPOSTä¸è¡Œ Â· GETç›¸å¯¹æ²¡æœ‰POSTå®‰å…¨ Â· GETå‚æ•°é€šè¿‡URLè¿›è¡Œä¼ é€’ï¼ŒPOSTå‚æ•°å­˜æ”¾åœ¨Request bodyå½“ä¸­ Â· GETè¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨ä¼šå°†http headerå’Œdataä¸€èµ·å‘é€é™¤å»ï¼ŒæœåŠ¡å™¨å“åº”ä¸º200ï¼› POSTè¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨ä¼šå…ˆå‘é€headerï¼ŒæœåŠ¡å™¨å“åº”100 continueï¼Œå†å‘é€dataï¼ŒæœåŠ¡å™¨å“åº”200ï¼ˆæ—¶é—´æ¶ˆè€—ç›¸å¯¹GETè¦é•¿ï¼‰ Â· GETæ¯æ¬¡äº§ç”Ÿ1ä¸ªTCPæ•°æ®åŒ…ï¼ŒPOSTäº§ç”Ÿä¸¤ä¸ª Â· GETå¯¹æ•°æ®çš„é•¿åº¦æœ‰é™åˆ¶ï¼ˆ2KBï¼‰ï¼ŒPOSTæ²¡æœ‰é™åˆ¶ Â· GETä»…å…è®¸ASCIIå­—ç¬¦ï¼ŒPOSTæ²¡æœ‰é™åˆ¶","categories":[{"name":"Web","slug":"Web","permalink":"http://yoursite.com/categories/Web/"}],"tags":[{"name":"GET/POST...","slug":"GET-POST","permalink":"http://yoursite.com/tags/GET-POST/"}]},{"title":"Pythonçš„å›¾ç‰‡ä¸å­—ç¬¦ç”»è½¬æ¢","slug":"Pythonçš„å›¾ç‰‡ä¸å­—ç¬¦ç”»è½¬æ¢","date":"2019-04-10T11:27:27.000Z","updated":"2022-06-27T07:36:12.714Z","comments":true,"path":"2019/04/10/Pythonçš„å›¾ç‰‡ä¸å­—ç¬¦ç”»è½¬æ¢/","link":"","permalink":"http://yoursite.com/2019/04/10/Pythonçš„å›¾ç‰‡ä¸å­—ç¬¦ç”»è½¬æ¢/","excerpt":"","text":"æ€»ä½“æ€æƒ³ä¸ºï¼šå°†å›¾ç‰‡è½¬æ¢ä¸ºç°åº¦å›¾ç‰‡å,åˆ©ç”¨å­—ç¬¦çš„â€œå¤æ‚ç¨‹åº¦â€æ›¿æ¢æ‰å›¾ç‰‡çš„å†…å®¹ï¼Œå­—ç¬¦æ•°ç»„çš„â€œå¤æ‚ç¨‹åº¦â€ç”±å¤§åˆ°å°æ’åˆ—å³å¯ã€‚ ä»£ç ï¼ˆéœ€è¦pipå®‰è£…PILåº“ï¼‰1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253from PIL import Image import argparse # å‘½ä»¤è¡Œè¾“å…¥å‚æ•°å¤„ç† parser = argparse.ArgumentParser() parser.add_argument('file') # è¾“å…¥æ–‡ä»¶ parser.add_argument('-o', '--output') # è¾“å‡ºæ–‡ä»¶ parser.add_argument('--width', type=int, default=80) # è¾“å‡ºå­—ç¬¦ç”»å®½ parser.add_argument('--height', type=int, default=80) # è¾“å‡ºå­—ç¬¦ç”»é«˜ # è·å–å‚æ•° args = parser.parse_args() IMG = args.fileWIDTH = args.width HEIGHT = args.height OUTPUT = args.output ascii_char = list(\"$@B%8&amp;WM#*oahkbdpqwmZO0QLCJUYXzcvunxrjft/\\|()1&#123;&#125;[]?-_+~&lt;&gt;i!lI;:,\\\"^`'. \") # å°†256ç°åº¦æ˜ å°„åˆ°70ä¸ªå­—ç¬¦ä¸Š def get_char(r, b, g, alpha=256): if alpha == 0: return ' ' length = len(ascii_char) gray = int(0.2126 * r + 0.7152 * g + 0.0722 * b) unit = (256.0 + 1)/length return ascii_char[int(gray/unit)] if __name__ == '__main__': im = Image.open(IMG) im = im.resize((WIDTH, HEIGHT), Image.NEAREST) txt = \"\" for i in range(HEIGHT): for j in range(WIDTH): txt += get_char(*im.getpixel((j, i))) txt += '\\n' print (txt) # å­—ç¬¦ç”»è¾“å‡ºåˆ°æ–‡ä»¶ if OUTPUT: with open(OUTPUT,'w') as f: f.write(txt) else: with open(\"output.txt\", 'w') as f: f.write(txt) ï¼ˆç¨¿ï¼‰","categories":[{"name":"Python","slug":"Python","permalink":"http://yoursite.com/categories/Python/"}],"tags":[{"name":"PIL","slug":"PIL","permalink":"http://yoursite.com/tags/PIL/"}]},{"title":"DOSBox0.74 For MASM","slug":"DOSBox0-74-For-MASM","date":"2019-04-10T11:26:12.000Z","updated":"2022-06-27T07:28:57.569Z","comments":true,"path":"2019/04/10/DOSBox0-74-For-MASM/","link":"","permalink":"http://yoursite.com/2019/04/10/DOSBox0-74-For-MASM/","excerpt":"","text":"ç”±äºæ±‡ç¼–çš„MASMæ˜¯åœ¨32ä½ç¯å¢ƒä¸‹ä½¿ç”¨çš„ï¼Œè¦åœ¨64ä½Windowsç¯å¢ƒä¸‹ä½¿ç”¨éœ€è¦å€ŸåŠ©å·¥å…·DOSBoxã€‚ DOSBox-0.74ä¸‹è½½åœ°å€ï¼š[https://pan.baidu.com/s/1wiAv0pwUhRavkM51pmdJCQ]ï¼ˆæå–ç ï¼šm0kxï¼‰ MASMä¸‹è½½MASMæ–‡ä»¶å¤¹å†…è‡³å°‘è¦åŒ…å«debug/exe2bin/link/masmå››ä¸ª.exeæ–‡ä»¶ã€‚åœ°å€ï¼š[https://pan.baidu.com/s/1MC75x01gKBxZwxmBuYq6fA]ï¼ˆæå–ç ï¼š4zu0ï¼‰ ä½¿ç”¨å°†DOSBox-0.74æ”¾è¿›MASMæ–‡ä»¶å¤¹å†…ï¼Œæ‰¾åˆ°DOSBox.exeæ–‡ä»¶åŒå‡»æ‰“å¼€ï¼Œè¾“å…¥mount d d:\\path,pathå¯ä»¥ä¸ºä½ çš„masmç›®å½•ã€‚å¦‚æœMASMæ–‡ä»¶å¤¹ä¸‹æœ‰ç¼–å†™å¥½çš„.asmæ±‡ç¼–æŒ‡ä»¤ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡å‘½ä»¤d:è¿›å…¥MASMï¼Œå†è¾“å…¥masmï¼Œè¿›å…¥è°ƒè¯•ï¼Œè¾“å…¥.asmæ–‡ä»¶åç§°ï¼ˆå¯ä¸å†™æ‰©å±•åï¼‰ï¼Œä¾æ¬¡linkï¼Œdebugå®Œæˆã€‚æ•ˆæœå¦‚å›¾ï¼š","categories":[{"name":"æ±‡ç¼–","slug":"æ±‡ç¼–","permalink":"http://yoursite.com/categories/æ±‡ç¼–/"}],"tags":[{"name":"MASM","slug":"MASM","permalink":"http://yoursite.com/tags/MASM/"}]},{"title":"Just for joy---æ‰“åœ°é¼ å°æ¸¸æˆ","slug":"Just-for-joy-æ‰“åœ°é¼ å°æ¸¸æˆ","date":"2018-12-20T02:59:34.000Z","updated":"2022-06-27T07:32:33.122Z","comments":true,"path":"2018/12/20/Just-for-joy-æ‰“åœ°é¼ å°æ¸¸æˆ/","link":"","permalink":"http://yoursite.com/2018/12/20/Just-for-joy-æ‰“åœ°é¼ å°æ¸¸æˆ/","excerpt":"","text":"Just For Joy å®˜ç½‘ï¼ˆæ¨¡æ‹Ÿï¼‰è·å–æ›´å¤šJFJå’¨è¯¢ï¼Œè¯·å…³æ³¨æˆ‘ä»¬çš„å®˜æ–¹ç½‘ç«™Created by elbadaernU9.9ï¼ˆincï¼‰ powered by hexo 2018. æ‰“åœ°é¼ å°æ¸¸æˆ1å¿«æ¥å’Œä½ çš„å°ä¼™ä¼´ä»¬æ¥è¯•è¯•æˆ‘ä»¬å…¨æ–°æ¨å‡ºçš„ä¼‘é—²å°æ¸¸æˆï¼šMouseHitï¼ˆæ‰“åœ°é¼ ï¼‰ï¼Œæ¸¸æˆä»…å”®0$! è´­ä¹°é“¾æ¥ï¼š 12é“¾æ¥: https://pan.baidu.com/s/1LSMij2q31pJXMwmXImponA 1æå–ç ï¼š90t6 æè¦æˆ‘ä»¬çš„æ¸¸æˆåŸºäºQtç¯å¢ƒå¼€å‘ï¼Œå¯ä»¥å®ç°è°ƒæ•´æ¸¸æˆéš¾åº¦ç­‰å„é¡¹åŸºç¡€åŠŸèƒ½ï¼Œé™¤æ­¤ä»¥å¤–ï¼Œæˆ‘ä»¬ä¸ºæ¸¸æˆè®¾ç½®äº†æ›´å¤šçš„å¯ç©æ€§å› ç´ ï¼ç°åœ¨ç‚¹å‡»ä¸¤ä¸ªå¤§çº¢è‰²é—®å·ï¼Œæ¥è·å¾—ä½œå¼Šçš„å¿«æ„Ÿï¼ä½ åŒæ ·å¯ä»¥è¿›è¡Œä¸åŒçš„æ¸¸æˆæ¨¡å¼ï¼Œæˆ‘ä»¬ç›®å‰å¼€å‘å‡ºæ¥ç»å…¸æ¨¡å¼å’Œé—¯å…³ä¸¤ç§æ¨¡å¼ï¼Œå¿«æ¥æµ‹è¯•ä½ åœ¨é—¯å…³æ¨¡å¼ä¸­èƒ½é—¯åˆ°ç¬¬å‡ è½®å‘¢ï¼Ÿï¼Ÿï¼Ÿèµ¶ç´§å’Œä½ çš„å°ä¼™ä¼´ä»¬ä¸€èµ·æ¥æŒ‘æˆ˜å§ï¼ ï¼ˆæ³¨ï¼Œä»¥ä¸Šå†…å®¹ä¸ºæ¼”å‡ºæ•ˆæœï¼Œæœ‰æ—¶é—´å°†å…·ä½“ä»£ç è¡¥è‡³Githubï¼‰","categories":[{"name":"ä¸ªäººç¬”è®°","slug":"ä¸ªäººç¬”è®°","permalink":"http://yoursite.com/categories/ä¸ªäººç¬”è®°/"}],"tags":[{"name":"QT","slug":"QT","permalink":"http://yoursite.com/tags/QT/"}]},{"title":"D3:SVGéšæœºæ ‘ä¸æ—¶é’Ÿç­‰","slug":"D3-SVGéšæœºæ ‘ä¸æ—¶é’Ÿç­‰","date":"2018-08-07T13:18:40.000Z","updated":"2022-06-27T07:27:58.434Z","comments":true,"path":"2018/08/07/D3-SVGéšæœºæ ‘ä¸æ—¶é’Ÿç­‰/","link":"","permalink":"http://yoursite.com/2018/08/07/D3-SVGéšæœºæ ‘ä¸æ—¶é’Ÿç­‰/","excerpt":"","text":"åŸºæœ¬åŠŸèƒ½åŠè¯´æ˜ï¼š1.ç‚¹å‡»index.htmlæ–‡ä»¶ï¼Œè¿›å…¥ä¸»é¡µé€‰æ‹©ç›¸åº”çš„åŠŸèƒ½ã€‚ 2.é€‰æ‹©svgç›†æ ½éšæœºæ ‘ï¼šåŸºäºD3å’ŒSVGç”Ÿæˆçš„ç›†æ ½éšæœºæ ‘ï¼Œé€šè¿‡ç‚¹å‡»â€œStart Growing!â€æŒ‰é’®ï¼Œæ¥å®ç°ç›†æ ½çš„ç”Ÿé•¿è¿‡ç¨‹ï¼ŒåŒæ—¶æ›´æ–°æŒ‰é’®ï¼Œç»§ç»­ç‚¹å‡»â€œGrowing Moreâ€ç»§ç»­ç”Ÿæˆæ›´å¤šçš„éšæœºæ ‘å­å¶ï¼›æœ€åé€šè¿‡ç‚¹å‡»â€œReplantâ€æ¢å¤èŠ±ç›†çŠ¶æ€ï¼Œå¯ä»¥è¿›è¡Œé‡æ–°ç”Ÿæˆï¼›é€šè¿‡å•æœºâ€œBackâ€æŒ‰é’®ï¼Œå›åˆ°indexä¸»é¡µé¢ 3.é€‰æ‹©SVGæ—¶é’Ÿï¼šåŸºäºSVGå’ŒTweenmaxGSAPçš„æ—¶é’Ÿæ¨¡å‹ï¼Œç”¨SVGæ¥ç»˜åˆ¶æ—¶åˆ»è¡¨å½¢çŠ¶ï¼Œå¹¶é€šè¿‡GSAPæ¥å®ç°æ—¶é’ŸæŒ‡é’ˆè½¬åŠ¨çš„åŠ¨æ€æ•ˆæœã€‚è¿›å…¥ä¸»é¡µä»¥åä¼šè‡ªåŠ¨åŒ¹é…ç³»ç»Ÿæ—¶é—´ï¼Œä¸»è¦é€šè¿‡Tweenmaxçš„GSAPåŠ¨ç”»å½¢æˆç¯å½¢æ—¶é’Ÿã€‚æµè§ˆåå¯ä»¥é€šè¿‡ç‚¹å‡»â€œBackâ€æŒ‰é’®ï¼Œå›åˆ°ç³»ç»Ÿindexä¸»ç•Œé¢ï¼Œå®Œæˆäº¤äº’ ç”¨é€”æœ¬æ–‡ä»¶å†…å®¹å¯æ‹†åˆ†ç”¨äºè£…é¥°åšå®¢ç­‰è§†è®¯ç½‘ç«™æ¡†æ¶ï¼Œå¢åŠ åŠŸèƒ½æ€§å’Œå¯è¯»æ€§ ä½¿ç”¨çš„åº“å’Œå·¥å…·jquery-2.1.1.min.jsã€TweenMaxã€D3.jsã€SVG é¢å¤–çš„Svg.cssæ–‡ä»¶ç”¨äºå­˜æ”¾index.htmlçš„ä¸»ç•Œé¢ä¿¡æ¯ï¼Œå¢å¼ºå¯è§†åŒ–ã€‚ å…¶ä»–https://github.com/elbadaernU404/d3","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"http://yoursite.com/categories/å‰ç«¯/"}],"tags":[{"name":"D3-SVG","slug":"D3-SVG","permalink":"http://yoursite.com/tags/D3-SVG/"}]},{"title":"Pythonçˆ¬è™«ç›¸å…³","slug":"Pythonçˆ¬è™«ç›¸å…³","date":"2018-07-29T11:25:10.000Z","updated":"2022-06-27T07:39:26.379Z","comments":true,"path":"2018/07/29/Pythonçˆ¬è™«ç›¸å…³/","link":"","permalink":"http://yoursite.com/2018/07/29/Pythonçˆ¬è™«ç›¸å…³/","excerpt":"è¿›ç¨‹å’Œçº¿ç¨‹å¹¶å‘å’Œå¹¶è¡Œå¹¶å‘æ˜¯åŒæ—¶å…·æœ‰å¤šä¸ªæ´»åŠ¨çš„ç³»ç»Ÿï¼Œå®è´¨æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªç‰©ç†CPUåœ¨è‹¥å¹²é“ç¨‹åºï¼ˆæˆ–çº¿ç¨‹ï¼‰ä¹‹é—´å¤šè·¯å¤ç”¨ã€‚å¹¶è¡Œæ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ä¸åŒäº‹ä»¶æˆ–çº¿ç¨‹åœ¨åŒä¸€æ—¶åˆ»åŒæ—¶æ‰§è¡Œã€‚å¹¶è¡Œåˆ©ç”¨å¹¶å‘ä½¿ç³»ç»Ÿè¿è¡Œæ›´å¿«ï¼Œåœ¨æ“ä½œç³»ç»Ÿçš„å¤šä¸ªæŠ½è±¡å±‚æ¬¡è¿ç”¨ã€‚ è¿›ç¨‹ç¨‹åºä¸èƒ½è‡ªå·±è¿è¡Œï¼Œåªæœ‰å°†ç¨‹åºè£…è½½è¿›å†…å­˜ï¼Œç”±ç³»ç»Ÿåˆ†é…èµ„æºåæ‰èƒ½è¿è¡Œã€‚ç¨‹åºæ˜¯æŒ‡ä»¤çš„é›†åˆï¼Œå¯ä»¥è§†ä¸ºæŒ‡ä»¤çš„é™æ€æ–‡æœ¬ï¼Œè€Œè¿›ç¨‹æ˜¯æŒ‡ä»¤çš„æ‰§è¡Œæ´»åŠ¨ï¼Œæ˜¯åŠ¨æ€çš„è¡Œä¸ºã€‚è¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿå¯¹äºä¸€ä¸ªè¿è¡Œä¸­ç¨‹åºçš„æŠ½è±¡ï¼Œæ˜¯CPUã€å†…å­˜ã€IOè®¾å¤‡çš„æŠ½è±¡ã€‚ç³»ç»Ÿå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªè¿›ç¨‹ã€‚ çº¿ç¨‹çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿè¿›è¡Œè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ï¼Œè¢«åŒ…å«äºè¿›ç¨‹ä¸­ï¼Œæ˜¯è¿›ç¨‹çš„å®é™…è¿ä½œå•ä½ã€‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥ç”±å¤šä¸ªçº¿ç¨‹ç»„æˆï¼Œçº¿ç¨‹ä¹‹é—´å…±äº«ä»£ç å’Œæ•°æ®ã€‚ç”±äºåœ¨å®é™…ç½‘ç»œæœåŠ¡å™¨ä¸­å¯¹å¹¶è¡Œçš„éœ€æ±‚ï¼Œçº¿ç¨‹æˆä¸ºé‡è¦çš„ç¼–ç¨‹æ¨¡å‹ï¼š1.å¤šçº¿ç¨‹ä¹‹é—´æ¯”å¤šè¿›ç¨‹ä¹‹é—´æ›´æ˜“å…±äº«æ•°æ®ã€‚2.çº¿ç¨‹ä¸€èˆ¬æ¯”è¿›ç¨‹é«˜æ•ˆã€‚","text":"è¿›ç¨‹å’Œçº¿ç¨‹å¹¶å‘å’Œå¹¶è¡Œå¹¶å‘æ˜¯åŒæ—¶å…·æœ‰å¤šä¸ªæ´»åŠ¨çš„ç³»ç»Ÿï¼Œå®è´¨æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªç‰©ç†CPUåœ¨è‹¥å¹²é“ç¨‹åºï¼ˆæˆ–çº¿ç¨‹ï¼‰ä¹‹é—´å¤šè·¯å¤ç”¨ã€‚å¹¶è¡Œæ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ä¸åŒäº‹ä»¶æˆ–çº¿ç¨‹åœ¨åŒä¸€æ—¶åˆ»åŒæ—¶æ‰§è¡Œã€‚å¹¶è¡Œåˆ©ç”¨å¹¶å‘ä½¿ç³»ç»Ÿè¿è¡Œæ›´å¿«ï¼Œåœ¨æ“ä½œç³»ç»Ÿçš„å¤šä¸ªæŠ½è±¡å±‚æ¬¡è¿ç”¨ã€‚ è¿›ç¨‹ç¨‹åºä¸èƒ½è‡ªå·±è¿è¡Œï¼Œåªæœ‰å°†ç¨‹åºè£…è½½è¿›å†…å­˜ï¼Œç”±ç³»ç»Ÿåˆ†é…èµ„æºåæ‰èƒ½è¿è¡Œã€‚ç¨‹åºæ˜¯æŒ‡ä»¤çš„é›†åˆï¼Œå¯ä»¥è§†ä¸ºæŒ‡ä»¤çš„é™æ€æ–‡æœ¬ï¼Œè€Œè¿›ç¨‹æ˜¯æŒ‡ä»¤çš„æ‰§è¡Œæ´»åŠ¨ï¼Œæ˜¯åŠ¨æ€çš„è¡Œä¸ºã€‚è¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿå¯¹äºä¸€ä¸ªè¿è¡Œä¸­ç¨‹åºçš„æŠ½è±¡ï¼Œæ˜¯CPUã€å†…å­˜ã€IOè®¾å¤‡çš„æŠ½è±¡ã€‚ç³»ç»Ÿå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªè¿›ç¨‹ã€‚ çº¿ç¨‹çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿè¿›è¡Œè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ï¼Œè¢«åŒ…å«äºè¿›ç¨‹ä¸­ï¼Œæ˜¯è¿›ç¨‹çš„å®é™…è¿ä½œå•ä½ã€‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥ç”±å¤šä¸ªçº¿ç¨‹ç»„æˆï¼Œçº¿ç¨‹ä¹‹é—´å…±äº«ä»£ç å’Œæ•°æ®ã€‚ç”±äºåœ¨å®é™…ç½‘ç»œæœåŠ¡å™¨ä¸­å¯¹å¹¶è¡Œçš„éœ€æ±‚ï¼Œçº¿ç¨‹æˆä¸ºé‡è¦çš„ç¼–ç¨‹æ¨¡å‹ï¼š1.å¤šçº¿ç¨‹ä¹‹é—´æ¯”å¤šè¿›ç¨‹ä¹‹é—´æ›´æ˜“å…±äº«æ•°æ®ã€‚2.çº¿ç¨‹ä¸€èˆ¬æ¯”è¿›ç¨‹é«˜æ•ˆã€‚ æ·±åº¦ä¼˜å…ˆå’Œå¹¿åº¦ä¼˜å…ˆåœ¨çˆ¬è™«ç³»ç»Ÿä¸­ï¼Œå¾…æŠ“å–URLé˜Ÿåˆ—æ˜¯å¾ˆé‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œå¾…æŠ“å–URLé˜Ÿåˆ—ä¸­çš„URLä»¥ä»€ä¹ˆæ ·çš„é¡ºåºæ’åˆ—ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„é—®é¢˜ï¼Œå› ä¸ºè¿™æ¶‰åŠåˆ°å…ˆæŠ“å–å“ªä¸ªé¡µé¢ï¼ŒåæŠ“å–å“ªä¸ªé¡µé¢ã€‚è€Œå†³å®šè¿™äº›URLæ’åˆ—é¡ºåºçš„æ–¹æ³•ï¼Œå«åšæŠ“å–ç­–ç•¥ã€‚ä»¥ä¸‹æ˜¯ä¸¤ç§å¸¸ç”¨çš„ç­–ç•¥ï¼šæ·±åº¦ä¼˜å…ˆã€å¹¿åº¦ä¼˜å…ˆã€‚ æ·±åº¦ä¼˜å…ˆæ·±åº¦ä¼˜å…ˆæ˜¯æŒ‡ç½‘ç»œçˆ¬è™«ä¼šä»èµ·å§‹é¡µå¼€å§‹ï¼Œä¸€ä¸ªé“¾æ¥ä¸€ä¸ªé“¾æ¥è·Ÿè¸ªä¸‹å»ï¼Œå¤„ç†å®Œè¿™æ¡çº¿è·¯ä¹‹åå†è½¬å…¥ä¸‹ä¸€ä¸ªèµ·å§‹é¡µï¼Œç»§ç»­è¿½è¸ªé“¾æ¥ã€‚æ·±åº¦ä¼˜å…ˆçš„çˆ¬å–çš„é¡ºåºå¼ï¼šA-B-D-E-I-C-F-G-H ï¼ˆé€’å½’ï¼‰ç®—æ³•ï¼ˆä¼ªä»£ç å½¢å¼ï¼‰ï¼š å¹¿åº¦ä¼˜å…ˆå¹¿åº¦ä¼˜å…ˆï¼Œæ˜¯æŒ‡å°†æ–°ä¸‹è½½ç½‘é¡µå‘ç°çš„é“¾æ¥ç›´æ¥æ’å…¥åˆ°å¾…æŠ“å–URLé˜Ÿåˆ—çš„æœ«å°¾ï¼Œä¹Ÿå°±æ˜¯æŒ‡ç½‘ç»œçˆ¬è™«ä¼šå…ˆæŠ“å–èµ·å§‹é¡µä¸­çš„æ‰€æœ‰ç½‘é¡µï¼Œç„¶ååœ¨é€‰æ‹©å…¶ä¸­çš„ä¸€ä¸ªè¿æ¥ç½‘é¡µï¼Œç»§ç»­æŠ“å–åœ¨æ­¤ç½‘é¡µä¸­é“¾æ¥çš„æ‰€æœ‰ç½‘é¡µã€‚å¹¿åº¦ä¼˜å…ˆçš„çˆ¬å–é¡ºåºä¸ºï¼šA-B-C-D-E-F-G-H-I (é˜Ÿåˆ—)ç®—æ³•ï¼ˆä¼ªä»£ç å½¢å¼ï¼‰ï¼š Cookieå’ŒSessionCookieç®€å•çš„è¯´å°±æ˜¯å½“ç”¨æˆ·é€šè¿‡httpåè®®è®¿é—®ä¸€ä¸ªæœåŠ¡å™¨çš„æ—¶å€™ï¼Œè¿™ä¸ªæœåŠ¡å™¨ä¼šå°†ä¸€äº›Name/Valueé”®å€¼å¯¹è¿”å›ç»™å®¢æˆ·ç«¯æµè§ˆå™¨ï¼Œå¹¶å°†è¿™äº›æ•°æ®åŠ ä¸Šä¸€äº›é™åˆ¶æ¡ä»¶ã€‚åœ¨æ¡ä»¶ç¬¦åˆæ—¶ï¼Œè¿™ä¸ªç”¨æˆ·ä¸‹æ¬¡å†è®¿é—®æœåŠ¡å™¨çš„æ—¶å€™ï¼Œæ•°æ®åˆè¢«å®Œæ•´çš„å¸¦ç»™æœåŠ¡å™¨ã€‚å› ä¸ºhttpæ˜¯ä¸€ç§æ— çŠ¶æ€åè®®ï¼Œç”¨æˆ·é¦–æ¬¡è®¿é—®webç«™ç‚¹çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨å¯¹ç”¨æˆ·ä¸€æ— æ‰€çŸ¥ã€‚è€ŒCookieå°±åƒæ˜¯æœåŠ¡å™¨ç»™æ¯ä¸ªæ¥è®¿é—®çš„ç”¨æˆ·è´´çš„æ ‡ç­¾ï¼Œè€Œè¿™äº›æ ‡ç­¾å°±æ˜¯å¯¹æ¥è®¿é—®çš„å®¢æˆ·ç«¯çš„ç‹¬æœ‰çš„èº«ä»½çš„ä¸€ä¸ªæ ‡è¯†ï¼Œè¿™é‡Œå°±å¦‚åŒæ¯ä¸ªäººçš„èº«ä»½è¯ä¸€æ ·ï¼Œå¸¦ç€ä½ çš„ä¸ªäººä¿¡æ¯ã€‚è€Œå½“ä¸€ä¸ªå®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡è¿æ¥è¿‡æ¥çš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯å°±ä¼šç»™ä»–æ‰“ä¸€ä¸ªæ ‡ç­¾ï¼Œè¿™é‡Œå°±å¦‚åŒç»™ä½ å‘äº†ä¸€ä¸ªèº«ä»½è¯ï¼Œå½“ä½ ä¸‹è½½å¸¦ç€è¿™ä¸ªèº«ä»½è¯æ¥çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨å°±çŸ¥é“ä½ æ˜¯è°äº†ã€‚æ‰€ä»¥Cookieæ˜¯å­˜åœ¨å®¢æˆ·ç«¯çš„ï¼Œè¿™é‡Œå…¶å®å°±æ˜¯åœ¨ä½ çš„æµè§ˆå™¨ä¸­ã€‚ Cookieåˆ†ç±»Cookieä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼šä¼šè¯Cookieï¼šä¸è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä¿å­˜åœ¨æµè§ˆå™¨çš„å†…å­˜ä¸­ï¼Œå…³é—­æµè§ˆå™¨ï¼ŒCookieä¾¿è¢«é”€æ¯æ™®é€šCookie:è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œä¿å­˜åœ¨ç¡¬ç›˜ä¸Š Sessionä¸Šé¢æˆ‘ä»¬çŸ¥é“äº†Cookieå¯ä»¥è®©æœåŠ¡å™¨ç«¯è·Ÿè¸ªæ¯ä¸ªå®¢æˆ·ç«¯çš„è®¿é—®ï¼Œä½†æ˜¯æ¯æ¬¡å®¢æˆ·ç«¯çš„è®¿é—®éƒ½å¿…é¡»ä¼ å›è¿™äº› Cookieï¼Œå¦‚æœ Cookie å¾ˆå¤šï¼Œè¿™æ— å½¢åœ°å¢åŠ äº†å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„æ•°æ®ä¼ è¾“é‡ï¼Œè€Œ Session çš„å‡ºç°æ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚åŒä¸€ä¸ªå®¢æˆ·ç«¯æ¯æ¬¡å’ŒæœåŠ¡ç«¯äº¤äº’æ—¶ï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½ä¼ å›æ‰€æœ‰çš„Cookieå€¼ï¼Œè€Œæ˜¯åªè¦ä¼ å›ä¸€ä¸ªIDè¿™ä¸ªIDæ˜¯å®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡è®¿é—®æœåŠ¡å™¨çš„æ—¶å€™ç”Ÿæˆçš„ï¼Œè€Œä¸”æ¯ä¸ªå®¢æˆ·ç«¯æ˜¯å”¯ä¸€çš„ã€‚è¿™æ ·æ¯ä¸ªå®¢æˆ·ç«¯å°±æœ‰äº†ä¸€ä¸ªå”¯ä¸€çš„IDï¼Œå®¢æˆ·ç«¯åªè¦ä¼ å›è¿™ä¸ªIDå°±è¡Œäº†ï¼Œè¿™ä¸ªIDé€šå¸¸æ˜¯NANEä¸ºJSESIONIDçš„ä¸€ä¸ªCookieã€‚æ‰€ä»¥Sessionå…¶å®æ˜¯åˆ©ç”¨Cookieè¿›è¡Œä¿¡æ¯å¤„ç†çš„ã€‚12345678910import reimport requestsresault = requests.get(&apos;http://120.24.86.145:8002/qiumingshan/&apos;)re = re.requests(r&apos;^&lt;div&gt;(.*)=\\?;&lt;/div&gt;$&apos;, resault.text,re.S|re.M|re.I)value =&#123;&apos;value&apos;: eval(re.group(1))&#125;resault = requests.post(&apos;http://120.24.86.145:8002/qiumingshan/&apos;, data=value)print(&apos;The Resault is:&apos;,eval(re.group(1)))print(resault.text) è¿™æ ·æ˜¯é”™è¯¯çš„ï¼Œä¼šè¯æ— æ³•ç»´æŒã€‚æ­£ç¡®å†™æ³•å¦‚ä¸‹ï¼š1234567891011import reimport requestssearch = requests.session()resault = search.get(&apos;http://120.24.86.145:8002/qiumingshan/&apos;)re = re.search(r&apos;^&lt;div&gt;(.*)=\\?;&lt;/div&gt;$&apos;, resault.text,re.S|re.M|re.I)value =&#123;&apos;value&apos;: eval(re.group(1))&#125;resault = search.post(&apos;http://120.24.86.145:8002/qiumingshan/&apos;, data=value)print(&apos;The Resault is:&apos;,eval(re.group(1)))print(resault.text) ç”¨HTMLæµ‹è¯•ç½‘ç«™httpbin.orgä¸¾ä¾‹ï¼š1234import requestsrequests.get(&quot;http://httpbin.org/cookies/set/number/123456&quot;)response = requests.get(&quot;http://httpbin.org/cookies&quot;)print(response.text) ç»“æœï¼š12345import requestss = requests.Session()s.get(&quot;http://httpbin.org/cookies/set/number/123456&quot;)response = s.get(&quot;http://httpbin.org/cookies&quot;)print(response.text) ç»“æœï¼šå¯¹äºCookieï¼Œå› ä¸ºäººä¸ºçš„å¯åˆ†ææœ¬åœ°Cookieè¿›è¡ŒCookieæ¬ºéª—ï¼ŒSessionç›¸å¯¹å®‰å…¨ã€‚è€ŒSessionä¼šä¸€æ®µæ—¶é—´å†…ä¿æŒåœ¨æœåŠ¡å™¨ä¸­ï¼Œè®¿é—®é‡è¶Šå¤šè¶Šå ç”¨æœåŠ¡å™¨æ€§èƒ½ã€‚å¦‚æœä¸»è¦å‡è½»æœåŠ¡å™¨å‹åŠ›ï¼ŒCookieç›¸å¯¹åˆé€‚ã€‚ HTMLä¸­formè¡¨å•ç™»å½•é¡µé¢ä¼šæœ‰ä¸€ä¸ªformè¡¨å•æäº¤ï¼Œformè¡¨å•çš„åŠŸèƒ½æ˜¯ç”¨äºæœé›†ä¸åŒç±»å‹çš„ç”¨æˆ·è¾“å…¥çš„å†…å®¹ã€‚æœ‰äº†è¡¨å•ï¼Œç½‘é¡µçš„å†…å®¹å¯ä»¥ç”±ç”¨æˆ·è‡ªå·±åˆ›å»ºã€‚è·å–authenticity_tokenä¿¡æ¯åï¼Œå¯ä»¥è·å¾—Cookieä¿¡æ¯ï¼Œåˆ†æç™»å½•åŒ…è·å–æäº¤åœ°å€ï¼Œåˆ©ç”¨Scrapyçˆ¬è™«æ¡†æ¶ç­‰ä¸€æ­¥æ­¥å®ç°é€šè¿‡çˆ¬è™«ç¨‹åºç™»å½•ç½‘ç«™ã€‚","categories":[{"name":"Python","slug":"Python","permalink":"http://yoursite.com/categories/Python/"}],"tags":[{"name":"çˆ¬è™«","slug":"çˆ¬è™«","permalink":"http://yoursite.com/tags/çˆ¬è™«/"}]},{"title":"Pythonæ­£åˆ™è¡¨è¾¾å¼å’Œrequestsçˆ¬è™«","slug":"Pythonæ­£åˆ™è¡¨è¾¾å¼å’Œrequestsçˆ¬è™«","date":"2018-07-20T00:23:31.000Z","updated":"2022-06-27T07:39:39.354Z","comments":true,"path":"2018/07/20/Pythonæ­£åˆ™è¡¨è¾¾å¼å’Œrequestsçˆ¬è™«/","link":"","permalink":"http://yoursite.com/2018/07/20/Pythonæ­£åˆ™è¡¨è¾¾å¼å’Œrequestsçˆ¬è™«/","excerpt":"Some people,when confronted with a problem,think,â€I know,Iâ€™ll use regular expressions.â€Now they have two problems. ----Jamie Zawinski æ­£åˆ™è¡¨è¾¾å¼æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¯åŒ¹é…æ–‡æœ¬ç‰‡æ®µçš„æ¨¡å¼ã€‚æœ€ç®€å•çš„æ­£åˆ™è¡¨è¾¾å¼ä¸ºæ™®é€šå­—ç¬¦ä¸²ï¼Œä¸è‡ªå·±åŒ¹é…ã€‚pythonæ¨¡å—reæä¾›äº†å…¶å¯¹æ­£åˆ™è¡¨è¾¾å¼çš„æ”¯æŒã€‚ requestsæ¨¡å—Requestsæ˜¯ç”¨Pythonè¯­è¨€ç¼–å†™ï¼ŒåŸºäºurllibï¼Œé‡‡ç”¨Apache2Licensedå¼€æºåè®®çš„HTTPåº“ï¼Œæ˜¯ä¸€ä¸ªéœ€è¦å•ç‹¬å®‰è£…çš„ç¬¬ä¸‰æ–¹åº“ã€‚é€šè¿‡pipæ‰§è¡ŒæŒ‡ä»¤ï¼š1pip install requests æ¥å®‰è£…requestsæ¨¡å—ã€‚py3ç‰ˆæœ¬å®‰è£…æ—¶è‡ªå¸¦pipã€‚å¦‚æœæŠ¥é”™ï¼Œå¯èƒ½éœ€è¦å¯¹pipè¿›è¡Œæ›´æ–°ï¼Œæ‰§è¡Œï¼š1python -m pip install -U pip æ¥å¯¹pipå®‰è£…æ›´æ–°ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡Œéœ€è¦å°†pythonæ·»åŠ è¿›ç¯å¢ƒå˜é‡æ‰å¯ä»¥æ‰§è¡Œã€‚è¿™æ ·å°±å®Œæˆrequestsæ¨¡å—çš„å®‰è£…ã€‚","text":"Some people,when confronted with a problem,think,â€I know,Iâ€™ll use regular expressions.â€Now they have two problems. ----Jamie Zawinski æ­£åˆ™è¡¨è¾¾å¼æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¯åŒ¹é…æ–‡æœ¬ç‰‡æ®µçš„æ¨¡å¼ã€‚æœ€ç®€å•çš„æ­£åˆ™è¡¨è¾¾å¼ä¸ºæ™®é€šå­—ç¬¦ä¸²ï¼Œä¸è‡ªå·±åŒ¹é…ã€‚pythonæ¨¡å—reæä¾›äº†å…¶å¯¹æ­£åˆ™è¡¨è¾¾å¼çš„æ”¯æŒã€‚ requestsæ¨¡å—Requestsæ˜¯ç”¨Pythonè¯­è¨€ç¼–å†™ï¼ŒåŸºäºurllibï¼Œé‡‡ç”¨Apache2Licensedå¼€æºåè®®çš„HTTPåº“ï¼Œæ˜¯ä¸€ä¸ªéœ€è¦å•ç‹¬å®‰è£…çš„ç¬¬ä¸‰æ–¹åº“ã€‚é€šè¿‡pipæ‰§è¡ŒæŒ‡ä»¤ï¼š1pip install requests æ¥å®‰è£…requestsæ¨¡å—ã€‚py3ç‰ˆæœ¬å®‰è£…æ—¶è‡ªå¸¦pipã€‚å¦‚æœæŠ¥é”™ï¼Œå¯èƒ½éœ€è¦å¯¹pipè¿›è¡Œæ›´æ–°ï¼Œæ‰§è¡Œï¼š1python -m pip install -U pip æ¥å¯¹pipå®‰è£…æ›´æ–°ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡Œéœ€è¦å°†pythonæ·»åŠ è¿›ç¯å¢ƒå˜é‡æ‰å¯ä»¥æ‰§è¡Œã€‚è¿™æ ·å°±å®Œæˆrequestsæ¨¡å—çš„å®‰è£…ã€‚ è„šæœ¬æ¥ä¸‹æ¥ä¾¿å¯ä»¥å°è¯•åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼ç»“åˆrequestsçˆ¬è™«æ¥å†™ä¸€ä¸ªè„šæœ¬ç”¨äºçˆ¬å–ç½‘é¡µä¿¡æ¯ï¼Œä»¥ä¸€é“ç®€å•çš„CTFé¢˜ä¸ºä¾‹ï¼šhttp://120.24.86.145:8002/qiumingshan/æ‰“å¼€é¡µé¢åè¦æ±‚2så†…è®¡ç®—ç®—æœ¯å¼çš„å€¼ï¼Œå¤šæ¬¡åˆ·æ–°åå¾—åˆ°æç¤ºç”¨postä¼ é€’valueå‚æ•°ï¼šé¦–å…ˆå¼•ç”¨æ¨¡å—æ­£åˆ™è¡¨è¾¾å¼å’Œrequestsçˆ¬è™«ï¼š1import re 1import requests æ¥ä¸‹æ¥ä½¿ç”¨Sessionå¯¹è±¡æ¥ç¡®ä¿å¯¹è¯çš„æŒç»­ï¼Œä½¿æœåŠ¡å™¨çŸ¥é“è¯·æ±‚å‡ä¸ºåŒä¸€PCç«¯å‘å‡ºã€‚ä½¿ç”¨getè·å¾—ç½‘é¡µæºç ä¸­çš„å†…å®¹ï¼š1search = requests.session() 1resault = search.get(&apos;http://120.24.86.145:8002/qiumingshan/&apos;) æ¥ä¸‹æ¥é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æ¥æå–éœ€è¦åˆ©ç”¨çš„ä¿¡æ¯ï¼š1re = re.search(r&apos;^&lt;div&gt;(.*)=\\?;&lt;/div&gt;$&apos;, resault.text,re.S|re.M|re.I) åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œâ€œ.â€ä¸ºé€šé…ç¬¦ï¼Œä¸é™¤æ¢è¡Œç¬¦å¤–çš„å…¶ä»–å­—ç¬¦éƒ½åŒ¹é…ï¼Œâ€œ.*â€è¡¨ç¤ºé€šé…ç¬¦å¯å‡ºç°0ã€1æˆ–å¤šæ¬¡ã€‚ä»ç½‘é¡µä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯æ¬¡ç®—æœ¯å¼éƒ½åœ¨æ”¹å˜ï¼Œä½†æ˜¯æœ€åçš„â€œ=?â€æ˜¯ä¸å˜çš„ï¼Œæ‰€ä»¥å¯¹æœ€åçš„â€œ=?â€ä¿ç•™åŸæ ·ï¼Œå¹¶ä½¿ç”¨åæ–œæ \\è¿›è¡Œè½¬ä¹‰ï¼šâ€œ=\\?â€ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ä¸­é—®å·ä»£è¡¨0æˆ–1ï¼Œæ˜¯ç‰¹æ®Šå­—ç¬¦ï¼‰ï¼Œè€Œä¸ºäº†è¡¨ç¤ºreæ¨¡å—éœ€è¦çš„å•ä¸ªåæ–œæ ï¼Œé€šå¸¸éœ€è¦ç”¨ä¸¤ä¸ªåæ–œæ æ¥è¿›è¡Œè½¬ä¹‰ï¼ŒåŒ…æ¶µè§£é‡Šå™¨çš„è½¬ä¹‰å’Œreæ¨¡å—æ‰§è¡Œçš„è½¬ä¹‰ã€‚æ‰€ä»¥åœ¨è¡¨è¾¾å¼çš„å¼€å§‹æˆ‘ä½¿ç”¨äº†åŸå§‹å­—ç¬¦ä¸²çš„æ ‡å¿—ræ¥å–æ¶ˆäº†è§£é‡Šå™¨åæ–œæ çš„ä½¿ç”¨ã€‚ç”±è„±å­—ç¬¦^æ¥å¼€å§‹ï¼Œæ‰“å¼€é“¾æ¥ï¼ŒF12è¿›è¡Œå®¡æŸ¥å…ƒç´ ï¼Œå¯ä»¥çœ‹åˆ°éœ€è¦åˆ©ç”¨åˆ°çš„éƒ¨åˆ†åŒ…æ‹¬åœ¨HTMLæ ‡ç­¾â€œ&lt;div&gt;â€¦&lt;/div&gt; â€ä¸­ï¼šå°†ä¸»ä½“ç®—æœ¯éƒ¨åˆ†ç”¨å°æ‹¬å·â€œ()â€æ¥è¿›è¡Œç¼–ç»„ï¼Œæ­¤æ—¶â€œ.*â€ä¸ºç¼–ç»„1ã€‚ä»¥ç¾å…ƒç¬¦å·â€œ$â€æ¥è¡¨ç¤ºå­—ç¬¦ä¸²çš„æœ«å°¾ï¼Œç”¨resault.textå°†å­—ç¬¦ä¸²è¿”å›ã€‚re.Sã€re.Mã€re.Içš„ä½œç”¨åˆ†åˆ«ä¸ºä»¥â€œ.â€ä»£æ›¿ä»»ä½•å­—ç¬¦ï¼Œå¤šè¡Œæ¨¡å¼ï¼Œä»¥åŠå¿½ç•¥å¤§å°å†™ï¼ŒæŒ‰ä½æˆ–è¿ç®—ç¬¦â€œ|â€åœ¨è¿™é‡Œè¡¨ç¤ºè¿™äº›flagså®šä¹‰å…¨éƒ¨æˆç«‹ã€‚1value =&#123;&apos;value&apos;: eval(re.group(1))&#125; å®šä¹‰ä¸€ä¸ªå­—å…¸valueï¼Œå…¶é”®å€¼åˆ†åˆ«ä¸ºâ€™valueâ€™å’Œç®—æœ¯å¼çš„ç»“æœã€‚evalå‡½æ•°ç”¨äºè®¡ç®—å­—ç¬¦ä¸²è¡¨ç¤ºçš„pythonè¡¨è¾¾å¼çš„å€¼å¹¶è¿”å›ç»“æœï¼Œå³è®¡ç®—å‡ºç¼–ç»„1ä¸­ç®—æœ¯å¼çš„å€¼ï¼Œå¹¶ä½œä¸ºå€¼ä¸â€™valueâ€™åŒ¹é…ã€‚å‘é€postè¯·æ±‚ï¼š1resault = search.post(&apos;http://120.24.86.145:8002/qiumingshan/&apos;, data=value) postè¯·æ±‚çš„å‚æ•°ä»¥dataå…³é”®å­—å‚æ•°æ¥ä¼ é€’ï¼Œè€Œdataå‚æ•°ä¼ é€’å­—å…¸ï¼Œè¿™é‡Œä¼ é€’çš„ä¾¿æ˜¯å­—å…¸â€™valueâ€™ã€‚æ˜¾ç¤ºç»“æœï¼š12print(&apos;The Resault is:&apos;ï¼Œeval(re.group(1)))print(resault.text) è¿™æ ·è§£é¢˜çš„è„šæœ¬ä¾¿å®Œæˆäº†ã€‚åœ¨IDLEä¸­è¿è¡Œï¼Œå¯ä»¥å¾—åˆ°flagã€‚","categories":[{"name":"Python","slug":"Python","permalink":"http://yoursite.com/categories/Python/"}],"tags":[{"name":"çˆ¬è™«","slug":"çˆ¬è™«","permalink":"http://yoursite.com/tags/çˆ¬è™«/"}]},{"title":"æµ·é¾Ÿç»˜å›¾æ³•ï¼ˆPythonï¼‰","slug":"æµ·é¾Ÿç»˜å›¾æ³•ï¼ˆPythonï¼‰","date":"2018-07-15T09:26:57.000Z","updated":"2022-06-27T07:40:34.929Z","comments":true,"path":"2018/07/15/æµ·é¾Ÿç»˜å›¾æ³•ï¼ˆPythonï¼‰/","link":"","permalink":"http://yoursite.com/2018/07/15/æµ·é¾Ÿç»˜å›¾æ³•ï¼ˆPythonï¼‰/","excerpt":"","text":"è¿™é‡Œæ˜¯pythonä¸­çš„ä¸€ä¸ªç»˜å›¾æ¨¡å—:æµ·é¾Ÿç»˜å›¾(turtle)ã€‚æ­¤æ¨¡å—å¯ä»¥è®©æ“ä½œè€…ç»˜åˆ¶å›¾å½¢ï¼Œè€Œéæ‰“å°æ–‡æœ¬ã€‚å…¶ä»–å‘½ä»¤å‚è€ƒï¼šhttps://docs.python.org/3/library/turtle.htmlç»˜å›¾æ–¹æ³•:å‚è€ƒæœç´¢turtle graphis æœ€ç®€å•çš„ç¤ºä¾‹:import turtlet=turtle.Pen()t.reset()for x in range(100): t.forward(x) t.left(90)æ•ˆæœå›¾:è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå­˜å‚¨æ–‡ä»¶æ—¶æ–‡ä»¶åç§°ä¸èƒ½ä»¥turtleå‘½åï¼Œå¦åˆ™è§£é‡Šå™¨å°†ä¼šæŠ¥é”™ã€‚ ä¹‹åå¯ä»¥å°è¯•ç»“åˆéšæœºå‡½æ•°å’Œéšæœºè¯­å¥æ¥ç»˜åˆ¶è¾ƒä¸ºå¤æ‚çš„å›¾å½¢:import turtle as tfrom random import randintt.TurtleScreen._RUNNING = True #ä½¿ç¨‹åºäºIDLEä¸­é¡ºåˆ©è¿è¡Œt.speed(0) #é€Ÿåº¦æœ€å¿«t.bgcolor(â€œblackâ€) #èƒŒæ™¯è‰²ä¸ºé»‘è‰²t.setpos(-25, 25) #èµ·å§‹ä½ç½®t.colormode(255) #é¢œè‰²æ¨¡å¼ä¸ºçœŸå½©è‰²i = 0 #èµ‹å“‘å€¼for a in range(0,200): #ç»˜åˆ¶èŠ±ç“£ r = randint(0, 255) g = randint(0, 255) b = randint(0, 255) t.pencolor(r, g, b) t.forward(50 + i) t.right(85) t.forward(i) t.left(30) i += 1t.left(90) #ç»˜åˆ¶èŠ±æ†t.pensize(width=10)t.pencolor(â€œgreenâ€)t.speed(10)t.forward(250)t.done()æ•ˆæœå›¾ï¼š å¯ä»¥è¿›ä¸€æ­¥æ¥è®¾è®¡ä¸€ä¸ªå°æ¸¸æˆ:import turtle as tfrom random import randint t.TurtleScreen._RUNNING = Truet.setup(width=750, height=350, startx=None, starty=None) #ç•Œé¢å¤§å°è®¾ç½®t.hideturtle() #éšè—æµ·é¾Ÿç”»ç¬”t.color(â€œorangeâ€)t.penup()t.setpos(0, 0)myfont = (â€œéš¶ä¹¦â€, 16, â€œnormalâ€) #è®¾ç½®å­—ä½“target = randint(1, 100)t.write(â€œä¸€ä¸ª1åˆ°100ä¹‹é—´çš„æ•´æ•°ï¼ŒçŒœçŒœçœ‹ï¼šâ€, font=myfont)guess = 0while target!=guess in range(0,100): guess = t.simpledialog.askinteger(â€œçŒœæ•°æ¸¸æˆâ€, â€œè¯·è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼šâ€) if guess == target: answer = â€œCongratulations!â€ t.bgcolor(â€œblackâ€) elif not guess: t.clear() t.write(â€œGive Up,Game Over.â€, font=myfont) break elif guess &gt; target: answer = â€œä½ çŒœå¤§äº†ï¼Œå†çŒœä¸€æ¬¡ï¼šâ€ else: answer = â€œä½ çŒœå°äº†ï¼Œå†çŒœä¸€æ¬¡ï¼šâ€ t.clear() t.write(answer, font=myfont)t.done()åˆå§‹ç•Œé¢:èƒœåˆ©ç•Œé¢:æ”¾å¼ƒç•Œé¢:","categories":[{"name":"Python","slug":"Python","permalink":"http://yoursite.com/categories/Python/"}],"tags":[{"name":"æµ·é¾Ÿç»˜å›¾","slug":"æµ·é¾Ÿç»˜å›¾","permalink":"http://yoursite.com/tags/æµ·é¾Ÿç»˜å›¾/"}]},{"title":"ä¸€äº›.vbsè„šæœ¬æ–‡ä»¶(è‡ªå¨±è‡ªä¹å‘)","slug":"ä¸€äº›-vbsè„šæœ¬æ–‡ä»¶-è‡ªå¨±è‡ªä¹å‘","date":"2018-07-01T11:57:57.000Z","updated":"2022-06-27T07:42:42.213Z","comments":true,"path":"2018/07/01/ä¸€äº›-vbsè„šæœ¬æ–‡ä»¶-è‡ªå¨±è‡ªä¹å‘/","link":"","permalink":"http://yoursite.com/2018/07/01/ä¸€äº›-vbsè„šæœ¬æ–‡ä»¶-è‡ªå¨±è‡ªä¹å‘/","excerpt":"","text":".vbsæˆ‘è®°å¾—åˆè¯†basicè¯­è¨€å¥½åƒè¦å›æº¯åˆ°2014å¹´ä»¥å‰ï¼Œåˆä¸­æ—¶ä»£ï¼Œå½“æ—¶è€ƒè¯•çš„é‡å¿ƒä¸»è¦æ˜¯æ”¾åœ¨è¯»ç¨‹åºé€»è¾‘ä¸Šï¼Œå‡ ä¸ªè¯­å¥ï¼Œåƒloopâ€¦untilè‡³ä»Šå°è±¡æ·±åˆ»ã€‚è®°å½•å‡ ä¸ªç®€å•çš„.vbsè„šæœ¬ï¼Œè®¡ç®—æœºå¯ä»¥ç›´æ¥æ‰§è¡Œã€‚ 1.æ¶ˆæ¯æ¡†æ‹›å‘¼è„šæœ¬è®°äº‹æœ¬ç¼–å†™â€™msgbox â€œHelloï¼Œ9.9â€â€˜ï¼Œå°†æ–‡ä»¶åç¼€.txtä¿®æ”¹ä¸º.vbså³å¯ï¼ŒåŒå‡»è¿è¡Œåå¼¹å‡ºæ¶ˆæ¯æ¡†ï¼Œå¯ä»¥å°†æ­¤è„šæœ¬è®¾ç½®ä¸ºå¼€æœºå¯åŠ¨ï¼Œæ©ï¼Œç¡¬æ ¸è‡ªå·±ç»™è‡ªå·±æ‰“ä¸ªæ‹›å‘¼æ¥è‡ªå¨±è‡ªä¹ã€‚ï¼ˆå¦ï¼Œåœ¨å®¤å‹ç”µè„‘ç¼–å†™åé¦–æœ«æ·»åŠ do/loopå¯ä»¥è®©ç¨‹åºè¿›å…¥æ­»å¾ªç¯ï¼Œè®¯æ¯å†…å®¹å¯ä»¥éšæ„å‘æŒ¥ï¼Œæ§åˆ¶å°å…³é—­ç¨‹åºå³å¯ï¼‰ 2.è¯­éŸ³è„šæœ¬åŒæ ·çš„ï¼Œåœ¨è®°äº‹æœ¬ç¼–å†™â€™CreateObject(â€œSAPI.SpVoiceâ€).Speak â€œHello,9.9â€â€˜ï¼Œè°ƒæ•´æ‰©å±•åä¸º.vbsï¼Œè¿è¡Œåå¾—åˆ°ç³»ç»Ÿè¯­è¨€æç¤ºã€‚åŒæ ·çš„ï¼Œå¯ä»¥å°†å…¶è®¾ç½®ä¸ºå¼€æœºå¯åŠ¨ï¼Œé…åˆæ¶ˆæ¯æ¡†é£Ÿç”¨æ•ˆæœæ›´ä½³ï¼ˆå‡è£…æ˜¯ç”µè„‘ç»™è‡ªå·±æ‰“æ‹›å‘¼ï¼‰ã€‚ 3.æ— é™åˆ·æ–°ï¼š1234set ws=createobject(&quot;wscript.shell&quot;)dows.sendkeys&quot;&#123;f5&#125;&quot;loop æ— é™Alt+f4123456dim WSHshellset WSHshell=wscript.createobject(&quot;wscript.shell&quot;)dowscript.sleep 2000WSHshell.SendKeys&quot;%&#123;f4&#125;&quot;loop QQæ¶ˆæ¯è‡ªåŠ¨å‘é€1234567891011On Error Resume Next Dim fd,ye set fd=createobject(&quot;wscript.shell&quot;) for i=1 to 10 //å¾ªç¯æ¬¡æ•°wscript.sleep 100 //å¾ªç¯é—´éš”ï¼Œè¶Šå¤§è¶Šæ…¢fd.AppActivate(&quot;Name&quot;) //å‘é€å¯¹è±¡çš„æ˜µç§°fd.sendKeys &quot;^v&quot; //æ‰“å°å¤åˆ¶çš„å†…å®¹fd.sendKeys ifd.sendKeys &quot;%s&quot; next wscript.quit ï¼ˆæ³¨ï¼šä»¥ä¸Šè„šæœ¬æ…ç”¨ï¼Œç©ç¬‘é€‚å¯è€Œæ­¢ã€‚ï¼‰ æ·»åŠ æ’æ›²æ¥è‡ªä¼Ÿå¤§çš„360çˆ¸çˆ¸å‘å‡ºçš„æœ¨é©¬è­¦å‘Šï¼ˆæˆ‘æ—¥æˆ‘è‡ªå·±lolï¼‰","categories":[{"name":"è„šæœ¬","slug":"è„šæœ¬","permalink":"http://yoursite.com/categories/è„šæœ¬/"}],"tags":[{"name":"vb","slug":"vb","permalink":"http://yoursite.com/tags/vb/"}]},{"title":"2018å¹´ä¸Šå®è®­è®°å½•","slug":"2018å¹´ä¸Šå®è®­è®°å½•","date":"2018-06-04T08:59:38.000Z","updated":"2022-06-27T07:33:02.826Z","comments":true,"path":"2018/06/04/2018å¹´ä¸Šå®è®­è®°å½•/","link":"","permalink":"http://yoursite.com/2018/06/04/2018å¹´ä¸Šå®è®­è®°å½•/","excerpt":"ï¼ˆæŒç»­æ›´æ–°ingâ€¦ï¼‰ Day1.æ‰€è°“å®è®­çš„å¤§ç›®æ ‡åªæœ‰ä¸€ä¸ªä¿„ç½—æ–¯æ–¹å—çš„è®¾è®¡ï¼Œå·¥å…·ä¸ºCodeblocksã€‚å®é™…ä¸ŠæŒºæ— èŠï¼Œä¸Šåˆä¸Šæœºçš„ç¯å¢ƒä¹‹å‰éƒ½æœ‰é…ç½®è¿‡ï¼Œç®€å•è°ƒè¯•äº†ä¸‹ï¼Œå‘çˆ¹çš„æ˜¯ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å®‰è£…äº†ä»€ä¹ˆä¼½å¡ä»–å¡æˆ‘å¡å¤§å®¶å¡çš„æµæ°“å­¦ç”Ÿç«¯è¯¾å ‚å·¥å…·ï¼ˆå·²ç­å£ï¼Œä¸‹å›¾1é™„åŠ æ–¹æ³•ï¼‰ã€‚ä¸‹åˆéšè¿›åº¦å†™äº†å‡ è¡Œä»£ç ï¼Œä»…ä»…è°ƒæ•´äº†å…‰æ ‡ä»¥åŠé¢œè‰²ç­‰çš„è®¾ç½®ï¼Œç„¶åå°±ï¼ˆç»“æŸäº†ï¼Ÿï¼Ÿï¼‰emmmmmï¼ŒGGï¼Œæ‡µé€¼ä¸­æ°´æ‰ä¸€å¤©ï¼Œè¿˜æ˜¯é¡ºå¸¦å­¦äº›å…¶ä»–çš„ç©æ„å§XDã€‚ä¸å¤šåæ§½ï¼Œè¿™ç©æ„è™½ç„¶å¸¸è§ï¼Œä»£ç åƒåƒä¸‡ä¸‡ä½†åˆ°è‡ªå·±æ‰‹é‡Œæ¯•ç«Ÿä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡åšï¼Œè¸å®äº›ã€‚","text":"ï¼ˆæŒç»­æ›´æ–°ingâ€¦ï¼‰ Day1.æ‰€è°“å®è®­çš„å¤§ç›®æ ‡åªæœ‰ä¸€ä¸ªä¿„ç½—æ–¯æ–¹å—çš„è®¾è®¡ï¼Œå·¥å…·ä¸ºCodeblocksã€‚å®é™…ä¸ŠæŒºæ— èŠï¼Œä¸Šåˆä¸Šæœºçš„ç¯å¢ƒä¹‹å‰éƒ½æœ‰é…ç½®è¿‡ï¼Œç®€å•è°ƒè¯•äº†ä¸‹ï¼Œå‘çˆ¹çš„æ˜¯ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å®‰è£…äº†ä»€ä¹ˆä¼½å¡ä»–å¡æˆ‘å¡å¤§å®¶å¡çš„æµæ°“å­¦ç”Ÿç«¯è¯¾å ‚å·¥å…·ï¼ˆå·²ç­å£ï¼Œä¸‹å›¾1é™„åŠ æ–¹æ³•ï¼‰ã€‚ä¸‹åˆéšè¿›åº¦å†™äº†å‡ è¡Œä»£ç ï¼Œä»…ä»…è°ƒæ•´äº†å…‰æ ‡ä»¥åŠé¢œè‰²ç­‰çš„è®¾ç½®ï¼Œç„¶åå°±ï¼ˆç»“æŸäº†ï¼Ÿï¼Ÿï¼‰emmmmmï¼ŒGGï¼Œæ‡µé€¼ä¸­æ°´æ‰ä¸€å¤©ï¼Œè¿˜æ˜¯é¡ºå¸¦å­¦äº›å…¶ä»–çš„ç©æ„å§XDã€‚ä¸å¤šåæ§½ï¼Œè¿™ç©æ„è™½ç„¶å¸¸è§ï¼Œä»£ç åƒåƒä¸‡ä¸‡ä½†åˆ°è‡ªå·±æ‰‹é‡Œæ¯•ç«Ÿä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡åšï¼Œè¸å®äº›ã€‚ Day2.æ”¶å½•ä¸Šåˆçš„ä»£ç ï¼š1/Headers/day1.h #ifndef DAY1_H_INCLUDED #define DAY1_H_INCLUDED #include&lt;stdio.h&gt; #include&lt;stdlib.h&gt; #include&lt;string.h&gt; #include&lt;time.h&gt; #include&lt;conio.h&gt; #include&lt;windows.h&gt; #include&lt;stdbool.h&gt; typedef struct TetriManager{ unsigned int pool[28];//æ¸¸æˆæ±  int x;//å½“å‰æ–¹å—æ¨ªåæ ‡ï¼Œæ­¤å¤„åæ ‡ä¸ºXè½´å·¦ä¸Šè§’æ¨ªåæ ‡ int y;//å½“å‰æ–¹å—çºµåæ ‡ï¼Œæ­¤å¤„åæ ‡ä¸ºYè½´å·¦ä¸Šè§’çºµåæ ‡ int type[3];//å½“å‰ã€ä¸‹ä¸€ä¸ªå’Œä¸‹ä¸‹ä¸€ä¸ªæ–¹å—çš„ç±»å‹ int orientation[3];//å½“å‰ã€ä¸‹ä¸€ä¸ªå’Œä¸‹ä¸‹ä¸€ä¸ªæ–¹å—çš„æ—‹è½¬çŠ¶æ€ unsigned score;//å¾—åˆ† unsigned erasedCount[4];//æ¶ˆè¡Œæ•° unsigned erasedTotle;//æ¶ˆå¤±è¡Œæ€»æ•° unsigned tetrisTotal;//æ–¹å—æ€»æ•° bool dead;//æ¸¸æˆæ˜¯å¦ç»“æŸ}Manager; typedef struct TetrisControl{ bool pause;//æš‚åœ bool clockwise;//æ—‹è½¬æ–¹å‘ï¼šé¡ºæ—¶é’ˆä¸ºtrue int direction;//ç§»åŠ¨æ–¹å‘ï¼š0å‘å·¦è¿åŠ¨ï¼Œ1å‘å³è¿åŠ¨ int color[28][16]}Control; HANDLE Output;void printPrompting();void gotoxyWithFullwidth(short x,short y); #endif // DAY1_H_INCLUDED1/Sources/main.c int main(){ Output=GetStdHandle(STD_OUTPUT_HANDLE); printPrompting();} void gotoxyWithFullwidth(short x,short y)//è¿›è¡Œå…¨è§’å®šä½{ static COORD cd; cd.X=(x*2); cd.Y=y; SetConsoleCursorPosition(Output,cd);} void printPrompting()//æ˜¾ç¤ºæç¤ºä¿¡æ¯{ SetConsoleTextAttribute(Output,11); gotoxyWithFullwidth(28,12); printf(â€œæ§åˆ¶ï¼šâ€);} æ”¶å½•ä¸‹åˆçš„ä»£ç ï¼ˆä¸»è¦æ˜¯åˆ©ç”¨å¾ªç¯å¢æ·»æç¤ºä¿¡æ¯ç­‰ï¼‰ï¼š","categories":[{"name":"ä¸ªäººç¬”è®°","slug":"ä¸ªäººç¬”è®°","permalink":"http://yoursite.com/categories/ä¸ªäººç¬”è®°/"}],"tags":[{"name":"C","slug":"C","permalink":"http://yoursite.com/tags/C/"}]},{"title":"ISCC2018çš„éƒ¨åˆ†WP","slug":"ISCC2018çš„éƒ¨åˆ†WP","date":"2018-05-07T12:03:21.000Z","updated":"2022-06-27T07:31:28.450Z","comments":true,"path":"2018/05/07/ISCC2018çš„éƒ¨åˆ†WP/","link":"","permalink":"http://yoursite.com/2018/05/07/ISCC2018çš„éƒ¨åˆ†WP/","excerpt":"ï¼ˆæŒç»­æ›´æ–°â€¦ï¼‰ 1.è¦æ±‚è¾“å…¥æ¯”æœåŠ¡å™¨ä¸Šå¤§çš„æ•°å­—ï¼Œéšä¾¿è¾“å…¥å‡ ä¸ª9ï¼Œå‘ç°æœ€å¤šåªèƒ½è¾“å…¥ä¸‰ä½æ•°ï¼Œç›´æ¥F12æ‰¾åˆ°maxlength=3å°†3ä¿®æ”¹ä¸º4å†éšæ„å¡«å…¥ä¸€ä¸ªå››ä½æ•°å³å¯ã€‚ 2.æ‰“å¼€åœ°å€åæ˜¯ä¸€ä»½PHPä»£ç ï¼šç”±ä»£ç è¯»å‡ºéœ€è¦ä½¿strcmpå‡½æ•°å€¼ä¸º0ï¼Œåº”è¯¥æ˜¯è¦æ„é€ å‡ºé•¿åº¦ç›¸ç­‰çš„æ•°ç»„ã€‚æ„é€ payloadï¼Œåœ¨è¿æ¥åæ·»å…¥/?password[]=aï¼Œè¿”å›flagã€‚ 3.ç”¨BurpsuiteæŠ“åŒ…ï¼ŒGOä¸€æ¬¡åå¾—åˆ°æç¤ºåœ¨Requestæ·»åŠ X-Forwarded-For:127.0.0.1å³å¯ã€‚","text":"ï¼ˆæŒç»­æ›´æ–°â€¦ï¼‰ 1.è¦æ±‚è¾“å…¥æ¯”æœåŠ¡å™¨ä¸Šå¤§çš„æ•°å­—ï¼Œéšä¾¿è¾“å…¥å‡ ä¸ª9ï¼Œå‘ç°æœ€å¤šåªèƒ½è¾“å…¥ä¸‰ä½æ•°ï¼Œç›´æ¥F12æ‰¾åˆ°maxlength=3å°†3ä¿®æ”¹ä¸º4å†éšæ„å¡«å…¥ä¸€ä¸ªå››ä½æ•°å³å¯ã€‚ 2.æ‰“å¼€åœ°å€åæ˜¯ä¸€ä»½PHPä»£ç ï¼šç”±ä»£ç è¯»å‡ºéœ€è¦ä½¿strcmpå‡½æ•°å€¼ä¸º0ï¼Œåº”è¯¥æ˜¯è¦æ„é€ å‡ºé•¿åº¦ç›¸ç­‰çš„æ•°ç»„ã€‚æ„é€ payloadï¼Œåœ¨è¿æ¥åæ·»å…¥/?password[]=aï¼Œè¿”å›flagã€‚ 3.ç”¨BurpsuiteæŠ“åŒ…ï¼ŒGOä¸€æ¬¡åå¾—åˆ°æç¤ºåœ¨Requestæ·»åŠ X-Forwarded-For:127.0.0.1å³å¯ã€‚ 4.ç™¾åº¦äº†ä¸€ä¸‹XSSï¼šåˆç§°CSS (Cross Site Script)ï¼Œè·¨ç«™è„šæœ¬æ”»å‡»ã€‚æ‰€ä»¥é“¾æ¥åçš„é‚£ä¸€éƒ¨åˆ†åº”è¯¥æ˜¯è¢«æ¤å…¥äº†è„šæœ¬å¹¶éšè—è¿›é“¾æ¥ä¸­ã€‚è§£ç åæ ¹æ®+v+äº†è§£åˆ°æ˜¯utf-7ç¼–ç ï¼Œè§£ç åå¾—åˆ°keyçš„å†…å®¹ï¼Œå¡«å…¥å¾—flagã€‚ 5.ä»…æ–‡æœ¬è¦æ±‚ç»™å‡ºæ­£ç¡®çš„è´¦å·å’Œå¯†ç ã€‚æŸ¥çœ‹ä»£ç ï¼š&lt;?phperror_reporting(0);$flag = â€œ***â€œ;if(isset($_GET[â€˜usernameâ€™])){ if (0 == strcasecmp($flag,$_GET[â€˜usernameâ€™])){ $a = fla; echo â€œvery good!Username is rightâ€; } else{ print â€˜Username is not rightâ€˜;}}elseprint â€˜Please give me username or password!â€™;if (isset($_GET[â€˜passwordâ€™])){ if (is_numeric($_GET[â€˜passwordâ€™])){ if (strlen($_GET[â€˜passwordâ€™]) &lt; 4){ if ($_GET[â€˜passwordâ€™] &gt; 999){ $b = g; print â€˜very good!Password is rightâ€˜; }else print â€˜Password too littleâ€˜; }else print â€˜Password too longâ€˜; }else print â€˜Password is not numericâ€˜;}if ($a.$b == â€œflagâ€) print $flag;?&gt;ç”¨æˆ·åä¸ºFlagï¼Œå¯†ç è¦æ±‚å°äº4ä¸ªå­—èŠ‚å¹¶å¤§äº999ï¼ŒæŒ‰ç…§strcasecmpé‡æ•°ç»„è¿”å›null=0ï¼ŒåŒæ—¶ç”¨16è¿›åˆ¶3e8æ¥ä»£æ›¿1000å³å¯ï¼ˆå®é™…ä¸Š3e7å’Œ3e6å¯¹åº”çš„999ä»¥åŠ998ä¹Ÿå¯ä»¥é€šè¿‡ï¼Œå¯èƒ½æ˜¯é¢˜ç›®è®¾è®¡å¾—ä¸å¤Ÿä¸¥è°¨ï¼‰ã€‚æ„é€ http://118.190.152.202:8017/index.php?username[]=&amp;password=3E8å³æ˜¾ç¤ºFlagã€‚ 6.ä¸€åªé»‘è‰²çš„æ‰‹æŒ‡å‘ä¸‹æ–¹ï¼Œå¯èƒ½åœ¨æš—ç¤ºäº›ä»€ä¹ˆã€‚ç”¨tweakpngæ‰“å¼€åå¾—åˆ°æç¤ºï¼šæŒ‰è¦æ±‚ä¿®æ”¹402e2d95ä¸ºb92fc0cdå¹¶æ²¡æœ‰å®é™…æ•ˆæœã€‚äº†è§£åˆ°crcé”™è¯¯ï¼Œå¯èƒ½æ˜¯æ‰‹æŒ‡ä¸‹æ–¹æˆªæ‰æŸäº›éƒ¨åˆ†å¯¼è‡´å›¾ç‰‡ä¸å®Œæ•´ã€‚å°è¯•ä¿®æ”¹äº†é«˜åº¦1f4ï¼ˆ16è¿›åˆ¶500ï¼‰ä¸º3e8ï¼ˆ1000ï¼‰åï¼Œå¯ä»¥çœ‹åˆ°Flagã€‚ 7.åŸºäºåŸ¹æ ¹å¯†ç çš„ç§˜å¯†ç”µæŠ¥ï¼Œæ ¹æ®å¯†ç è¡¨å³å¯ç ´è¯‘ã€‚ 8.â€œæœ‰è¶£çš„ISCCâ€ï¼Œåœ¨å›¾ç‰‡ä¸­éšè—äº†å†…å®¹ã€‚ç›´æ¥ç”¨è®°äº‹æœ¬æ‰“å¼€å›¾ç‰‡ï¼Œå‘ç°æ–‡æœ¬æœ€åçš„ç¼–ç ï¼š? # 9 2 ; &amp; # 1 1 7 ; &amp; # 4 8 ; &amp; # 4 8 ; &amp; # 5 4 ; &amp; # 5 4 ; &amp; # 9 2 ; &amp; # 1 1 7 ; &amp; # 4 8 ; &amp; # 4 8 ; &amp; # 5 4 ; &amp; # 9 9 ; &amp; # 9 2 ; &amp; # 1 1 7 ; &amp; # 4 8 ; &amp; # 4 8 ; &amp; # 5 4 ; &amp; # 4 9 ; &amp; # 9 2 ; &amp; # 1 1 7 ; &amp; # 4 8 ; &amp; # 4 8 ; &amp; # 5 4 ; &amp; # 5 5 ; &amp; # 9 2 ; &amp; # 1 1 7 ; &amp; # 4 8 ; &amp; # 4 8 ; &amp; # 5 5 ; &amp; # 9 8 ; &amp; # 9 2 ; &amp; # 1 1 7 ; &amp; # 4 8 ; &amp; # 4 8 ; &amp; # 5 4 ; &amp; # 5 7 ; &amp; # 9 2 ; &amp; # 1 1 7 ; &amp; # 4 8 ; &amp; # 4 8 ; &amp; # 5 5 ; &amp; # 5 1 ; &amp; # 9 2 ; &amp; # 1 1 7 ; &amp; # 4 8 ; &amp; # 4 8 ; &amp; # 5 4 ; &amp; # 5 1 ; &amp; # 9 2 ; &amp; # 1 1 7 ; &amp; # 4 8 ; &amp; # 4 8 ; &amp; # 5 4 ; &amp; # 5 1 ; &amp; # 9 2 ; &amp; # 1 1 7 ; &amp; # 4 8 ; &amp; # 4 8 ; &amp; # 5 0 ; &amp; # 4 8 ; &amp; # 9 2 ; &amp; # 1 1 7 ; &amp; # 4 8 ; &amp; # 4 8 ; &amp; # 5 4 ; &amp; # 5 7 ; &amp; # 9 2 ; &amp; # 1 1 7 ; &amp; # 4 8 ; &amp; # 4 8 ; &amp; # 5 5 ; &amp; # 5 1 ; &amp; # 9 2 ; &amp; # 1 1 7 ; &amp; # 4 8 ; &amp; # 4 8 ; &amp; # 5 0 ; &amp; # 4 8 ; &amp; # 9 2 ; &amp; # 1 1 7 ; &amp; # 4 8 ; &amp; # 4 8 ; &amp; # 5 4 ; &amp; # 5 4 ; &amp; # 9 2 ; &amp; # 1 1 7 ; &amp; # 4 8 ; &amp; # 4 8 ; &amp; # 5 5 ; &amp; # 5 3 ; &amp; # 9 2 ; &amp; # 1 1 7 ; &amp; # 4 8 ; &amp; # 4 8 ; &amp; # 5 4 ; &amp; # 1 0 1 ; &amp; # 9 2 ; &amp; # 1 1 7 ; &amp; # 4 8 ; &amp; # 4 8 ; &amp; # 5 5 ; &amp; # 1 0 0 ;ä¸€å¼€å§‹æ‹¿å»Unicodeè§£ç æ²¡æœ‰ä»»ä½•ç»“æœï¼Œå¼„äº†åŠå¤©åæ‰åˆ æ‰äº†å­—ç¬¦é—´çš„ç©ºæ ¼â€¦â€¦æ•´ç†å¥½å¾—åˆ°è¿™æ ·ä¸€æ®µï¼š?#92;&#117;&#48;&#48;&#54;&#54;&#92;&#117;&#48;&#48;&#54;&#99;&#92;&#117;&amp;#4 8;&#48;&#54;&#49;&#92;&#117;&#48;&#48;&#54;&#55;&#92;&#117;&#48;&#48;&#55;&#98;&#92;&#117;&#48;&#48;&#54;&#57; &#92;&#117;&#48;&#48;&#55;&#51;&#92;&#117;&#48;&#48;&#54;&#51;&#92;&#117;&#48;&#48;&#54;&#51;&#92;&#117;&#48;&#48;&#50;&#48;&#92;&#117;&#48;&#48;&#54;&#57;&#92;&#117;&#48;&#48;&#55;&#51;&#92;&#117;&#48;&#48;&#50;&#48;&#92;&#117;&#48;&#48;&#54;&#54;&#92;&#117;&#48;&#48;&#55;&#53;&#92;&#117;&#48;&#48;&#54;&#101;&#92;&#117;&#48;&#48;&#55;&#100;å†è§£ç ï¼š 9.å‡¯æ’’åä¸‰ä¸–åœ¨å­¦ä¼šä½¿ç”¨é”®ç›˜åï¼Œå‘ä½ æ‰”äº†ä¸€ä¸²å­—ç¬¦ï¼šâ€œebdgc697g95w3â€ï¼ŒçŒœçŒœå®ƒå§ã€‚å‡¯æ’’å¯†ç ï¼Œåœ¨ç›¸å…³ç½‘ç«™è§£å‡ºäº†25ç»„ç»“æœï¼Œè¯•äº†å‰2ç»„åå‘ç°éƒ½æ˜¯é”™çš„ï¼Œç´¢æ€§ç›´æ¥ä¸€ç»„ä¸€ç»„æŒ‰åŠ å¯†æ¬¡æ•°è¿˜åŸï¼Œå‘ç°ç¬¬13æ¬¡è§£å¯†å¾—åˆ°çš„roqtp697t95j3åŠ å¯†13æ¬¡åæ­£å¥½æ˜¯ebdgc697g95w3ï¼ˆè¿™å¾ˆå‡¯æ’’åä¸‰ä¸–â€¦ï¼‰ã€‚å¡«å…¥æç¤ºä»ç„¶é”™è¯¯ã€‚æƒ³äº†å¾ˆä¹…ï¼Œä¹Ÿå°è¯•äº†12ï¼Œ14çš„ç»“æœæœŸé—´é”™äº†ä¸€ä¸‡æ¬¡ï¼Œåæ¥æ‰å‘ç°å¾—åˆ°çš„ç»“æœæœ¬èº«ä¹Ÿæ˜¯ä¸ªé”®ç›˜å¯†ç ï¼Œçå¼„äº†å¾ˆä¹…ï¼ŒæœŸé—´åˆé”™äº†ä¸€ä¸‡æ¬¡ï¼Œåˆ°æœ€åæ‰å¼„æ˜ç™½æ˜¯æ¯ä¸ªå•è¯å†å¯¹åº”å…¶åŸå§‹é”®ç›˜çš„ä¸‹ä¸€è¡Œå¼€å§‹æ…¢æ…¢å¾—åˆ°Flagyougotmeã€‚ä»¤äººæ™ºç†„ã€‚ 10.ä½›ç³»CTFâ€¦æ‰“å¼€é™„ä»¶ä¸‹è½½åå¾—åˆ°çš„é¡µé¢ï¼šæœ«å°¾ä¸¤ä¸ªâ€œ=â€æ‹¿å»Base64è§£ç ï¼Œåå¤è§£ç æœ€åè·å¾—ï¼šU2FsdGVkX183BPnBd50ynIRM3o8YLmwHaoi8b8QvfVdFHCEwG9iwp4hJHznrl7d4%0AB5rKClEyYVtx6uZFIKtCXo71fR9Mcf6b0EzejhZ4pnhnJOl+zrZVlV0T9NUA+u1z%0AiN+jkpb6ERH86j7t45v4Mpe+j1gCpvaQgoKC0Oaa5kc%3Däº†è§£åˆ°AESåŠ å¯†åè§£å¯†å¾—åˆ°æ–‡å­—ï¼šå¾ˆæ‡µé€¼ï¼Œæˆ‘ä½›æ…ˆæ‚²ï¼Œåœ¨è§£å¯†ç½‘ç«™é›†é”¦Ctrl+Fè¾“å…¥â€œä½›â€åå±…ç„¶è¿˜çœŸçš„æœ‰ç§ä¸ä½›è®ºç¦…åŠ å¯†ã€‚ä¾ç…§æç¤ºåŠ ä¸Šä½›æ›°ä¹‹åå¾—åˆ°äº†Flagï¼š","categories":[{"name":"ä¿¡æ¯å®‰å…¨","slug":"ä¿¡æ¯å®‰å…¨","permalink":"http://yoursite.com/categories/ä¿¡æ¯å®‰å…¨/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"http://yoursite.com/tags/ctf/"}]},{"title":"å…³äºQQå¦ç™½è¯´JSONæºç ´è§£å¯¹æ–¹èº«ä»½çš„æ–¹æ³•","slug":"å…³äºQQå¦ç™½è¯´JSONæºç ´è§£å¯¹æ–¹èº«ä»½çš„æ–¹æ³•","date":"2018-04-03T05:06:04.000Z","updated":"2022-06-27T07:40:45.713Z","comments":true,"path":"2018/04/03/å…³äºQQå¦ç™½è¯´JSONæºç ´è§£å¯¹æ–¹èº«ä»½çš„æ–¹æ³•/","link":"","permalink":"http://yoursite.com/2018/04/03/å…³äºQQå¦ç™½è¯´JSONæºç ´è§£å¯¹æ–¹èº«ä»½çš„æ–¹æ³•/","excerpt":"","text":"è¿™ä¸ªé—®é¢˜åœ¨4æœˆ2æ—¥æ™šä¸Šä¸ƒç‚¹å·¦å³å·²ç»è¢«ä¿®å¤ï¼Œå­˜åœ¨æ—¶é—´ä¸é•¿ã€‚éšç€è¢«ä¿®å¤çš„é—®é¢˜è¿˜æœ‰å¾ˆå¤šï¼Œå¢¨æ°´ä¸å¤šï¼Œè¿™é‡Œä¸å¤šè¯´ã€‚é¦–å…ˆé€šè¿‡https://ti.qq.com/cgi-node/honest-say/receive/mine ï¼Œå¯ä»¥æ‰“å¼€è‡ªå·±çš„å¦ç™½è¯´JSONæºï¼Œç„¶åå‘ç°EncodeUinåçš„åŠ å¯†ä»£ç ï¼Œå¦‚å›¾ï¼šæœ‰å¤§ä½¬ç ´è§£å‡ºäº†ï¼šå¯¹ç…§è§£ç åä¾¿å¯ä»¥å¾—åˆ°å‘é€è€…çš„QQå·ç â€¦â€¦æ© ï¼Œå¾ˆå¯æ€•ã€‚å½“ç„¶é—®é¢˜å¾ˆä¸¥é‡ï¼Œä¿®å¤ä¹Ÿå¾ˆå¿«ï¼Œç°åœ¨åªèƒ½è¢«å¼€å‘è€…è°ƒä¾ƒã€‚æ€ä¹ˆè¯´å‘¢ï¼Œå°±å½“æ„šäººèŠ‚èœå•å§ï¼Œåœ¨åŒ¿åçš„ä¸–ç•Œé‡Œçš®ä¸€ä¸‹ä¹Ÿå¾—é€‚å½“ä¸€äº›233ã€‚","categories":[{"name":"ä¿¡æ¯å®‰å…¨","slug":"ä¿¡æ¯å®‰å…¨","permalink":"http://yoursite.com/categories/ä¿¡æ¯å®‰å…¨/"}],"tags":[{"name":"QQå¦ç™½è¯´","slug":"QQå¦ç™½è¯´","permalink":"http://yoursite.com/tags/QQå¦ç™½è¯´/"}]},{"title":"CTF-Tests(3)","slug":"CTF-Tests-3","date":"2018-03-31T13:02:45.000Z","updated":"2022-06-27T07:27:23.769Z","comments":true,"path":"2018/03/31/CTF-Tests-3/","link":"","permalink":"http://yoursite.com/2018/03/31/CTF-Tests-3/","excerpt":"1.2018å¹´0ctfç­¾åˆ°é¢˜æ ¹æ®æç¤ºè¦æ±‚åŠ å…¥freenodeç½‘ç«™çš„IRC(Internet Relay Chat)0ctf2018èŠå¤©å®¤æ¥è·å–flagã€‚åˆæ¬¡è¿›å…¥chat.freenode.netï¼Œç½‘é¡µæ²¡æœ‰ååº”ï¼Œæ¨æµ‹ç«¯å£é—®é¢˜æˆ–è€…æ˜¯ç½‘ç»œèŠ‚ç‚¹é—®é¢˜ã€‚ä¹‹åæˆ‘åœ¨è¿›å…¥freenode.netåï¼ŒæŒ‰ç…§è¯´æ˜ä½¿ç”¨äº†6667~6669çš„ç«¯å£ï¼Œå‡ä¸èƒ½æˆåŠŸï¼Œäºæ˜¯æ‰“å¼€æ‰‹æœºVPNï¼Œç­‰å¾…ä¹‹åæˆåŠŸè¿›å…¥èŠå¤©é¡µé¢ï¼Œè¾“å…¥ç»™å®šçš„#0ctf2018è¿›å…¥èŠå¤©å®¤ï¼Œå¾—åˆ°flagã€‚","text":"1.2018å¹´0ctfç­¾åˆ°é¢˜æ ¹æ®æç¤ºè¦æ±‚åŠ å…¥freenodeç½‘ç«™çš„IRC(Internet Relay Chat)0ctf2018èŠå¤©å®¤æ¥è·å–flagã€‚åˆæ¬¡è¿›å…¥chat.freenode.netï¼Œç½‘é¡µæ²¡æœ‰ååº”ï¼Œæ¨æµ‹ç«¯å£é—®é¢˜æˆ–è€…æ˜¯ç½‘ç»œèŠ‚ç‚¹é—®é¢˜ã€‚ä¹‹åæˆ‘åœ¨è¿›å…¥freenode.netåï¼ŒæŒ‰ç…§è¯´æ˜ä½¿ç”¨äº†6667~6669çš„ç«¯å£ï¼Œå‡ä¸èƒ½æˆåŠŸï¼Œäºæ˜¯æ‰“å¼€æ‰‹æœºVPNï¼Œç­‰å¾…ä¹‹åæˆåŠŸè¿›å…¥èŠå¤©é¡µé¢ï¼Œè¾“å…¥ç»™å®šçš„#0ctf2018è¿›å…¥èŠå¤©å®¤ï¼Œå¾—åˆ°flagã€‚ 2.è¿›å…¥åå°è¯•adminç™»é™†ï¼Œç”¨BPå­—å…¸Passworldçˆ†ç ´å¯†ç ï¼Œç»“æœé•¿åº¦å‡ä¸€è‡´ï¼Œè½¬ç”¨æ³¨å†ŒåŠŸèƒ½æ³¨å†Œadminï¼Œæç¤ºå·²ç»è¢«æ³¨å†Œï¼Œæ‰€ä»¥è¿˜æ˜¯è¦ç”¨adminç™»é™†æ¥è·å¾—flagã€‚æ ¹æ®æç¤ºåˆ›å»ºadmin,åœ¨å…¶åå¢åŠ è‹¥å¹²ç©ºæ ¼åè¿›å…¥ï¼Œå¾—åˆ°flagã€‚ 3.è¦æ±‚2ç§’å†…è¿›è¡Œè®¡ç®—ã€‚ç”¨PYè„šæœ¬ï¼šimport requestsimport reurl = â€˜http://120.24.86.145:8002/qiumingshan/&#39;s = requests.Session()source = s.get(url)expression = re.search(râ€™(\\d+[+-*])+(\\d+)â€™, source.text).group()result = eval(expression)post = {â€˜valueâ€™: result}print(s.post(url, data = post).text)è¿è¡Œåå¯å¾—åˆ°flagã€‚ 4.ç”¨BPæŠ“åŒ…åå¾—åˆ°flagçš„ä¿¡æ¯ï¼Œä»æœ«å°¾çš„â€œ=â€å¾—çŸ¥åº”è¯¥æ˜¯ä¸€ä¸ªbase64ç¼–ç ï¼Œè§£ç åå¾—åˆ°çš„ç»“æœç»§ç»­è§£ç ç”¨Pyè„šæœ¬è§£å‡ºflagã€‚import requests import base64url =â€™http://120.24.86.145:8002/web6/&#39;r =requests.session()headers = r.get(url).headerskey = base64.b64decode(base64.b64decode(headers[â€˜flagâ€™]).split(â€˜:â€™)[1])data={â€˜marginâ€™:key}print r.post(url=url,data=data).content 5.CTFæ•…äº‹æ±‡â€¦â€¦BPæŠ“åŒ…åå‘ç°æ–‡æœ¬ä¸­çš„é“¾æ¥æ˜¯ä¸ªçœŸçš„é“¾æ¥ï¼Œæ‰“å¼€åå‘ç°æ˜¯phpä¸­md5()å‡½æ•°æ¼æ´å’Œstrcmp()å‡½æ•°æ¼æ´çš„åˆ©ç”¨ï¼ŒMD5ä¸èƒ½å¤„ç†æ•°ç»„ï¼Œæœ‰æ—¶ä¹Ÿå¯ä»¥ç”¨æ•°ç»„ç»•è¿‡ã€‚åŒæ—¶strcmpï¼ˆï¼‰å‡½æ•°ä¹Ÿå¯ç”¨æ•°ç»„ç»•è¿‡ï¼Œæ„é€ payloadï¼Œè¿›å…¥http://47.93.190.246:49162/?v1[]=1&amp;v2[]=2&amp;v3[]=1 ï¼Œå‡ºç°flagã€‚","categories":[{"name":"ä¿¡æ¯å®‰å…¨","slug":"ä¿¡æ¯å®‰å…¨","permalink":"http://yoursite.com/categories/ä¿¡æ¯å®‰å…¨/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"http://yoursite.com/tags/ctf/"}]},{"title":"ä¸€äº›å¯†ç å­¦è§£å¯†ç½‘ç«™","slug":"ä¸€äº›å¯†ç å­¦è§£å¯†ç½‘ç«™","date":"2018-03-29T14:53:00.000Z","updated":"2022-06-27T07:43:01.465Z","comments":true,"path":"2018/03/29/ä¸€äº›å¯†ç å­¦è§£å¯†ç½‘ç«™/","link":"","permalink":"http://yoursite.com/2018/03/29/ä¸€äº›å¯†ç å­¦è§£å¯†ç½‘ç«™/","excerpt":"","text":"èµ„æ–™æ¥æºç½‘ç»œï¼ŒæŒç»­æ›´æ–°ã€‚URL[http://tool.chinaz.com/tools/urlencode.aspx]; JSFuck[http://discogscounter.getfreehosting.co.uk/js-noalnum.php?i=1]; Base64[http://www1.tc711.com/tool/BASE64.htm]; Base64(img)[http://www.vgot.net/test/image2base64.php]; Base32[https://tools.deamwork.com/crypt/decrypt/base32decode.html]; String[http://www.5ixuexiwang.com/str/];","categories":[{"name":"ä¿¡æ¯å®‰å…¨","slug":"ä¿¡æ¯å®‰å…¨","permalink":"http://yoursite.com/categories/ä¿¡æ¯å®‰å…¨/"}],"tags":[{"name":"å·¥å…·ç«™","slug":"å·¥å…·ç«™","permalink":"http://yoursite.com/tags/å·¥å…·ç«™/"}]},{"title":"CTF-Tests(2)","slug":"CTF-Tests-2","date":"2018-03-29T13:34:58.000Z","updated":"2022-06-27T07:27:07.978Z","comments":true,"path":"2018/03/29/CTF-Tests-2/","link":"","permalink":"http://yoursite.com/2018/03/29/CTF-Tests-2/","excerpt":"","text":"ä»ç„¶æ˜¯5é“æ™®é€šçš„CTFã€‚ 1.é¡µé¢ä¼šä¸æ–­å¼¹å‡ºâ€FLAGå°±åœ¨è¿™é‡Œâ€ã€â€æ¥æ‰¾æ‰¾å§â€è¿™æ ·çš„ä¿¡æ¯ã€‚åœ¨å¼ºè¡Œå…³é—­å¼¹çª—åï¼Œå®¡æŸ¥å…ƒç´ ï¼Œå¾—åˆ°å¦‚ä¸‹çš„ç¼–ç ï¼Œå¼„æ¸…ååœ¨ç½‘ç«™[http://tool.chinaz.com/tools/urlencode.aspx] Unicodeè§£ç å¾—åˆ°FLAGã€‚ 2.æ ¹æ®æç¤ºæ‰“å¼€æºä»£ç ï¼Œæ‰¾åˆ°ä¹‹ååŒæ ·æŒ‰ç…§æç¤ºè¿›è¡Œè§£ç åä¾¿å¾—åˆ°FLAGã€‚ 3.äº†è§£åˆ°åŒæ ·æ˜¯ä¸€ä¸ªç¼–ç åï¼Œæ ¹æ®æç¤ºJSFuck(å‘ƒâ€¦)è§£ç ï¼Œä¼šå¾—åˆ°FLAGã€‚ 4.é¢˜ç›®å«å¤´ç­‰èˆ±ï¼Œè€Œæ‰“å¼€åæç¤ºä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œå®¡æŸ¥å…ƒç´ ä»¥åŠæŸ¥çœ‹æºåæ— æœï¼Œç”¨BurpsuiteæŠ“åŒ…ï¼Œå¾—åˆ°Flagã€‚ 5.åªæœ‰è¿™äº›å†…å®¹ï¼Œå°è¯•ä»è¯­æ³•å…¥æ‰‹åæ·»åŠ é“¾æ¥ï¼Œå›è½¦åä¼šå¾—åˆ°FLAGã€‚","categories":[{"name":"ä¿¡æ¯å®‰å…¨","slug":"ä¿¡æ¯å®‰å…¨","permalink":"http://yoursite.com/categories/ä¿¡æ¯å®‰å…¨/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"http://yoursite.com/tags/ctf/"}]},{"title":"CTF-Tests","slug":"CTF-Tests","date":"2018-03-22T12:30:54.000Z","updated":"2022-06-27T07:26:50.323Z","comments":true,"path":"2018/03/22/CTF-Tests/","link":"","permalink":"http://yoursite.com/2018/03/22/CTF-Tests/","excerpt":"","text":"Burpsuiteã€IDAã€ODç­‰å·¥å…·å®‰è£…å®Œæˆåï¼Œæˆ‘å¼€å§‹å°è¯•åœ¨ç™¾åº¦ç­‰æ•™ç¨‹ä¸‹å»åšç®€å•çš„CTFã€‚è¿™é‡Œæ˜¯5ä¸ªç®€å•çš„ä¾‹å­ã€‚ 1.ç¬¬ä¸€ä¸ªæ˜¯å«helloçš„ç¨‹åºï¼Œä½¿ç”¨ODæ‰“å¼€åï¼Œåˆ©ç”¨æœç´¢åŠŸèƒ½æŸ¥æ‰¾å­—ç¬¦ä¸²ï¼Œç›´æ¥å¾—åˆ°äº†keyï¼šWelcomeToKanXueCtf2017ï¼Œè¾“å…¥ï¼Œå®Œæˆã€‚ 2.è¿™æ˜¯ä¸€ä¸ªå…³äºç½‘é¡µéªŒè¯ç çš„é—®é¢˜ï¼Œå¾ˆç®€å•çš„ä¸¤ä½æ•°ç›¸åŠ æ±‚å’Œï¼Œä½†å°è¯•è¾“å…¥æ—¶å‘ç°äº†é—®é¢˜æ‰€åœ¨ï¼šåªèƒ½è¾“å…¥ä¸€ä¸ªå­—ç¬¦ã€‚F12å¼€å¯å®¡æŸ¥å…ƒç´ ï¼Œæ‰¾åˆ°maxlength=â€1â€ï¼Œå¾ˆæ˜æ˜¾é—®é¢˜å‡ºåœ¨è¿™é‡Œï¼Œåœ¨1åé¢åŠ ä¸Šä¸¤ä¸ª0ä¹‹åï¼Œè¾“å…¥ç»“æœï¼Œå¾—åˆ°Flagã€‚ 3.å®½å¸¦ä¿¡æ¯æ³„éœ²ï¼Œå¥½å‰å®³çš„æ ·å­ï¼Œä¸‹ä¸€ä¸ªâ€¦Ummmmmï¼Œæ‰¾åˆ°.binçš„æ–‡ä»¶ï¼Œç”¨RouterPassViewå·¥å…·æ‰“å¼€å®ƒï¼Œç„¶åå¾—åˆ°usernameï¼Œä¹Ÿå°±æ˜¯æç¤ºçš„Flagï¼Œè¾“å…¥é€šè¿‡ã€‚ 4.å®¡é¢˜åå­—å«åšåœä¸ä¸‹æ¥â€¦æ©ç¡®å®åœä¸ä¸‹æ¥ï¼Œé¡µé¢ä¸æ–­è‡ªåŠ¨æœ‰è§„å¾‹çš„åˆ·æ–°ï¼Œåˆ·å‡ºä¸åŒçš„ç»“æœï¼Œæ‰“å¼€Burpsuiteï¼Œæ”¾è¿›Repeaterä¹‹åå¼€å§‹æŒ‰ç…§é¢˜ç›®åˆ·æ–°çš„è§„å¾‹å¤šæ¬¡å‘é€è®¿é—®åŒ…ï¼Œå¾—åˆ°äº†Flagã€‚ 5.è¦æ±‚æäº¤ä¸€ä¸ª.phpæ–‡ä»¶ï¼Œæˆ‘åœ¨Wampé‡Œæ‹¿å‡ºä¹‹å‰çš„HelloWorldï¼Œæäº¤è¿›å»ä¹‹åæç¤ºä¸æ˜¯å›¾ç‰‡æ–‡ä»¶ï¼Œemmmmï¼Œå°†åç¼€æ”¹ä¸º.pngï¼Œå†æ¬¡æäº¤æ—¶ä¸¢è¿›BurpSuiteï¼Œåœ¨å…¶ä¸­å†å°†.pngæ”¹ä½œ.phpåï¼Œä¸Šä¼ è‡³Repeaterå¾—åˆ°Flagã€‚psï¼Œå®é™…ä¸Šå°è¯•å»è§£è¿™äº›CTFæ—¶ï¼ŒåŸºæœ¬æ¯ä¸€é“é¢˜éƒ½ä¼šåœ¨å®¡æŸ¥å…ƒç´ é‡Œæ— è·åï¼Œå°è¯•å„ç§å·¥å…·ï¼Œé‡åˆ°å„ç§éšœç¢ä»¥åŠçœ‹ä¸æ‡‚çš„æƒ…å†µï¼Œæ‡µé€¼è‰¯ä¹…ã€‚ä¹Ÿæœ‰å¾ˆå¤šé¢˜ç›®å®Œæˆä¸€éƒ¨åˆ†åå¼€å§‹ä¸€çŸ¥åŠè§£ï¼Œå§‹ç»ˆå¾—ä¸åˆ°Flagï¼Œæƒ³è§£å‡ºæŸäº›å¯†ç ï¼Œåœ¨å®¡æŸ¥å…ƒç´ ä¸­æ‰¾åˆ°ä¸€äº›çº¿ç´¢åå´ä¸èƒ½å¼€å±•ä¸‹å»ã€‚æ—¶é—´å¾ˆçŸ­ï¼Œè·¯è¿˜å¾ˆé•¿ã€‚","categories":[{"name":"ä¿¡æ¯å®‰å…¨","slug":"ä¿¡æ¯å®‰å…¨","permalink":"http://yoursite.com/categories/ä¿¡æ¯å®‰å…¨/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"http://yoursite.com/tags/ctf/"}]},{"title":"BurpSuite","slug":"BurpSuite","date":"2018-03-22T12:25:03.000Z","updated":"2022-06-27T07:26:31.089Z","comments":true,"path":"2018/03/22/BurpSuite/","link":"","permalink":"http://yoursite.com/2018/03/22/BurpSuite/","excerpt":"","text":"æœ€è¿‘å¼€å§‹å¼„CTFã€‚å­¦ä¹ ä¿¡æ¯å®‰å…¨ï¼Œè‡ªæˆ‘æ„è¯†åˆ°ä»…ä»…åªé phpè¿™äº›è¯­è¨€å’Œç¼–è¯‘å™¨æ˜¯è¿œè¿œä¸è¶³çš„ï¼Œå„å¼å„æ ·çš„å·¥å…·åŒæ ·å‘æŒ¥ç€éå¸¸é‡è¦çš„ä½œç”¨ã€‚ä¹‹å‰å°±å¬è¯´è¿‡æ‰“å—ï¼Œä½†æ˜¯å®è£…BurpSuiteåˆ™æ˜¯ä¸ä¹…å‰å†åº¦è¢«å®‰åˆ©æ‰è¿›è¡Œï¼Œè¿‡ç¨‹ä»ç„¶ä¸€æ³¢ä¸‰æŠ˜ã€‚æˆ‘å‘ç°å¾ˆå¤šæ‰€è°“çš„æ•™ç¨‹æ›´å¤šå®Œå…¨åªæ˜¯æä¾›äº†å®Œæ•´çš„å…·ä½“æ€è·¯ï¼Œå®Œå…¨æ²¡æœ‰è€ƒè™‘è¿‡çœŸæ­£åˆæ¬¡æ¥è§¦è€…çš„æ„Ÿå—ï¼Œå¾ˆå¤šç»†èŠ‚æ˜¯éå¸¸ä»¤äººå¤´ç—›çš„ï¼Œæˆ‘è§‰å¾—æ¢ç´¢æ›´å¤šåº”è¯¥æ”¾åœ¨å®è·µä¹‹ä¸­ï¼Œè€Œä¸æ˜¯åœ¨åˆå­¦ä¹‹ä¸­ã€‚BurpSuiteæ˜¯ä¸€æ¬¾åŸºäºJavaç¯å¢ƒä¸‹çš„Javaç¨‹åºï¼Œé‚£ä¹ˆåœ¨å®‰è£…Burpä¹‹å‰éœ€è¦å…ˆé…ç½®Javaç¯å¢ƒï¼Œæ­£å·§æˆ‘è¿˜æ²¡æœ‰æ¥è§¦è¿‡Javaï¼Œæ‰€ä»¥å…ˆæ­è½½äº†jdkï¼Œå®‰è£…å®Œæ¯•ï¼Œä¹‹åä¸‹è½½äº†52ç ´è§£å¹³å°çš„Burpä¸“ä¸šç‰ˆï¼ˆä¹‹å‰åœ¨å®˜ç½‘è¿˜ä¸‹è½½è¿‡ç›´è£…æ™®é€šç‰ˆï¼Œä¸“ä¸šç‰ˆèŠ±è´¹æœ‰äº›é«˜ï¼‰ï¼Œä¹ æƒ¯æ€§è§£å‹ï¼Œå¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶å¤¹ã€‚ç„¶åæ™•äº†ï¼Œæ©ï¼ŸBurpæ€ä¹ˆæ‰“å¼€ï¼Ÿè™½ç„¶æ²¡æœ‰åº”ç”¨ç¨‹åºï¼Œä½†ä¹Ÿåº”è¯¥æœ‰å¯æ‰§è¡Œçš„éƒ¨åˆ†ï¼Œå°†æ–‡ä»¶å¤¹é€ä¸ªæ‰“å¼€åæ˜¯è®¸è®¸å¤šå¤š.Classæ–‡ä»¶ã€‚åˆæ­¥æ¨æµ‹Javaç¯å¢ƒæœªèƒ½æ­å»ºæˆåŠŸï¼ŒWin+Rï¼Œå¼€å¯CMDï¼Œè¾“å…¥Java -versionï¼Œç»“æœç¡®å®æ˜¯æç¤ºâ€™Javaä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åºæˆ–æ‰¹å¤„ç†æ–‡ä»¶â€™ï¼Œå› ä¸ºä¹‹å‰è£…nodejsæ—¶å‡ºè¿‡ç±»ä¼¼é—®é¢˜ï¼Œç¬¬ä¸€æ—¶é—´æƒ³åˆ°çš„æ˜¯ç‰ˆæœ¬ä¸ç¬¦ï¼Œäºæ˜¯æˆ‘å»Javaå®˜ç½‘å°†Jdkæœ€æ–°ç‰ˆæœ¬ã€8u161ã€8u162éƒ½å°è¯•å®‰è£…ï¼ŒæœŸé—´ä¹Ÿå°è¯•äº†Burpçš„å„ä¸ªç‰ˆæœ¬ï¼Œä¹‹ååœ¨52ç¡®å®šäº†Burp1.7å’Œjdk161å®Œå…¨æ²¡æœ‰é—®é¢˜ï¼Œå¼€å§‹åœ¨å…¶ä»–æ–¹é¢æŸ¥æ‰¾é—®é¢˜ã€‚è¯¢é—®å¤§ä½¬ä¹‹åæ‰æ„è¯†åˆ°jdkçš„å®‰è£…æ˜¯æœ‰é—¨é“çš„ï¼Œäºæ˜¯æˆ‘å¼€å§‹æŸ¥æ‰¾æ•™ç¨‹ä¸€æ­¥æ­¥å®‰è£…jdkï¼Œå‘ç°ä¸€ç›´é—æ¼äº†å…³é”®çš„æ­¥éª¤ï¼Œå°±æ˜¯åœ¨æœ€åæ‰‹åŠ¨é…ç½®Javaç¯å¢ƒå˜é‡ï¼ˆè¿™ç©æ„è¿˜çœŸä¸æ˜¯å®‰è£…åŒ…ä¸€æ­¥åˆ°ä½çš„â€¦â€¦ï¼‰ä¸€ç•ªå¤„ç†åï¼Œæ‰“å¼€CMDï¼ŒJavaå®‰è£…æˆåŠŸã€‚æ¥ä¸‹æ¥æˆ‘é‡æ–°è§£å‹äº†Burpï¼Œå°´å°¬çš„æ˜¯ä»ç„¶æ˜¯ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œæ‘†åœ¨æˆ‘çš„é¢å‰ã€‚ä¸€ç•ªå°è¯•æ— æœï¼Œå›å½’æ‡µé€¼çŠ¶æ€ã€‚åˆæ˜¯ä¸€ç•ªæœç´¢ä¹‹åï¼Œæ— æ„ä¸­äº†è§£åˆ°.jarä¸.zipæ–‡ä»¶ä¹‹é—´çš„å­½ç¼˜ï¼ŒåŸæ¥é‚£ä¸¤ä¸ªâ€œå‹ç¼©åŒ…â€å¯ä»¥ç›´æ¥æ‰“å¼€è¿è¡Œâ€¦â€¦å®‰è£…ç®—æ˜¯æˆåŠŸäº†ï¼ŒæŒ‰ç…§52çš„æ•™ç¨‹ä¸€æ­¥æ­¥é¡ºåˆ©çš„æ‰“å¼€äº†BurpSuiteã€‚è€Œé…ç½®å®Œæˆåï¼Œè¿™ä¸¤å¤©å¼€å§‹å®è·µCTFæ—¶åœ¨Burpä¸­å†ä¸€æ¬¡é‡åˆ°äº†ç“¶é¢ˆï¼Œæ— è®ºå¦‚ä½•åˆ·æ–°ç½‘é¡µï¼ŒBurpéƒ½ä¸ä¼šè‡ªå·±æŠ“åŒ…ï¼Œä¹Ÿæ˜¯ï¼Œè™½ç„¶æˆ‘è®¾ç½®äº†Burpçš„ç«¯å£127.0.0.1ï¼š8082ï¼Œä½†æ˜¯å’ŒæœåŠ¡å™¨çš„é“¾æ¥åº”è¯¥è¿˜æ˜¯æœ‰å¾…åè°ƒï¼Œæœ€ååœ¨å±€åŸŸé‡Œæ·»åŠ è¿›å‡†å¤‡å¥½ç«¯å£ï¼Œå¹¶åœ¨Firefoxé‡Œè®¾ç½®å¥½ä»£ç†ï¼Œç»ˆäºï¼ŒBurpSuiteå¼€å§‹åœ¨æµè§ˆå™¨çš„åˆ·æ–°ä¸‹è‡ªåŠ¨æŠ“åŒ…ã€‚åˆ°è¿™é‡Œå·®ä¸å¤šå…¨éƒ¨å®Œæˆäº†ã€‚å¤§ä½“è€Œè¨€å°±æ˜¯è¿™æ ·ï¼Œè¿‡ç¨‹æ‹–æ³¥å¸¦æ°´ï¼Œä¸è¿‡ç»“æœè¿˜ç®—è¿‘äººæ„ã€‚ä¸‹ä¸€æ¬¡å®‰è£…å·¥å…·æ—¶å¸Œæœ›èƒ½ç¨å¾®é¡ºåˆ©ä¸€äº›ã€‚å¯èƒ½æˆ‘ç¢°ä¸Šçš„ç»†èŠ‚é—®é¢˜ä¹Ÿä¼šæ˜¯å¾ˆå¤šäººç¬¬ä¸€æ¬¡å¤„ç†çš„éº»çƒ¦æ‰€åœ¨ï¼Œè™½ç„¶è®¨åŒï¼Œä½†åªè¦æ­¥éª¤æ­£ç¡®ï¼Œç»ˆç©¶èƒ½å¤Ÿå®Œæˆï¼Œè¿™æˆ–è®¸æ˜¯è®¡ç®—æœºçš„é­…åŠ›æ‰€åœ¨ã€‚@elbadaernU 2018.3.22","categories":[{"name":"ä¿¡æ¯å®‰å…¨","slug":"ä¿¡æ¯å®‰å…¨","permalink":"http://yoursite.com/categories/ä¿¡æ¯å®‰å…¨/"}],"tags":[{"name":"BurpSuite","slug":"BurpSuite","permalink":"http://yoursite.com/tags/BurpSuite/"}]},{"title":"Update-log","slug":"Update-log","date":"2018-03-05T09:33:54.000Z","updated":"2022-06-22T03:02:18.064Z","comments":true,"path":"2018/03/05/Update-log/","link":"","permalink":"http://yoursite.com/2018/03/05/Update-log/","excerpt":"","text":"2018.3.5 æ›´æ–°æ—¥å¿—ï¼š11.æ›¿æ¢ç¬¬äºŒå¼ é¦–é¡µå¹»ç¯ç‰‡ï¼› 12.éŸ³ä¹æ›´æ”¹ä¸ºæ‰‹åŠ¨æ’­æ”¾ï¼› 13.æ ‡é¢˜é¢œè‰²ç”±éšæœºä¿®æ”¹ä¸ºè“è‰²ï¼› 14.åˆ é™¤â€œæ‰“èµâ€åŠŸèƒ½ï¼› 1Psï¼šåˆšåˆšè¿‡å®Œå¹´ï¼Œæœ€è¿‘å¤ä¹ Cå’Œå­¦ä¹ Pythonï¼Œè®¡åˆ’ä¹‹åå®Œæˆé¡µé¢æ‰©å±•ã€å¢åŠ éŸ³ä¹å’Œè§†é¢‘å†…å®¹ç­‰æ›´æ–°.","categories":[],"tags":[]},{"title":"æˆ‘çš„ç¬¬ä¸€ä¸ªPHPå®ä¾‹","slug":"æˆ‘çš„ç¬¬ä¸€ä¸ªPHPå®ä¾‹","date":"2018-02-03T09:51:38.000Z","updated":"2022-06-27T07:42:01.072Z","comments":true,"path":"2018/02/03/æˆ‘çš„ç¬¬ä¸€ä¸ªPHPå®ä¾‹/","link":"","permalink":"http://yoursite.com/2018/02/03/æˆ‘çš„ç¬¬ä¸€ä¸ªPHPå®ä¾‹/","excerpt":"","text":"å¼€å§‹æˆ‘æ˜¯æœ¬å‘¨ï¼Œ18å¹´1æœˆæœ«åˆ°18å¹´2æœˆåˆå¼€å§‹å…¥é—¨å­¦ä¹ PHPã€‚åŸæœ¬è®¡åˆ’å…ˆä»Pythonå¼€å§‹å…¥æ‰‹å­¦ä¹ ï¼Œä½†æ˜¯ç½‘ä¸Šé¢„å®šçš„ç›¸å…³ä¹¦ç±å‘è´§æ—¥æœŸè¾ƒè¿Ÿï¼Œåˆå®åœ¨ä¸å–œæ¬¢ç”µå­ä¹¦çš„é˜…è§ˆæ–¹å¼ï¼Œèº«è¾¹æ­£å¥½æœ‰PHPçš„å·¥å…·ä¹¦ï¼Œç´¢æ€§å¼€å§‹å°è¯•ã€‚ é¦–å…ˆä½œä¸ºç¬¬ä¸€æ­¥å½“ç„¶æ˜¯é…ç½®ç›¸å…³è½¯ä»¶ï¼ŒPHPç›¸å…³çš„ç¼–è¯‘å·¥å…·æœ‰Dreamweaverã€ZendStudioã€PhpStormã€Notepad++ã€EditPlusç­‰å¤šç§ã€‚æˆ‘çš„ç³»ç»Ÿä¸ºWin10ï¼ŒäºWindowsç¯å¢ƒä¸‹é¦–å…ˆå®‰è£…äº†Adobeçš„Dreamweaver CCã€‚ ç›¸å…³ç¼–è¯‘å™¨å¸ƒç½®å®Œæˆåï¼Œæˆ‘å¼€å§‹åœ¨Windowsç¯å¢ƒä¸‹é…ç½®WampServerã€‚ ä¸€ç‚¹é—®é¢˜Wampè¿è¡Œå¤±è´¥çš„ç¬¬ä¸€æ¬¡å°è¯•è§£å†³ç›¸å…³å®‰è£…å®Œæˆåï¼Œæ‰“å¼€Wampï¼Œå›¾æ ‡æ˜¾ç¤ºæ©™è‰²ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨æ²¡æœ‰åœ¨æ„ã€‚æˆ‘å°†æµè§ˆå™¨æ‰“å¼€è¾“å…¥äº†localhostï¼Œç»“æœæ˜¯æ— æ³•è®¿é—®ã€‚å·¥å…·ä¹¦å¹¶æ²¡æœ‰ç»™å‡ºç›¸å…³è§£é‡Šï¼Œäºæ˜¯æˆ‘é¦–å…ˆçŒœæƒ³è¿™ä¸ªlocalhostçš„é»˜è®¤ç«¯å£å¯èƒ½ä¸æŸä¸ªè½¯ä»¶çš„ç«¯å£å‘ç”Ÿäº†å†²çªã€‚ç™¾åº¦ä¹‹åæ‰¾åˆ°äº†httpd.confå’Œwampmanagerä¸¤ä¸ªæ–‡ä»¶ï¼Œå°†é»˜è®¤ç«¯å£80ä¿®æ”¹ä¸º82ã€‚ä½†ç»“æœä»æ—§æ˜¯æ— æ³•æ‰“å¼€localhostã€‚ Wampè¿è¡Œå¤±è´¥çš„ç¬¬äºŒæ¬¡å°è¯•è§£å†³äºæ˜¯æˆ‘æ€€ç–‘è¿™äº›å¸¸è§„ç«¯å£å¯èƒ½éƒ½è¢«å ç”¨äº†ã€‚æœç´¢åˆ°äº†ä¸€ååšä¸»çš„ç±»ä¼¼è§£å†³æ–¹æ¡ˆï¼Œä»–å°†ç«¯å£ä¿®æ”¹ä¸ºAllow from allï¼Œè§£å†³äº†é—®é¢˜ï¼Œäºæ˜¯æˆ‘æŒ‰ç…§ä»–çš„ä¿®æ”¹æ‰“å¼€äº†.confæ–‡ä»¶ï¼ŒCtrl+få´æœç´¢ä¸åˆ°ä»–çš„æ–‡ä»¶å†…å®¹ã€‚ç»è¿‡å¯¹æ¯”åæˆ‘å‘ç°å¯èƒ½æ˜¯åŸºäºè½¯ä»¶ç‰ˆæœ¬çš„ä¸åŒæ–‡ä»¶å†…å®¹å·²è¢«ä¿®æ”¹è¿‡ã€‚æˆ‘æ‰‹åŠ¨è¡¥å…¨ä»–çš„æ–‡ä»¶å†æ‰“å¼€Wampï¼Œä»ç„¶æ˜¯æ©™è‰²ã€‚ Wampè¿è¡Œå¤±è´¥çš„ç¬¬ä¸‰æ¬¡å°è¯•è§£å†³æˆ‘å¼€å§‹ç¡®ä¿¡ä¸æ˜¯å¤§å¤šæ•°äººâ€œç«¯å£è¢«å ç”¨â€çš„é—®é¢˜ã€‚ç™¾åº¦åˆ°æ§åˆ¶å°æŒ‡ä»¤netstat -anoåæˆ‘æŸ¥çœ‹äº†æ¯ä¸ªè¢«åº”ç”¨çš„ç«¯å£ï¼Œ80å¹¶æ²¡æœ‰è¢«å ç”¨ï¼Œå¼€å§‹å°è¯•åœ¨å…¶ä»–è§’åº¦è§£å†³é—®é¢˜ã€‚è¿™æ—¶æˆ‘å‘ç°äº†Wampçš„æç¤ºï¼šæœåŠ¡å™¨ç¦»çº¿ï¼Œ2/3ä¸ªè¿›ç¨‹å†è¿è¡Œã€‚äºæ˜¯æˆ‘çŒœæƒ³ä¼šä¸ä¼šWampåœ¨å®‰è£…æ—¶å‘ç”Ÿé”™è¯¯ï¼Œæœ‰éƒ¨åˆ†æœªè¢«å®‰è£…ä¸Šã€‚äºæ˜¯åœ¨å¸è½½Wampä¹‹åæˆ‘é‡æ–°å®‰è£…äº†ä¸€æ¬¡ï¼Œç»“æœä»ç„¶æ˜¯æ©™è‰²ï¼ŒæœåŠ¡å™¨ç¦»çº¿ï¼Œ2/3ä¸ªæœåŠ¡åœ¨è¿è¡Œã€‚ä½†æ˜¯ä¼šä¸ä¼šæ˜¯æ–‡ä»¶ä¿®æ”¹é”™è¯¯ï¼Œåæ€äº†ä¸€ä¸‹æ˜¯æ‰å®‰è£…çš„è½¯ä»¶ï¼Œä»…ä»…ä¿®æ”¹äº†ç«¯å£åˆé‡æ–°ä¿®æ”¹å›å»ï¼Œä¸å¯èƒ½æ˜¯è½¯ä»¶è‡ªèº«çš„é—®é¢˜ã€‚æ­¤æ—¶æ­¤åˆ»æˆ‘ä»æ—§ä¸€å¤´é›¾æ°´ã€‚ Wampè¿è¡Œå¤±è´¥çš„ç¬¬å››æ¬¡å°è¯•è§£å†³ä¸ç”˜å¿ƒçš„æ‰“å¼€äº†ç”µè„‘ç®¡ç†ä¸­çš„æœåŠ¡ï¼Œå¼€å§‹ç€æ‰‹å»æŸ¥åˆ°åº•æ˜¯å“ªé¡¹æœåŠ¡æ²¡æœ‰è¢«æ‰“å¼€ã€‚è¿™å›ç»ˆäºå‘ç°äº†ï¼Œæ˜¯Apacheæ²¡æœ‰å¼€å¯æœåŠ¡ã€‚æˆ‘å°è¯•æ‰‹åŠ¨æ‰“å¼€ï¼Œä½†è¢«æç¤ºWindowsæ— æ³•æ‰“å¼€è¿™é¡¹æœåŠ¡ï¼Œäºæ˜¯æˆ‘ç»ˆäºæ„è¯†åˆ°é—®é¢˜å‡ºåœ¨Apacheçš„æ•…éšœã€‚æˆ‘å¼€å§‹æ€è€ƒä¼šä¸ä¼šæ˜¯Apacheçš„ç‰ˆæœ¬ä¸å…¼å®¹ï¼Œæƒ³ç€è¦ä¸è¦é‡æ–°å®‰è£…å¦ä¸€ä¸ªç‰ˆæœ¬æ¥æ›¿æ¢æ—¶ï¼Œæˆ‘åœ¨ç™¾åº¦é‡Œå‘ç°äº†ä¸€æ¡çº¿ç´¢ï¼Œè·¯å¾„é—®é¢˜ã€‚å› ä¸ºæˆ‘çš„Wampå®‰è£…åœ¨è·¯å¾„cd /d/ç¼–è¯‘å™¨/PHP/WampSeverä¸­ï¼Œæˆ‘åœ¨æƒ³ä¼šä¸ä¼šæ˜¯â€œç¼–è¯‘å™¨â€è¿™ä¸ªä¸­æ–‡è·¯å¾„çš„é”…ã€‚å› ä¸ºMySQLä¹Ÿåœ¨åŒä¸€è·¯å¾„ä½†æ˜¯æ²¡æœ‰å‡ºä»»ä½•é—®é¢˜ï¼Œäºæ˜¯æˆ‘æƒ³å¯èƒ½æ€§åº”è¯¥å¾ˆå°ã€‚ä½†æŠ±ç€ç ´ç½å­ç ´æ‘”çš„å¿ƒæ€æˆ‘è¿˜æ˜¯å°†ç»„ä»¶åˆå…¨éƒ¨å¸è½½å®‰è£…äº†ä¸€æ¬¡ï¼Œå¹¶å°†è·¯å¾„ä¸­çš„â€œç¼–è¯‘å™¨â€ä¿®æ”¹ä¸ºäº†â€œCompilerâ€ã€‚è¿™ä¸€æ¬¡ï¼Œå‡ºä¹æ„æ–™è€Œä»¤äººå“­ç¬‘ä¸å¾—çš„æ˜¯ï¼Œæ‰“å¼€WampæœåŠ¡åå®ƒç»ˆäºä»çº¢è‰²å˜æˆæ©™è‰²ï¼Œå³åˆ»è½¬ä¸ºç»¿è‰²ã€‚æ‰“å¼€localhostï¼ŒæˆåŠŸè¿›å…¥ï¼Œå¤§åŠŸå‘Šæˆã€‚ æˆ‘çš„ç¬¬ä¸€ä¸ªPHPå®ä¾‹ä¹‹åæˆ‘é¡ºåˆ©çš„æ‰“å¼€Dreamweaverï¼Œç”¨æœ€åŸºæœ¬çš„phpè¯­æ³•å†™ä¸‹äº†å’Œåˆå­¦Cè¯­è¨€æ—¶ä¸€æ ·çš„é‚£å¥æˆ‘å¾ˆå–œæ¬¢çš„è¯ï¼šecho &quot;Hello World&quot;; ä¿å­˜è¿›æå‰è®¾å®šå¥½çš„æ–‡ä»¶å¤¹è·¯å¾„åï¼Œæˆ‘å›åˆ°Wampï¼Œåœ¨localhoståæ·»åŠ äº†.phpæ–‡ä»¶çš„è·¯å¾„ï¼Œå¹¶æ‰“å¼€ã€‚è‡³æ­¤å®Œæˆã€‚ æ„Ÿæƒ³A.12æˆ–è®¸åœ¨é—®é¢˜ä¸­æŒ£æ‰ç¡®å®å¾ˆç´¯ï¼Œä½†æ˜¯è§£å†³æ‰å®ƒä¹‹åäººæ€»ä¼šä½“éªŒåˆ°åä¸ºæ‰§ç€çš„å¹¸ç¦ã€‚å¾€å¾€å¾ˆå¤šé—®é¢˜å®é™…ä¸Šæ˜¯å‡ºåœ¨ç»†èŠ‚ï¼Œå¹³é™ä¸‹æ¥ï¼Œç»†å—…è”·è–‡ï¼Œè¦æ‹†æ‰çš„ä¸ä¸€å®šæ˜¯é«˜æ¥¼å¤§å¦ï¼Œåªæ˜¯åº•å±‚è¢«æ°å¼¯çš„ä¸€æ ¹èºä¸é’‰ã€‚ B.1æ—¢ç„¶é€‰æ‹©è®¡ç®—æœºè¿™æ¡é“è·¯ï¼Œé‚£ä¹ˆé‡é—®é¢˜å°±åº”è¯¥åŠæ—¶æ˜ç¡®é—®é¢˜ã€æ‰¾å‡ºåŸå› ã€å¯¹ç—‡ä¸‹è¯ï¼Œä¸å¿˜ä¸¾ä¸€åä¸‰ï¼Œä½¿äººæ„Ÿåˆ°å¿«ä¹ã€‚ å°±åˆ°è¿™é‡Œç»“æŸå§ã€‚å®é™…ä¸Šè¿™ä¹Ÿç®—ä½œæ˜¯æˆ‘çš„ç¬¬ä¸€æ¡æ­£å¼å†™æˆçš„åšå®¢ã€‚æ„Ÿè°¢æµè§ˆã€‚ @elbadaernU --2018.2.3.","categories":[{"name":"ä¸ªäººç¬”è®°","slug":"ä¸ªäººç¬”è®°","permalink":"http://yoursite.com/categories/ä¸ªäººç¬”è®°/"}],"tags":[{"name":"php","slug":"php","permalink":"http://yoursite.com/tags/php/"}]},{"title":"Start test","slug":"Start-test","date":"2018-01-25T06:20:21.000Z","updated":"2022-06-22T03:02:18.064Z","comments":true,"path":"2018/01/25/Start-test/","link":"","permalink":"http://yoursite.com/2018/01/25/Start-test/","excerpt":"","text":"@2018.1Okeydokey.Finished.","categories":[],"tags":[]}],"categories":[{"name":"ç›®æ ‡æ£€æµ‹","slug":"ç›®æ ‡æ£€æµ‹","permalink":"http://yoursite.com/categories/ç›®æ ‡æ£€æµ‹/"},{"name":"NetworkX","slug":"NetworkX","permalink":"http://yoursite.com/categories/NetworkX/"},{"name":"Linux","slug":"Linux","permalink":"http://yoursite.com/categories/Linux/"},{"name":"GPT","slug":"GPT","permalink":"http://yoursite.com/categories/GPT/"},{"name":"BigData","slug":"BigData","permalink":"http://yoursite.com/categories/BigData/"},{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"http://yoursite.com/categories/æ·±åº¦å­¦ä¹ /"},{"name":"è®¡ç®—æœºè§†è§‰","slug":"è®¡ç®—æœºè§†è§‰","permalink":"http://yoursite.com/categories/è®¡ç®—æœºè§†è§‰/"},{"name":"Docker","slug":"Docker","permalink":"http://yoursite.com/categories/Docker/"},{"name":"Web","slug":"Web","permalink":"http://yoursite.com/categories/Web/"},{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"http://yoursite.com/categories/æœºå™¨å­¦ä¹ /"},{"name":"Python","slug":"Python","permalink":"http://yoursite.com/categories/Python/"},{"name":"ä¸ªäººç¬”è®°","slug":"ä¸ªäººç¬”è®°","permalink":"http://yoursite.com/categories/ä¸ªäººç¬”è®°/"},{"name":"æ±‡ç¼–","slug":"æ±‡ç¼–","permalink":"http://yoursite.com/categories/æ±‡ç¼–/"},{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"http://yoursite.com/categories/å‰ç«¯/"},{"name":"è„šæœ¬","slug":"è„šæœ¬","permalink":"http://yoursite.com/categories/è„šæœ¬/"},{"name":"ä¿¡æ¯å®‰å…¨","slug":"ä¿¡æ¯å®‰å…¨","permalink":"http://yoursite.com/categories/ä¿¡æ¯å®‰å…¨/"}],"tags":[{"name":"opencv","slug":"opencv","permalink":"http://yoursite.com/tags/opencv/"},{"name":"yolov8","slug":"yolov8","permalink":"http://yoursite.com/tags/yolov8/"},{"name":"nebula","slug":"nebula","permalink":"http://yoursite.com/tags/nebula/"},{"name":"å›¾ç®—æ³•","slug":"å›¾ç®—æ³•","permalink":"http://yoursite.com/tags/å›¾ç®—æ³•/"},{"name":"networkx","slug":"networkx","permalink":"http://yoursite.com/tags/networkx/"},{"name":"linuxå·¥å…·","slug":"linuxå·¥å…·","permalink":"http://yoursite.com/tags/linuxå·¥å…·/"},{"name":"LibreOffice","slug":"LibreOffice","permalink":"http://yoursite.com/tags/LibreOffice/"},{"name":"langchain-chatchat","slug":"langchain-chatchat","permalink":"http://yoursite.com/tags/langchain-chatchat/"},{"name":"chat-glm","slug":"chat-glm","permalink":"http://yoursite.com/tags/chat-glm/"},{"name":"baichuan","slug":"baichuan","permalink":"http://yoursite.com/tags/baichuan/"},{"name":"database","slug":"database","permalink":"http://yoursite.com/tags/database/"},{"name":"paddlepaddle","slug":"paddlepaddle","permalink":"http://yoursite.com/tags/paddlepaddle/"},{"name":"LiveGBS","slug":"LiveGBS","permalink":"http://yoursite.com/tags/LiveGBS/"},{"name":"OCR","slug":"OCR","permalink":"http://yoursite.com/tags/OCR/"},{"name":"nebua","slug":"nebua","permalink":"http://yoursite.com/tags/nebua/"},{"name":"spark","slug":"spark","permalink":"http://yoursite.com/tags/spark/"},{"name":"elastic search","slug":"elastic-search","permalink":"http://yoursite.com/tags/elastic-search/"},{"name":"pyspark","slug":"pyspark","permalink":"http://yoursite.com/tags/pyspark/"},{"name":"Spark","slug":"Spark","permalink":"http://yoursite.com/tags/Spark/"},{"name":"-database -nebula","slug":"database-nebula","permalink":"http://yoursite.com/tags/database-nebula/"},{"name":"Docker","slug":"Docker","permalink":"http://yoursite.com/tags/Docker/"},{"name":"fastapi","slug":"fastapi","permalink":"http://yoursite.com/tags/fastapi/"},{"name":"clickhouse","slug":"clickhouse","permalink":"http://yoursite.com/tags/clickhouse/"},{"name":"FastApi","slug":"FastApi","permalink":"http://yoursite.com/tags/FastApi/"},{"name":"scrapy","slug":"scrapy","permalink":"http://yoursite.com/tags/scrapy/"},{"name":"numpyã€pandas","slug":"numpyã€pandas","permalink":"http://yoursite.com/tags/numpyã€pandas/"},{"name":"Django","slug":"Django","permalink":"http://yoursite.com/tags/Django/"},{"name":"CNN","slug":"CNN","permalink":"http://yoursite.com/tags/CNN/"},{"name":"Hadoop","slug":"Hadoop","permalink":"http://yoursite.com/tags/Hadoop/"},{"name":"java","slug":"java","permalink":"http://yoursite.com/tags/java/"},{"name":"xpath","slug":"xpath","permalink":"http://yoursite.com/tags/xpath/"},{"name":"beautifulsoup","slug":"beautifulsoup","permalink":"http://yoursite.com/tags/beautifulsoup/"},{"name":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","permalink":"http://yoursite.com/tags/å¤šçº¿ç¨‹/"},{"name":"GET/POST...","slug":"GET-POST","permalink":"http://yoursite.com/tags/GET-POST/"},{"name":"PIL","slug":"PIL","permalink":"http://yoursite.com/tags/PIL/"},{"name":"MASM","slug":"MASM","permalink":"http://yoursite.com/tags/MASM/"},{"name":"QT","slug":"QT","permalink":"http://yoursite.com/tags/QT/"},{"name":"D3-SVG","slug":"D3-SVG","permalink":"http://yoursite.com/tags/D3-SVG/"},{"name":"çˆ¬è™«","slug":"çˆ¬è™«","permalink":"http://yoursite.com/tags/çˆ¬è™«/"},{"name":"æµ·é¾Ÿç»˜å›¾","slug":"æµ·é¾Ÿç»˜å›¾","permalink":"http://yoursite.com/tags/æµ·é¾Ÿç»˜å›¾/"},{"name":"vb","slug":"vb","permalink":"http://yoursite.com/tags/vb/"},{"name":"C","slug":"C","permalink":"http://yoursite.com/tags/C/"},{"name":"ctf","slug":"ctf","permalink":"http://yoursite.com/tags/ctf/"},{"name":"QQå¦ç™½è¯´","slug":"QQå¦ç™½è¯´","permalink":"http://yoursite.com/tags/QQå¦ç™½è¯´/"},{"name":"å·¥å…·ç«™","slug":"å·¥å…·ç«™","permalink":"http://yoursite.com/tags/å·¥å…·ç«™/"},{"name":"BurpSuite","slug":"BurpSuite","permalink":"http://yoursite.com/tags/BurpSuite/"},{"name":"php","slug":"php","permalink":"http://yoursite.com/tags/php/"}]}